<?xml version="1.0" ?>
<!DOCTYPE html 
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>電脳Ruby謹製品 インストールガイド - ソースから自分でコンパイルする際の手順</title>
<link href="http://ruby.gfd-dennou.org/tutorial/install/dennou-ruby-install.css" type="text/css" rel="stylesheet" />
</head>
<body>
<h1><a name="label:0" id="label:0">ソースから自分でコンパイルする際の手順</a></h1><!-- RDLabel: "ソースから自分でコンパイルする際の手順" -->
<p>Last updated: Thu, 25 Sep 2003 23:50:55 +0900</p>
<p>ここでは，自分で資源をダウンロードして make, install する際の手順をご説明します．</p>
<p>Linux あるいは Windows 上で Cygwin を使っていることを想定しています．
他の UNIX 系 OS の場合，Linux と同じ手順でインストールできると思いますが，
コンパイル時のオプションが若干違うかもしれませんので，
資源中の README 等のドキュメントをお読みください．</p>
<p>(Linux) (Cygwin) とあるところは，
お使いの環境と一致するほうを実行してください．</p>
<p>本ドキュメントでは，インストールされる場所は /usr/local 以下となります．
他のディレクトリにインストールしたい場合は，
<kbd>./configure</kbd> の最後に <kbd>--prefix=ディレクトリ名</kbd>
をつけ加えてください．</p>
<p>まず Cygwin をインストールされる方のために
<a href="./cygwin/">Cygwinのインストールガイド</a>もあります．どうぞご覧ください．</p>
<p>dcl-5.2-C.3, ruby-dclにパッチを当るとGTKからDCLが利用できるようになります。ただしGTKを使う際にはいくつか注意点がありますので
<a href="../gtk.html">GTKに関する情報</a>をみてください。
</p>
<h3><a name="label:7" id="label:7">準備</a></h3><!-- RDLabel: "準備" -->
<p>以下のものが必要です．インストールされていなければ，資源をダウンロードしてきましょう．</p>
<ul>
<li><a href="http://www.gfd-dennou.org/arch/dcl/dcl-5.2-C.3.tar.gz">DCL-5.2-C-3</a>
  -- C言語版 地球流体電脳ライブラリ (例外処理関数 msgdmp_ 取換可能版)
  [<a href="http://www.gfd-dennou.org/arch/dcl/">公式サイト</a>]
<ul>
<li><kbd> % which cdclcc </kbd> としてみてコマンドが見つかれば，既にインストールされています．</li>
</ul></li>
<li><a href="http://www.gfd-dennou.org/arch/netcdf/unidata-mirror/netcdf-3.5.0.tar.Z">NetCDF</a> ver. 3
  -- 自己記述式多次元データフォーマット I/O ライブラリ
  [<a href="http://my.unidata.ucar.edu/content/software/netcdf/">公式サイト</a>]
<ul>
<li><kbd> % which ncdump </kbd> としてみてコマンドが見つかれば，既にインストールされています．</li>
</ul></li>
</ul>
<p>上記ライブラリを Ruby で扱うために，Ruby とその拡張ライブラリが必要です．
(これらの拡張ライブラリは最新の Ruby 1.8 系でも動作します)</p>
<ul>
<li><a href="ftp://ftp.ruby-lang.org/pub/ruby/ruby-1.8.0.tar.gz">Ruby</a> 1.6.5 or later
  -- オブジェクト指向スクリプト言語
  [<a href="http://www.ruby-lang.org/">公式サイト</a>]
<ul>
<li><kbd> % ruby -v </kbd> としてみてバージョン名が表示されれば，既にインストールされています．</li>
</ul></li>
<li><a href="http://www.ir.isas.ac.jp/~masa/ruby/dist/narray-0.5.7.tar.gz">NArray</a>
  0.5.6p2 or later -- 多次元数値配列用 Ruby拡張ライブラリ
  [<a href="http://raa.ruby-lang.org/list.rhtml?name=narray">RAA</a>]</li>
<li><a href="http://ruby.gfd-dennou.org/products/narray_miss/narray_miss-1.0.0.tar.gz">NArrayMiss</a>
  -- NArrayで欠損値を扱うための追加クラス
  [<a href="http://ruby.gfd-dennou.org/products/narray_miss/">公式サイト</a>]</li>
<li><a href="http://ruby.gfd-dennou.org/products/ruby-dcl/ruby-dcl-1.3.0.tar.gz">RubyDCL</a>
  -- DCL用 Ruby拡張ライブラリ
  [<a href="http://raa.ruby-lang.org/list.rhtml?name=rubydcl">RAA</a>]</li>
<li><a href="http://ruby.gfd-dennou.org/products/ruby-netcdf/ruby-netcdf-0.5.2.tar.gz">RubyNetCDF</a>
  -- NetCDF用 Ruby拡張ライブラリ
  [<a href="http://raa.ruby-lang.org/list.rhtml?name=rubynetcdf">RAA</a>]</li>
</ul>
<p>これらをさらに使いやすくするためのハンドリングツールもあります．</p>
<ul>
<li><a href="http://ruby.gfd-dennou.org/products/misc/misc-0.0.3.tar.gz">Misc</a>
  -- Ruby プログラミングに便利な関数・クラス
  [<a href="http://ruby.gfd-dennou.org/products/misc/">公式サイト</a>]</li>
<li><a href="http://ruby.gfd-dennou.org/products/gphys/gphys-0.2.1.tar.gz">GPhys</a>
  -- 多次元物理量データ ハンドリングツール
  [<a href="http://ruby.gfd-dennou.org/products/gphys/">公式サイト</a>]</li>
</ul>
<p>以下，これらすべてのファイルをダウンロードして同じディレクトリに置いたもの
として解説します．</p>
<p>なお，Ruby 1.8をお使いの場合は，以下のパッチをあてる必要がありますので，
これもダウンロードしてください．</p>
<ul>
<li><a href="./patches/narray_with_ruby18.patch">narray_with_ruby18.patch</a> -- NArray Ruby 1.8 用パッチ</li>
</ul>
<p>さらに Cygwin をお使いの方は，以下のパッチもダウンロードしてください．</p>
<ul>
<li><a href="./patches/netcdf-cygwin.patch">netcdf-cygwin.patch</a> -- NetCDF Cygwin用パッチ</li>
<li><a href="./patches/ruby-netcdf-cygwin.patch">ruby-netcdf-cygwin.patch</a> -- RubyNetCDF Cygwin用パッチ</li>
</ul>
<h3><a name="label:8" id="label:8">Ruby のインストール</a></h3><!-- RDLabel: "Ruby のインストール" -->
<p>1. Ruby をインストールします．</p>
<p>Cコンパイラが必要です．ここではgccを使います．</p>
<pre>$ tar zxvf ruby-1.8.0.tar.gz
$ cd ruby-1.8.0
$ ./configure  (Linux)
$ ./configure --enable-shared  (Cygwin)
$ make
$ make test ← "test succeeded" だったらOK.
# make install</pre>
<p>2. 拡張ライブラリ NArray をインストールします．</p>
<p>Cコンパイラが必要です．ここではgccを使います．</p>
<pre>$ tar zxvf narray-0.5.7.tar.gz
$ cd narray-0.5.7
$ patch -p1 &lt; ../narray_with_ruby18.patch  (Ruby 1.8の場合)
$ ruby extconf.rb
$ make
# make site-install</pre>
<p>narray-0.5.7/test/ 以下のスクリプトを実行してテストしてみましょう．</p>
<pre>$ ruby test/statistics.rb</pre>
<p>などなど</p>
<p>※ Cygwin で Ruby 1.6 をお使いの場合は，以下の手順でインストールしてください．</p>
<p>以下のパッチをダウンロードしてください．</p>
<ul>
<li><a href="./cygwin/patches/narray_def-cygwin.patch">narray_def-cygwin.patch</a> -- NArray narray.def Cygwin用パッチ</li>
<li><a href="./cygwin/patches/narray_h-cygwin.patch">narray_h-cygwin.patch</a> -- NArray narray.h Cygwin用パッチ</li>
</ul>
<pre>$ tar zxvf narray-0.5.7.tar.gz
$ cd narray-0.5.7
$ patch -p1 &lt; ../narray_def-cygwin.patch
$ ruby extconf.rb
$ make
$ patch -p1 &lt; ../narray_h-cygwin.patch
# make site-install</pre>
<p>3. NArrayMiss をインストールします．</p>
<p>※ RubyDCL 1.3.0 から NArrayMiss 対応になりました！</p>
<p>※ RubyNetCDF 0.5.2 から NArrayMiss が必須となりました！</p>
<pre>$ tar zxvf narray_miss-1.0.0.tar.gz
$ cd narray_miss-1.0.0
# install narray_miss.rb `ruby -r rbconfig -e 'print Config::CONFIG["sitelibdir"]'`</pre>
<h3><a name="label:9" id="label:9">RubyDCL のインストール</a></h3><!-- RDLabel: "RubyDCL のインストール" -->
<p>1. C版DCLをインストールします．</p>
<p>Cコンパイラが必要です．ここではgccを使います．</p>
<pre>$ tar zxvf dcl-5.2-C.3.tar.gz
$ cd dcl-5.2-C
$ ./configure
$ make
# make install</pre>
<p>demo/ 以下のスクリプトを実行してテストしてみましょう．</p>
<pre>$ cd demo/grph2/ximage
$ make
$ ./ximg01</pre>
<p>などなど</p>
<p>2. RubyDCL をインストールします．</p>
<p>Cコンパイラが必要です．ここではgccを使います．</p>
<pre>$ tar zxvf ruby-dcl-1.3.0.tar.gz
$ cd ruby-dcl-1.3.0
$ ruby extconf.rb
$ make
# make site-install</pre>
<p>demo/ 以下のスクリプトを実行してテストしてみましょう．</p>
<pre>$ ruby demo/grph2/ximage/ximg01.rb</pre>
<p>などなど</p>
<h3><a name="label:10" id="label:10">RubyNetCDF のインストール</a></h3><!-- RDLabel: "RubyNetCDF のインストール" -->
<p>1. NetCDF をインストールします．</p>
<p>Cコンパイラが必要です．ここでは gcc を使います．</p>
<ul>
<li>RubyNetCDF を使うのに必要なのはCのインターフェイスのみですが，
  C++, FORTRANのコンパイラ(e.g. g++, g77)があれば，C++, FORTRANの
  インターフェイスもそれぞれインストールされます．
  それが嫌な場合は，<kbd> ./configure </kbd> の際に，<kbd>CXX="" FC=""</kbd> 
  としてください．詳しくは，資源中の INSTALL.html をご参照ください．</li>
<li>Cygwin の場合，C++インターフェイスのコンパイル時にエラーになりますので，
  パッチをあててください．C++インターフェイスが必要ない場合
  (<kbd>./configure</kbd> の際に <kbd> CXX="" </kbd> とした場合) は，
  このパッチは必要ありません．
  [<a href="http://op.gfz-potsdam.de/GMT-Help/Archive/msg09347.html">参考サイト</a>]</li>
</ul>
<pre>$ tar zxvf netcdf-3.5.0.tar.Z
$ cd netcdf-3.5.0/src
$ patch -p2 &lt; ../../netcdf-cygwin.patch  (Cygwin)
$ CPPFLAGS="-DNDEBUG -Df2cFortran" ./configure --prefix=/usr/local  (Linux)
$ ./configure --prefix=/usr/local  (Cygwin)
$ make
$ make test
# make install</pre>
<p>2. RubyNetCDF をインストールします．</p>
<p>Cコンパイラが必要です．ここではgccを使います．</p>
<pre>$ tar zxvf ruby-netcdf-0.5.2.tar.gz
$ cd ruby-netcdf-0.5.2
$ patch -p1 &lt; ../ruby-netcdf-cygwin.patch  (Cygwin)
$ ruby extconf.rb
$ make
# make site-install</pre>
<p>demo/ 以下のスクリプトを実行してテストしてみましょう．</p>
<pre>$ ruby demo/demo1-create.rb</pre>
<p>などなど</p>
<h3><a name="label:11" id="label:11">GPhys のインストール</a></h3><!-- RDLabel: "GPhys のインストール" -->
<p>1. Misc をインストールします．</p>
<pre>$ tar zxvf misc-0.0.3.tar.gz %))
$ cd misc-0.0.3 %))
# ruby install.rb %))</pre>
<p>2. GPhys をインストールします．</p>
<pre>$ tar zxvf gphys-0.2.0.tar.gz
$ cd gphys-0.2.0
# ruby install.rb</pre>
<p><a href="http://ruby.gfd-dennou.org/products/gphys/tutorial/">チュートリアル</a>
を参考にしていろいろ遊んでみましょう．</p>
<hr>
Copyright (C) 2003 GFD Dennou Club. All rights reserved.
</body>
</html>
