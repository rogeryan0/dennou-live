<?xml version="1.0" encoding="euc-jp"?>
<!DOCTYPE html
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>Class: wtu_module</title>
  <meta http-equiv="Content-Type" content="text/html; charset=euc-jp" />
  <meta http-equiv="Content-Script-Type" content="text/javascript" />
  <link rel="stylesheet" href=".././rdoc-style.css" type="text/css" media="screen" />
  <script type="text/javascript">
  // <![CDATA[

  function popupCode( url ) {
    window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
  }

  function toggleCode( id ) {
    if ( document.getElementById )
      elem = document.getElementById( id );
    else if ( document.all )
      elem = eval( "document.all." + id );
    else
      return false;

    elemStyle = elem.style;

    if ( elemStyle.display != "block" ) {
      elemStyle.display = "block"
    } else {
      elemStyle.display = "none"
    }

    return true;
  }

  // Make codeblocks hidden by default
  document.writeln( "<style type=\"text/css\">div.method-source-code { display: none }</style>" )

  // ]]>
  </script>

</head>
<body>


    <div id="classHeader">
        <table class="header-table">
        <tr class="top-aligned-row">
          <td><strong>Class</strong></td>
          <td class="class-name-in-header">wtu_module</td>
        </tr>
        <tr class="top-aligned-row">
            <td><strong>In:</strong></td>
            <td>


                <a href="../files/src/wtu_module_f90.html">

                src/wtu_module.f90

                </a>


        <br />
            </td>
        </tr>


        </table>
    </div>
  <!-- banner header -->

  <div id="bodyContent">


  <div id="contextContent">



    <div id="description">
      <h1><a href="wtu_module.html">wtu_module</a></h1>
<table>
<tr><td valign="top">Authors:</td><td>Shin-ichi Takehiro, Youhei SASAKI

</td></tr>
<tr><td valign="top">Version:</td><td>$Id: <a href="../files/src/wtu_module_f90.html">wtu_module.f90</a>,v 1.5
2009-02-28 21:33:48 uwabami Exp $

</td></tr>
<tr><td valign="top">Copyright&amp;License:</td><td>See <a href="../../COPYRIGHT">COPYRIGHT</a>

</td></tr>
</table>
<h2>概要</h2>
<p>
spml/wtu_module モジュールは球とその外側の球殻領域での流体運動を
スペクトル法によって数値計算するための Fortran90 関数を提供する ものである.
</p>
<p>
水平方向に球面調和函数変換および動径方向にチェビシェフ変換を用いる
場合のスペクトル計算のためのさまざまな関数を提供する.
</p>
<p>
内部で <a href="wt_module.html">wt_module</a>, <a
href="wu_module.html">wu_module</a> を用いている. 最下部では球面調和変換
およびチェビシェフ変換のエンジンとして ISPACK の Fortran77
サブルーチンを用いている.
</p>
<h2>関数・変数の名前と型について</h2>
<h3>命名法</h3>
<ul>
<li>関数名の先頭 (wu_, nmr_, nr_, xyr_, wr_, w_, xy_, x_, y_, r_, a_, wt_,
nmz_, nz_, xyz_, wz_, w_, xy_, x_, y_, z_, a_) は, 返す値の形を示している.

<table>
<tr><td valign="top">wt_  :</td><td>スペクトルデータ(球面調和函数・チェビシェフ変換-球殻)

</td></tr>
<tr><td valign="top">nmz_ :</td><td>水平スペクトルデータ(全波数 n, 帯状波数各成分, 動径-球殻)

</td></tr>
<tr><td valign="top">nz_  :</td><td>水平スペクトルデータ(全波数 n, 動径-球殻)

</td></tr>
<tr><td valign="top">xyz_ :</td><td>3 次元格子点データ(経度・緯度・動径-球殻)

</td></tr>
<tr><td valign="top">wz_  :</td><td>水平スペクトル, 動径格子点データ, 球殻

</td></tr>
<tr><td valign="top">wu_  :</td><td>スペクトルデータ(球面調和函数・チェビシェフ変換-球)

</td></tr>
<tr><td valign="top">nmr_ :</td><td>水平スペクトルデータ(全波数 n, 帯状波数各成分, 動径-球)

</td></tr>
<tr><td valign="top">nr_  :</td><td>水平スペクトルデータ(全波数 n, 動径-球)

</td></tr>
<tr><td valign="top">xyr_ :</td><td>3 次元格子点データ(経度・緯度・動径-球)

</td></tr>
<tr><td valign="top">wr_  :</td><td>水平スペクトル, 動径格子点データ, 球

</td></tr>
</table>
</li>
<li>関数名の間の文字列(DLon, GradLat, GradLat, DivLon, DivLat, Lapla,..) は,
その関数の作用を表している.

</li>
<li>関数名の最後 (wt_, xyz_, wz_, w_, xy_, x_, y_, z_, a_, wu_, xyz_, wr_, w_,
xy_, x_, y_, r_, a_) は, 入力変数の形が
スペクトルデータおよび格子点データであることを示している.

<table>
<tr><td valign="top">_wt      :</td><td>スペクトルデータ

</td></tr>
<tr><td valign="top">_xyz     :</td><td>3 次元格子点データ

</td></tr>
<tr><td valign="top">_xyz_xyz :</td><td>2 つの3 次元格子点データ, &#8230;

</td></tr>
<tr><td valign="top">_wu      :</td><td>スペクトルデータ

</td></tr>
<tr><td valign="top">_xyr     :</td><td>3 次元格子点データ

</td></tr>
<tr><td valign="top">_xyr_xyr :</td><td>2 つの3 次元格子点データ, &#8230;

</td></tr>
</table>
</li>
</ul>
<h3>各データの種類の説明</h3>
<ul>
<li>xyz : 3 次元格子点データ(経度・緯度・動径-球殻)

<ul>
<li>変数の種類と次元は real(8), dimension(0:im-1,1:jm,0:km).

</li>
<li>im, jm, km はそれぞれ経度, 緯度, 動径座標の格子点数であり, サブルーチン
wt_Initial にてあらかじめ設定しておく.

</li>
</ul>
</li>
<li>wt : スペクトルデータ-球殻

<ul>
<li>変数の種類と次元は real(8), dimension((nm+1)*(nm+1),0:lm).

</li>
<li>nm は球面調和函数の最大全波数, lm はチェビシェフ多項式の最大次数 であり,
サブルーチン wt_Initial にてあらかじめ設定しておく.

</li>
<li>水平スペクトルデータの格納のされ方は関数 <a
href="wtu_module.html#M001683">l_nm</a>, <a
href="wtu_module.html#M001687">nm_l</a> によって調べる ことができる.

</li>
</ul>
</li>
<li>nmz : 水平スペクトルデータの並んだ 3 次元配列(球殻).

<ul>
<li>変数の種類と次元は real(8), dimension(0:nm,-nm:nm,0:km).

</li>
<li>第 1 次元が水平全波数, 第 2 次元が帯状波数, 第 3 次元が動径座標を表す.

</li>
<li>nm は球面調和函数の最大全波数であり, サブルーチン wt_Initial にて
あらかじめ設定しておく.

</li>
</ul>
</li>
<li>nz : スペクトルデータの並んだ 2 次元配列(球殻).

<ul>
<li>変数の種類と次元は real(8), dimension(0:nm,0:km).

</li>
<li>第 1 次元が水平全波数を表す. nm は球面調和函数の最大全波数であり,
サブルーチン wt_Initial にてあらかじめ設定しておく.

</li>
</ul>
</li>
<li>wz : 水平スペクトル, 動径格子点データ(球殻).

<ul>
<li>変数の種類と次元は real(8), dimension((nm+1)*(nm+1),0:km).

</li>
</ul>
</li>
<li>xyr : 3 次元格子点データ(経度・緯度・動径-球)

<ul>
<li>変数の種類と次元は real(8), dimension(0:im-1,1:jm,0:km).

</li>
<li>im, jm, km はそれぞれ経度, 緯度, 動径座標の格子点数であり, サブルーチン
wt_Initial にてあらかじめ設定しておく.

</li>
</ul>
</li>
<li>wu : スペクトルデータ(球)

<ul>
<li>変数の種類と次元は real(8), dimension((nm+1)*(nm+1),0:lm).

</li>
<li>nm は球面調和函数の最大全波数, lm はチェビシェフ多項式の最大次数 であり,
サブルーチン wt_Initial にてあらかじめ設定しておく.

</li>
<li>水平スペクトルデータの格納のされ方は関数 <a
href="wtu_module.html#M001683">l_nm</a>, <a
href="wtu_module.html#M001687">nm_l</a> によって調べる ことができる.

</li>
</ul>
</li>
<li>nmr : 水平スペクトルデータの並んだ 3 次元配列(球).

<ul>
<li>変数の種類と次元は real(8), dimension(0:nm,-nm:nm,0:km).

</li>
<li>第 1 次元が水平全波数, 第 2 次元が帯状波数, 第 3 次元が動径座標を表す.

</li>
<li>nm は球面調和函数の最大全波数であり, サブルーチン wt_Initial にて
あらかじめ設定しておく.

</li>
</ul>
</li>
<li>nr : スペクトルデータの並んだ 2 次元配列(球).

<ul>
<li>変数の種類と次元は real(8), dimension(0:nm,0:km).

</li>
<li>第 1 次元が水平全波数を表す. nm は球面調和函数の最大全波数であり,
サブルーチン wt_Initial にてあらかじめ設定しておく.

</li>
</ul>
</li>
<li>wr : 水平スペクトル, 動径格子点データ(球).

<ul>
<li>変数の種類と次元は real(8), dimension((nm+1)*(nm+1),0:km).

</li>
</ul>
</li>
<li>wt_ で始まる関数が返す値はスペクトルデータに同じ.

</li>
<li>xyz_ で始まる関数が返す値は 3 次元格子点データに同じ.

</li>
<li>wz_ で始まる関数が返す値は水平スペクトル, 動径格子点データに同じ.

</li>
<li>wu_ で始まる関数が返す値はスペクトルデータに同じ.

</li>
<li>xyr_ で始まる関数が返す値は 3 次元格子点データに同じ.

</li>
<li>wr_ で始まる関数が返す値は水平スペクトル, 動径格子点データに同じ.

</li>
<li>スペクトルデータに対する微分等の作用とは, 対応する格子点データに
微分などを作用させたデータをスペクトル変換したものことである.

</li>
</ul>
<h2>変数・手続き群の要約</h2>
<h4>初期化</h4>
<table>
<tr><td valign="top"><a href="wtu_module.html#M001670">wtu_Initial</a> :</td><td>スペクトル変換の格子点数, 波数, 領域の大きさの設定

</td></tr>
</table>
<h4>座標変数</h4>
<table>
<tr><td valign="top"><a href="wtu_module.html#M001677">x_Lon</a>, <a href="wtu_module.html#M001679">y_Lat</a>               :</td><td>格子点座標(緯度, 経度)を格納した1 次元配列

</td></tr>
<tr><td valign="top"><a href="wtu_module.html#M001681">z_Rad</a>                      :</td><td>格子点座標(動径, 球殻)を格納した1 次元配列

</td></tr>
<tr><td valign="top">r_Rad                      :</td><td>格子点座標(動径, 球)を格納した1 次元配列

</td></tr>
<tr><td valign="top"><a href="wtu_module.html#M001678">x_Lon_Weight</a>, <a href="wtu_module.html#M001680">y_Lat_Weight</a> :</td><td>重み座標を格納した 1 次元配列

</td></tr>
<tr><td valign="top"><a href="wtu_module.html#M001682">z_Rad_Weight</a>               :</td><td>重み座標を格納した 1 次元配列

</td></tr>
<tr><td valign="top">r_Rad_Weight               :</td><td>重み座標を格納した 1 次元配列

</td></tr>
<tr><td valign="top"><a href="wtu_module.html#M001691">xyz_Lon</a>, <a href="wtu_module.html#M001692">xyz_Lat</a>           :</td><td>格子点データの経度・緯度(X,Y) (格子点データ型 3 次元配列)

</td></tr>
<tr><td valign="top"><a href="wtu_module.html#M001693">xyz_Rad</a>                    :</td><td>格子点データの動径(球殻)(Z) (格子点データ型 3 次元配列)

</td></tr>
<tr><td valign="top"><a href="wtu_module.html#M001788">xyr_Lon</a>, <a href="wtu_module.html#M001789">xyr_Lat</a>           :</td><td>格子点データの経度・緯度(X,Y) (格子点データ型 3 次元配列)

</td></tr>
<tr><td valign="top"><a href="wtu_module.html#M001790">xyr_Rad</a>                    :</td><td>格子点データの動径(球) (格子点データ型 3 次元配列)

</td></tr>
</table>
<h4>基本変換</h4>
<table>
<tr><td valign="top"><a href="wtu_module.html#M001702">xyz_wt</a>, <a href="wtu_module.html#M001703">wt_xyz</a> :</td><td>スペクトルデータと 3 次元格子データの間の変換 (球面調和函数,
チェビシェフ変換)

</td></tr>
<tr><td valign="top"><a href="wtu_module.html#M001704">xyz_wz</a>, <a href="wtu_module.html#M001705">wz_xyz</a> :</td><td>3 次元格子データと水平スペクトル・動径格子データとの 間の変換
(球面調和函数)

</td></tr>
<tr><td valign="top"><a href="wtu_module.html#M001706">wz_wt</a>, <a href="wtu_module.html#M001707">wt_wz</a>   :</td><td>スペクトルデータと水平スペクトル・動径格子データとの 間の変換
(チェビシェフ変換)

</td></tr>
<tr><td valign="top"><a href="wtu_module.html#M001793">xyr_wu</a>, <a href="wtu_module.html#M001794">wu_xyr</a> :</td><td>スペクトルデータと 3 次元格子データの 間の変換 (球面調和函数,
チェビシェフ変換)

</td></tr>
<tr><td valign="top"><a href="wtu_module.html#M001795">xyr_wr</a>, <a href="wtu_module.html#M001796">wr_xyr</a> :</td><td>3 次元格子データと水平スペクトル・動径格子データとの 間の変換
(球面調和函数)

</td></tr>
<tr><td valign="top">wr_wu, wu_wr   :</td><td>スペクトルデータと水平スペクトル・動径格子データとの 間の変換
(チェビシェフ変換)

</td></tr>
<tr><td valign="top"><a href="wtu_module.html#M001696">w_xy</a>, <a href="wtu_module.html#M001697">xy_w</a>     :</td><td>スペクトルデータと 2 次元水平格子データの 間の変換(球面調和函数変換)

</td></tr>
<tr><td valign="top"><a href="wtu_module.html#M001683">l_nm</a>, <a href="wtu_module.html#M001687">nm_l</a>     :</td><td>スペクトルデータの格納位置と全波数・帯状波数の変換

</td></tr>
</table>
<h4>微分</h4>
<table>
<tr><td valign="top"><a href="wtu_module.html#M001708">wt_DRad_wt</a>          :</td><td>スペクトルデータに動径微分 ∂/∂r を作用させる

</td></tr>
<tr><td valign="top"><a href="wtu_module.html#M001709">wt_DivRad_wt</a>        :</td><td>スペクトルデータに発散型動径微分 1/r^2 ∂/∂r r^2 = ∂/∂r + 2/r
を作用させる

</td></tr>
<tr><td valign="top"><a href="wtu_module.html#M001710">wt_RotRad_wt</a>        :</td><td>スペクトルデータに回転型動径微分 1/r ∂/∂rr = ∂/∂r + 1/r を作用させる

</td></tr>
<tr><td valign="top"><a href="wtu_module.html#M001711">wt_Lapla_wt</a>         :</td><td>スペクトルデータにラプラシアンを作用させる

</td></tr>
<tr><td valign="top"><a href="wtu_module.html#M001712">xyz_GradLon_wt</a>      :</td><td>スペクトルデータに勾配型経度微分 1/rcosφ・∂/∂λを作用させる

</td></tr>
<tr><td valign="top"><a href="wtu_module.html#M001713">xyz_GradLat_wt</a>      :</td><td>スペクトルデータに勾配型緯度微分 1/r・∂/∂φを作用させる

</td></tr>
<tr><td valign="top"><a href="wtu_module.html#M001714">wt_DivLon_xyz</a>       :</td><td>格子データに発散型経度微分 1/rcosφ・∂/∂λを作用させる

</td></tr>
<tr><td valign="top"><a href="wtu_module.html#M001715">wt_DivLat_xyz</a>       :</td><td>格子データに発散型緯度微分 1/rcosφ・∂(g cosφ)/∂φを作用させる

</td></tr>
<tr><td valign="top"><a href="wtu_module.html#M001716">wt_Div_xyz_xyz_xyz</a>  :</td><td>ベクトル成分である 3 つの格子データに 発散を作用させる

</td></tr>
<tr><td valign="top"><a href="wtu_module.html#M001717">xyz_Div_xyz_xyz_xyz</a> :</td><td>ベクトル成分である 3 つの格子データに 発散を作用させる

</td></tr>
<tr><td valign="top"><a href="wtu_module.html#M001718">xyz_RotLon_wt_wt</a>    :</td><td>ベクトル場の回転の経度成分を計算する

</td></tr>
<tr><td valign="top"><a href="wtu_module.html#M001719">xyz_RotLat_wt_wt</a>    :</td><td>ベクトル場の回転の緯度成分を計算する

</td></tr>
<tr><td valign="top"><a href="wtu_module.html#M001720">wt_RotRad_xyz_xyz</a>   :</td><td>ベクトル場の回転の動径成分を計算する

</td></tr>
<tr><td valign="top">wr_DRad_wu          :</td><td>スペクトルデータに動径微分 ∂/∂r を作用させる

</td></tr>
<tr><td valign="top">wr_DRad2_wu         :</td><td>スペクトルデータに動径微分 ∂^2/∂r^2 を作用させる

</td></tr>
<tr><td valign="top"><a href="wtu_module.html#M001797">wr_DivRad_wu</a>        :</td><td>スペクトルデータに発散型動径微分 1/r^2 ∂/∂r r^2 = ∂/∂r + 2/r
を作用させる

</td></tr>
<tr><td valign="top"><a href="wtu_module.html#M001798">wr_RotRad_wu</a>        :</td><td>スペクトルデータに回転型動径微分 1/r ∂/∂rr = ∂/∂r + 1/r を作用させる

</td></tr>
<tr><td valign="top"><a href="wtu_module.html#M001799">wr_Lapla_wu</a>         :</td><td>スペクトルデータにラプラシアンを作用させる

</td></tr>
<tr><td valign="top"><a href="wtu_module.html#M001800">xyr_GradLon_wu</a>      :</td><td>スペクトルデータに勾配型経度微分 1/rcosφ・∂/∂λを作用させる

</td></tr>
<tr><td valign="top"><a href="wtu_module.html#M001801">xyr_GradLat_wu</a>      :</td><td>スペクトルデータに勾配型緯度微分 1/r・∂/∂φを作用させる

</td></tr>
<tr><td valign="top"><a href="wtu_module.html#M001802">wr_DivLon_xyr</a>       :</td><td>格子データに発散型経度微分 1/rcosφ・∂/∂λを作用させる

</td></tr>
<tr><td valign="top"><a href="wtu_module.html#M001803">wr_DivLat_xyr</a>       :</td><td>格子データに発散型緯度微分 1/rcosφ・∂(g cosφ)/∂φを作用させる

</td></tr>
<tr><td valign="top"><a href="wtu_module.html#M001804">wr_Div_xyr_xyr_xyr</a>  :</td><td>ベクトル成分である 3 つの格子データに 発散を作用させる

</td></tr>
<tr><td valign="top"><a href="wtu_module.html#M001805">xyr_Div_xyr_xyr_xyr</a> :</td><td>ベクトル成分である 3 つの格子データに 発散を作用させる

</td></tr>
<tr><td valign="top"><a href="wtu_module.html#M001806">xyr_RotLon_wu_wu</a>    :</td><td>ベクトル場の回転の経度成分を計算する

</td></tr>
<tr><td valign="top"><a href="wtu_module.html#M001807">xyr_RotLat_wu_wu</a>    :</td><td>ベクトル場の回転の緯度成分を計算する

</td></tr>
<tr><td valign="top"><a href="wtu_module.html#M001808">wr_RotRad_xyr_xyr</a>   :</td><td>ベクトル場の回転の動径成分を計算する

</td></tr>
</table>
<h4>トロイダルポロイダル計算用微分</h4>
<table>
<tr><td valign="top"><a href="wtu_module.html#M001759">wt_KxRGrad_wt</a>            :</td><td>スペクトルデータに経度微分 k×r・▽ = ∂/∂λを作用させる

</td></tr>
<tr><td valign="top"><a href="wtu_module.html#M001760">xyz_KGrad_wt</a>             :</td><td>スペクトルデータに軸方向微分 k・▽ = cosφ/r ∂/∂φ + sinφ∂/∂r を
作用させる

</td></tr>
<tr><td valign="top"><a href="wtu_module.html#M001761">wt_L2_wt</a>                 :</td><td>スペクトルデータに L2 演算子 = -水平ラプラシアンを 作用させる

</td></tr>
<tr><td valign="top"><a href="wtu_module.html#M001762">wt_L2Inv_wt</a>              :</td><td>スペクトルデータに L2 演算子の逆 = -逆水平ラプラシアンを 作用させる

</td></tr>
<tr><td valign="top"><a href="wtu_module.html#M001763">wt_QOperator_wt</a>          :</td><td>スペクトルデータに演算子 Q=(k・▽-1/2(L2 k・▽+ k・▽L2)) を 作用させる

</td></tr>
<tr><td valign="top"><a href="wtu_module.html#M001764">wt_RadRot_xyz_xyz</a>        :</td><td>ベクトル v の渦度と動径ベクトル r の内積 r・(▽×v) を計算する

</td></tr>
<tr><td valign="top"><a href="wtu_module.html#M001765">wt_RadRotRot_xyz_xyz_xyz</a> :</td><td>ベクトルの v の r・(▽×▽×v) を計算する

</td></tr>
<tr><td valign="top"><a href="wtu_module.html#M001766">wt_Potential2Vector</a>      :</td><td>トロイダルポロイダルポテンシャルから ベクトル場を計算する

</td></tr>
<tr><td valign="top"><a href="wtu_module.html#M001767">wt_Potential2Rotation</a>    :</td><td>トロイダルポロイダルポテンシャルで表される
非発散ベクトル場の回転の各成分を計算する

</td></tr>
<tr><td valign="top"><a href="wtu_module.html#M001839">wu_L2_wu</a>                 :</td><td>スペクトルデータに L2 演算子 = -水平ラプラシアンを作用させる

</td></tr>
<tr><td valign="top"><a href="wtu_module.html#M001840">wu_L2Inv_wu</a>              :</td><td>スペクトルデータに L2 演算子の逆 = -逆水平ラプラシアンを 作用させる

</td></tr>
<tr><td valign="top"><a href="wtu_module.html#M001841">wu_QOperator_wu</a>          :</td><td>スペクトルデータに演算子 Q=(k・▽-1/2(L2 k・▽+ k・▽L2)) を 作用させる

</td></tr>
<tr><td valign="top"><a href="wtu_module.html#M001842">wu_RadRot_xyr_xyr</a>        :</td><td>ベクトル v の渦度と動径ベクトル r の内積 r・(▽×v) を計算する

</td></tr>
<tr><td valign="top"><a href="wtu_module.html#M001843">wr_RadRotRot_xyr_xyr_xyr</a> :</td><td>ベクトルの v の r・(▽×▽×v) を計算する

</td></tr>
<tr><td valign="top"><a href="wtu_module.html#M001844">wu_Potential2Vector</a>      :</td><td>トロイダルポロイダルポテンシャルから ベクトル場を計算する

</td></tr>
<tr><td valign="top"><a href="wtu_module.html#M001845">wu_Potential2Rotation</a>    :</td><td>トロイダルポロイダルポテンシャルで表される
非発散ベクトル場の回転の各成分を計算する

</td></tr>
</table>
<h4>ポロイダル/トロイダルモデル用スペクトル解析</h4>
<table>
<tr><td valign="top"><a href="wtu_module.html#M001770">nmz_ToroidalEnergySpectrum_wt</a>, <a href="wtu_module.html#M001771">nz_ToroidalEnergySpectrum_wt</a>   :</td><td>トロイダルポテンシャルからエネルギーの球面調和函数各成分を計算する

</td></tr>
<tr><td valign="top"><a href="wtu_module.html#M001772">nmz_PoloidalEnergySpectrum_wt</a>, <a href="wtu_module.html#M001773">nz_PoloidalEnergySpectrum_wt</a>   :</td><td>ポロイダルポテンシャルからエネルギーの球面調和函数各成分を計算する

</td></tr>
<tr><td valign="top"><a href="wtu_module.html#M001846">nmr_ToroidalEnergySpectrum_wu</a>, <a href="wtu_module.html#M001847">nr_ToroidalEnergySpectrum_wu</a>   :</td><td>トロイダルポテンシャルからエネルギーの球面調和函数各成分を計算する

</td></tr>
<tr><td valign="top"><a href="wtu_module.html#M001848">nmr_PoloidalEnergySpectrum_wu</a>, <a href="wtu_module.html#M001849">nr_PoloidalEnergySpectrum_wu</a>   :</td><td>ポロイダルポテンシャルからエネルギーの球面調和函数各成分を計算する

</td></tr>
</table>
<h4>境界値問題</h4>
<table>
<tr><td valign="top"><a href="wtu_module.html#M001779">wt_BoundariesTau</a>, <a href="wtu_module.html#M001783">wt_BoundariesGrid</a>, <a href="wtu_module.html#M001774">wt_Boundaries</a>                   :</td><td>タウ法, 選点法

</td></tr>
<tr><td valign="top"><a href="wtu_module.html#M001780">wt_TorBoundariesTau</a>, <a href="wtu_module.html#M001784">wt_TorBoundariesGrid</a>, <a href="wtu_module.html#M001775">wt_TorBoundaries</a>          :</td><td>速度トロイダルポテンシャルの境界条件を球殻領域に適用する (タウ法,選点法)

</td></tr>
<tr><td valign="top"><a href="wtu_module.html#M001776">wz_LaplaPol2Pol_wz</a>, wt_LaplaPol2Pol_wt                               :</td><td>球殻領域の速度ポロイダルポテンシャルΦを▽^2Φから求める
(入出力がそれぞれチェビシェフ格子点,チェビシェフ係数)

</td></tr>
<tr><td valign="top"><a href="wtu_module.html#M001781">wt_TorMagBoundariesTau</a>, <a href="wtu_module.html#M001786">wt_TorMagBoundariesGrid</a>, <a href="wtu_module.html#M001777">wt_TorMagBoundaries</a> :</td><td>磁場トロイダルポテンシャルの境界条件を球殻領域に適用する (タウ法, 選点法)

</td></tr>
<tr><td valign="top"><a href="wtu_module.html#M001782">wt_PolMagBoundariesTau</a>, <a href="wtu_module.html#M001787">wt_PolMagBoundariesGrid</a>, <a href="wtu_module.html#M001778">wt_PolMagBoundaries</a> :</td><td>磁場トロイダルポテンシャル境界の境界条件を球殻領域に適用する (タウ法,
選点法)

</td></tr>
<tr><td valign="top"><a href="wtu_module.html#M001850">wu_BoundaryTau</a>, <a href="wtu_module.html#M001851">wu_BoundaryGrid</a>, <a href="wtu_module.html#M001860">wu_Boundary</a>                         :</td><td>球領域にディリクレ, ノイマン境界条件を適用する (タウ法, 選点法)

</td></tr>
<tr><td valign="top"><a href="wtu_module.html#M001852">wu_TorBoundaryTau</a>, <a href="wtu_module.html#M001853">wu_TorBoundaryGrid</a>, <a href="wtu_module.html#M001861">wu_TorBoundary</a>                :</td><td>球領域の速度トロイダルポテンシャルの境界条件を適用する(タウ法,選点法)

</td></tr>
<tr><td valign="top"><a href="wtu_module.html#M001854">wr_LaplaPol2Pol_wr</a>, wu_LaplaPol2Pol_wu                               :</td><td>球領域の速度ポロイダルポテンシャルΦを▽^2Φから求める
(入出力がそれぞれチェビシェフ格子点,チェビシェフ係数)

</td></tr>
<tr><td valign="top"><a href="wtu_module.html#M001856">wu_TorMagBoundaryTau</a>, <a href="wtu_module.html#M001857">wu_TorMagBoundaryGrid</a>, <a href="wtu_module.html#M001862">wu_TorMagBoundary</a>       :</td><td>磁場トロイダルポテンシャルの境界条件を球領域に適用する(タウ法, 選点法)

</td></tr>
<tr><td valign="top"><a href="wtu_module.html#M001858">wu_PolMagBoundaryTau</a>, <a href="wtu_module.html#M001859">wu_PolMagBoundaryGrid</a>, <a href="wtu_module.html#M001863">wu_PolMagBoundary</a>       :</td><td>磁場トロイダルポテンシャル境界の境界条件を球領域に適用する (タウ法, 選点法)

</td></tr>
<tr><td valign="top"><a href="wtu_module.html#M001671">wtu_TormagBoundariesTau</a>, <a href="wtu_module.html#M001672">wtu_TormagBoundariesGrid</a>                    :</td><td>磁場トロイダルポテンシャル境界の境界条件を球および球殻領域全体に
適用する(タウ法, 選点法)

</td></tr>
</table>
<h4>積分・平均(3 次元データ)</h4>
<table>
<tr><td valign="top"><a href="wtu_module.html#M001727">IntLonLatRad_xyz</a>, <a href="wtu_module.html#M001746">AvrLonLatRad_xyz</a> :</td><td>3 次元格子点データの 全領域積分および平均

</td></tr>
<tr><td valign="top"><a href="wtu_module.html#M001726">z_IntLonLat_xyz</a>, <a href="wtu_module.html#M001745">z_AvrLonLat_xyz</a>   :</td><td>3 次元格子点データの 緯度経度(水平・球面)積分および平均

</td></tr>
<tr><td valign="top"><a href="wtu_module.html#M001725">y_IntLonRad_xyz</a>, <a href="wtu_module.html#M001744">y_AvrLonRad_xyz</a>   :</td><td>3 次元格子点データの 緯度動径積分および平均

</td></tr>
<tr><td valign="top">z_IntLatRad_xyz, z_AvrLatRad_xyz   :</td><td>3 次元格子点データの 経度動径(子午面)積分および平均

</td></tr>
<tr><td valign="top"><a href="wtu_module.html#M001721">yz_IntLon_xyz</a>, <a href="wtu_module.html#M001740">yz_AvrLon_xyz</a>       :</td><td>3 次元格子点データの 経度方向積分および平均

</td></tr>
<tr><td valign="top"><a href="wtu_module.html#M001722">xz_IntLat_xyz</a>, <a href="wtu_module.html#M001741">xz_AvrLat_xyz</a>       :</td><td>3 次元格子点データの 緯度方向積分および平均

</td></tr>
<tr><td valign="top">xz_IntRad_xyz, xz_AvrRad_xyz       :</td><td>3 次元格子点データの 動径方向積分および平均

</td></tr>
<tr><td valign="top"><a href="wtu_module.html#M001815">IntLonLatRad_xyr</a>, <a href="wtu_module.html#M001829">AvrLonLatRad_xyr</a> :</td><td>3 次元格子点データの 全領域積分および平均

</td></tr>
<tr><td valign="top">z_IntLonLat_xyr, z_AvrLonLat_xyr   :</td><td>3 次元格子点データの 緯度経度(水平・球面)積分および平均

</td></tr>
<tr><td valign="top"><a href="wtu_module.html#M001813">y_IntLonRad_xyr</a>, <a href="wtu_module.html#M001827">y_AvrLonRad_xyr</a>   :</td><td>3 次元格子点データの 緯度動径積分および平均

</td></tr>
<tr><td valign="top">z_IntLatRad_xyr, z_AvrLatRad_xyr   :</td><td>3 次元格子点データの 経度動径(子午面)積分および平均

</td></tr>
<tr><td valign="top">yz_IntLon_xyr, yz_AvrLon_xyr       :</td><td>3 次元格子点データの 経度方向積分および平均

</td></tr>
<tr><td valign="top">xz_IntLat_xyr, xz_AvrLat_xyr       :</td><td>3 次元格子点データの 緯度方向積分および平均

</td></tr>
<tr><td valign="top">xz_IntRad_xyr, xz_AvrRad_xyr       :</td><td>3 次元格子点データの 動径方向積分および平均

</td></tr>
</table>
<h4>積分・平均(2 次元データ)</h4>
<table>
<tr><td valign="top"><a href="wtu_module.html#M001730">IntLonLat_xy</a>, <a href="wtu_module.html#M001749">AvrLonLat_xy</a> :</td><td>2 次元格子点データの水平(球面)積分および平均

</td></tr>
<tr><td valign="top"><a href="wtu_module.html#M001736">IntLonRad_xz</a>, <a href="wtu_module.html#M001755">AvrLonRad_xz</a> :</td><td>2 次元(XZ)格子点データの経度動径積分 および平均

</td></tr>
<tr><td valign="top"><a href="wtu_module.html#M001733">IntLatRad_yz</a>, <a href="wtu_module.html#M001752">AvrLatRad_yz</a> :</td><td>2 次元(YZ)格子点データの緯度動径(子午面) 積分および平均

</td></tr>
<tr><td valign="top"><a href="wtu_module.html#M001729">y_IntLon_xy</a>, <a href="wtu_module.html#M001748">y_AvrLon_xy</a>   :</td><td>水平 2 次元(球面)格子点データの経度方向 積分および平均

</td></tr>
<tr><td valign="top"><a href="wtu_module.html#M001728">x_IntLat_xy</a>, <a href="wtu_module.html#M001747">x_AvrLat_xy</a>   :</td><td>水平2 次元(球面)格子点データの緯度方向積分 および平均

</td></tr>
<tr><td valign="top"><a href="wtu_module.html#M001734">z_IntLon_xz</a>, <a href="wtu_module.html#M001753">z_AvrLon_xz</a>   :</td><td>2 次元(XZ)格子点データの経度方向積分および 平均

</td></tr>
<tr><td valign="top"><a href="wtu_module.html#M001735">x_IntRad_xz</a>, <a href="wtu_module.html#M001754">x_AvrRad_xz</a>   :</td><td>2 次元(XZ)格子点データの動径方向積分および 平均

</td></tr>
<tr><td valign="top"><a href="wtu_module.html#M001731">z_IntLat_yz</a>, <a href="wtu_module.html#M001750">z_AvrLat_yz</a>   :</td><td>2 次元(YZ)格子点データの緯度方向積分および 平均

</td></tr>
<tr><td valign="top"><a href="wtu_module.html#M001732">y_IntRad_yz</a>, <a href="wtu_module.html#M001751">y_AvrRad_yz</a>   :</td><td>2 次元(YZ)格子点データの動径方向積分および 平均

</td></tr>
<tr><td valign="top"><a href="wtu_module.html#M001821">IntLonRad_xr</a>, <a href="wtu_module.html#M001835">AvrLonRad_xr</a> :</td><td>2 次元(XZ)格子点データの経度動径積分 および平均

</td></tr>
<tr><td valign="top"><a href="wtu_module.html#M001818">IntLatRad_yr</a>, <a href="wtu_module.html#M001832">AvrLatRad_yr</a> :</td><td>2 次元(YZ)格子点データの緯度動径(子午面) 積分および平均

</td></tr>
<tr><td valign="top"><a href="wtu_module.html#M001819">r_IntLon_xr</a>, <a href="wtu_module.html#M001833">r_AvrLon_xr</a>   :</td><td>2 次元(XZ)格子点データの経度方向積分および 平均

</td></tr>
<tr><td valign="top"><a href="wtu_module.html#M001820">x_IntRad_xr</a>, <a href="wtu_module.html#M001834">x_AvrRad_xr</a>   :</td><td>2 次元(XZ)格子点データの動径方向積分および 平均

</td></tr>
<tr><td valign="top"><a href="wtu_module.html#M001816">r_IntLat_yr</a>, <a href="wtu_module.html#M001830">r_AvrLat_yr</a>   :</td><td>2 次元(YZ)格子点データの緯度方向積分および 平均

</td></tr>
<tr><td valign="top"><a href="wtu_module.html#M001817">y_IntRad_yr</a>, <a href="wtu_module.html#M001831">y_AvrRad_yr</a>   :</td><td>2 次元(YZ)格子点データの動径方向積分および 平均

</td></tr>
</table>
<h4>積分・平均(1 次元データ)</h4>
<table>
<tr><td valign="top"><a href="wtu_module.html#M001737">IntLon_x</a>, <a href="wtu_module.html#M001756">AvrLon_x</a>  :</td><td>1 次元(X)格子点データの経度方向積分および平均

</td></tr>
<tr><td valign="top"><a href="wtu_module.html#M001738">IntLat_y</a>, <a href="wtu_module.html#M001757">AvrLat_y</a>  :</td><td>1 次元(Y)格子点データの緯度方向積分および平均

</td></tr>
<tr><td valign="top"><a href="wtu_module.html#M001739">IntRad_z</a>, <a href="wtu_module.html#M001758">AvrRad_z</a>  :</td><td>1 次元(Z)格子点データの動径方向積分および平均

</td></tr>
<tr><td valign="top"><a href="wtu_module.html#M001822">IntRad_r</a>, <a href="wtu_module.html#M001836">AvrRad_r</a>  :</td><td>1 次元(Z)格子点データの動径方向積分および平均

</td></tr>
</table>

    </div>





   </div>


    <div id="method-list">
      <h3 class="section-bar">Methods</h3>

      <div class="name-list">

        <a href="#M001832">AvrLatRad_yr</a>&nbsp;&nbsp;

        <a href="#M001752">AvrLatRad_yz</a>&nbsp;&nbsp;

        <a href="#M001757">AvrLat_y</a>&nbsp;&nbsp;

        <a href="#M001829">AvrLonLatRad_xyr</a>&nbsp;&nbsp;

        <a href="#M001746">AvrLonLatRad_xyz</a>&nbsp;&nbsp;

        <a href="#M001749">AvrLonLat_xy</a>&nbsp;&nbsp;

        <a href="#M001835">AvrLonRad_xr</a>&nbsp;&nbsp;

        <a href="#M001755">AvrLonRad_xz</a>&nbsp;&nbsp;

        <a href="#M001756">AvrLon_x</a>&nbsp;&nbsp;

        <a href="#M001836">AvrRad_r</a>&nbsp;&nbsp;

        <a href="#M001758">AvrRad_z</a>&nbsp;&nbsp;

        <a href="#M001818">IntLatRad_yr</a>&nbsp;&nbsp;

        <a href="#M001733">IntLatRad_yz</a>&nbsp;&nbsp;

        <a href="#M001738">IntLat_y</a>&nbsp;&nbsp;

        <a href="#M001815">IntLonLatRad_xyr</a>&nbsp;&nbsp;

        <a href="#M001727">IntLonLatRad_xyz</a>&nbsp;&nbsp;

        <a href="#M001730">IntLonLat_xy</a>&nbsp;&nbsp;

        <a href="#M001821">IntLonRad_xr</a>&nbsp;&nbsp;

        <a href="#M001736">IntLonRad_xz</a>&nbsp;&nbsp;

        <a href="#M001737">IntLon_x</a>&nbsp;&nbsp;

        <a href="#M001822">IntRad_r</a>&nbsp;&nbsp;

        <a href="#M001739">IntRad_z</a>&nbsp;&nbsp;

        <a href="#M001769">Interpolate_wt</a>&nbsp;&nbsp;

        <a href="#M001698">at_Dr_at</a>&nbsp;&nbsp;

        <a href="#M001701">at_az</a>&nbsp;&nbsp;

        <a href="#M001700">az_at</a>&nbsp;&nbsp;

        <a href="#M001683">l_nm</a>&nbsp;&nbsp;

        <a href="#M001684">l_nm</a>&nbsp;&nbsp;

        <a href="#M001685">l_nm</a>&nbsp;&nbsp;

        <a href="#M001686">l_nm</a>&nbsp;&nbsp;

        <a href="#M001687">nm_l</a>&nbsp;&nbsp;

        <a href="#M001688">nm_l</a>&nbsp;&nbsp;

        <a href="#M001848">nmr_PoloidalEnergySpectrum_wu</a>&nbsp;&nbsp;

        <a href="#M001846">nmr_ToroidalEnergySpectrum_wu</a>&nbsp;&nbsp;

        <a href="#M001772">nmz_PoloidalEnergySpectrum_wt</a>&nbsp;&nbsp;

        <a href="#M001770">nmz_ToroidalEnergySpectrum_wt</a>&nbsp;&nbsp;

        <a href="#M001849">nr_PoloidalEnergySpectrum_wu</a>&nbsp;&nbsp;

        <a href="#M001847">nr_ToroidalEnergySpectrum_wu</a>&nbsp;&nbsp;

        <a href="#M001773">nz_PoloidalEnergySpectrum_wt</a>&nbsp;&nbsp;

        <a href="#M001771">nz_ToroidalEnergySpectrum_wt</a>&nbsp;&nbsp;

        <a href="#M001830">r_AvrLat_yr</a>&nbsp;&nbsp;

        <a href="#M001828">r_AvrLonLat_xyr</a>&nbsp;&nbsp;

        <a href="#M001833">r_AvrLon_xr</a>&nbsp;&nbsp;

        <a href="#M001816">r_IntLat_yr</a>&nbsp;&nbsp;

        <a href="#M001814">r_IntLonLat_xyr</a>&nbsp;&nbsp;

        <a href="#M001819">r_IntLon_xr</a>&nbsp;&nbsp;

        <a href="#M001699">t_Dr_t</a>&nbsp;&nbsp;

        <a href="#M001696">w_xy</a>&nbsp;&nbsp;

        <a href="#M001803">wr_DivLat_xyr</a>&nbsp;&nbsp;

        <a href="#M001802">wr_DivLon_xyr</a>&nbsp;&nbsp;

        <a href="#M001797">wr_DivRad_wu</a>&nbsp;&nbsp;

        <a href="#M001804">wr_Div_xyr_xyr_xyr</a>&nbsp;&nbsp;

        <a href="#M001854">wr_LaplaPol2Pol_wr</a>&nbsp;&nbsp;

        <a href="#M001799">wr_Lapla_wu</a>&nbsp;&nbsp;

        <a href="#M001791">wr_RAD</a>&nbsp;&nbsp;

        <a href="#M001843">wr_RadRotRot_xyr_xyr_xyr</a>&nbsp;&nbsp;

        <a href="#M001798">wr_RotRad_wu</a>&nbsp;&nbsp;

        <a href="#M001808">wr_RotRad_xyr_xyr</a>&nbsp;&nbsp;

        <a href="#M001796">wr_xyr</a>&nbsp;&nbsp;

        <a href="#M001774">wt_Boundaries</a>&nbsp;&nbsp;

        <a href="#M001783">wt_BoundariesGrid</a>&nbsp;&nbsp;

        <a href="#M001779">wt_BoundariesTau</a>&nbsp;&nbsp;

        <a href="#M001708">wt_DRad_wt</a>&nbsp;&nbsp;

        <a href="#M001715">wt_DivLat_xyz</a>&nbsp;&nbsp;

        <a href="#M001714">wt_DivLon_xyz</a>&nbsp;&nbsp;

        <a href="#M001709">wt_DivRad_wt</a>&nbsp;&nbsp;

        <a href="#M001716">wt_Div_xyz_xyz_xyz</a>&nbsp;&nbsp;

        <a href="#M001759">wt_KxRGrad_wt</a>&nbsp;&nbsp;

        <a href="#M001762">wt_L2Inv_wt</a>&nbsp;&nbsp;

        <a href="#M001761">wt_L2_wt</a>&nbsp;&nbsp;

        <a href="#M001785">wt_LaplaPol2PolGrid_wt</a>&nbsp;&nbsp;

        <a href="#M001711">wt_Lapla_wt</a>&nbsp;&nbsp;

        <a href="#M001778">wt_PolMagBoundaries</a>&nbsp;&nbsp;

        <a href="#M001787">wt_PolmagBoundariesGrid</a>&nbsp;&nbsp;

        <a href="#M001782">wt_PolmagBoundariesTau</a>&nbsp;&nbsp;

        <a href="#M001767">wt_Potential2Rotation</a>&nbsp;&nbsp;

        <a href="#M001766">wt_Potential2Vector</a>&nbsp;&nbsp;

        <a href="#M001763">wt_QOperator_wt</a>&nbsp;&nbsp;

        <a href="#M001765">wt_RadRotRot_xyz_xyz_xyz</a>&nbsp;&nbsp;

        <a href="#M001764">wt_RadRot_xyz_xyz</a>&nbsp;&nbsp;

        <a href="#M001710">wt_RotRad_wt</a>&nbsp;&nbsp;

        <a href="#M001720">wt_RotRad_xyz_xyz</a>&nbsp;&nbsp;

        <a href="#M001775">wt_TorBoundaries</a>&nbsp;&nbsp;

        <a href="#M001784">wt_TorBoundariesGrid</a>&nbsp;&nbsp;

        <a href="#M001780">wt_TorBoundariesTau</a>&nbsp;&nbsp;

        <a href="#M001777">wt_TorMagBoundaries</a>&nbsp;&nbsp;

        <a href="#M001786">wt_TormagBoundariesGrid</a>&nbsp;&nbsp;

        <a href="#M001781">wt_TormagBoundariesTau</a>&nbsp;&nbsp;

        <a href="#M001768">wt_VGradV</a>&nbsp;&nbsp;

        <a href="#M001695">wt_VMiss</a>&nbsp;&nbsp;

        <a href="#M001707">wt_wz</a>&nbsp;&nbsp;

        <a href="#M001703">wt_xyz</a>&nbsp;&nbsp;

        <a href="#M001670">wtu_Initial</a>&nbsp;&nbsp;

        <a href="#M001676">wtu_PolMagBoundaries</a>&nbsp;&nbsp;

        <a href="#M001674">wtu_PolmagBoundariesGrid</a>&nbsp;&nbsp;

        <a href="#M001673">wtu_PolmagBoundariesTau</a>&nbsp;&nbsp;

        <a href="#M001675">wtu_TorMagBoundaries</a>&nbsp;&nbsp;

        <a href="#M001672">wtu_TormagBoundariesGrid</a>&nbsp;&nbsp;

        <a href="#M001671">wtu_TormagBoundariesTau</a>&nbsp;&nbsp;

        <a href="#M001860">wu_Boundary</a>&nbsp;&nbsp;

        <a href="#M001851">wu_BoundaryGrid</a>&nbsp;&nbsp;

        <a href="#M001850">wu_BoundaryTau</a>&nbsp;&nbsp;

        <a href="#M001837">wu_KxRGrad_wu</a>&nbsp;&nbsp;

        <a href="#M001840">wu_L2Inv_wu</a>&nbsp;&nbsp;

        <a href="#M001839">wu_L2_wu</a>&nbsp;&nbsp;

        <a href="#M001855">wu_LaplaPol2PolGrid_wu</a>&nbsp;&nbsp;

        <a href="#M001863">wu_PolMagBoundary</a>&nbsp;&nbsp;

        <a href="#M001859">wu_PolmagBoundaryGrid</a>&nbsp;&nbsp;

        <a href="#M001858">wu_PolmagBoundaryTau</a>&nbsp;&nbsp;

        <a href="#M001845">wu_Potential2Rotation</a>&nbsp;&nbsp;

        <a href="#M001844">wu_Potential2Vector</a>&nbsp;&nbsp;

        <a href="#M001841">wu_QOperator_wu</a>&nbsp;&nbsp;

        <a href="#M001842">wu_RadRot_xyr_xyr</a>&nbsp;&nbsp;

        <a href="#M001861">wu_TorBoundary</a>&nbsp;&nbsp;

        <a href="#M001853">wu_TorBoundaryGrid</a>&nbsp;&nbsp;

        <a href="#M001852">wu_TorBoundaryTau</a>&nbsp;&nbsp;

        <a href="#M001862">wu_TorMagBoundary</a>&nbsp;&nbsp;

        <a href="#M001857">wu_TormagBoundaryGrid</a>&nbsp;&nbsp;

        <a href="#M001856">wu_TormagBoundaryTau</a>&nbsp;&nbsp;

        <a href="#M001792">wu_VMiss</a>&nbsp;&nbsp;

        <a href="#M001794">wu_xyr</a>&nbsp;&nbsp;

        <a href="#M001776">wz_LaplaPol2Pol_wz</a>&nbsp;&nbsp;

        <a href="#M001694">wz_RAD</a>&nbsp;&nbsp;

        <a href="#M001706">wz_wt</a>&nbsp;&nbsp;

        <a href="#M001705">wz_xyz</a>&nbsp;&nbsp;

        <a href="#M001826">x_AvrLatRad_xyr</a>&nbsp;&nbsp;

        <a href="#M001743">x_AvrLatRad_xyz</a>&nbsp;&nbsp;

        <a href="#M001747">x_AvrLat_xy</a>&nbsp;&nbsp;

        <a href="#M001834">x_AvrRad_xr</a>&nbsp;&nbsp;

        <a href="#M001754">x_AvrRad_xz</a>&nbsp;&nbsp;

        <a href="#M001812">x_IntLatRad_xyr</a>&nbsp;&nbsp;

        <a href="#M001724">x_IntLatRad_xyz</a>&nbsp;&nbsp;

        <a href="#M001728">x_IntLat_xy</a>&nbsp;&nbsp;

        <a href="#M001820">x_IntRad_xr</a>&nbsp;&nbsp;

        <a href="#M001735">x_IntRad_xz</a>&nbsp;&nbsp;

        <a href="#M001677">x_Lon</a>&nbsp;&nbsp;

        <a href="#M001678">x_Lon_Weight</a>&nbsp;&nbsp;

        <a href="#M001824">xr_AvrLat_xyr</a>&nbsp;&nbsp;

        <a href="#M001810">xr_IntLat_xyr</a>&nbsp;&nbsp;

        <a href="#M001825">xy_AvrRad_xyr</a>&nbsp;&nbsp;

        <a href="#M001742">xy_AvrRad_xyz</a>&nbsp;&nbsp;

        <a href="#M001811">xy_IntRad_xyr</a>&nbsp;&nbsp;

        <a href="#M001723">xy_IntRad_xyz</a>&nbsp;&nbsp;

        <a href="#M001690">xy_Lat</a>&nbsp;&nbsp;

        <a href="#M001689">xy_Lon</a>&nbsp;&nbsp;

        <a href="#M001697">xy_w</a>&nbsp;&nbsp;

        <a href="#M001805">xyr_Div_xyr_xyr_xyr</a>&nbsp;&nbsp;

        <a href="#M001801">xyr_GradLat_wu</a>&nbsp;&nbsp;

        <a href="#M001800">xyr_GradLon_wu</a>&nbsp;&nbsp;

        <a href="#M001838">xyr_KGrad_wu</a>&nbsp;&nbsp;

        <a href="#M001789">xyr_LAT</a>&nbsp;&nbsp;

        <a href="#M001788">xyr_LON</a>&nbsp;&nbsp;

        <a href="#M001790">xyr_RAD</a>&nbsp;&nbsp;

        <a href="#M001807">xyr_RotLat_wu_wu</a>&nbsp;&nbsp;

        <a href="#M001806">xyr_RotLon_wu_wu</a>&nbsp;&nbsp;

        <a href="#M001795">xyr_wr</a>&nbsp;&nbsp;

        <a href="#M001793">xyr_wu</a>&nbsp;&nbsp;

        <a href="#M001717">xyz_Div_xyz_xyz_xyz</a>&nbsp;&nbsp;

        <a href="#M001713">xyz_GradLat_wt</a>&nbsp;&nbsp;

        <a href="#M001712">xyz_GradLon_wt</a>&nbsp;&nbsp;

        <a href="#M001760">xyz_KGrad_wt</a>&nbsp;&nbsp;

        <a href="#M001692">xyz_LAT</a>&nbsp;&nbsp;

        <a href="#M001691">xyz_LON</a>&nbsp;&nbsp;

        <a href="#M001693">xyz_RAD</a>&nbsp;&nbsp;

        <a href="#M001719">xyz_RotLat_wt_wt</a>&nbsp;&nbsp;

        <a href="#M001718">xyz_RotLon_wt_wt</a>&nbsp;&nbsp;

        <a href="#M001702">xyz_wt</a>&nbsp;&nbsp;

        <a href="#M001704">xyz_wz</a>&nbsp;&nbsp;

        <a href="#M001741">xz_AvrLat_xyz</a>&nbsp;&nbsp;

        <a href="#M001722">xz_IntLat_xyz</a>&nbsp;&nbsp;

        <a href="#M001827">y_AvrLonRad_xyr</a>&nbsp;&nbsp;

        <a href="#M001744">y_AvrLonRad_xyz</a>&nbsp;&nbsp;

        <a href="#M001748">y_AvrLon_xy</a>&nbsp;&nbsp;

        <a href="#M001831">y_AvrRad_yr</a>&nbsp;&nbsp;

        <a href="#M001751">y_AvrRad_yz</a>&nbsp;&nbsp;

        <a href="#M001813">y_IntLonRad_xyr</a>&nbsp;&nbsp;

        <a href="#M001725">y_IntLonRad_xyz</a>&nbsp;&nbsp;

        <a href="#M001729">y_IntLon_xy</a>&nbsp;&nbsp;

        <a href="#M001817">y_IntRad_yr</a>&nbsp;&nbsp;

        <a href="#M001732">y_IntRad_yz</a>&nbsp;&nbsp;

        <a href="#M001679">y_Lat</a>&nbsp;&nbsp;

        <a href="#M001680">y_Lat_Weight</a>&nbsp;&nbsp;

        <a href="#M001823">yr_AvrLon_xyr</a>&nbsp;&nbsp;

        <a href="#M001809">yr_IntLon_xyr</a>&nbsp;&nbsp;

        <a href="#M001740">yz_AvrLon_xyz</a>&nbsp;&nbsp;

        <a href="#M001721">yz_IntLon_xyz</a>&nbsp;&nbsp;

        <a href="#M001750">z_AvrLat_yz</a>&nbsp;&nbsp;

        <a href="#M001745">z_AvrLonLat_xyz</a>&nbsp;&nbsp;

        <a href="#M001753">z_AvrLon_xz</a>&nbsp;&nbsp;

        <a href="#M001731">z_IntLat_yz</a>&nbsp;&nbsp;

        <a href="#M001726">z_IntLonLat_xyz</a>&nbsp;&nbsp;

        <a href="#M001734">z_IntLon_xz</a>&nbsp;&nbsp;

        <a href="#M001681">z_RAD</a>&nbsp;&nbsp;

        <a href="#M001682">z_RAD_WEIGHT</a>&nbsp;&nbsp;
      </div>
    </div>


  </div>


    <!-- if includes -->

    <div id="includes">
      <h3 class="section-bar">Included Modules</h3>

      <div id="includes-list">

        <span class="include-name">dc_message</span>

        <span class="include-name"><a href="lumatrix.html">lumatrix</a></span>

        <span class="include-name"><a href="wt_module.html">wt_module</a></span>

        <span class="include-name"><a href="wu_module.html">wu_module</a></span>
      </div>
    </div>



    <div id="section">










      


    <!-- if method_list -->

    <div id="methods">


      <h3 class="section-bar">Public Instance methods</h3>


      <div id="method-M001832" class="method-detail">
        <a name="M001832"></a>

        <div class="method-heading">




          <span class="method-name">AvrLatRad_yr</span><span class="method-args">( yr ) result(AvrLatRad_yr)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001832">AvrLatRad_yr</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 平均値

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>yr  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(1:jm,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 2 次元緯度動径(子午面)格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
緯度動径(子午面)積分
</p>
<p>
2 次元(YR)格子点データの緯度動径(子午面)平均
</p>
<p>
2 次元データ f(φ,r) に対して
</p>
<pre>
   ∫f(φ,r) r^2cosφ dφdr /(2(r[o]^3-r[i]^3)/3)
</pre>
<p>
を計算する.
</p>
<p>
Original external subprogram is <a
href="wu_module.html#M000418">wu_module#AvrLatRad_yr</a>
</p>


        </div>
      </div>


      <div id="method-M001752" class="method-detail">
        <a name="M001752"></a>

        <div class="method-heading">




          <span class="method-name">AvrLatRad_yz</span><span class="method-args">( yz ) result(AvrLatRad_yz)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001752">AvrLatRad_yz</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 平均値

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>yz  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(1:jm,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 2 次元緯度動径(子午面)格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
緯度動径(子午面)積分
</p>
<p>
2 次元(YZ)格子点データの緯度動径(子午面)平均
</p>
<p>
2 次元データ f(φ,r) に対して
</p>
<pre>
   ∫f(φ,r) r^2cosφ dφdr /(2(r[o]^3-r[i]^3)/3)
</pre>
<p>
を計算する.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001439">wt_module#AvrLatRad_yz</a>
</p>


        </div>
      </div>


      <div id="method-M001757" class="method-detail">
        <a name="M001757"></a>

        <div class="method-heading">




          <span class="method-name">AvrLat_y</span><span class="method-args">( y_data ) result(AvrLat_y)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001757">AvrLat_y</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 平均値

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>y_data(1:jm)  </tt></b>  <tt> </tt> :</td><td><tt>real(8), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 1 次元緯度格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
1 次元(Y)格子点データの緯度(Y)方向平均(1 層用).
</p>
<p>
実際には格子点データ各点毎に y_Y_Weight をかけた総和を計算し, y_Y_Weight
の総和で割ることで平均している.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001502">wt_module#AvrLat_y</a>
</p>


        </div>
      </div>


      <div id="method-M001829" class="method-detail">
        <a name="M001829"></a>

        <div class="method-heading">




          <span class="method-name">AvrLonLatRad_xyr</span><span class="method-args">( xyr ) result(AvrLonLatRad_xyr)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001829">AvrLonLatRad_xyr</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 全球平均値

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xyr  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 3 次元経度緯度動径格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
緯度経度動径(全球)積分
</p>
<p>
3 次元格子点データの緯度経度動径(全球)積分
</p>
<p>
3 次元データ f(λ,φ,r) に対して
</p>
<pre>
   ∫f(λ,φ,r) r^2cosφ dλdφdr /(4π(r[o]^3-r[i]^3)/3)
</pre>
<p>
を計算する.
</p>
<p>
Original external subprogram is <a
href="wu_module.html#M000415">wu_module#AvrLonLatRad_xyr</a>
</p>


        </div>
      </div>


      <div id="method-M001746" class="method-detail">
        <a name="M001746"></a>

        <div class="method-heading">




          <span class="method-name">AvrLonLatRad_xyz</span><span class="method-args">( xyz ) result(AvrLonLatRad_xyz)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001746">AvrLonLatRad_xyz</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 全球平均値

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xyz  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 3 次元経度緯度動径格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
緯度経度動径(全球)積分
</p>
<p>
3 次元格子点データの緯度経度動径(全球)積分
</p>
<p>
3 次元データ f(λ,φ,r) に対して
</p>
<pre>
   ∫f(λ,φ,r) r^2cosφ dλdφdr /(4π(r[o]^3-r[i]^3)/3)
</pre>
<p>
を計算する.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001436">wt_module#AvrLonLatRad_xyz</a>
</p>


        </div>
      </div>


      <div id="method-M001749" class="method-detail">
        <a name="M001749"></a>

        <div class="method-heading">




          <span class="method-name">AvrLonLat_xy</span><span class="method-args">( xy_data ) result(AvrLonLat_xy)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001749">AvrLonLat_xy</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 平均値

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xy_data(0:im-1,1:jm)  </tt></b>  <tt> </tt> :</td><td><tt>real(8), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 2 次元経度緯度格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
2 次元緯度経度格子点データの全領域平均(1 層用).
</p>
<p>
実際には格子点データ各点毎に x_X_Weight, y_Y_Weight をかけた 総和を計算し,
x_X_Weight*y_Y_Weight の総和で割ることで平均している.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001500">wt_module#AvrLonLat_xy</a>
</p>


        </div>
      </div>


      <div id="method-M001835" class="method-detail">
        <a name="M001835"></a>

        <div class="method-heading">




          <span class="method-name">AvrLonRad_xr</span><span class="method-args">( xr ) result(AvrLonRad_xr)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001835">AvrLonRad_xr</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8)</tt>

<table>
<tr><td valign="top"> :</td><td> 積分値

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xr  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in)2 次元格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
経度動径(緯度円)積分
</p>
<p>
2 次元(XR)格子点データの経度動径平均
</p>
<p>
2 次元データ f(λ,r) に対して
</p>
<pre>
   ∫f(λ,r) r^2dλdr /(2π(r[o]^3-r[i]^3)/3)
</pre>
<p>
を計算する.
</p>
<p>
Original external subprogram is <a
href="wu_module.html#M000421">wu_module#AvrLonRad_xr</a>
</p>


        </div>
      </div>


      <div id="method-M001755" class="method-detail">
        <a name="M001755"></a>

        <div class="method-heading">




          <span class="method-name">AvrLonRad_xz</span><span class="method-args">( xz ) result(AvrLonRad_xz)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001755">AvrLonRad_xz</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8)</tt>

<table>
<tr><td valign="top"> :</td><td> 積分値

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xz  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 2 次元格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
経度動径(緯度円)積分
</p>
<p>
2 次元(XZ)格子点データの経度動径平均
</p>
<p>
2 次元データ f(λ,r) に対して
</p>
<pre>
   ∫f(λ,r) r^2dλdr /(2π(r[o]^3-r[i]^3)/3)
</pre>
<p>
を計算する.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001442">wt_module#AvrLonRad_xz</a>
</p>


        </div>
      </div>


      <div id="method-M001756" class="method-detail">
        <a name="M001756"></a>

        <div class="method-heading">




          <span class="method-name">AvrLon_x</span><span class="method-args">( x_data ) result(AvrLon_x)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001756">AvrLon_x</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 平均値

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>x_data(0:im-1)  </tt></b>  <tt> </tt> :</td><td><tt>real(8), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 1 次元経度(X)格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
1 次元(X)格子点データの経度(X)方向平均(1 層用).
</p>
<p>
実際には格子点データ各点毎に x_X_Weight をかけた総和を計算し, x_X_Weight
の総和で割ることで平均している.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001501">wt_module#AvrLon_x</a>
</p>


        </div>
      </div>


      <div id="method-M001836" class="method-detail">
        <a name="M001836"></a>

        <div class="method-heading">




          <span class="method-name">AvrRad_r</span><span class="method-args">( z ) result(AvrRad_r)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001836">AvrRad_r</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 平均値

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>z  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 1 次元動径格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
1 次元(Z)格子点データの動径方向域平均.
</p>
<p>
1 次元データ f(r) に対して ∫f(r) r^2dr /((r[o]^3-r[i]^3)/3) を 計算する.
</p>
<p>
Original external subprogram is <a
href="wu_module.html#M000422">wu_module#AvrRad_r</a>
</p>


        </div>
      </div>


      <div id="method-M001758" class="method-detail">
        <a name="M001758"></a>

        <div class="method-heading">




          <span class="method-name">AvrRad_z</span><span class="method-args">( z ) result(AvrRad_z)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001758">AvrRad_z</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 平均値

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>z  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 1 次元動径格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
1 次元(Z)格子点データの動径方向域平均.
</p>
<p>
1 次元データ f(r) に対して ∫f(r) r^2dr /((r[o]^3-r[i]^3)/3) を 計算する.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001443">wt_module#AvrRad_z</a>
</p>


        </div>
      </div>


      <div id="method-M001818" class="method-detail">
        <a name="M001818"></a>

        <div class="method-heading">




          <span class="method-name">IntLatRad_yr</span><span class="method-args">( yr ) result(IntLatRad_yr)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001818">IntLatRad_yr</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 積分値

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>yr  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(1:jm,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 2 次元緯度動径(子午面)格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
2 次元(YR)格子点データの緯度動径積分(子午面)および平均
</p>
<p>
2 次元データ f(φ,r) に対して ∫f(φ,r) r^2cosφ dφdr を計算する.
</p>
<p>
Original external subprogram is <a
href="wu_module.html#M000404">wu_module#IntLatRad_yr</a>
</p>


        </div>
      </div>


      <div id="method-M001733" class="method-detail">
        <a name="M001733"></a>

        <div class="method-heading">




          <span class="method-name">IntLatRad_yz</span><span class="method-args">( yz ) result(IntLatRad_yz)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001733">IntLatRad_yz</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 積分値

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>yz  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(1:jm,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 2 次元緯度動径(子午面)格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
2 次元(YZ)格子点データの緯度動径積分(子午面)および平均
</p>
<p>
2 次元データ f(φ,r) に対して ∫f(φ,r) r^2cosφ dφdr を計算する.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001425">wt_module#IntLatRad_yz</a>
</p>


        </div>
      </div>


      <div id="method-M001738" class="method-detail">
        <a name="M001738"></a>

        <div class="method-heading">




          <span class="method-name">IntLat_y</span><span class="method-args">( y_data ) result(IntLat_y)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001738">IntLat_y</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 積分値

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>y_data(1:jm)  </tt></b>  <tt> </tt> :</td><td><tt>real(8), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 1 次元緯度(Y)格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
1 次元緯度(Y)格子点データの Y 方向積分(1 層用).
</p>
<p>
実際には格子点データ各点毎に y_Y_Weight をかけた総和を計算している.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001497">wt_module#IntLat_y</a>
</p>


        </div>
      </div>


      <div id="method-M001815" class="method-detail">
        <a name="M001815"></a>

        <div class="method-heading">




          <span class="method-name">IntLonLatRad_xyr</span><span class="method-args">( xyr ) result(IntLonLatRad_xyr)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001815">IntLonLatRad_xyr</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 全球積分値

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xyr  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 3 次元経度緯度動径格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
緯度経度動径(全球)積分
</p>
<p>
3 次元格子点データの緯度経度動径(全球)積分
</p>
<p>
3 次元データ f(λ,φ,r) に対して
</p>
<pre>
    ∫f(λ,φ,r) r^2cosφ dλdφdr
</pre>
<p>
を計算する.
</p>
<p>
Original external subprogram is <a
href="wu_module.html#M000401">wu_module#IntLonLatRad_xyr</a>
</p>


        </div>
      </div>


      <div id="method-M001727" class="method-detail">
        <a name="M001727"></a>

        <div class="method-heading">




          <span class="method-name">IntLonLatRad_xyz</span><span class="method-args">( xyz ) result(IntLonLatRad_xyz)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001727">IntLonLatRad_xyz</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 全球積分値

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xyz  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 3 次元経度緯度動径格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
緯度経度動径(全球)積分
</p>
<p>
3 次元格子点データの緯度経度動径(全球)積分
</p>
<p>
3 次元データ f(λ,φ,r) に対して
</p>
<pre>
    ∫f(λ,φ,r) r^2cosφ dλdφdr
</pre>
<p>
を計算する.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001422">wt_module#IntLonLatRad_xyz</a>
</p>


        </div>
      </div>


      <div id="method-M001730" class="method-detail">
        <a name="M001730"></a>

        <div class="method-heading">




          <span class="method-name">IntLonLat_xy</span><span class="method-args">( xy_data ) result(IntLonLat_xy)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001730">IntLonLat_xy</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 積分値

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xy_data(0:im-1,1:jm)  </tt></b>  <tt> </tt> :</td><td><tt>real(8), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 2 次元経度緯度格子点データ(0:im-1,1:jm)

</td></tr>
</table>
</td></tr>
</table>
<p>
2 次元緯度経度格子点データの全領域積分(1 層用).
</p>
<p>
実際には格子点データ各点毎に x_X_Weight, y_Y_Weight をかけた
総和を計算している.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001495">wt_module#IntLonLat_xy</a>
</p>


        </div>
      </div>


      <div id="method-M001821" class="method-detail">
        <a name="M001821"></a>

        <div class="method-heading">




          <span class="method-name">IntLonRad_xr</span><span class="method-args">( xr ) result(IntLonRad_xr)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001821">IntLonRad_xr</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 積分値

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xr  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 2 次元緯度動径格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
経度動径(緯度円)積分
</p>
<p>
2 次元(XR)格子点データの経度動径積分
</p>
<p>
2 次元データ f(λ,r) に対して∫f(λ,r) r^2dλdr を計算する.
</p>
<p>
Original external subprogram is <a
href="wu_module.html#M000407">wu_module#IntLonRad_xr</a>
</p>


        </div>
      </div>


      <div id="method-M001736" class="method-detail">
        <a name="M001736"></a>

        <div class="method-heading">




          <span class="method-name">IntLonRad_xz</span><span class="method-args">( xz ) result(IntLonRad_xz)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001736">IntLonRad_xz</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 積分値

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xz  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 2 次元緯度動径格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
経度動径(緯度円)積分
</p>
<p>
2 次元(XZ)格子点データの経度動径積分
</p>
<p>
2 次元データ f(λ,r) に対して∫f(λ,r) r^2dλdr を計算する.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001428">wt_module#IntLonRad_xz</a>
</p>


        </div>
      </div>


      <div id="method-M001737" class="method-detail">
        <a name="M001737"></a>

        <div class="method-heading">




          <span class="method-name">IntLon_x</span><span class="method-args">( x_data ) result(IntLon_x)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001737">IntLon_x</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 積分値

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>x_data(0:im-1)  </tt></b>  <tt> </tt> :</td><td><tt>real(8), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 1 次元経度(X)格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
1 次元経度(X)格子点データの X 方向積分(1 層用).
</p>
<p>
実際には格子点データ各点毎に x_X_Weight をかけた総和を計算している.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001496">wt_module#IntLon_x</a>
</p>


        </div>
      </div>


      <div id="method-M001822" class="method-detail">
        <a name="M001822"></a>

        <div class="method-heading">




          <span class="method-name">IntRad_r</span><span class="method-args">( z ) result(IntRad_r)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001822">IntRad_r</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 積分値

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>z  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 1 次元動径格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
動径積分
</p>
<p>
1 次元(Z)格子点データの動径方向域積分.
</p>
<p>
1 次元データ f(r) に対して ∫f(r) r^2dr を計算する.
</p>
<p>
Original external subprogram is <a
href="wu_module.html#M000408">wu_module#IntRad_r</a>
</p>


        </div>
      </div>


      <div id="method-M001739" class="method-detail">
        <a name="M001739"></a>

        <div class="method-heading">




          <span class="method-name">IntRad_z</span><span class="method-args">( z ) result(IntRad_z)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001739">IntRad_z</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 積分値

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>z  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 1 次元動径格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
動径積分
</p>
<p>
1 次元(Z)格子点データの動径方向域積分.
</p>
<p>
1 次元データ f(r) に対して ∫f(r) r^2dr を計算する.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001429">wt_module#IntRad_z</a>
</p>


        </div>
      </div>


      <div id="method-M001769" class="method-detail">
        <a name="M001769"></a>

        <div class="method-heading">




          <span class="method-name">Interpolate_wt</span><span class="method-args">( wt_data, alon, alat, arad ) result(Interpolate_wt)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001769">Interpolate_wt</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8)</tt>

<table>
<tr><td valign="top"> :</td><td> 補間した値

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>wt_data((nm+1)**2,0:km)  </tt></b>  <tt> </tt> :</td><td><tt>real(8), intent(IN)</tt>

<table>
<tr><td valign="top"> :</td><td> スペクトルデータ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>alon  </tt></b>  <tt> </tt> :</td><td><tt>real(8), intent(IN)</tt>

<table>
<tr><td valign="top"> :</td><td> 補間する位置(経度)

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>alat  </tt></b>  <tt> </tt> :</td><td><tt>real(8), intent(IN)</tt>

<table>
<tr><td valign="top"> :</td><td> 補間する位置(緯度)

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>arad  </tt></b>  <tt> </tt> :</td><td><tt>real(8), intent(IN)</tt>

<table>
<tr><td valign="top"> :</td><td> 補間する位置(動径)

</td></tr>
</table>
</td></tr>
</table>
<p>
緯度 alon, 経度 alat 動径 arad における関数値を その球面調和変換係数
wa_data から補間計算する
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001454">wt_module#Interpolate_wt</a>
</p>


        </div>
      </div>


      <div id="method-M001698" class="method-detail">
        <a name="M001698"></a>

        <div class="method-heading">




          <span class="method-name">at_Dr_at</span><span class="method-args">( at_data ) result(at_Dx_at)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt>at_Dx_at  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(size(at_data,1),0:size(at_data,2)-1)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) チェビシェフデータの X 微分

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>at_data  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(:,0:), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 入力チェビシェフデータ

</td></tr>
</table>
</td></tr>
</table>
<p>
入力チェビシェフデータに X 微分を作用する(2 次元配列用).
</p>
<p>
チェビシェフデータの X 微分とは, 対応する格子点データに X 微分を
作用させたデータのチェビシェフ変換のことである.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001489">wt_module#at_Dr_at</a>
</p>


        </div>
      </div>


      <div id="method-M001701" class="method-detail">
        <a name="M001701"></a>

        <div class="method-heading">




          <span class="method-name">at_az</span><span class="method-args">( ag_data ) result(at_ag)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt>at_ag  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(size(ag_data,1),0:km)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) チェビシェフデータ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>ag_data  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(:,:), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
格子データからチェビシェフデータへ変換する(2 次元配列用).
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001492">wt_module#at_az</a>
</p>


        </div>
      </div>


      <div id="method-M001700" class="method-detail">
        <a name="M001700"></a>

        <div class="method-heading">




          <span class="method-name">az_at</span><span class="method-args">( at_data ) result(ag_at)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt>ag_at  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(size(at_data,1),0:im)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 格子点データ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>at_data  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(:,:), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) チェビシェフデータ

</td></tr>
</table>
</td></tr>
</table>
<p>
チェビシェフデータから格子データへ変換する(2 次元配列用).
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001491">wt_module#az_at</a>
</p>


        </div>
      </div>


      <div id="method-M001683" class="method-detail">
        <a name="M001683"></a>

        <div class="method-heading">




          <span class="method-name">l_nm</span><span class="method-args">( n, m ) result(l_nm_array00)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt>l_nm_array00  </tt></b>  <tt> </tt> :</td><td><tt>integer</tt>

<table>
<tr><td valign="top"> :</td><td> (out) スペクトルデータの格納位置

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>n  </tt></b>  <tt> </tt> :</td><td><tt>integer, intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 全波数

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>m  </tt></b>  <tt> </tt> :</td><td><tt>integer, intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 帯状波数

</td></tr>
</table>
</td></tr>
</table>
<p>
全波数(n)と東西波数(m)からそのスペクトルデータの格納位置を返す.
</p>
<p>
引数 n,m がともに整数値の場合, 整数値を返す.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001479">wt_module#l_nm</a>
</p>


        </div>
      </div>


      <div id="method-M001684" class="method-detail">
        <a name="M001684"></a>

        <div class="method-heading">




          <span class="method-name">l_nm</span><span class="method-args">( n, marray ) result(l_nm_array01)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt>l_nm_array01(size(marray))  </tt></b>  <tt> </tt> :</td><td><tt>integer</tt>

<table>
<tr><td valign="top"> :</td><td> (out) スペクトルデータ位置

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>n  </tt></b>  <tt> </tt> :</td><td><tt>integer, intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 全波数

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>marray(:)  </tt></b>  <tt> </tt> :</td><td><tt>integer, intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 帯状波数

</td></tr>
</table>
</td></tr>
</table>
<p>
スペクトルデータの格納位置
</p>
<p>
全波数(n)と東西波数(m)からそのスペクトルデータの格納位置を返す.
</p>
<p>
第 1 引数 n が整数, 第 2 引数 marray が整数 1 次元配列の場合, marray
と同じ大きさの 1 次元整数配列を返す.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001479">wt_module#l_nm</a>
</p>


        </div>
      </div>


      <div id="method-M001685" class="method-detail">
        <a name="M001685"></a>

        <div class="method-heading">




          <span class="method-name">l_nm</span><span class="method-args">( narray, m ) result(l_nm_array10)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt>l_nm_array10(size(narray))  </tt></b>  <tt> </tt> :</td><td><tt>integer</tt>

<table>
<tr><td valign="top"> :</td><td> (out) スペクトルデータ位置

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>narray(:)  </tt></b>  <tt> </tt> :</td><td><tt>integer, intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 全波数

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>m  </tt></b>  <tt> </tt> :</td><td><tt>integer, intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 帯状波数

</td></tr>
</table>
</td></tr>
</table>
<p>
全波数(n)と東西波数(m)からそのスペクトルデータの格納位置を返す.
</p>
<p>
第 1 引数 narray が整数 1 次元配列, 第 2 引数 m が整数の場合, narray
と同じ大きさの 1 次元整数配列を返す.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001479">wt_module#l_nm</a>
</p>


        </div>
      </div>


      <div id="method-M001686" class="method-detail">
        <a name="M001686"></a>

        <div class="method-heading">




          <span class="method-name">l_nm</span><span class="method-args">( narray, marray ) result(l_nm_array11)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt>l_nm_array11(size(narray))  </tt></b>  <tt> </tt> :</td><td><tt>integer</tt>

<table>
<tr><td valign="top"> :</td><td> (out) スペクトルデータ位置

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>narray(:)  </tt></b>  <tt> </tt> :</td><td><tt>integer, intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 全波数

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>marray(:)  </tt></b>  <tt> </tt> :</td><td><tt>integer, intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 帯状波数

</td></tr>
</table>
</td></tr>
</table>
<p>
全波数(n)と東西波数(m)からそのスペクトルデータの格納位置を返す.
</p>
<p>
第 1,2 引数 narray, marray がともに整数 1 次元配列の場合, narray, marray
と同じ大きさの 1 次元整数配列を返す. narray, marray
は同じ大きさでなければならない.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001479">wt_module#l_nm</a>
</p>


        </div>
      </div>


      <div id="method-M001687" class="method-detail">
        <a name="M001687"></a>

        <div class="method-heading">




          <span class="method-name">nm_l</span><span class="method-args">( l ) result(nm_l_int)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt>nm_l_int(2)  </tt></b>  <tt> </tt> :</td><td><tt>integer</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 全波数, 帯状波数

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>l  </tt></b>  <tt> </tt> :</td><td><tt>integer, intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) スペクトルデータの格納位置

</td></tr>
</table>
</td></tr>
</table>
<p>
スペクトルデータの格納位置(l)から全波数(n)と東西波数(m)を返す.
</p>
<p>
引数 l が整数値の場合, 対応する全波数と帯状波数を 長さ 2 の 1
次元整数値を返す. <a href="wtu_module.html#M001687">nm_l</a>(1) が全波数,
<a href="wtu_module.html#M001687">nm_l</a>(2) が帯状波数である.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001483">wt_module#nm_l</a>
</p>


        </div>
      </div>


      <div id="method-M001688" class="method-detail">
        <a name="M001688"></a>

        <div class="method-heading">




          <span class="method-name">nm_l</span><span class="method-args">( larray ) result(nm_l_array)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt>nm_l_array(size(larray),2)  </tt></b>  <tt> </tt> :</td><td><tt>integer</tt>

<table>
<tr><td valign="top"> :</td><td> (in) スペクトルデータの格納位置

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>larray(:)  </tt></b>  <tt> </tt> :</td><td><tt>integer, intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 全波数, 帯状波数

</td></tr>
</table>
</td></tr>
</table>
<p>
スペクトルデータの格納位置(l)から全波数(n)と東西波数(m)を返す.
</p>
<p>
引数 larray が整数 1 次元配列の場合, larray に対応する n, m を格納した 2
次元整数配列を返す. nm_l_array(:,1) が全波数, nm_l_array(:,2)
が帯状波数である.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001483">wt_module#nm_l</a>
</p>


        </div>
      </div>


      <div id="method-M001848" class="method-detail">
        <a name="M001848"></a>

        <div class="method-heading">




          <span class="method-name">nmr_PoloidalEnergySpectrum_wu</span><span class="method-args">( wu_POLPOT ) result(nmr_PoloidalEnergySpectrum_wu)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001848">nmr_PoloidalEnergySpectrum_wu</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:nm,-nm:nm,0:km)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) エネルギースペクトルポロイダル成分

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>wu_POLPOT  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) ポロイダルポテンシャル

</td></tr>
</table>
</td></tr>
</table>
<p>
ポロイダルポテンシャルから, ポロイダルエネルギーの 球面調和函数全波数 n,
帯状波数 m の各成分を計算する.
</p>
<pre>
 * 全波数 n, 帯状波数 m のポロイダルポテンシャルのスペクトル成分
   φ(n,m,r)から全波数 n, 帯状波数 m 成分のポロイダルエネルギー
   スペクトルは

     (1/2)n(n+1)4πr^2{[d(rφ(n,m,r))/dr]^2 + n(n+1)φ(n,m,r)^2}

   と計算される.

 * 全てのエネルギースペクトル成分の和を動径積分したもの(r^2の重み無し)
   が球殻内での全エネルギーに等しい.

 * データの存在しない全波数 n, 帯状波数 m の配列には欠損値が格納される.
   欠損値の値はモジュール変数 wu_VMiss によって設定できる
   (初期値は -999.0)
</pre>
<p>
Original external subprogram is <a
href="wu_module.html#M000434">wu_module#nmr_PoloidalEnergySpectrum_wu</a>
</p>


        </div>
      </div>


      <div id="method-M001846" class="method-detail">
        <a name="M001846"></a>

        <div class="method-heading">




          <span class="method-name">nmr_ToroidalEnergySpectrum_wu</span><span class="method-args">( wu_TORPOT ) result(nmr_ToroidalEnergySpectrum_wu)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001846">nmr_ToroidalEnergySpectrum_wu</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:nm,-nm:nm,0:km)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) エネルギースペクトルトロイダル成分

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>wu_TORPOT  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) トロイダルポテンシャル

</td></tr>
</table>
</td></tr>
</table>
<p>
トロイダルポテンシャルから, トロイダルエネルギーの 球面調和函数全波数 n,
帯状波数 m の各成分を計算する
</p>
<pre>
 * 全波数 n, 帯状波数 m のトロイダルポテンシャルのスペクトル成分
   ψ(n,m,r)から全波数 n, 帯状波数 m 成分のトロイダルエネルギー
   スペクトルは  (1/2)n(n+1)4πr^2ψ(n,m,r)^2  と計算される.

 * 全てのエネルギースペクトル成分の和を動径積分したもの(r^2の重み無し)
   が球殻内での全エネルギーに等しい.

 * データの存在しない全波数 n, 帯状波数 m の配列には欠損値が格納される.
   wu_VMiss によって設定できる (初期値は -999.0)
</pre>
<p>
Original external subprogram is <a
href="wu_module.html#M000432">wu_module#nmr_ToroidalEnergySpectrum_wu</a>
</p>


        </div>
      </div>


      <div id="method-M001772" class="method-detail">
        <a name="M001772"></a>

        <div class="method-heading">




          <span class="method-name">nmz_PoloidalEnergySpectrum_wt</span><span class="method-args">( wt_POLPOT ) result(nmz_PoloidalEnergySpectrum_wt)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001772">nmz_PoloidalEnergySpectrum_wt</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:nm,-nm:nm,0:km)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) エネルギースペクトルポロイダル成分

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>wt_POLPOT  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) ポロイダルポテンシャル

</td></tr>
</table>
</td></tr>
</table>
<p>
ポロイダルポテンシャルから, ポロイダルエネルギーの 球面調和函数全波数 n,
帯状波数 m の各成分を計算する.
</p>
<pre>
 * 全波数 n, 帯状波数 m のポロイダルポテンシャルのスペクトル成分
   φ(n,m,r)から全波数 n, 帯状波数 m 成分のポロイダルエネルギー
   スペクトルは

     (1/2)n(n+1)4πr^2{[d(rφ(n,m,r))/dr]^2 + n(n+1)φ(n,m,r)^2}

   と計算される.

 * 全てのエネルギースペクトル成分の和を動径積分したもの(r^2の重み無し)
   が球殻内での全エネルギーに等しい.

 * データの存在しない全波数 n, 帯状波数 m の配列には欠損値が格納される.
   欠損値の値はモジュール変数 wt_VMiss によって設定できる
   (初期値は -999.0)
</pre>
<p>
Original external subprogram is <a
href="wt_module.html#M001457">wt_module#nmz_PoloidalEnergySpectrum_wt</a>
</p>


        </div>
      </div>


      <div id="method-M001770" class="method-detail">
        <a name="M001770"></a>

        <div class="method-heading">




          <span class="method-name">nmz_ToroidalEnergySpectrum_wt</span><span class="method-args">( wt_TORPOT ) result(nmz_ToroidalEnergySpectrum_wt)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001770">nmz_ToroidalEnergySpectrum_wt</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:nm,-nm:nm,0:km)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) エネルギースペクトルトロイダル成分

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>wt_TORPOT  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) トロイダルポテンシャル

</td></tr>
</table>
</td></tr>
</table>
<p>
トロイダルポテンシャルから, トロイダルエネルギーの 球面調和函数全波数 n,
帯状波数 m の各成分を計算する
</p>
<pre>
 * 全波数 n, 帯状波数 m のトロイダルポテンシャルのスペクトル成分
   ψ(n,m,r)から全波数 n, 帯状波数 m 成分のトロイダルエネルギー
   スペクトルは  (1/2)n(n+1)4πr^2ψ(n,m,r)^2  と計算される.

 * 全てのエネルギースペクトル成分の和を動径積分したもの(r^2の重み無し)
   が球殻内での全エネルギーに等しい.

 * データの存在しない全波数 n, 帯状波数 m の配列には欠損値が格納される.
   wt_VMiss によって設定できる (初期値は -999.0)
</pre>
<p>
Original external subprogram is <a
href="wt_module.html#M001455">wt_module#nmz_ToroidalEnergySpectrum_wt</a>
</p>


        </div>
      </div>


      <div id="method-M001849" class="method-detail">
        <a name="M001849"></a>

        <div class="method-heading">




          <span class="method-name">nr_PoloidalEnergySpectrum_wu</span><span class="method-args">( wu_POLPOT ) result(nr_PoloidalEnergySpectrum_wu)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001849">nr_PoloidalEnergySpectrum_wu</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:nm,0:km)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) エネルギースペクトルポロイダル成分

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>wu_POLPOT  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) ポロイダルポテンシャル

</td></tr>
</table>
</td></tr>
</table>
<p>
ポロイダルポテンシャルから, ポロイダルエネルギーの
球面調和函数全波数の各成分を計算する
</p>
<pre>
 * 全波数 n, 帯状波数 m のポロイダルポテンシャルのスペクトル成分
   φ(n,m,r)から全波数 n 成分のポロイダルエネルギースペクトルは

     Σ[m=-n]^n ((1/2)n(n+1)4πr^2{[d(rφ(n,m,r))/dr]^2
                + n(n+1)φ(n,m,r)^2}

   と計算される.

 * 全ての全波数に対してのエネルギースペクトル成分の和を動径積分したもの
   (r^2の重み無し)が球殻内での全エネルギーに等しい.
</pre>
<p>
Original external subprogram is <a
href="wu_module.html#M000435">wu_module#nr_PoloidalEnergySpectrum_wu</a>
</p>


        </div>
      </div>


      <div id="method-M001847" class="method-detail">
        <a name="M001847"></a>

        <div class="method-heading">




          <span class="method-name">nr_ToroidalEnergySpectrum_wu</span><span class="method-args">( wu_TORPOT ) result(nr_ToroidalEnergySpectrum_wu)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001847">nr_ToroidalEnergySpectrum_wu</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:nm,0:km)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) エネルギースペクトルトロイダル成分

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>wu_TORPOT  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) トロイダルポテンシャル

</td></tr>
</table>
</td></tr>
</table>
<p>
トロイダルポテンシャルから, トロイダルエネルギーの
球面調和函数全波数の各成分を計算する.
</p>
<pre>
 * 全波数 n, 帯状波数 m のトロイダルポテンシャルのスペクトル成分
   ψ(n,m,r)から全波数 n 成分のトロイダルエネルギースペクトルは
   Σ[m=-n]^n(1/2)n(n+1)4πr^2ψ(n,m,r)^2 と計算される.
</pre>
<ul>
<li>全てのエネルギースペクトル成分の和を動径積分したもの(r^2の重み無し)

<pre>
 が球殻内での全エネルギーに等しい.
</pre>
</li>
</ul>
<p>
Original external subprogram is <a
href="wu_module.html#M000433">wu_module#nr_ToroidalEnergySpectrum_wu</a>
</p>


        </div>
      </div>


      <div id="method-M001773" class="method-detail">
        <a name="M001773"></a>

        <div class="method-heading">




          <span class="method-name">nz_PoloidalEnergySpectrum_wt</span><span class="method-args">( wt_POLPOT ) result(nz_PoloidalEnergySpectrum_wt)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001773">nz_PoloidalEnergySpectrum_wt</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:nm,0:km)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) エネルギースペクトルポロイダル成分

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>wt_POLPOT  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) ポロイダルポテンシャル

</td></tr>
</table>
</td></tr>
</table>
<p>
ポロイダルポテンシャルから, ポロイダルエネルギーの
球面調和函数全波数の各成分を計算する
</p>
<pre>
 * 全波数 n, 帯状波数 m のポロイダルポテンシャルのスペクトル成分
   φ(n,m,r)から全波数 n 成分のポロイダルエネルギースペクトルは

     Σ[m=-n]^n ((1/2)n(n+1)4πr^2{[d(rφ(n,m,r))/dr]^2
                + n(n+1)φ(n,m,r)^2}

   と計算される.

 * 全ての全波数に対してのエネルギースペクトル成分の和を動径積分したもの
   (r^2の重み無し)が球殻内での全エネルギーに等しい.
</pre>
<p>
Original external subprogram is <a
href="wt_module.html#M001458">wt_module#nz_PoloidalEnergySpectrum_wt</a>
</p>


        </div>
      </div>


      <div id="method-M001771" class="method-detail">
        <a name="M001771"></a>

        <div class="method-heading">




          <span class="method-name">nz_ToroidalEnergySpectrum_wt</span><span class="method-args">( wt_TORPOT ) result(nz_ToroidalEnergySpectrum_wt)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001771">nz_ToroidalEnergySpectrum_wt</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:nm,0:km)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) エネルギースペクトルトロイダル成分

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>wt_TORPOT  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) トロイダルポテンシャル

</td></tr>
</table>
</td></tr>
</table>
<p>
トロイダルポテンシャルから, トロイダルエネルギーの
球面調和函数全波数の各成分を計算する.
</p>
<pre>
 * 全波数 n, 帯状波数 m のトロイダルポテンシャルのスペクトル成分
   ψ(n,m,r)から全波数 n 成分のトロイダルエネルギースペクトルは
   Σ[m=-n]^n(1/2)n(n+1)4πr^2ψ(n,m,r)^2 と計算される.
</pre>
<ul>
<li>全てのエネルギースペクトル成分の和を動径積分したもの(r^2の重み無し)

<pre>
 が球殻内での全エネルギーに等しい.
</pre>
</li>
</ul>
<p>
Original external subprogram is <a
href="wt_module.html#M001456">wt_module#nz_ToroidalEnergySpectrum_wt</a>
</p>


        </div>
      </div>


      <div id="method-M001830" class="method-detail">
        <a name="M001830"></a>

        <div class="method-heading">




          <span class="method-name">r_AvrLat_yr</span><span class="method-args">( yr ) result(r_AvrLat_yr)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001830">r_AvrLat_yr</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:km)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 緯度平均された 1 次元動径格子点データ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>yr  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(1:jm,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 2 次元緯度動径(子午面)格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
2 次元(YR)格子点データの緯度方向域平均.
</p>
<p>
2 次元データ f(φ,r) に対して ∫f(φ,r) cosφ dφ/2 を計算する.
</p>
<p>
Original external subprogram is <a
href="wu_module.html#M000416">wu_module#r_AvrLat_yr</a>
</p>


        </div>
      </div>


      <div id="method-M001828" class="method-detail">
        <a name="M001828"></a>

        <div class="method-heading">




          <span class="method-name">r_AvrLonLat_xyr</span><span class="method-args">( xyr ) result(r_AvrLonLat_xyr)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001828">r_AvrLonLat_xyr</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:km)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 緯度経度(水平, 球面)平均された 1 次元動径格子点データ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xyr  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 3 次元経度緯度動径格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
緯度経度(水平)積分
</p>
<p>
3 次元格子点データの緯度経度(水平, 球面)積分
</p>
<p>
3 次元データ f(λ,φ,r) に対して
</p>
<pre>
   ∫f(λ,φ,r) cosφ dλdφ /4π
</pre>
<p>
を計算する.
</p>
<p>
Original external subprogram is <a
href="wu_module.html#M000414">wu_module#r_AvrLonLat_xyr</a>
</p>


        </div>
      </div>


      <div id="method-M001833" class="method-detail">
        <a name="M001833"></a>

        <div class="method-heading">




          <span class="method-name">r_AvrLon_xr</span><span class="method-args">( xr ) result(r_AvrLon_xr)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001833">r_AvrLon_xr</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:km)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 経度平均された 1 次元動径格子点データ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xr  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 2 次元緯度動径格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
経度(帯状)積分
</p>
<p>
2 次元(XR)格子点データの経度方向平均.
</p>
<p>
2 次元データ f(λ,r) に対して ∫f(λ,r)dλ/2π を計算する.
</p>
<p>
Original external subprogram is <a
href="wu_module.html#M000419">wu_module#r_AvrLon_xr</a>
</p>


        </div>
      </div>


      <div id="method-M001816" class="method-detail">
        <a name="M001816"></a>

        <div class="method-heading">




          <span class="method-name">r_IntLat_yr</span><span class="method-args">( yr ) result(r_IntLat_yr)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001816">r_IntLat_yr</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:km)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 緯度積分された 1 次元動径格子点データ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>yr  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(jm,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 2 次元緯度動径(子午面)格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
緯度積分
</p>
<p>
2 次元(YR)格子点データの緯度方向域積分.
</p>
<p>
2 次元データ f(φ,r) に対して∫f(φ,r) cosφ dφ を計算する.
</p>
<p>
Original external subprogram is <a
href="wu_module.html#M000402">wu_module#r_IntLat_yr</a>
</p>


        </div>
      </div>


      <div id="method-M001814" class="method-detail">
        <a name="M001814"></a>

        <div class="method-heading">




          <span class="method-name">r_IntLonLat_xyr</span><span class="method-args">( xyr ) result(r_IntLonLat_xyr)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001814">r_IntLonLat_xyr</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:km)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 緯度経度(水平, 球面)積分された 1 次元動径格子点データ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xyr  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 3 次元経度緯度動径格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
緯度経度(水平)積分
</p>
<p>
3 次元格子点データの緯度経度(水平, 球面)積分
</p>
<p>
3 次元データ f(λ,φ,r) に対して
</p>
<pre>
   ∫f(λ,φ,r) cosφ dλdφ
</pre>
<p>
を計算する.
</p>
<p>
Original external subprogram is <a
href="wu_module.html#M000400">wu_module#r_IntLonLat_xyr</a>
</p>


        </div>
      </div>


      <div id="method-M001819" class="method-detail">
        <a name="M001819"></a>

        <div class="method-heading">




          <span class="method-name">r_IntLon_xr</span><span class="method-args">( xr ) result(r_IntLon_xr)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001819">r_IntLon_xr</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:km)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 経度積分された 1 次元動径格子点データ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xr  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 2 次元緯度動径格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
2 次元(XR)格子点データの経度方向積分.
</p>
<p>
2 次元データ f(λ,r) に対して ∫f(λ,r)dλ を計算する.
</p>
<p>
Original external subprogram is <a
href="wu_module.html#M000405">wu_module#r_IntLon_xr</a>
</p>


        </div>
      </div>


      <div id="method-M001699" class="method-detail">
        <a name="M001699"></a>

        <div class="method-heading">




          <span class="method-name">t_Dr_t</span><span class="method-args">( t_data ) result(t_Dx_t)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt>t_Dx_t  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(size(t_data))</tt>

<table>
<tr><td valign="top"> :</td><td> (out) チェビシェフデータの X 微分

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>t_data  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(:), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 入力チェビシェフデータ

</td></tr>
</table>
</td></tr>
</table>
<p>
入力チェビシェフデータに X 微分を作用する(1 次元配列用).
</p>
<p>
チェビシェフデータの X 微分とは, 対応する格子点データに X 微分を
作用させたデータのチェビシェフ変換のことである.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001490">wt_module#t_Dr_t</a>
</p>


        </div>
      </div>


      <div id="method-M001696" class="method-detail">
        <a name="M001696"></a>

        <div class="method-heading">




          <span class="method-name">w_xy</span><span class="method-args">( xy_data, [ipow], [iflag] ) result(w_xy)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001696">w_xy</a>((nm+1)*(nm+1))  </tt></b>  <tt> </tt> :</td><td><tt>real(8)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) スペクトルデータ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xy_data(0:im-1,1:jm)  </tt></b>  <tt> </tt> :</td><td><tt>real(8), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 格子点データ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>ipow  </tt></b>  <tt> </tt> :</td><td><tt>integer, intent(in), optional</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 変換時に同時に作用させる 1/cosφ の次数. 省略時は 0.

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>iflag  </tt></b>  <tt> </tt> :</td><td><tt>integer, intent(in), optional</tt>

<table>
<tr><td valign="top"> :</td><td> 変換の種類

<pre>
   0 : 通常の正変換
  -1 : 経度微分を作用させた正変換
   1 : 緯度微分 1/cosφ・∂(f cos^2φ)/∂φ を作用させた正変換
   2 : sinφを作用させた正変換
 省略時は 0.
</pre>
</td></tr>
</table>
</td></tr>
</table>
<p>
格子データからスペクトルデータへ(正)変換する(1 層用).
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001487">wt_module#w_xy</a>
</p>


        </div>
      </div>


      <div id="method-M001803" class="method-detail">
        <a name="M001803"></a>

        <div class="method-heading">




          <span class="method-name">wr_DivLat_xyr</span><span class="method-args">( xyr ) result(wr_DivLat_xyr)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001803">wr_DivLat_xyr</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:km)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 発散型緯度微分を作用された水平スペクトル動径格子点データ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xyr  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 3 次元経度緯度動径格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
格子データに発散型緯度微分 1/rcosφ・∂(f cosφ)/∂φ を
作用させたスペクトルデータを返す.
</p>
<p>
Original external subprogram is <a
href="wu_module.html#M000389">wu_module#wr_DivLat_xyr</a>
</p>


        </div>
      </div>


      <div id="method-M001802" class="method-detail">
        <a name="M001802"></a>

        <div class="method-heading">




          <span class="method-name">wr_DivLon_xyr</span><span class="method-args">( xyr ) result(wr_DivLon_xyr)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001802">wr_DivLon_xyr</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:km)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 発散型経度微分を作用された水平スペクトル動径格子点データ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xyr  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 3 次元経度緯度動径格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
格子点データに発散型経度微分 1/rcosφ・∂/∂λ を作用させた
スペクトルデータを返す.
</p>
<p>
Original external subprogram is <a
href="wu_module.html#M000388">wu_module#wr_DivLon_xyr</a>
</p>


        </div>
      </div>


      <div id="method-M001797" class="method-detail">
        <a name="M001797"></a>

        <div class="method-heading">




          <span class="method-name">wr_DivRad_wu</span><span class="method-args">( wu ) result(wr_DivRad_wu)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001797">wr_DivRad_wu</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:km)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 発散型動径微分を作用された水平スペクトル動径格子点データ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>wu  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 2 次元球面調和函数チェビシェフスペクトルデータ

</td></tr>
</table>
</td></tr>
</table>
<p>
入力スペクトルデータに発散型動径微分
</p>
<pre>
      1/r^2 ∂/∂r (r^2 .)= ∂/∂r + 2/r
</pre>
<p>
を作用する.
</p>
<p>
スペクトルデータの発散型動径微分とは, 対応する格子点データに
発散型動径微分を作用させたデータのスペクトル変換のことである.
</p>
<p>
Original external subprogram is <a
href="wu_module.html#M000383">wu_module#wr_DivRad_wu</a>
</p>


        </div>
      </div>


      <div id="method-M001804" class="method-detail">
        <a name="M001804"></a>

        <div class="method-heading">




          <span class="method-name">wr_Div_xyr_xyr_xyr</span><span class="method-args">( xyr_Vlon, xyr_Vlat, xyr_Vrad ) result(wr_Div_xyr_xyr_xyr)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001804">wr_Div_xyr_xyr_xyr</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:km)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) ベクトル場の発散

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xyr_Vlon  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) ベクトル場の経度成分

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xyr_Vlat  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) ベクトル場の緯度成分

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xyr_Vrad  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) ベクトル場の動径成分

</td></tr>
</table>
</td></tr>
</table>
<p>
べクトル成分である 3 つの格子データに発散を作用させた
スペクトルデータを返す.
</p>
<p>
第 1, 2 ,3 引数(u,v,w)がそれぞれベクトルの経度成分, 緯度成分,
動径成分を表し, 発散は
</p>
<pre>
     1/rcosφ・∂u/∂λ + 1/rcosφ・∂(v cosφ)/∂φ
   + 1/r^2 ∂/∂r (r^2 w)
</pre>
<p>
と計算される.
</p>
<p>
Original external subprogram is <a
href="wu_module.html#M000390">wu_module#wr_Div_xyr_xyr_xyr</a>
</p>


        </div>
      </div>


      <div id="method-M001854" class="method-detail">
        <a name="M001854"></a>

        <div class="method-heading">




          <span class="method-name">wr_LaplaPol2Pol_wr</span><span class="method-args">( wr, [cond], [new] ) result(wr_LaplaPol2Pol_wr)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001854">wr_LaplaPol2Pol_wr</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:km)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 出力ポロイダルポテンシャル分布

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>wr  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:km),intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 入力▽^2φ分布

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>cond  </tt></b>  <tt> </tt> :</td><td><tt>character(len=1), intent(in), optional</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 境界条件スイッチ. 省略時は &#8216;R&#8216;

<pre>
    R    : 上側粘着条件
    F    : 上側応力なし条件
</pre>
</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>new  </tt></b>  <tt> </tt> :</td><td><tt>logical, intent(IN), optional</tt>

<table>
<tr><td valign="top"> :</td><td> (in) true だと境界条件計算用行列を強制的に新たに作る.

<pre>
    default は false.
</pre>
</td></tr>
</table>
</td></tr>
</table>
<p>
速度ポロイダルポテンシャルΦを▽^2Φから計算する.
</p>
<p>
チェビシェフ格子点空間で境界条件を適用している. この関数を用いるためには
wu_Initial にて設定する チェビシェフ切断波数(lm)と鉛直格子点数(km)を等しく
しておく必要がある.
</p>
<p>
速度ポロイダルポテンシャルΦを f = ▽^2Φから定める式は
</p>
<pre>
  ▽^2Φ = f
    Φ = const. at Boundary.
    ∂Φ/∂r = 0 at Boundary           (粘着条件)
    or ∂^2Φ/∂r^2 = 0 at Boundary    (応力なし条件)
</pre>
<p>
最初に呼ばれるときはオプショナル引数 new に関係なく行列が設定される.
</p>
<p>
Original external subprogram is <a
href="wu_module.html#M000440">wu_module#wr_LaplaPol2Pol_wr</a>
</p>


        </div>
      </div>


      <div id="method-M001799" class="method-detail">
        <a name="M001799"></a>

        <div class="method-heading">




          <span class="method-name">wr_Lapla_wu</span><span class="method-args">( wu ) result(wr_Lapla_wu)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001799">wr_Lapla_wu</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:km)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) ラプラシアンを作用された水平スペクトル動径格子点データ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>wu  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 2 次元球面調和函数チェビシェフスペクトルデータ

</td></tr>
</table>
</td></tr>
</table>
<p>
入力スペクトルデータにラプラシアン
</p>
<pre>
    ▽^2 =   1/r^2 cos^2φ・∂^2/∂λ^2
           + 1/r^2 cosφ・∂/∂φ(cosφ∂/∂φ)
           + 1/r^2 ∂/∂r (r^2 ∂/∂r)
             (∂^2/∂r^2 + 2/r∂/∂r)
</pre>
<p>
を作用する.
</p>
<p>
スペクトルデータのラプラシアンとは, 対応する格子点データに
ラプラシアンを作用させたデータのスペクトル変換のことである.
</p>
<p>
Original external subprogram is <a
href="wu_module.html#M000385">wu_module#wr_Lapla_wu</a>
</p>


        </div>
      </div>


      <div id="method-M001791" class="method-detail">
        <a name="M001791"></a>

        <div class="method-heading">




          <span class="method-name">wr_RAD</span><span class="method-args"></span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em>Variable</em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001791">wr_RAD</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(:,:), allocatable</tt>

<table>
<tr><td valign="top"> :</td><td> 座標

</td></tr>
</table>
</td></tr>
</table>
<p>
Original external subprogram is <a
href="wu_module.html#M000376">wu_module#wr_RAD</a>
</p>


        </div>
      </div>


      <div id="method-M001843" class="method-detail">
        <a name="M001843"></a>

        <div class="method-heading">




          <span class="method-name">wr_RadRotRot_xyr_xyr_xyr</span><span class="method-args">( xyr_VLON, xyr_VLAT, xyr_VRAD ) result(wr_RadRotRot_xyr_xyr_xyr)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001843">wr_RadRotRot_xyr_xyr_xyr</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:km)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) ベクトル v の r・(▽×▽×v)

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xyr_VLON  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) ベクトルの経度成分

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xyr_VLAT  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) ベクトルの緯度成分

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xyr_VRAD  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) ベクトルの動径成分

</td></tr>
</table>
</td></tr>
</table>
<p>
ベクトル v に対して r・(▽×▽×v) を計算する.
</p>
<p>
第 1, 2, 3 引数(v[λ], v[φ], v[r])がそれぞれベクトルの経度成分, 緯度成分,
動径成分を表す.
</p>
<pre>
   r・(▽×▽×v)  = 1/r ∂/∂r (r・( 1/cosφ・∂v[λ]/∂λ
                                 + 1/cosφ・∂(v[φ] cosφ)/∂φ ) )
                    + L^2 v[r]/r
</pre>
<p>
のスペクトルデータが返される.
</p>
<p>
Original external subprogram is <a
href="wu_module.html#M000429">wu_module#wr_RadRotRot_xyr_xyr_xyr</a>
</p>


        </div>
      </div>


      <div id="method-M001798" class="method-detail">
        <a name="M001798"></a>

        <div class="method-heading">




          <span class="method-name">wr_RotRad_wu</span><span class="method-args">( wu ) result(wr_RotRad_wu)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001798">wr_RotRad_wu</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:km)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 回転型動径微分を作用された水平スペクトル動径格子点データ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>wu  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 2 次元球面調和函数チェビシェフスペクトルデータ

</td></tr>
</table>
</td></tr>
</table>
<p>
入力スペクトルデータに回転型動径微分
</p>
<pre>
     1/r ∂(r.)/∂r = ∂(.)/∂r + (.)/r
</pre>
<p>
を作用する.
</p>
<p>
スペクトルデータの回転型動径微分とは, 対応する格子点データに
回転型動径微分を作用させたデータのスペクトル変換のことである.
</p>
<p>
Original external subprogram is <a
href="wu_module.html#M000384">wu_module#wr_RotRad_wu</a>
</p>


        </div>
      </div>


      <div id="method-M001808" class="method-detail">
        <a name="M001808"></a>

        <div class="method-heading">




          <span class="method-name">wr_RotRad_xyr_xyr</span><span class="method-args">( xyr_Vlat, xyr_Vlon ) result(wr_RotRad_xyr_xyr)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001808">wr_RotRad_xyr_xyr</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:km)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) ベクトル場の回転の動径成分

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xyr_Vlat  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) ベクトル場の緯度成分

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xyr_Vlon  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) ベクトル場の経度成分

</td></tr>
</table>
</td></tr>
</table>
<p>
ベクトルの緯度成分, 経度成分である第 1, 2 引数 Vlat, Vlon に対して
ベクトル場の回転の動径成分
</p>
<pre>
   1/rcosφ・∂Vlat/∂λ - 1/rcosφ・∂(Vlon cosφ)/∂φ
</pre>
<p>
を計算する.
</p>
<p>
Original external subprogram is <a
href="wu_module.html#M000394">wu_module#wr_RotRad_xyr_xyr</a>
</p>


        </div>
      </div>


      <div id="method-M001796" class="method-detail">
        <a name="M001796"></a>

        <div class="method-heading">




          <span class="method-name">wr_xyr</span><span class="method-args">( xyr ) result(wr_xyr)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001796">wr_xyr</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:km)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 2 次元球面調和函数スペクトル・動径格子点データ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xyr  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 3 次元経度緯度動径格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
3 次元格子データから水平スペクトル・動径格子点データへ(正)変換する.
</p>
<p>
Original external subprogram is <a
href="wu_module.html#M000382">wu_module#wr_xyr</a>
</p>


        </div>
      </div>


      <div id="method-M001774" class="method-detail">
        <a name="M001774"></a>

        <div class="method-heading">




          <span class="method-name">wt_Boundaries</span><span class="method-args">( wt, [values], [cond] ) </span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Subroutine </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt>wt  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm),intent(inout)</tt>

<table>
<tr><td valign="top"> :</td><td> (inout) 境界条件を適用するデータ. 修正された値を返す.

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>values  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),2), intent(in), optional</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 境界での 値/勾配 分布を水平スペクトル変換したものを与える.

<pre>
    省略時は値/勾配 0 となる.
</pre>
</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>cond  </tt></b>  <tt> </tt> :</td><td><tt>character(len=2), intent(in), optional</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 境界条件. 省略時は &#8216;DD&#8216;

<pre>
       DD : 両端ディリクレ条件
       DN : 上端ディリクレ, 下端ノイマン条件
       ND : 上端ノイマン, 下端ディリクレ条件
       NN : 両端ノイマン条件
</pre>
</td></tr>
</table>
</td></tr>
</table>
<p>
スペクトルデータにディリクレ・ノイマン境界条件を適用する Chebyshev
空間での境界条件適用(タウ法)
</p>
<p>
チェビシェフ空間において境界条件を満たすべく高次の係数を
定める方法をとっている(タウ法).
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001469">wt_module#wt_Boundaries</a>
</p>


        </div>
      </div>


      <div id="method-M001783" class="method-detail">
        <a name="M001783"></a>

        <div class="method-heading">




          <span class="method-name">wt_BoundariesGrid</span><span class="method-args">( wt, [values], [cond] ) </span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Subroutine </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt>wt  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm),intent(inout)</tt>

<table>
<tr><td valign="top"> :</td><td> (inout) 境界条件を適用するデータ. 修正された値を返す.

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>values  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),2), intent(in), optional</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 境界での 値/勾配 分布を水平スペクトル変換したものを与える.

<pre>
   省略時は値/勾配 0 となる.
</pre>
</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>cond  </tt></b>  <tt> </tt> :</td><td><tt>character(len=2), intent(in), optional</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 境界条件. 省略時は &#8216;DD&#8216;

<pre>
       DD : 両端ディリクレ条件
       DN : 上端ディリクレ, 下端ノイマン条件
       ND : 上端ノイマン, 下端ディリクレ条件
       NN : 両端ノイマン条件
</pre>
</td></tr>
</table>
</td></tr>
</table>
<p>
スペクトルデータにディリクレ・ノイマン境界条件を適用する
実空間での境界条件適用
</p>
<p>
鉛直実格子点空間において内部領域の値と境界条件を満たすように
条件を課している(選点法). このルーチンを用いるためには wt_Initial
にて設定するチェビシェフ切断波数(lm)と鉛直格子点数(km)を
等しくしておく必要がある.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001460">wt_module#wt_BoundariesGrid</a>
</p>


        </div>
      </div>


      <div id="method-M001779" class="method-detail">
        <a name="M001779"></a>

        <div class="method-heading">




          <span class="method-name">wt_BoundariesTau</span><span class="method-args">( wt, [values], [cond] ) </span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Subroutine </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt>wt  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm),intent(inout)</tt>

<table>
<tr><td valign="top"> :</td><td> (inout) 境界条件を適用するデータ. 修正された値を返す.

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>values  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),2), intent(in), optional</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 境界での 値/勾配 分布を水平スペクトル変換したものを与える.

<pre>
    省略時は値/勾配 0 となる.
</pre>
</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>cond  </tt></b>  <tt> </tt> :</td><td><tt>character(len=2), intent(in), optional</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 境界条件. 省略時は &#8216;DD&#8216;

<pre>
       DD : 両端ディリクレ条件
       DN : 上端ディリクレ, 下端ノイマン条件
       ND : 上端ノイマン, 下端ディリクレ条件
       NN : 両端ノイマン条件
</pre>
</td></tr>
</table>
</td></tr>
</table>
<p>
スペクトルデータにディリクレ・ノイマン境界条件を適用する Chebyshev
空間での境界条件適用(タウ法)
</p>
<p>
チェビシェフ空間において境界条件を満たすべく高次の係数を
定める方法をとっている(タウ法).
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001459">wt_module#wt_BoundariesTau</a>
</p>


        </div>
      </div>


      <div id="method-M001708" class="method-detail">
        <a name="M001708"></a>

        <div class="method-heading">




          <span class="method-name">wt_DRad_wt</span><span class="method-args">( wt ) result(wt_DRad_wt)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001708">wt_DRad_wt</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 動径微分された2 次元球面調和函数チェビシェフスペクトルデータ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>wt  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 2 次元球面調和函数チェビシェフスペクトルデータ

</td></tr>
</table>
</td></tr>
</table>
<p>
入力スペクトルデータに動径微分 ∂/∂r を作用する.
</p>
<p>
スペクトルデータの動径微分とは, 対応する格子点データに動径微分を
作用させたデータのスペクトル変換のことである.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001403">wt_module#wt_DRad_wt</a>
</p>


        </div>
      </div>


      <div id="method-M001715" class="method-detail">
        <a name="M001715"></a>

        <div class="method-heading">




          <span class="method-name">wt_DivLat_xyz</span><span class="method-args">( xyz ) result(wt_DivLat_xyz)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001715">wt_DivLat_xyz</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 発散型緯度微分を作用された 2 次元スペクトルデータ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xyz  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 3 次元経度緯度動径格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
格子データに発散型緯度微分 1/rcosφ・∂(f cosφ)/∂φ を
作用させたスペクトルデータを返す.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001410">wt_module#wt_DivLat_xyz</a>
</p>


        </div>
      </div>


      <div id="method-M001714" class="method-detail">
        <a name="M001714"></a>

        <div class="method-heading">




          <span class="method-name">wt_DivLon_xyz</span><span class="method-args">( xyz ) result(wt_DivLon_xyz)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001714">wt_DivLon_xyz</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 発散型経度微分を作用された 2 次元スペクトルデータ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xyz  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 3 次元経度緯度動径格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
格子点データに発散型経度微分 1/rcosφ・∂/∂λ を作用させた
スペクトルデータを返す.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001409">wt_module#wt_DivLon_xyz</a>
</p>


        </div>
      </div>


      <div id="method-M001709" class="method-detail">
        <a name="M001709"></a>

        <div class="method-heading">




          <span class="method-name">wt_DivRad_wt</span><span class="method-args">( wt ) result(wt_DivRad_wt)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001709">wt_DivRad_wt</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 発散型動径微分を作用された 2 次元スペクトルデータ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>wt  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 2 次元球面調和函数チェビシェフスペクトルデータ

</td></tr>
</table>
</td></tr>
</table>
<p>
入力スペクトルデータに発散型動径微分
</p>
<pre>
      1/r^2 ∂/∂r (r^2 .)= ∂/∂r + 2/r
</pre>
<p>
を作用する.
</p>
<p>
スペクトルデータの発散型動径微分とは, 対応する格子点データに
発散型動径微分を作用させたデータのスペクトル変換のことである.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001404">wt_module#wt_DivRad_wt</a>
</p>


        </div>
      </div>


      <div id="method-M001716" class="method-detail">
        <a name="M001716"></a>

        <div class="method-heading">




          <span class="method-name">wt_Div_xyz_xyz_xyz</span><span class="method-args">( xyz_Vlon, xyz_Vlat, xyz_Vrad ) result(wt_Div_xyz_xyz_xyz)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001716">wt_Div_xyz_xyz_xyz</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) ベクトル場の発散

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xyz_Vlon  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) ベクトル場の経度成分

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xyz_Vlat  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) ベクトル場の緯度成分

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xyz_Vrad  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) ベクトル場の動径成分

</td></tr>
</table>
</td></tr>
</table>
<p>
べクトル成分である 3 つの格子データに発散を作用させた
スペクトルデータを返す.
</p>
<p>
第 1, 2 ,3 引数(u,v,w)がそれぞれベクトルの経度成分, 緯度成分,
動径成分を表し, 発散は
</p>
<pre>
     1/rcosφ・∂u/∂λ + 1/rcosφ・∂(v cosφ)/∂φ
   + 1/r^2 ∂/∂r (r^2 w)
</pre>
<p>
と計算される.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001411">wt_module#wt_Div_xyz_xyz_xyz</a>
</p>


        </div>
      </div>


      <div id="method-M001759" class="method-detail">
        <a name="M001759"></a>

        <div class="method-heading">




          <span class="method-name">wt_KxRGrad_wt</span><span class="method-args">( wt ) result(wt_KxRGrad_wt)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001759">wt_KxRGrad_wt</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 経度微分を作用された 2 次元スペクトルデータ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>wt  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 2 次元球面調和函数チェビシェフスペクトルデータ

</td></tr>
</table>
</td></tr>
</table>
<p>
入力スペクトルデータに経度微分 k×r・▽ = ∂/∂λを作用する.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001444">wt_module#wt_KxRGrad_wt</a>
</p>


        </div>
      </div>


      <div id="method-M001762" class="method-detail">
        <a name="M001762"></a>

        <div class="method-heading">




          <span class="method-name">wt_L2Inv_wt</span><span class="method-args">( wt ) result(wt_L2Inv_wt)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001762">wt_L2Inv_wt</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) L^2 演算子の逆演算を作用された 2 次元スペクトルデータ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>wt  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 2 次元球面調和函数チェビシェフスペクトルデータ

</td></tr>
</table>
</td></tr>
</table>
<p>
入力スペクトルデータに L^2 演算子の逆演算(-逆水平ラプラシアン)を 作用する.
</p>
<p>
スペクトルデータに L^2 演算子を作用させる関数 <a
href="wtu_module.html#M001761">wt_L2_wt</a> の逆計算を 行う関数である.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001447">wt_module#wt_L2Inv_wt</a>
</p>


        </div>
      </div>


      <div id="method-M001761" class="method-detail">
        <a name="M001761"></a>

        <div class="method-heading">




          <span class="method-name">wt_L2_wt</span><span class="method-args">( wt ) result(wt_L2_wt)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001761">wt_L2_wt</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) L^2 演算子を作用された 2 次元スペクトルデータ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>wt  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 2 次元球面調和函数チェビシェフスペクトルデータ

</td></tr>
</table>
</td></tr>
</table>
<p>
入力スペクトルデータに L^2 演算子(=-水平ラプラシアン)を作用する.
</p>
<p>
L^2 演算子は単位球面上の水平ラプラシアンの逆符号にあたる.
</p>
<pre>
 入力スペクトルデ ータに対応する格子点データに演算子

    L^2 = -1/cos^2φ・∂^2/∂λ^2 - 1/cosφ・∂/∂φ(cosφ∂/∂φ)
</pre>
<p>
を作用させたデータのスペクトル変換が返される.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001446">wt_module#wt_L2_wt</a>
</p>


        </div>
      </div>


      <div id="method-M001785" class="method-detail">
        <a name="M001785"></a>

        <div class="method-heading">




          <span class="method-name">wt_LaplaPol2PolGrid_wt</span><span class="method-args">( wt, [cond], [new] ) result(wt_LaplaPol2PolGrid_wt)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001785">wt_LaplaPol2PolGrid_wt</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 出力ポロイダルポテンシャル分布

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>wt  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm),intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 入力▽^2φ分布

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>cond  </tt></b>  <tt> </tt> :</td><td><tt>character(len=2), intent(in), optional</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 境界条件スイッチ. 省略時は &#8216;RR&#8216;

<pre>
    RR    : 両端粘着条件
    RF    : 上端粘着, 下端応力なし条件
    FR    : 上端応力なし, 下端粘着条件
    FF    : 両端応力なし条件
</pre>
</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>new  </tt></b>  <tt> </tt> :</td><td><tt>logical, intent(IN), optional</tt>

<table>
<tr><td valign="top"> :</td><td> (in) true だと境界条件計算用行列を強制的に新たに作る.

<pre>
    default は false.
</pre>
</td></tr>
</table>
</td></tr>
</table>
<p>
速度ポロイダルポテンシャルΦを▽^2Φから計算する.
チェビシェフ格子点空間で境界条件を適用している.
</p>
<p>
この関数を用いるためには wt_Initial にて設定する
チェビシェフ切断波数(lm)と鉛直格子点数(km)を等しく しておく必要がある.
</p>
<p>
速度ポロイダルポテンシャルΦを f = ▽^2Φから定める式は
</p>
<pre>
   ▽^2Φ = f
     Φ = const. at boundaries.
     ∂Φ/∂r = 0 at boundaries          (粘着条件)
     or ∂^2Φ/∂r^2 = 0 at boundaries   (応力なし条件)
</pre>
<p>
最初に呼ばれるときはオプショナル引数 new に関係なく行列が設定される.
</p>
<p>
最終的にチェビシェフ係数の解が欲しい場合には, <a
href="wtu_module.html#M001776">wz_LaplaPol2Pol_wz</a> に 比べてチェビシェフ
&#8212; 格子点変換が 1 回分少なくて済む.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001464">wt_module#wt_LaplaPol2PolGrid_wt</a>
</p>


        </div>
      </div>


      <div id="method-M001711" class="method-detail">
        <a name="M001711"></a>

        <div class="method-heading">




          <span class="method-name">wt_Lapla_wt</span><span class="method-args">( wt ) result(wt_Lapla_wt)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001711">wt_Lapla_wt</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) ラプラシアンを作用された 2 次元スペクトルデータ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>wt  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 2 次元球面調和函数チェビシェフスペクトルデータ

</td></tr>
</table>
</td></tr>
</table>
<p>
入力スペクトルデータにラプラシアン
</p>
<pre>
    ▽^2 =   1/r^2 cos^2φ・∂^2/∂λ^2
           + 1/r^2 cosφ・∂/∂φ(cosφ∂/∂φ)
           + 1/r^2 ∂/∂r (r^2 ∂/∂r)
</pre>
<p>
を作用する.
</p>
<p>
スペクトルデータのラプラシアンとは, 対応する格子点データに
ラプラシアンを作用させたデータのスペクトル変換のことである.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001406">wt_module#wt_Lapla_wt</a>
</p>


        </div>
      </div>


      <div id="method-M001778" class="method-detail">
        <a name="M001778"></a>

        <div class="method-heading">




          <span class="method-name">wt_PolMagBoundaries</span><span class="method-args">( wt_POL, [new] ) </span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Subroutine </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt>wt_POL  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm),intent(inout)</tt>

<table>
<tr><td valign="top"> :</td><td> (inout) 境界条件を適用するデータ. 修正された値を返す.

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>new  </tt></b>  <tt> </tt> :</td><td><tt>logical, intent(IN), optional</tt>

<table>
<tr><td valign="top"> :</td><td> (in) true だと境界条件計算用行列を強制的に新たに作る.

<pre>
    default は false.
</pre>
</td></tr>
</table>
</td></tr>
</table>
<p>
磁場ポロイダルポテンシャルに対して境界条件を適用する. Chebyshev
空間での境界条件適用
</p>
<p>
チェビシェフ空間において境界条件を満たすべく高次の係数を定める方法を
とっている(タウ法). 現在のところ境界物質が非電気伝導体の場合のみ
対応している. その場合, 磁場ポロイダルポテンシャルの各水平スペクトル 成分 h
にたいして境界条件が与えられ,
</p>
<pre>
 * 外側境界 : dh/dr + (n+1)h/r = 0
 * 内側境界 : dh/dr - nh/r = 0
</pre>
<p>
である. ここで n は h の水平全波数である.
</p>
<p>
最初に呼ばれるときはオプショナル引数 new に関係なく行列が設定される.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001472">wt_module#wt_PolMagBoundaries</a>
</p>


        </div>
      </div>


      <div id="method-M001787" class="method-detail">
        <a name="M001787"></a>

        <div class="method-heading">




          <span class="method-name">wt_PolmagBoundariesGrid</span><span class="method-args">( wt_POL, [new] ) </span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Subroutine </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt>wt_POL  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm),intent(inout)</tt>

<table>
<tr><td valign="top"> :</td><td> (inout) 境界条件を適用するデータ. 修正された値を返す.

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>new  </tt></b>  <tt> </tt> :</td><td><tt>logical, intent(IN), optional</tt>

<table>
<tr><td valign="top"> :</td><td> (in) true だと境界条件計算用行列を強制的に新たに作る.

<pre>
    default は false.
</pre>
</td></tr>
</table>
</td></tr>
</table>
<p>
磁場ポロイダルポテンシャルに対して境界条件を適用する.
鉛直実空間での境界条件適用.
</p>
<p>
鉛直実格子点空間において内部領域の値と境界条件を満たすように
条件を課している(選点法). このルーチンを用いるためには wt_Initial
にて設定するチェビシェフ切断波数(lm)と鉛直格子点数(km)を
等しくしておく必要がある.
</p>
<p>
現在のところ境界物質が非電気伝導体の場合のみ対応している. その場合,
磁場ポロイダルポテンシャルの各水平スペクトル成分 h に
たいして境界条件が与えられ,
</p>
<pre>
 * 外側境界 : dh/dr + (n+1)h/r = 0
 * 内側境界 : dh/dr - nh/r = 0
</pre>
<p>
である. ここで n は h の水平全波数である.
</p>
<p>
最初に呼ばれるときはオプショナル引数 new に関係なく行列が設定される.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001468">wt_module#wt_PolmagBoundariesGrid</a>
</p>


        </div>
      </div>


      <div id="method-M001782" class="method-detail">
        <a name="M001782"></a>

        <div class="method-heading">




          <span class="method-name">wt_PolmagBoundariesTau</span><span class="method-args">( wt_POL, [new] ) </span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Subroutine </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt>wt_POL  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm),intent(inout)</tt>

<table>
<tr><td valign="top"> :</td><td> (inout) 境界条件を適用するデータ. 修正された値を返す.

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>new  </tt></b>  <tt> </tt> :</td><td><tt>logical, intent(IN), optional</tt>

<table>
<tr><td valign="top"> :</td><td> (in) true だと境界条件計算用行列を強制的に新たに作る.

<pre>
    default は false.
</pre>
</td></tr>
</table>
</td></tr>
</table>
<p>
磁場ポロイダルポテンシャルに対して境界条件を適用する. Chebyshev
空間での境界条件適用
</p>
<p>
チェビシェフ空間において境界条件を満たすべく高次の係数を定める方法を
とっている(タウ法). 現在のところ境界物質が非電気伝導体の場合のみ
対応している. その場合, 磁場ポロイダルポテンシャルの各水平スペクトル 成分 h
にたいして境界条件が与えられ,
</p>
<pre>
 * 外側境界 : dh/dr + (n+1)h/r = 0
 * 内側境界 : dh/dr - nh/r = 0
</pre>
<p>
である. ここで n は h の水平全波数である.
</p>
<p>
最初に呼ばれるときはオプショナル引数 new に関係なく行列が設定される.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001467">wt_module#wt_PolmagBoundariesTau</a>
</p>


        </div>
      </div>


      <div id="method-M001767" class="method-detail">
        <a name="M001767"></a>

        <div class="method-heading">




          <span class="method-name">wt_Potential2Rotation</span><span class="method-args">( xyz_RotVLON, xyz_RotVLAT, xyz_RotVRAD, wt_TORPOT, wt_POLPOT ) </span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Subroutine </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt>xyz_RotVLON  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km), intent(OUT)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 回転の経度成分

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xyz_RotVLAT  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km), intent(OUT)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 回転の緯度成分

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xyz_RotVRAD  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km), intent(OUT)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 回転の動径成分

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>wt_TORPOT  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) トロイダルポテンシャル

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>wt_POLPOT  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) ポロイダルポテンシャル

</td></tr>
</table>
</td></tr>
</table>
<p>
トロイダルポロイダルポテンシャルΨ,Φで表される非発散ベクトル場
</p>
<pre>
    v = ▽x(Ψr) + ▽x▽x(Φr)
</pre>
<p>
に対して, その回転
</p>
<pre>
    ▽xv = ▽x▽x(Ψr) + ▽x▽x▽x(Φr) = ▽x▽x(Ψr) - ▽x((▽^2Φ)r)
</pre>
<p>
を計算する.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001452">wt_module#wt_Potential2Rotation</a>
</p>


        </div>
      </div>


      <div id="method-M001766" class="method-detail">
        <a name="M001766"></a>

        <div class="method-heading">




          <span class="method-name">wt_Potential2Vector</span><span class="method-args">( xyz_VLON, xyz_VLAT, xyz_VRAD, wt_TORPOT, wt_POLPOT ) </span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Subroutine </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt>xyz_VLON  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) ベクトル場の経度成分

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xyz_VLAT  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) ベクトル場の緯度成分

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xyz_VRAD  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) ベクトル場の動径成分

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>wt_TORPOT  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) トロイダルポテンシャル

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>wt_POLPOT  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) ポロイダルポテンシャル

</td></tr>
</table>
</td></tr>
</table>
<p>
トロイダルポロイダルポテンシャルΨ,Φで表される非発散ベクトル場
</p>
<pre>
    v = ▽x(Ψr) + ▽x▽x(Φr)
</pre>
<p>
の各成分を計算する
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001451">wt_module#wt_Potential2Vector</a>
</p>


        </div>
      </div>


      <div id="method-M001763" class="method-detail">
        <a name="M001763"></a>

        <div class="method-heading">




          <span class="method-name">wt_QOperator_wt</span><span class="method-args">( wt ) result(wt_QOperator_wt)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001763">wt_QOperator_wt</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) Q 演算子を作用された 2 次元スペクトルデータ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>wt  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 2 次元球面調和函数チェビシェフスペクトルデータ

</td></tr>
</table>
</td></tr>
</table>
<p>
入力スペクトルデータに対応する格子点データに演算子
</p>
<pre>
   Q=(k・▽-1/2(L2 k・▽+ k・▽L2))
</pre>
<p>
を作用させたデータのスペクトル変換が返される.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001448">wt_module#wt_QOperator_wt</a>
</p>


        </div>
      </div>


      <div id="method-M001765" class="method-detail">
        <a name="M001765"></a>

        <div class="method-heading">




          <span class="method-name">wt_RadRotRot_xyz_xyz_xyz</span><span class="method-args">( xyz_VLON, xyz_VLAT, xyz_VRAD ) result(wt_RadRotRot_xyz_xyz_xyz)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001765">wt_RadRotRot_xyz_xyz_xyz</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) ベクトル v の r・(▽×▽×v)

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xyz_VLON  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) ベクトルの経度成分

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xyz_VLAT  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) ベクトルの緯度成分

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xyz_VRAD  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) ベクトルの動径成分

</td></tr>
</table>
</td></tr>
</table>
<p>
ベクトル v に対して r・(▽×▽×v) を計算する.
</p>
<p>
第 1, 2, 3 引数(v[λ], v[φ], v[r])がそれぞれベクトルの経度成分, 緯度成分,
動径成分を表す.
</p>
<pre>
   r・(▽×▽×v)  = 1/r ∂/∂r (r・( 1/cosφ・∂v[λ]/∂λ
                                 + 1/cosφ・∂(v[φ] cosφ)/∂φ ) )
                    + L^2 v[r]/r
</pre>
<p>
のスペクトルデータが返される.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001450">wt_module#wt_RadRotRot_xyz_xyz_xyz</a>
</p>


        </div>
      </div>


      <div id="method-M001764" class="method-detail">
        <a name="M001764"></a>

        <div class="method-heading">




          <span class="method-name">wt_RadRot_xyz_xyz</span><span class="method-args">( xyz_VLON, xyz_VLAT ) result(wt_RadRot_xyz_xyz)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001764">wt_RadRot_xyz_xyz</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) ベクトルの渦度と動径ベクトルの内積

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xyz_VLON  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) ベクトルの経度成分

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xyz_VLAT  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) ベクトルの緯度成分

</td></tr>
</table>
</td></tr>
</table>
<p>
r・(▽×v)
</p>
<p>
ベクトルの渦度と動径ベクトルの内積 r・(▽×v) を計算する.
</p>
<p>
第 1, 2 引数(v[λ], v[φ])がそれぞれベクトルの経度成分, 緯度成分を表す.
</p>
<pre>
   r・(▽×v) = 1/cosφ・∂v[φ]/∂λ - 1/cosφ・∂(v[λ] cosφ)/∂φ
</pre>
<p>
のスペクトル データが返される.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001449">wt_module#wt_RadRot_xyz_xyz</a>
</p>


        </div>
      </div>


      <div id="method-M001710" class="method-detail">
        <a name="M001710"></a>

        <div class="method-heading">




          <span class="method-name">wt_RotRad_wt</span><span class="method-args">( wt ) result(wt_RotRad_wt)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001710">wt_RotRad_wt</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 回転型動径微分を作用された 2 次元スペクトルデータ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>wt  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 2 次元球面調和函数チェビシェフスペクトルデータ

</td></tr>
</table>
</td></tr>
</table>
<p>
入力スペクトルデータに回転型動径微分
</p>
<pre>
     1/r ∂(r.)/∂r = ∂(.)/∂r + (.)/r
</pre>
<p>
を作用する.
</p>
<p>
スペクトルデータの回転型動径微分とは, 対応する格子点データに
回転型動径微分を作用させたデータのスペクトル変換のことである.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001405">wt_module#wt_RotRad_wt</a>
</p>


        </div>
      </div>


      <div id="method-M001720" class="method-detail">
        <a name="M001720"></a>

        <div class="method-heading">




          <span class="method-name">wt_RotRad_xyz_xyz</span><span class="method-args">( xyz_Vlat, xyz_Vlon ) result(wt_RotRad_xyz_xyz)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001720">wt_RotRad_xyz_xyz</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) ベクトル場の回転の動径成分

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xyz_Vlat  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) ベクトル場の緯度成分

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xyz_Vlon  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) ベクトル場の経度成分

</td></tr>
</table>
</td></tr>
</table>
<p>
ベクトルの緯度成分, 経度成分である第 1, 2 引数 Vlat, Vlon に対して
ベクトル場の回転の動径成分
</p>
<pre>
   1/rcosφ・∂Vlat/∂λ - 1/rcosφ・∂(Vlon cosφ)/∂φ
</pre>
<p>
を計算する.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001415">wt_module#wt_RotRad_xyz_xyz</a>
</p>


        </div>
      </div>


      <div id="method-M001775" class="method-detail">
        <a name="M001775"></a>

        <div class="method-heading">




          <span class="method-name">wt_TorBoundaries</span><span class="method-args">( wt_TORPOT, [values], [cond], [new] ) </span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Subroutine </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt>wt_TORPOT  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm),intent(inout)</tt>

<table>
<tr><td valign="top"> :</td><td> (inout) 境界条件を適用するデータ. 修正された値を返す.

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>values  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),2), intent(in), optional</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 両端境界でのトロイダルポテンシャル

<pre>
    粘着条件の時のみ有効
</pre>
</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>cond  </tt></b>  <tt> </tt> :</td><td><tt>character(len=2), intent(in), optional</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 境界条件スイッチ. 省略時は &#8216;RR&#8216;

<pre>
    RR    : 両端粘着条件
    RF    : 上端粘着, 下端応力なし条件
    FR    : 上端応力なし, 下端粘着条件
    FF    : 両端応力なし条件
</pre>
</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>new  </tt></b>  <tt> </tt> :</td><td><tt>logical, intent(IN), optional</tt>

<table>
<tr><td valign="top"> :</td><td> (in) true だと境界条件計算用行列を強制的に新たに作る.

<pre>
    default は false.
</pre>
</td></tr>
</table>
</td></tr>
</table>
<p>
速度トロイダルポテンシャルに対して境界条件を適用する. Chebyshev
空間での境界条件適用.
</p>
<p>
速度トロイダルポテンシャルΨに対して与えられる境界条件は
</p>
<pre>
  * 粘着条件 : Ψ = Ψb(lon,lat). Ψb は境界球面での速度分布.
                                  default は 0(静止状態).

  * 応力なし条件 : ∂(Ψ/r)/∂r = 0.
</pre>
<p>
最初に呼ばれるときはオプショナル引数 new に関係なく行列が設定される.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001470">wt_module#wt_TorBoundaries</a>
</p>


        </div>
      </div>


      <div id="method-M001784" class="method-detail">
        <a name="M001784"></a>

        <div class="method-heading">




          <span class="method-name">wt_TorBoundariesGrid</span><span class="method-args">( wt_TORPOT, [values], [cond], [new] ) </span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Subroutine </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt>wt_TORPOT  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm),intent(inout)</tt>

<table>
<tr><td valign="top"> :</td><td> (inout) 境界条件を適用するデータ. 修正された値を返す.

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>values  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),2), intent(in), optional</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 両端境界でのトロイダルポテンシャル

<pre>
    粘着条件の時のみ有効
</pre>
</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>cond  </tt></b>  <tt> </tt> :</td><td><tt>character(len=2), intent(in), optional</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 境界条件スイッチ. 省略時は &#8216;RR&#8216;

<pre>
    RR    : 両端粘着条件
    RF    : 上端粘着, 下端応力なし条件
    FR    : 上端応力なし, 下端粘着条件
    FF    : 両端応力なし条件
</pre>
</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>new  </tt></b>  <tt> </tt> :</td><td><tt>logical, intent(IN), optional</tt>

<table>
<tr><td valign="top"> :</td><td> (in) true だと境界条件計算用行列を強制的に新たに作る.

<pre>
    default は false.
</pre>
</td></tr>
</table>
</td></tr>
</table>
<p>
速度トロイダルポテンシャルに対して境界条件を適用する.
実空間での境界条件適用
</p>
<p>
鉛直実格子点空間において内部領域の値と境界条件を満たすように
条件を課している(選点法). このルーチンを用いるためには wt_Initial
にて設定するチェビシェフ切断波数(lm)と鉛直格子点数(km)を
等しくしておく必要がある.
</p>
<p>
速度トロイダルポテンシャルΨに対して与えられる境界条件は
</p>
<pre>
  * 粘着条件 : Ψ = Ψb(lon,lat). Ψb は境界球面での速度分布.
                                  default は 0 (静止状態).

  * 応力なし条件 : ∂(Ψ/r)/∂r = 0.
</pre>
<p>
最初に呼ばれるときはオプショナル引数 new に関係なく行列が設定される.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001462">wt_module#wt_TorBoundariesGrid</a>
</p>


        </div>
      </div>


      <div id="method-M001780" class="method-detail">
        <a name="M001780"></a>

        <div class="method-heading">




          <span class="method-name">wt_TorBoundariesTau</span><span class="method-args">( wt_TORPOT, [values], [cond], [new] ) </span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Subroutine </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt>wt_TORPOT  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm),intent(inout)</tt>

<table>
<tr><td valign="top"> :</td><td> (inout) 境界条件を適用するデータ. 修正された値を返す.

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>values  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),2), intent(in), optional</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 両端境界でのトロイダルポテンシャル

<pre>
    粘着条件の時のみ有効
</pre>
</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>cond  </tt></b>  <tt> </tt> :</td><td><tt>character(len=2), intent(in), optional</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 境界条件スイッチ. 省略時は &#8216;RR&#8216;

<pre>
    RR    : 両端粘着条件
    RF    : 上端粘着, 下端応力なし条件
    FR    : 上端応力なし, 下端粘着条件
    FF    : 両端応力なし条件
</pre>
</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>new  </tt></b>  <tt> </tt> :</td><td><tt>logical, intent(IN), optional</tt>

<table>
<tr><td valign="top"> :</td><td> (in) true だと境界条件計算用行列を強制的に新たに作る.

<pre>
    default は false.
</pre>
</td></tr>
</table>
</td></tr>
</table>
<p>
速度トロイダルポテンシャルに対して境界条件を適用する. Chebyshev
空間での境界条件適用.
</p>
<p>
速度トロイダルポテンシャルΨに対して与えられる境界条件は
</p>
<pre>
  * 粘着条件 : Ψ = Ψb(lon,lat). Ψb は境界球面での速度分布.
                                  default は 0(静止状態).

  * 応力なし条件 : ∂(Ψ/r)/∂r = 0.
</pre>
<p>
最初に呼ばれるときはオプショナル引数 new に関係なく行列が設定される.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001461">wt_module#wt_TorBoundariesTau</a>
</p>


        </div>
      </div>


      <div id="method-M001777" class="method-detail">
        <a name="M001777"></a>

        <div class="method-heading">




          <span class="method-name">wt_TorMagBoundaries</span><span class="method-args">( wt_TOR, [new] ) </span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Subroutine </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt>wt_TOR  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm),intent(inout)</tt>

<table>
<tr><td valign="top"> :</td><td> (inout) 境界条件を適用するデータ. 修正された値を返す.

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>new  </tt></b>  <tt> </tt> :</td><td><tt>logical, intent(IN), optional</tt>

<table>
<tr><td valign="top"> :</td><td> (in) true だと境界条件計算用行列を強制的に新たに作る.

<pre>
    default は false.
</pre>
</td></tr>
</table>
</td></tr>
</table>
<p>
Original external subprogram is <a
href="wt_module.html#M001471">wt_module#wt_TorMagBoundaries</a>
</p>


        </div>
      </div>


      <div id="method-M001786" class="method-detail">
        <a name="M001786"></a>

        <div class="method-heading">




          <span class="method-name">wt_TormagBoundariesGrid</span><span class="method-args">( wt_TOR, [new] ) </span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Subroutine </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt>wt_TOR  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm),intent(inout)</tt>

<table>
<tr><td valign="top"> :</td><td> (inout) 境界条件を適用するデータ. 修正された値を返す.

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>new  </tt></b>  <tt> </tt> :</td><td><tt>logical, intent(IN), optional</tt>

<table>
<tr><td valign="top"> :</td><td> (in) true だと境界条件計算用行列を強制的に新たに作る.

<pre>
    default は false.
</pre>
</td></tr>
</table>
</td></tr>
</table>
<p>
磁場トロイダルポテンシャルに対して境界条件を適用する.
鉛直実空間での境界条件適用.
</p>
<p>
鉛直実格子点空間において内部領域の値と境界条件を満たすように
条件を課している(選点法). このルーチンを用いるためには wt_Initial
にて設定するチェビシェフ切断波数(lm)と鉛直格子点数(km)を
等しくしておく必要がある.
</p>
<p>
現在のところ境界物質が非電気伝導体の場合のみ対応している. その場合,
磁場トロイダルポテンシャルの境界条件は
</p>
<p>
外側
</p>
<pre>
   wt_psi = 0   at the outer boundary
</pre>
<p>
内側
</p>
<pre>
   wt_psi = 0       at the inner boundary
</pre>
<p>
であるので <a href="wtu_module.html#M001774">wt_Boundaries</a>
で対応可能だが, 将来のため別途作成しておく
</p>
<p>
最初に呼ばれるときはオプショナル引数 new に関係なく行列が設定される.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001466">wt_module#wt_TormagBoundariesGrid</a>
</p>


        </div>
      </div>


      <div id="method-M001781" class="method-detail">
        <a name="M001781"></a>

        <div class="method-heading">




          <span class="method-name">wt_TormagBoundariesTau</span><span class="method-args">( wt_TOR, [new] ) </span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Subroutine </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt>wt_TOR  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm),intent(inout)</tt>

<table>
<tr><td valign="top"> :</td><td> (inout) 境界条件を適用するデータ. 修正された値を返す.

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>new  </tt></b>  <tt> </tt> :</td><td><tt>logical, intent(IN), optional</tt>

<table>
<tr><td valign="top"> :</td><td> (in) true だと境界条件計算用行列を強制的に新たに作る.

<pre>
    default は false.
</pre>
</td></tr>
</table>
</td></tr>
</table>
<p>
Original external subprogram is <a
href="wt_module.html#M001465">wt_module#wt_TormagBoundariesTau</a>
</p>


        </div>
      </div>


      <div id="method-M001768" class="method-detail">
        <a name="M001768"></a>

        <div class="method-heading">




          <span class="method-name">wt_VGradV</span><span class="method-args">( xyz_VGRADV_LON, xyz_VGRADV_LAT, xyz_VGRADV_RAD, xyz_VLON, xyz_VLAT, xyz_VRAD ) </span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Subroutine </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt>xyz_VGRADV_LON  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km),intent(out)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) (v・▽v) 経度成分

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xyz_VGRADV_LAT  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km),intent(out)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) (v・▽v) 緯度成分

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xyz_VGRADV_RAD  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km),intent(out)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) (v・▽v) 動径成分

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xyz_VLON  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km),intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) ベクトル場 v の経度成分

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xyz_VLAT  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km),intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) ベクトル場 v の緯度成分

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xyz_VRAD  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km),intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) ベクトル場 v の動径成分

</td></tr>
</table>
</td></tr>
</table>
<p>
ベクトル場の v・▽v を計算する.
</p>
<p>
ベクトル場 v=(v[λ],v[φ],v[r]) に対するv・▽vの各成分は
次のように計算される.
</p>
<pre>
  (v・▽v)[λ] = ▽・(v[λ]v) + v[λ]v[r]/r - v[λ]v[φ]tan(φ)/r
  (v・▽v)[φ] = ▽・(v[φ]v) + v[φ]v[r]/r - v[λ]^2tan(φ)/r
  (v・▽v)[r] = ▽・(v[r]v) + (v[λ]^2+v[φ]^2)/r
</pre>
<p>
非発散速度場に対してはポテンシャルから <a
href="wtu_module.html#M001767">wt_Potential2Rotation</a> を
用いて回転を計算し, 恒等式 v・▽v = ▽(v[2^/2) - vx▽xv を
用いる方がよいだろう.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001453">wt_module#wt_VGradV</a>
</p>


        </div>
      </div>


      <div id="method-M001695" class="method-detail">
        <a name="M001695"></a>

        <div class="method-heading">




          <span class="method-name">wt_VMiss</span><span class="method-args"></span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em>Variable</em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001695">wt_VMiss</a>  </tt></b>  <tt> = -999.0        </tt> :</td><td><tt>real(8)</tt>

<table>
<tr><td valign="top"> :</td><td> 欠損値

</td></tr>
</table>
</td></tr>
</table>
<p>
Original external subprogram is <a
href="wt_module.html#M001395">wt_module#wt_VMiss</a>
</p>


        </div>
      </div>


      <div id="method-M001707" class="method-detail">
        <a name="M001707"></a>

        <div class="method-heading">




          <span class="method-name">wt_wz</span><span class="method-args">( wz ) result(wt_wz)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001707">wt_wz</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 2 次元球面調和函数チェビシェフスペクトルデータ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>wz  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 2 次元球面調和函数スペクトル・動径格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
水平スペクトル・動径格子点データからスペクトルデータへ(正)変換する.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001402">wt_module#wt_wz</a>
</p>


        </div>
      </div>


      <div id="method-M001703" class="method-detail">
        <a name="M001703"></a>

        <div class="method-heading">




          <span class="method-name">wt_xyz</span><span class="method-args">( xyz ) result(wt_xyz)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001703">wt_xyz</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 2 次元球面調和函数チェビシェフスペクトルデータ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xyz  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 3 次元経度緯度動径格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
3 次元格子点データからスペクトルデータへ(正)変換する.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001398">wt_module#wt_xyz</a>
</p>


        </div>
      </div>


      <div id="method-M001670" class="method-detail">
        <a name="M001670"></a>

        <div class="method-heading">


          <a href="#M001670" class="method-signature">



          <span class="method-name">wtu_Initial</span><span class="method-args">( i, j, ki, ko, n, li, lo, r_in, r_out, [np] ) </span>



          </a>

        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Subroutine </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt>i  </tt></b>  <tt> </tt> :</td><td><tt>integer,intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> 格子点数(経度λ)

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>j  </tt></b>  <tt> </tt> :</td><td><tt>integer,intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> 格子点数(緯度φ)

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>ki  </tt></b>  <tt> </tt> :</td><td><tt>integer,intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> 格子点数(動径 r)

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>ko  </tt></b>  <tt> </tt> :</td><td><tt>integer,intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> 格子点数(動径 z)

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>n  </tt></b>  <tt> </tt> :</td><td><tt>integer,intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> 切断波数(水平全波数)

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>li  </tt></b>  <tt> </tt> :</td><td><tt>integer,intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> 切断波数(球動径波数)

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>lo  </tt></b>  <tt> </tt> :</td><td><tt>integer,intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> 切断波数(球殻動径波数)

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>r_in  </tt></b>  <tt> </tt> :</td><td><tt>real(8),intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> 球半径

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>r_out  </tt></b>  <tt> </tt> :</td><td><tt>real(8),intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> 球半径

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>np  </tt></b>  <tt> </tt> :</td><td><tt>integer,intent(in), optional</tt>

<table>
<tr><td valign="top"> :</td><td> OPENMP での最大スレッド数

</td></tr>
</table>
</td></tr>
</table>
<p>
スペクトル変換の格子点数, 波数, 球および球殻動径座標の範囲を設定する.
</p>
<p>
他の関数を呼ぶ前に, 最初にこのサブルーチンを呼んで初期設定を
しなければならない.
</p>
<p>
np に 1 より大きな値を指定すれば ISPACK の球面調和函数変換 OPENMP
並列計算ルーチンが用いられる. 並列計算を実行するには, 実行時に環境変数
OMP_NUM_THREADS を np 以下の数字に設定する等の
システムに応じた準備が必要となる.
</p>
<p>
np に 1 より大きな値を指定しなければ並列計算ルーチンは呼ばれない.
</p>


          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M001670-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M001670-source">
<pre>
   subroutine wtu_Initial(i,j,ki,ko,n,li,lo,r_in,r_out,np)
     !
     ! スペクトル変換の格子点数, 波数, 球および球殻動径座標の範囲を設定する.
     !
     ! 他の関数を呼ぶ前に, 最初にこのサブルーチンを呼んで初期設定を
     ! しなければならない. 
     !
     ! np に 1 より大きな値を指定すれば ISPACK の球面調和函数変換 
     ! OPENMP 並列計算ルーチンが用いられる. 並列計算を実行するには, 
     ! 実行時に環境変数 OMP_NUM_THREADS を np 以下の数字に設定する等の
     ! システムに応じた準備が必要となる. 
     !
     ! np に 1 より大きな値を指定しなければ並列計算ルーチンは呼ばれない.
     !
     !
     integer,intent(in) :: i              ! 格子点数(経度λ)
     integer,intent(in) :: j              ! 格子点数(緯度φ)
     integer,intent(in) :: ki             ! 格子点数(動径 r)
     integer,intent(in) :: ko             ! 格子点数(動径 z)
     integer,intent(in) :: n              ! 切断波数(水平全波数)
     integer,intent(in) :: li             ! 切断波数(球動径波数)
     integer,intent(in) :: lo             ! 切断波数(球殻動径波数)

     real(8),intent(in) :: r_in, r_out    ! 球半径

     integer,intent(in), optional :: np   ! OPENMP での最大スレッド数

     im = i  
      jm = j 
      kmo = ko 
      kmi = ki
     nm = n  
      lmo = lo 
      lmi=li
     ri = r_in 
      ro = r_out

     if ( present(np) ) then
        if ( kmo &gt; kmi ) then
           call wt_Initial(im,jm,kmo,nm,lmo,ri,ro,np)
           call wu_Initial(im,jm,kmi,nm,lmi,ri,np,wa_init=.false.)
        else
           call wu_Initial(im,jm,kmi,nm,lmi,ri,np)
           call wt_Initial(im,jm,kmo,nm,lmo,ri,ro,np,wa_init=.false.)
        endif
     else
        if ( kmo &gt; kmi ) then
           call wt_Initial(im,jm,kmo,nm,lmo,ri,ro)
           call wu_Initial(im,jm,kmi,nm,lmi,ri,wa_init=.false.)
        else
           call wu_Initial(im,jm,kmi,nm,lmi,ri)
           call wt_Initial(im,jm,kmo,nm,lmo,ri,ro,wa_init=.false.)
        endif
     endif

     call MessageNotify('M','wtu_initial','wtu_module (2009/01/09) is initialized')

   end subroutine wtu_Initial
</pre>
          </div>

        </div>
      </div>


      <div id="method-M001676" class="method-detail">
        <a name="M001676"></a>

        <div class="method-heading">




          <span class="method-name">wtu_PolMagBoundaries</span><span class="method-args">( wt_Pol, wu_Pol, [new] ) </span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Subroutine </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt>wt_Pol  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lmo),intent(inout)</tt>

<table>
<tr><td valign="top"> :</td><td> (inout) 境界条件を適用するデータ. 修正された値を返す.

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>wu_Pol  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lmi),intent(inout)</tt>

<table>
<tr><td valign="top"> :</td><td> (inout) 境界条件を適用するデータ. 修正された値を返す.

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>new  </tt></b>  <tt> </tt> :</td><td><tt>logical, intent(IN), optional</tt>

<table>
<tr><td valign="top"> :</td><td> (in) true だと境界条件計算用行列を強制的に新たに作る.

<pre>
    default は false.
</pre>
</td></tr>
</table>
</td></tr>
</table>
<p>
磁場ポロイダルポテンシャルに対して境界条件を適用する. Chebyshev
空間での境界条件適用
</p>
<p>
チェビシェフ空間において境界条件を満たすべく高次の係数を定める方法を
とっている(タウ法). 現在のところ外側境界物質が非電気伝導体の場合のみ
対応している. その場合, 磁場トロイダルポテンシャルの境界条件は
</p>
<p>
現在のところ外側境界物質が非電気伝導体の場合のみ対応している. その場合,
磁場トロイダルポテンシャルの境界条件は
</p>
<p>
外側
</p>
<pre>
   dPol_o/dr +(n+1)/r Pol_o= 0   at the outer boundary
</pre>
<p>
球&#8212;球殻境界
</p>
<pre>
   Pol_o = Phi_i, DrDPol_o = DrDPol_i    at the boundary
</pre>
<p>
最初に呼ばれるときはオプショナル引数 new に関係なく行列が設定される.
</p>
<p>
Alias for <a href="wtu_module.html#M001673">wtu_PolMagBoundariesTau</a>
</p>


        </div>
      </div>


      <div id="method-M001674" class="method-detail">
        <a name="M001674"></a>

        <div class="method-heading">


          <a href="#M001674" class="method-signature">



          <span class="method-name">wtu_PolmagBoundariesGrid</span><span class="method-args">( wt_Pol, wu_Pol, [new] ) </span>



          </a>

        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Subroutine </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt>wt_Pol  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lmo),intent(inout)</tt>

<table>
<tr><td valign="top"> :</td><td> (inout) 境界条件を適用するデータ. 修正された値を返す.

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>wu_Pol  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lmi),intent(inout)</tt>

<table>
<tr><td valign="top"> :</td><td> (inout) 境界条件を適用するデータ. 修正された値を返す.

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>new  </tt></b>  <tt> </tt> :</td><td><tt>logical, intent(IN), optional</tt>

<table>
<tr><td valign="top"> :</td><td> (in) true だと境界条件計算用行列を強制的に新たに作る.

<pre>
    default は false.
</pre>
</td></tr>
</table>
</td></tr>
</table>
<p>
磁場ポロイダルポテンシャルに対して境界条件を適用する.
鉛直実空間での境界条件適用.
</p>
<p>
鉛直実格子点空間において内部領域の値と境界条件を満たすように
条件を課している(選点法). このルーチンを用いるためには <a
href="wtu_module.html#M001670">wtu_Initial</a>
にて設定するチェビシェフ切断波数(lmo,lmi)と
鉛直格子点数(kmo,kmi)を等しくしておく必要がある.
</p>
<p>
現在のところ境界物質が非電気伝導体の場合のみ対応している. その場合,
磁場トロイダルポテンシャルの境界条件は
</p>
<p>
外側
</p>
<pre>
   dPol_o/dr +(n+1)/r Pol_o= 0   at the outer boundary
</pre>
<p>
球&#8212;球殻境界
</p>
<pre>
   Pol_o = Phi_i, DrDPol_o = DrDPol_i    at the boundary
</pre>
<p>
最初に呼ばれるときはオプショナル引数 new に関係なく行列が設定される.
</p>


          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M001674-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M001674-source">
<pre>
    subroutine wtu_PolmagBoundariesGrid(wt_Pol,wu_Pol,new)
      !
      ! 磁場ポロイダルポテンシャルに対して境界条件を適用する.
      ! 鉛直実空間での境界条件適用.
      !
      ! 鉛直実格子点空間において内部領域の値と境界条件を満たすように
      ! 条件を課している(選点法). このルーチンを用いるためには 
      ! wtu_Initial にて設定するチェビシェフ切断波数(lmo,lmi)と
      ! 鉛直格子点数(kmo,kmi)を等しくしておく必要がある. 
      !
      ! 現在のところ境界物質が非電気伝導体の場合のみ対応している. 
      ! その場合, 磁場トロイダルポテンシャルの境界条件は
      !
      ! 外側
      !    dPol_o/dr +(n+1)/r Pol_o= 0   at the outer boundary
      ! 球--球殻境界
      !    Pol_o = Phi_i, DrDPol_o = DrDPol_i    at the boundary
      ! 
      ! 最初に呼ばれるときはオプショナル引数 new に関係なく行列が設定される.
      !
      real(8), dimension((nm+1)*(nm+1),0:lmo),intent(inout)   :: wt_Pol
              !(inout) 境界条件を適用するデータ. 修正された値を返す. 

      real(8), dimension((nm+1)*(nm+1),0:lmi),intent(inout)   :: wu_Pol
              !(inout) 境界条件を適用するデータ. 修正された値を返す. 

      logical, intent(IN), optional :: new
              !(in) true だと境界条件計算用行列を強制的に新たに作る.
              !     default は false.

      real(8), dimension(:,:,:), allocatable  :: alu
      integer, dimension(:,:), allocatable    :: kp

      real(8), dimension(:,:), allocatable    :: wt_I
      real(8), dimension(:,:), allocatable    :: wz_PSI
      real(8), dimension(:,:), allocatable    :: wz_DPSIDR
      real(8), dimension(:,:), allocatable    :: wu_I
      real(8), dimension(:,:), allocatable    :: wr_PSI
      real(8), dimension(:,:), allocatable    :: wr_DPSIDR

      real(8), dimension((nm+1)*(nm+1),0:lmo+lmi+1) :: wtu_Pol
      real(8), dimension((nm+1)*(nm+1),0:kmo+kmi+1) :: wzr_Pol

      logical :: first = .true.
      logical :: new_matrix = .false.
      integer  :: n,l,nn(2)
      save     :: alu, kp, first

      if (.not. present(new)) then
         new_matrix=.false.
      else 
         new_matrix=new
      endif

      if ( first .OR. new_matrix ) then
         first = .false.

         if ( lmo /= kmo .OR. lmi /= kmi ) then
            call MessageNotify('E','wtu_TorMagBoundariesGrid', 'Chebyshev truncation and number of grid points should be same.')
         endif

         if ( allocated(alu) ) deallocate(alu)
         if ( allocated(kp) ) deallocate(kp)
         if ( allocated(wt_I) ) deallocate(wt_I)
         if ( allocated(wz_PSI) ) deallocate(wz_PSI)
         if ( allocated(wu_I) ) deallocate(wu_I)
         if ( allocated(wr_PSI) ) deallocate(wr_PSI)
         allocate(alu((nm+1)*(nm+1),0:kmo+kmi+1,0:lmo+lmi+1))
         allocate(kp((nm+1)*(nm+1),0:lmo+lmi+1))
         allocate(wt_I((nm+1)*(nm+1),0:lmo),wz_PSI((nm+1)*(nm+1),0:kmo))
         allocate(wu_I((nm+1)*(nm+1),0:lmi),wr_PSI((nm+1)*(nm+1),0:kmi))
         allocate(wz_DPSIDR((nm+1)*(nm+1),0:kmo))
         allocate(wr_DPSIDR((nm+1)*(nm+1),0:kmi))

         alu = 0.0D0
         do l=0,lmo
            wt_I = 0.0D0
            wt_I(:,l)=1.0D0
            alu(:,0:kmo,l) = wz_wt(wt_I)              ! 内部領域は値そのまま.
         enddo
         do l=0,lmi
            wu_I = 0.0D0
            wu_I(:,l)=1.0D0
            alu(:,kmo+1:kmo+kmi+1,lmo+1+l) = wr_wu(wu_I)! 内部領域は値そのまま.
         enddo

         ! 球殻外側境界
         do l=0,lmo
            wt_I = 0.0D0
            wt_I(:,l) = 1.0D0
            wz_PSI = wz_wt(wt_I)
            wz_DPSIDR = wz_wt(wt_DRad_wt(wt_I))

            do n=1,(nm+1)*(nm+1)
               nn=nm_l(n)
               alu(n,0,l) = wz_DPSIDR(n,0) + (nn(1)+1) * wz_PSI(n,0)/z_RAD(0)
            enddo
         enddo

         ! 球--球殻境界
         do l=0,lmo
            wt_I = 0.0D0
            wt_I(:,l) = 1.0D0
            wz_PSI = wz_wt(wt_I)
            wz_DPSIDR = wz_wt(wt_DRad_wt(wt_I))

            alu(:,kmo,l)   = wz_DPSIDR(:,kmo) 
            alu(:,kmo+1,l) = wz_PSI(:,kmo)
         enddo
         do l=0,lmi
            wu_I = 0.0D0
            wu_I(:,l) = 1.0D0
            wr_PSI = wr_wu(wu_I)
            wr_DPSIDR = wr_DRad_wu(wu_I)

            alu(:,kmo,lmo+1+l)   = - wr_DPSIDR(:,0) 
            alu(:,kmo+1,lmo+1+l) = - wr_PSI(:,0)
         enddo

         call ludecomp(alu,kp)

         deallocate(wt_I,wz_PSI,wz_DPSIDR,wu_I,wr_PSI,wr_DPSIDR)

         call MessageNotify('M','PolmagBoundaryGrid', 'Matrix to apply  b.c. newly produced.')
      endif
      
      wzr_Pol(:,0:kmo)            = wz_wt(wt_Pol)
      wzr_Pol(:,kmo+1:kmo+kmi+1)  = wr_wu(wu_Pol)
      wzr_Pol(:,0)      = 0.0D0
      wzr_Pol(:,kmo)    = 0.0D0
      wzr_Pol(:,kmo+1)  = 0.0D0
      wtu_Pol = lusolve(alu,kp,wzr_Pol)

      wt_Pol = wtu_Pol(:,0:lmo)
      wu_Pol = wtu_Pol(:,lmo+1:lmo+lmi+1)  

    end subroutine wtu_PolmagBoundariesGrid
</pre>
          </div>

        </div>
      </div>


      <div id="method-M001673" class="method-detail">
        <a name="M001673"></a>

        <div class="method-heading">


          <a href="#M001673" class="method-signature">



          <span class="method-name">wtu_PolmagBoundariesTau</span><span class="method-args">( wt_Pol, wu_Pol, [new] ) </span>



          </a>

        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Subroutine </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt>wt_Pol  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lmo),intent(inout)</tt>

<table>
<tr><td valign="top"> :</td><td> (inout) 境界条件を適用するデータ. 修正された値を返す.

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>wu_Pol  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lmi),intent(inout)</tt>

<table>
<tr><td valign="top"> :</td><td> (inout) 境界条件を適用するデータ. 修正された値を返す.

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>new  </tt></b>  <tt> </tt> :</td><td><tt>logical, intent(IN), optional</tt>

<table>
<tr><td valign="top"> :</td><td> (in) true だと境界条件計算用行列を強制的に新たに作る.

<pre>
    default は false.
</pre>
</td></tr>
</table>
</td></tr>
</table>
<p>
磁場ポロイダルポテンシャルに対して境界条件を適用する. Chebyshev
空間での境界条件適用
</p>
<p>
チェビシェフ空間において境界条件を満たすべく高次の係数を定める方法を
とっている(タウ法). 現在のところ外側境界物質が非電気伝導体の場合のみ
対応している. その場合, 磁場トロイダルポテンシャルの境界条件は
</p>
<p>
現在のところ外側境界物質が非電気伝導体の場合のみ対応している. その場合,
磁場トロイダルポテンシャルの境界条件は
</p>
<p>
外側
</p>
<pre>
   dPol_o/dr +(n+1)/r Pol_o= 0   at the outer boundary
</pre>
<p>
球&#8212;球殻境界
</p>
<pre>
   Pol_o = Phi_i, DrDPol_o = DrDPol_i    at the boundary
</pre>
<p>
最初に呼ばれるときはオプショナル引数 new に関係なく行列が設定される.
</p>


          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M001673-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M001673-source">
<pre>
    subroutine wtu_PolmagBoundariesTau(wt_Pol,wu_Pol,new)
      !
      ! 磁場ポロイダルポテンシャルに対して境界条件を適用する.
      ! Chebyshev 空間での境界条件適用
      !
      ! チェビシェフ空間において境界条件を満たすべく高次の係数を定める方法を
      ! とっている(タウ法). 現在のところ外側境界物質が非電気伝導体の場合のみ
      ! 対応している. その場合, 磁場トロイダルポテンシャルの境界条件は
      !
      ! 現在のところ外側境界物質が非電気伝導体の場合のみ対応している. 
      ! その場合, 磁場トロイダルポテンシャルの境界条件は
      !
      ! 外側
      !    dPol_o/dr +(n+1)/r Pol_o= 0   at the outer boundary
      ! 球--球殻境界
      !    Pol_o = Phi_i, DrDPol_o = DrDPol_i    at the boundary
      ! 
      ! 最初に呼ばれるときはオプショナル引数 new に関係なく行列が設定される.
      !
      real(8), dimension((nm+1)*(nm+1),0:lmo),intent(inout)   :: wt_Pol
              !(inout) 境界条件を適用するデータ. 修正された値を返す. 

      real(8), dimension((nm+1)*(nm+1),0:lmi),intent(inout)   :: wu_Pol
              !(inout) 境界条件を適用するデータ. 修正された値を返す. 

      logical, intent(IN), optional :: new
              !(in) true だと境界条件計算用行列を強制的に新たに作る.
              !     default は false.

      real(8), dimension(:,:,:), allocatable  :: alu
      integer, dimension(:,:), allocatable    :: kp

      real(8), dimension(:,:), allocatable    :: wt_I
      real(8), dimension(:,:), allocatable    :: wz_PSI
      real(8), dimension(:,:), allocatable    :: wz_DPSIDR
      real(8), dimension(:,:), allocatable    :: wu_I
      real(8), dimension(:,:), allocatable    :: wr_PSI
      real(8), dimension(:,:), allocatable    :: wr_DPSIDR

      real(8), dimension((nm+1)*(nm+1),0:lmo+lmi+1) :: wtu_Pol

      logical :: first = .true.
      logical :: new_matrix = .false.
      integer  :: n,l,nn(2)
      save     :: alu, kp, first

      if (.not. present(new)) then
         new_matrix=.false.
      else 
         new_matrix=new
      endif

      if ( first .OR. new_matrix ) then
         first = .false.

         if ( allocated(alu) ) deallocate(alu)
         if ( allocated(kp) ) deallocate(kp)
         if ( allocated(wt_I) ) deallocate(wt_I)
         if ( allocated(wz_PSI) ) deallocate(wz_PSI)
         if ( allocated(wu_I) ) deallocate(wu_I)
         if ( allocated(wr_PSI) ) deallocate(wr_PSI)
         allocate(alu((nm+1)*(nm+1),0:lmo+lmi+1,0:lmo+lmi+1))
         allocate(kp((nm+1)*(nm+1),0:lmo+lmi+1))
         allocate(wt_I((nm+1)*(nm+1),0:lmo),wz_PSI((nm+1)*(nm+1),0:kmo))
         allocate(wu_I((nm+1)*(nm+1),0:lmi),wr_PSI((nm+1)*(nm+1),0:kmi))
         allocate(wz_DPSIDR((nm+1)*(nm+1),0:kmo))
         allocate(wr_DPSIDR((nm+1)*(nm+1),0:kmi))

         alu = 0.0D0
         do l=0,lmo+lmi+1
            alu(:,l,l) = 1.0d0   ! 低波数はそのまま.
         enddo

         ! 球殻外側境界
         do l=0,lmo
            wt_I = 0.0D0
            wt_I(:,l) = 1.0D0
            wz_PSI = wz_wt(wt_I)
            wz_DPSIDR = wz_wt(wt_DRad_wt(wt_I))

            do n=1,(nm+1)*(nm+1)
               nn=nm_l(n)
               alu(n,lmo-1,l) = wz_DPSIDR(n,0) + (nn(1)+1)*wz_PSI(n,0)/z_RAD(0)
            enddo
         enddo

         ! 球--球殻境界
         do l=0,lmo
            wt_I = 0.0D0
            wt_I(:,l) = 1.0D0
            wz_PSI = wz_wt(wt_I)
            wz_DPSIDR = wz_wt(wt_DRad_wt(wt_I))

            alu(:,lmo,l)       = wz_DPSIDR(:,kmo) 
            alu(:,lmo+lmi+1,l) = wz_PSI(:,kmo)
         enddo
         do l=0,lmi
            wu_I = 0.0D0
            wu_I(:,l) = 1.0D0
            wr_PSI = wr_wu(wu_I)
            wr_DPSIDR = wr_DRad_wu(wu_I)

            alu(:,lmo,lmo+1+l)   = - wr_DPSIDR(:,0) 
            alu(:,lmo+lmi+1,lmo+1+l) = - wr_PSI(:,0)
         enddo

         call ludecomp(alu,kp)

         deallocate(wt_I,wz_PSI,wz_DPSIDR,wu_I,wr_PSI,wr_DPSIDR)

         call MessageNotify('M','PolmagBoundaryTau', 'Matrix to apply  b.c. newly produced.')
      endif
      
      wtu_Pol(:,0:lmo)            = wt_Pol
      wtu_Pol(:,lmo+1:lmo+lmi+1)  = wu_Pol
      wtu_Pol(:,lmo-1)  = 0.0D0
      wtu_Pol(:,lmo)    = 0.0D0
      wtu_Pol(:,lmo+1)  = 0.0D0
      wtu_Pol = lusolve(alu,kp,wtu_Pol)

      wt_Pol = wtu_Pol(:,0:lmo)
      wu_Pol = wtu_Pol(:,lmo+1:lmo+lmi+1)  

    end subroutine wtu_PolmagBoundariesTau
</pre>
          </div>

        </div>
      </div>


      <div id="method-M001675" class="method-detail">
        <a name="M001675"></a>

        <div class="method-heading">




          <span class="method-name">wtu_TorMagBoundaries</span><span class="method-args">( wt_TOR, wu_TOR, Pmo, Pmi, [new] ) </span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Subroutine </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt>wt_TOR  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lmo),intent(inout)</tt>

<table>
<tr><td valign="top"> :</td><td> (inout) 境界条件を適用するデータ. 修正された値を返す.

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>wu_TOR  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lmi),intent(inout)</tt>

<table>
<tr><td valign="top"> :</td><td> (inout) 境界条件を適用するデータ. 修正された値を返す.

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>Pmo  </tt></b>  <tt> </tt> :</td><td><tt>real(8),intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 球殻の磁気プランドル数

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>Pmi  </tt></b>  <tt> </tt> :</td><td><tt>real(8),intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 内球の磁気プランドル数

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>new  </tt></b>  <tt> </tt> :</td><td><tt>logical, intent(IN), optional</tt>

<table>
<tr><td valign="top"> :</td><td> (in) true だと境界条件計算用行列を強制的に新たに作る.

<pre>
    default は false.
</pre>
</td></tr>
</table>
</td></tr>
</table>
<p>
磁場トロイダルポテンシャルに対して境界条件を適用する. Chebyshev
空間での境界条件適用
</p>
<p>
チェビシェフ空間において境界条件を満たすべく高次の係数を定める方法を
とっている(タウ法). 現在のところ外側境界物質が非電気伝導体の場合のみ
対応している. その場合, 磁場トロイダルポテンシャルの境界条件は
</p>
<p>
外側
</p>
<pre>
   Psi_o = 0   at the outer boundary
</pre>
<p>
球&#8212;球殻境界
</p>
<pre>
   Psi_o = Psi_i, Pm_o DrDPsi_o = Pm_i DrDPsi_i    at the boundary
</pre>
<p>
最初に呼ばれるときはオプショナル引数 new に関係なく行列が設定される.
</p>
<p>
Alias for <a href="wtu_module.html#M001671">wtu_TorMagBoundariesTau</a>
</p>


        </div>
      </div>


      <div id="method-M001672" class="method-detail">
        <a name="M001672"></a>

        <div class="method-heading">


          <a href="#M001672" class="method-signature">



          <span class="method-name">wtu_TormagBoundariesGrid</span><span class="method-args">( wt_TOR, wu_TOR, Pmo, Pmi, [new] ) </span>



          </a>

        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Subroutine </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt>wt_TOR  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lmo),intent(inout)</tt>

<table>
<tr><td valign="top"> :</td><td> (inout) 境界条件を適用するデータ. 修正された値を返す.

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>wu_TOR  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lmi),intent(inout)</tt>

<table>
<tr><td valign="top"> :</td><td> (inout) 境界条件を適用するデータ. 修正された値を返す.

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>Pmo  </tt></b>  <tt> </tt> :</td><td><tt>real(8),intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 球殻の磁気プランドル数

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>Pmi  </tt></b>  <tt> </tt> :</td><td><tt>real(8),intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 内球の磁気プランドル数

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>new  </tt></b>  <tt> </tt> :</td><td><tt>logical, intent(IN), optional</tt>

<table>
<tr><td valign="top"> :</td><td> (in) true だと境界条件計算用行列を強制的に新たに作る.

<pre>
    default は false.
</pre>
</td></tr>
</table>
</td></tr>
</table>
<p>
磁場トロイダルポテンシャルに対して境界条件を適用する.
鉛直実空間での境界条件適用.
</p>
<p>
鉛直実格子点空間において内部領域の値と境界条件を満たすように
条件を課している(選点法). このルーチンを用いるためには <a
href="wtu_module.html#M001670">wtu_Initial</a>
にて設定するチェビシェフ切断波数(lmo,lmi)と
鉛直格子点数(kmo,kmi)を等しくしておく必要がある.
</p>
<p>
現在のところ境界物質が非電気伝導体の場合のみ対応している. その場合,
磁場トロイダルポテンシャルの境界条件は
</p>
<p>
外側
</p>
<pre>
   Psi_o = 0   at the outer boundary
</pre>
<p>
球&#8212;球殻境界
</p>
<pre>
   Psi_o = Psi_i, Pm_o DrDPsi_o = Pm_i DrDPsi_i    at the boundary
</pre>
<p>
最初に呼ばれるときはオプショナル引数 new に関係なく行列が設定される.
</p>


          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M001672-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M001672-source">
<pre>
    subroutine wtu_TormagBoundariesGrid(wt_TOR,wu_TOR,Pmo,Pmi,new)
      !
      ! 磁場トロイダルポテンシャルに対して境界条件を適用する.
      ! 鉛直実空間での境界条件適用.
      !
      ! 鉛直実格子点空間において内部領域の値と境界条件を満たすように
      ! 条件を課している(選点法). このルーチンを用いるためには 
      ! wtu_Initial にて設定するチェビシェフ切断波数(lmo,lmi)と
      ! 鉛直格子点数(kmo,kmi)を等しくしておく必要がある. 
      !
      ! 現在のところ境界物質が非電気伝導体の場合のみ対応している. 
      ! その場合, 磁場トロイダルポテンシャルの境界条件は
      !
      ! 外側
      !    Psi_o = 0   at the outer boundary
      ! 球--球殻境界
      !    Psi_o = Psi_i, Pm_o DrDPsi_o = Pm_i DrDPsi_i    at the boundary
      ! 
      ! 最初に呼ばれるときはオプショナル引数 new に関係なく行列が設定される.
      !
      real(8), dimension((nm+1)*(nm+1),0:lmo),intent(inout)   :: wt_TOR
              !(inout) 境界条件を適用するデータ. 修正された値を返す. 

      real(8), dimension((nm+1)*(nm+1),0:lmi),intent(inout)   :: wu_TOR
              !(inout) 境界条件を適用するデータ. 修正された値を返す. 

      real(8),intent(in)           :: Pmo
              !(in) 球殻の磁気プランドル数

      real(8),intent(in)           :: Pmi
              !(in) 内球の磁気プランドル数

      logical, intent(IN), optional :: new
              !(in) true だと境界条件計算用行列を強制的に新たに作る.
              !     default は false.

      real(8), dimension(:,:,:), allocatable  :: alu
      integer, dimension(:,:), allocatable    :: kp

      real(8), dimension(:,:), allocatable    :: wt_I
      real(8), dimension(:,:), allocatable    :: wz_PSI
      real(8), dimension(:,:), allocatable    :: wz_DPSIDR
      real(8), dimension(:,:), allocatable    :: wu_I
      real(8), dimension(:,:), allocatable    :: wr_PSI
      real(8), dimension(:,:), allocatable    :: wr_DPSIDR

      real(8), dimension((nm+1)*(nm+1),0:lmo+lmi+1) :: wtu_PSI
      real(8), dimension((nm+1)*(nm+1),0:kmo+kmi+1) :: wzr_PSI

      logical :: first = .true.
      logical :: new_matrix = .false.
      integer  :: l
      save     :: alu, kp, first

      if (.not. present(new)) then
         new_matrix=.false.
      else 
         new_matrix=new
      endif

      if ( first .OR. new_matrix ) then
         first = .false.

         if ( lmo /= kmo .OR. lmi /= kmi ) then
            call MessageNotify('E','wtu_TorMagBoundariesGrid', 'Chebyshev truncation and number of grid points should be same.')
         endif

         if ( allocated(alu) ) deallocate(alu)
         if ( allocated(kp) ) deallocate(kp)
         if ( allocated(wt_I) ) deallocate(wt_I)
         if ( allocated(wz_PSI) ) deallocate(wz_PSI)
         if ( allocated(wu_I) ) deallocate(wu_I)
         if ( allocated(wr_PSI) ) deallocate(wr_PSI)
         allocate(alu((nm+1)*(nm+1),0:kmo+kmi+1,0:lmo+lmi+1))
         allocate(kp((nm+1)*(nm+1),0:lmo+lmi+1))
         allocate(wt_I((nm+1)*(nm+1),0:lmo),wz_PSI((nm+1)*(nm+1),0:kmo))
         allocate(wu_I((nm+1)*(nm+1),0:lmi),wr_PSI((nm+1)*(nm+1),0:kmi))
         allocate(wz_DPSIDR((nm+1)*(nm+1),0:kmo))
         allocate(wr_DPSIDR((nm+1)*(nm+1),0:kmi))

         alu = 0.0D0
         do l=0,lmo
            wt_I = 0.0D0
            wt_I(:,l)=1.0D0
            alu(:,0:kmo,l) = wz_wt(wt_I)              ! 内部領域は値そのまま.
         enddo
         do l=0,lmi
            wu_I = 0.0D0
            wu_I(:,l)=1.0D0
            alu(:,kmo+1:kmo+kmi+1,lmo+1+l) = wr_wu(wu_I)! 内部領域は値そのまま.
         enddo

         ! 球--球殻境界
         do l=0,lmo
            wt_I = 0.0D0
            wt_I(:,l) = 1.0D0
            wz_PSI = wz_wt(wt_I)
            wz_DPSIDR = wz_wt(wt_DRad_wt(wt_I))

            alu(:,kmo,l)   = Pmo * wz_DPSIDR(:,kmo) 
            alu(:,kmo+1,l) = wz_PSI(:,kmo)
         enddo
         do l=0,lmi
            wu_I = 0.0D0
            wu_I(:,l) = 1.0D0
            wr_PSI = wr_wu(wu_I)
            wr_DPSIDR = wr_DRad_wu(wu_I)

            alu(:,kmo,lmo+1+l)   = -Pmi * wr_DPSIDR(:,0) 
            alu(:,kmo+1,lmo+1+l) = - wr_PSI(:,0)
         enddo

         call ludecomp(alu,kp)

         deallocate(wt_I,wz_PSI,wz_DPSIDR,wu_I,wr_PSI,wr_DPSIDR)

         call MessageNotify('M','TormagBoundaryGrid', 'Matrix to apply  b.c. newly produced.')
      endif
      
      wzr_PSI(:,0:kmo)            = wz_wt(wt_TOR)
      wzr_PSI(:,kmo+1:kmo+kmi+1)  = wr_wu(wu_TOR)
      wzr_PSI(:,0)      = 0.0D0
      wzr_PSI(:,kmo)    = 0.0D0
      wzr_PSI(:,kmo+1)  = 0.0D0
      wtu_PSI = lusolve(alu,kp,wzr_PSI)

      wt_TOR = wtu_PSI(:,0:lmo)
      wu_TOR = wtu_PSI(:,lmo+1:lmo+lmi+1)  

    end subroutine wtu_TormagBoundariesGrid
</pre>
          </div>

        </div>
      </div>


      <div id="method-M001671" class="method-detail">
        <a name="M001671"></a>

        <div class="method-heading">


          <a href="#M001671" class="method-signature">



          <span class="method-name">wtu_TormagBoundariesTau</span><span class="method-args">( wt_TOR, wu_TOR, Pmo, Pmi, [new] ) </span>



          </a>

        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Subroutine </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt>wt_TOR  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lmo),intent(inout)</tt>

<table>
<tr><td valign="top"> :</td><td> (inout) 境界条件を適用するデータ. 修正された値を返す.

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>wu_TOR  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lmi),intent(inout)</tt>

<table>
<tr><td valign="top"> :</td><td> (inout) 境界条件を適用するデータ. 修正された値を返す.

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>Pmo  </tt></b>  <tt> </tt> :</td><td><tt>real(8),intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 球殻の磁気プランドル数

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>Pmi  </tt></b>  <tt> </tt> :</td><td><tt>real(8),intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 内球の磁気プランドル数

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>new  </tt></b>  <tt> </tt> :</td><td><tt>logical, intent(IN), optional</tt>

<table>
<tr><td valign="top"> :</td><td> (in) true だと境界条件計算用行列を強制的に新たに作る.

<pre>
    default は false.
</pre>
</td></tr>
</table>
</td></tr>
</table>
<p>
磁場トロイダルポテンシャルに対して境界条件を適用する. Chebyshev
空間での境界条件適用
</p>
<p>
チェビシェフ空間において境界条件を満たすべく高次の係数を定める方法を
とっている(タウ法). 現在のところ外側境界物質が非電気伝導体の場合のみ
対応している. その場合, 磁場トロイダルポテンシャルの境界条件は
</p>
<p>
外側
</p>
<pre>
   Psi_o = 0   at the outer boundary
</pre>
<p>
球&#8212;球殻境界
</p>
<pre>
   Psi_o = Psi_i, Pm_o DrDPsi_o = Pm_i DrDPsi_i    at the boundary
</pre>
<p>
最初に呼ばれるときはオプショナル引数 new に関係なく行列が設定される.
</p>


          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M001671-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M001671-source">
<pre>
    subroutine wtu_TormagBoundariesTau(wt_TOR,wu_TOR,Pmo,Pmi,new)
      !
      ! 磁場トロイダルポテンシャルに対して境界条件を適用する.
      ! Chebyshev 空間での境界条件適用
      !
      ! チェビシェフ空間において境界条件を満たすべく高次の係数を定める方法を
      ! とっている(タウ法). 現在のところ外側境界物質が非電気伝導体の場合のみ
      ! 対応している. その場合, 磁場トロイダルポテンシャルの境界条件は
      !
      ! 外側
      !    Psi_o = 0   at the outer boundary
      ! 球--球殻境界
      !    Psi_o = Psi_i, Pm_o DrDPsi_o = Pm_i DrDPsi_i    at the boundary
      ! 
      ! 最初に呼ばれるときはオプショナル引数 new に関係なく行列が設定される.
      !
      real(8), dimension((nm+1)*(nm+1),0:lmo),intent(inout)   :: wt_TOR
              !(inout) 境界条件を適用するデータ. 修正された値を返す. 

      real(8), dimension((nm+1)*(nm+1),0:lmi),intent(inout)   :: wu_TOR
              !(inout) 境界条件を適用するデータ. 修正された値を返す. 

      real(8),intent(in)           :: Pmo
              !(in) 球殻の磁気プランドル数

      real(8),intent(in)           :: Pmi
              !(in) 内球の磁気プランドル数

      logical, intent(IN), optional :: new
              !(in) true だと境界条件計算用行列を強制的に新たに作る.
              !     default は false.

      real(8), dimension(:,:,:), allocatable  :: alu
      integer, dimension(:,:), allocatable    :: kp

      real(8), dimension(:,:), allocatable    :: wt_I
      real(8), dimension(:,:), allocatable    :: wz_PSI
      real(8), dimension(:,:), allocatable    :: wz_DPSIDR
      real(8), dimension(:,:), allocatable    :: wu_I
      real(8), dimension(:,:), allocatable    :: wr_PSI
      real(8), dimension(:,:), allocatable    :: wr_DPSIDR

      real(8), dimension((nm+1)*(nm+1),0:lmo+lmi+1) :: wtu_PSI

      logical :: first = .true.
      logical :: new_matrix = .false.
      integer  :: l
      save     :: alu, kp, first

      if (.not. present(new)) then
         new_matrix=.false.
      else 
         new_matrix=new
      endif

      if ( first .OR. new_matrix ) then
         first = .false.

         if ( allocated(alu) ) deallocate(alu)
         if ( allocated(kp) ) deallocate(kp)
         if ( allocated(wt_I) ) deallocate(wt_I)
         if ( allocated(wz_PSI) ) deallocate(wz_PSI)
         if ( allocated(wu_I) ) deallocate(wu_I)
         if ( allocated(wr_PSI) ) deallocate(wr_PSI)
         allocate(alu((nm+1)*(nm+1),0:lmo+lmi+1,0:lmo+lmi+1))
         allocate(kp((nm+1)*(nm+1),0:lmo+lmi+1))
         allocate(wt_I((nm+1)*(nm+1),0:lmo),wz_PSI((nm+1)*(nm+1),0:kmo))
         allocate(wu_I((nm+1)*(nm+1),0:lmi),wr_PSI((nm+1)*(nm+1),0:kmi))
         allocate(wz_DPSIDR((nm+1)*(nm+1),0:kmo))
         allocate(wr_DPSIDR((nm+1)*(nm+1),0:kmi))

         alu = 0.0D0
         do l=0,lmo+lmi+1
            wt_I = 0.0D0
            alu(:,l,l) = 1.0D0      ! 低波数はそのまま
         enddo

         ! 球--球殻境界
         do l=0,lmo
            wt_I = 0.0D0
            wt_I(:,l) = 1.0D0
            wz_PSI = wz_wt(wt_I)
            wz_DPSIDR = wz_wt(wt_DRad_wt(wt_I))

            alu(:,lmo-1,l)   = wz_PSI(:,0)
            alu(:,lmo,l)   = Pmo * wz_DPSIDR(:,kmo) 
            alu(:,lmo+lmi+1,l) = wz_PSI(:,kmo)
         enddo
         do l=0,lmi
            wu_I = 0.0D0
            wu_I(:,l) = 1.0D0
            wr_PSI = wr_wu(wu_I)
            wr_DPSIDR = wr_DRad_wu(wu_I)

            alu(:,lmo,lmo+1+l)   = -Pmi * wr_DPSIDR(:,0) 
            alu(:,lmo+lmi+1,lmo+1+l) = - wr_PSI(:,0)
         enddo

         call ludecomp(alu,kp)

         deallocate(wt_I,wz_PSI,wz_DPSIDR,wu_I,wr_PSI,wr_DPSIDR)

         call MessageNotify('M','TormagBoundaryTau', 'Matrix to apply  b.c. newly produced.')
      endif
      
      wtu_PSI(:,0:lmo)            = wt_TOR
      wtu_PSI(:,lmo+1:lmo+lmi+1)  = wu_TOR
      wtu_PSI(:,lmo-1)      = 0.0D0
      wtu_PSI(:,lmo)        = 0.0D0
      wtu_PSI(:,lmo+lmi+1)  = 0.0D0
      wtu_PSI = lusolve(alu,kp,wtu_PSI)

      wt_TOR = wtu_PSI(:,0:lmo)
      wu_TOR = wtu_PSI(:,lmo+1:lmo+lmi+1)  

    end subroutine wtu_TormagBoundariesTau
</pre>
          </div>

        </div>
      </div>


      <div id="method-M001860" class="method-detail">
        <a name="M001860"></a>

        <div class="method-heading">




          <span class="method-name">wu_Boundary</span><span class="method-args">( wu, [value], [cond] ) </span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Subroutine </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt>wu  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm),intent(inout)</tt>

<table>
<tr><td valign="top"> :</td><td> (inout) 境界条件を適用するデータ. 修正された値を返す.

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>value  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1)), intent(in), optional</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 境界での 値/勾配 分布を水平スペクトル変換したものを与える.

<pre>
    省略時は値/勾配 0 となる.
</pre>
</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>cond  </tt></b>  <tt> </tt> :</td><td><tt>character(len=1), intent(in), optional</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 境界条件. 省略時は &#8216;D&#8216;

<pre>
       D : 外側ディリクレ条件
       N : 外側ノイマン条件
</pre>
</td></tr>
</table>
</td></tr>
</table>
<p>
スペクトルデータにディリクレ・ノイマン境界条件を適用する Chebyshev
空間での境界条件適用(タウ法)
</p>
<p>
チェビシェフ空間において境界条件を満たすべく高次の係数を
定める方法をとっている(タウ法).
</p>
<p>
Original external subprogram is <a
href="wu_module.html#M000446">wu_module#wu_Boundary</a>
</p>


        </div>
      </div>


      <div id="method-M001851" class="method-detail">
        <a name="M001851"></a>

        <div class="method-heading">




          <span class="method-name">wu_BoundaryGrid</span><span class="method-args">( wu, [value], [cond] ) </span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Subroutine </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt>wu  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm),intent(inout)</tt>

<table>
<tr><td valign="top"> :</td><td> (inout) 境界条件を適用するデータ. 修正された値を返す.

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>value  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1)), intent(in), optional</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 境界での 値/勾配 分布を水平スペクトル変換したものを与える.

<pre>
   省略時は値/勾配 0 となる.
</pre>
</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>cond  </tt></b>  <tt> </tt> :</td><td><tt>character(len=1), intent(in), optional</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 境界条件. 省略時は &#8216;D&#8216;

<pre>
       D : 外側ディリクレ条件
       N : 外側ノイマン条件
</pre>
</td></tr>
</table>
</td></tr>
</table>
<p>
スペクトルデータにディリクレ・ノイマン境界条件を適用する
実空間での境界条件適用
</p>
<p>
鉛直実格子点空間において内部領域の値と境界条件を満たすように
条件を課している(選点法). このルーチンを用いるためには wu_Initial
にて設定するチェビシェフ切断波数(lm)と鉛直格子点数(km)を
等しくしておく必要がある.
</p>
<p>
Original external subprogram is <a
href="wu_module.html#M000437">wu_module#wu_BoundaryGrid</a>
</p>


        </div>
      </div>


      <div id="method-M001850" class="method-detail">
        <a name="M001850"></a>

        <div class="method-heading">




          <span class="method-name">wu_BoundaryTau</span><span class="method-args">( wu, [value], [cond] ) </span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Subroutine </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt>wu  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm),intent(inout)</tt>

<table>
<tr><td valign="top"> :</td><td> (inout) 境界条件を適用するデータ. 修正された値を返す.

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>value  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1)), intent(in), optional</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 境界での 値/勾配 分布を水平スペクトル変換したものを与える.

<pre>
    省略時は値/勾配 0 となる.
</pre>
</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>cond  </tt></b>  <tt> </tt> :</td><td><tt>character(len=1), intent(in), optional</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 境界条件. 省略時は &#8216;D&#8216;

<pre>
       D : 外側ディリクレ条件
       N : 外側ノイマン条件
</pre>
</td></tr>
</table>
</td></tr>
</table>
<p>
スペクトルデータにディリクレ・ノイマン境界条件を適用する Chebyshev
空間での境界条件適用(タウ法)
</p>
<p>
チェビシェフ空間において境界条件を満たすべく高次の係数を
定める方法をとっている(タウ法).
</p>
<p>
Original external subprogram is <a
href="wu_module.html#M000436">wu_module#wu_BoundaryTau</a>
</p>


        </div>
      </div>


      <div id="method-M001837" class="method-detail">
        <a name="M001837"></a>

        <div class="method-heading">




          <span class="method-name">wu_KxRGrad_wu</span><span class="method-args">( wu ) result(wu_KxRGrad_wu)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001837">wu_KxRGrad_wu</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 経度微分を作用された 2 次元スペクトルデータ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>wu  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 2 次元球面調和函数チェビシェフスペクトルデータ

</td></tr>
</table>
</td></tr>
</table>
<p>
入力スペクトルデータに経度微分 k×r・▽ = ∂/∂λを作用する.
</p>
<p>
Original external subprogram is <a
href="wu_module.html#M000423">wu_module#wu_KxRGrad_wu</a>
</p>


        </div>
      </div>


      <div id="method-M001840" class="method-detail">
        <a name="M001840"></a>

        <div class="method-heading">




          <span class="method-name">wu_L2Inv_wu</span><span class="method-args">( wu ) result(wu_L2Inv_wu)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001840">wu_L2Inv_wu</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) L^2 演算子の逆演算を作用された 2 次元スペクトルデータ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>wu  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 2 次元球面調和函数チェビシェフスペクトルデータ

</td></tr>
</table>
</td></tr>
</table>
<p>
入力スペクトルデータに L^2 演算子の逆演算(-逆水平ラプラシアン)を 作用する.
</p>
<p>
スペクトルデータに L^2 演算子を作用させる関数 <a
href="wtu_module.html#M001839">wu_L2_wu</a> の逆計算を 行う関数である.
</p>
<p>
Original external subprogram is <a
href="wu_module.html#M000426">wu_module#wu_L2Inv_wu</a>
</p>


        </div>
      </div>


      <div id="method-M001839" class="method-detail">
        <a name="M001839"></a>

        <div class="method-heading">




          <span class="method-name">wu_L2_wu</span><span class="method-args">( wu ) result(wu_L2_wu)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001839">wu_L2_wu</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) L^2 演算子を作用された 2 次元スペクトルデータ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>wu  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 2 次元球面調和函数チェビシェフスペクトルデータ

</td></tr>
</table>
</td></tr>
</table>
<p>
入力スペクトルデータに L^2 演算子(=-水平ラプラシアン)を作用する.
</p>
<p>
L^2 演算子は単位球面上の水平ラプラシアンの逆符号にあたる.
</p>
<pre>
 入力スペクトルデ ータに対応する格子点データに演算子

    L^2 = -1/cos^2φ・∂^2/∂λ^2 - 1/cosφ・∂/∂φ(cosφ∂/∂φ)
</pre>
<p>
を作用させたデータのスペクトル変換が返される.
</p>
<p>
Original external subprogram is <a
href="wu_module.html#M000425">wu_module#wu_L2_wu</a>
</p>


        </div>
      </div>


      <div id="method-M001855" class="method-detail">
        <a name="M001855"></a>

        <div class="method-heading">




          <span class="method-name">wu_LaplaPol2PolGrid_wu</span><span class="method-args">( wu, [cond], [new] ) result(wu_LaplaPol2PolGrid_wu)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001855">wu_LaplaPol2PolGrid_wu</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 出力ポロイダルポテンシャル分布

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>wu  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm),intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 入力▽^2φ分布

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>cond  </tt></b>  <tt> </tt> :</td><td><tt>character(len=1), intent(in), optional</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 境界条件スイッチ. 省略時は &#8216;R&#8216;

<pre>
    R    : 上側粘着条件
    F    : 上側応力なし条件
</pre>
</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>new  </tt></b>  <tt> </tt> :</td><td><tt>logical, intent(IN), optional</tt>

<table>
<tr><td valign="top"> :</td><td> (in) true だと境界条件計算用行列を強制的に新たに作る.

<pre>
    default は false.
</pre>
</td></tr>
</table>
</td></tr>
</table>
<p>
速度ポロイダルポテンシャルΦを▽^2Φから計算する.
チェビシェフ格子点空間で境界条件を適用している.
</p>
<p>
この関数を用いるためには wu_Initial にて設定する
チェビシェフ切断波数(lm)と鉛直格子点数(km)を等しく しておく必要がある.
</p>
<p>
速度ポロイダルポテンシャルΦを f = ▽^2Φから定める式は
</p>
<pre>
   ▽^2Φ = f
     Φ = const. at Boundary.
     ∂Φ/∂r = 0 at Boundary          (粘着条件)
     or ∂^2Φ/∂r^2 = 0 at Boundary   (応力なし条件)
</pre>
<p>
最初に呼ばれるときはオプショナル引数 new に関係なく行列が設定される.
</p>
<p>
最終的にチェビシェフ係数の解が欲しい場合には, <a
href="wtu_module.html#M001854">wr_LaplaPol2Pol_wr</a> に 比べてチェビシェフ
&#8212; 格子点変換が 1 回分少なくて済む.
</p>
<p>
Original external subprogram is <a
href="wu_module.html#M000441">wu_module#wu_LaplaPol2PolGrid_wu</a>
</p>


        </div>
      </div>


      <div id="method-M001863" class="method-detail">
        <a name="M001863"></a>

        <div class="method-heading">




          <span class="method-name">wu_PolMagBoundary</span><span class="method-args">( wu_POL, [new] ) </span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Subroutine </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt>wu_POL  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm),intent(inout)</tt>

<table>
<tr><td valign="top"> :</td><td> (inout) 境界条件を適用するデータ. 修正された値を返す.

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>new  </tt></b>  <tt> </tt> :</td><td><tt>logical, intent(IN), optional</tt>

<table>
<tr><td valign="top"> :</td><td> (in) true だと境界条件計算用行列を強制的に新たに作る.

<pre>
    default は false.
</pre>
</td></tr>
</table>
</td></tr>
</table>
<p>
磁場ポロイダルポテンシャルに対して境界条件を適用する. Chebyshev
空間での境界条件適用
</p>
<p>
チェビシェフ空間において境界条件を満たすべく高次の係数を定める方法を
とっている(タウ法). 現在のところ境界物質が非電気伝導体の場合のみ
対応している. その場合, 磁場ポロイダルポテンシャルの各水平スペクトル 成分 h
にたいして境界条件が与えられ,
</p>
<pre>
 * 外側境界 : dh/dr + (n+1)h/r = 0
</pre>
<p>
である. ここで n は h の水平全波数である.
</p>
<p>
最初に呼ばれるときはオプショナル引数 new に関係なく行列が設定される.
</p>
<p>
Original external subprogram is <a
href="wu_module.html#M000449">wu_module#wu_PolMagBoundary</a>
</p>


        </div>
      </div>


      <div id="method-M001859" class="method-detail">
        <a name="M001859"></a>

        <div class="method-heading">




          <span class="method-name">wu_PolmagBoundaryGrid</span><span class="method-args">( wu_POL, [new] ) </span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Subroutine </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt>wu_POL  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm),intent(inout)</tt>

<table>
<tr><td valign="top"> :</td><td> (inout) 境界条件を適用するデータ. 修正された値を返す.

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>new  </tt></b>  <tt> </tt> :</td><td><tt>logical, intent(IN), optional</tt>

<table>
<tr><td valign="top"> :</td><td> (in) true だと境界条件計算用行列を強制的に新たに作る.

<pre>
    default は false.
</pre>
</td></tr>
</table>
</td></tr>
</table>
<p>
磁場ポロイダルポテンシャルに対して境界条件を適用する.
鉛直実空間での境界条件適用.
</p>
<p>
鉛直実格子点空間において内部領域の値と境界条件を満たすように
条件を課している(選点法). このルーチンを用いるためには wu_Initial
にて設定するチェビシェフ切断波数(lm)と鉛直格子点数(km)を
等しくしておく必要がある.
</p>
<p>
現在のところ境界物質が非電気伝導体の場合のみ対応している. その場合,
磁場ポロイダルポテンシャルの各水平スペクトル成分 h に
たいして境界条件が与えられ,
</p>
<pre>
 * 外側境界 : dh/dr + (n+1)h/r = 0
</pre>
<p>
である. ここで n は h の水平全波数である.
</p>
<p>
最初に呼ばれるときはオプショナル引数 new に関係なく行列が設定される.
</p>
<p>
Original external subprogram is <a
href="wu_module.html#M000445">wu_module#wu_PolmagBoundaryGrid</a>
</p>


        </div>
      </div>


      <div id="method-M001858" class="method-detail">
        <a name="M001858"></a>

        <div class="method-heading">




          <span class="method-name">wu_PolmagBoundaryTau</span><span class="method-args">( wu_POL, [new] ) </span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Subroutine </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt>wu_POL  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm),intent(inout)</tt>

<table>
<tr><td valign="top"> :</td><td> (inout) 境界条件を適用するデータ. 修正された値を返す.

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>new  </tt></b>  <tt> </tt> :</td><td><tt>logical, intent(IN), optional</tt>

<table>
<tr><td valign="top"> :</td><td> (in) true だと境界条件計算用行列を強制的に新たに作る.

<pre>
    default は false.
</pre>
</td></tr>
</table>
</td></tr>
</table>
<p>
磁場ポロイダルポテンシャルに対して境界条件を適用する. Chebyshev
空間での境界条件適用
</p>
<p>
チェビシェフ空間において境界条件を満たすべく高次の係数を定める方法を
とっている(タウ法). 現在のところ境界物質が非電気伝導体の場合のみ
対応している. その場合, 磁場ポロイダルポテンシャルの各水平スペクトル 成分 h
にたいして境界条件が与えられ,
</p>
<pre>
 * 外側境界 : dh/dr + (n+1)h/r = 0
</pre>
<p>
である. ここで n は h の水平全波数である.
</p>
<p>
最初に呼ばれるときはオプショナル引数 new に関係なく行列が設定される.
</p>
<p>
Original external subprogram is <a
href="wu_module.html#M000444">wu_module#wu_PolmagBoundaryTau</a>
</p>


        </div>
      </div>


      <div id="method-M001845" class="method-detail">
        <a name="M001845"></a>

        <div class="method-heading">




          <span class="method-name">wu_Potential2Rotation</span><span class="method-args">( xyr_RotVLON, xyr_RotVLAT, xyr_RotVRAD, wu_TORPOT, wu_POLPOT ) </span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Subroutine </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt>xyr_RotVLON  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km), intent(OUT)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 回転の経度成分

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xyr_RotVLAT  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km), intent(OUT)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 回転の緯度成分

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xyr_RotVRAD  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km), intent(OUT)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 回転の動径成分

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>wu_TORPOT  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) トロイダルポテンシャル

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>wu_POLPOT  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) ポロイダルポテンシャル

</td></tr>
</table>
</td></tr>
</table>
<p>
トロイダルポロイダルポテンシャルΨ,Φで表される非発散ベクトル場
</p>
<pre>
    v = ▽x(Ψr) + ▽x▽x(Φr)
</pre>
<p>
に対して, その回転
</p>
<pre>
    ▽xv = ▽x▽x(Ψr) + ▽x▽x▽x(Φr) = ▽x▽x(Ψr) - ▽x((▽^2Φ)r)
</pre>
<p>
を計算する.
</p>
<p>
Original external subprogram is <a
href="wu_module.html#M000431">wu_module#wu_Potential2Rotation</a>
</p>


        </div>
      </div>


      <div id="method-M001844" class="method-detail">
        <a name="M001844"></a>

        <div class="method-heading">




          <span class="method-name">wu_Potential2Vector</span><span class="method-args">( xyr_VLON, xyr_VLAT, xyr_VRAD, wu_TORPOT, wu_POLPOT ) </span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Subroutine </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt>xyr_VLON  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) ベクトル場の経度成分

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xyr_VLAT  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) ベクトル場の緯度成分

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xyr_VRAD  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) ベクトル場の動径成分

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>wu_TORPOT  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) トロイダルポテンシャル

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>wu_POLPOT  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) ポロイダルポテンシャル

</td></tr>
</table>
</td></tr>
</table>
<p>
トロイダルポロイダルポテンシャルΨ,Φで表される非発散ベクトル場
</p>
<pre>
    v = ▽x(Ψr) + ▽x▽x(Φr)
</pre>
<p>
の各成分を計算する
</p>
<p>
Original external subprogram is <a
href="wu_module.html#M000430">wu_module#wu_Potential2Vector</a>
</p>


        </div>
      </div>


      <div id="method-M001841" class="method-detail">
        <a name="M001841"></a>

        <div class="method-heading">




          <span class="method-name">wu_QOperator_wu</span><span class="method-args">( wu ) result(wu_QOperator_wu)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001841">wu_QOperator_wu</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) Q 演算子を作用された 2 次元スペクトルデータ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>wu  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 2 次元球面調和函数チェビシェフスペクトルデータ

</td></tr>
</table>
</td></tr>
</table>
<p>
入力スペクトルデータに対応する格子点データに演算子
</p>
<pre>
   Q=(k・▽-1/2(L2 k・▽+ k・▽L2))
</pre>
<p>
を作用させたデータのスペクトル変換が返される.
</p>
<p>
Original external subprogram is <a
href="wu_module.html#M000427">wu_module#wu_QOperator_wu</a>
</p>


        </div>
      </div>


      <div id="method-M001842" class="method-detail">
        <a name="M001842"></a>

        <div class="method-heading">




          <span class="method-name">wu_RadRot_xyr_xyr</span><span class="method-args">( xyr_VLON, xyr_VLAT ) result(wu_RadRot_xyr_xyr)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001842">wu_RadRot_xyr_xyr</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) ベクトルの渦度と動径ベクトルの内積

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xyr_VLON  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) ベクトルの経度成分

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xyr_VLAT  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) ベクトルの緯度成分

</td></tr>
</table>
</td></tr>
</table>
<p>
r・(▽×v)
</p>
<p>
ベクトルの渦度と動径ベクトルの内積 r・(▽×v) を計算する.
</p>
<p>
第 1, 2 引数(v[λ], v[φ])がそれぞれベクトルの経度成分, 緯度成分を表す.
</p>
<pre>
   r・(▽×v) = 1/cosφ・∂v[φ]/∂λ - 1/cosφ・∂(v[λ] cosφ)/∂φ
</pre>
<p>
のスペクトル データが返される.
</p>
<p>
Original external subprogram is <a
href="wu_module.html#M000428">wu_module#wu_RadRot_xyr_xyr</a>
</p>


        </div>
      </div>


      <div id="method-M001861" class="method-detail">
        <a name="M001861"></a>

        <div class="method-heading">




          <span class="method-name">wu_TorBoundary</span><span class="method-args">( wu_TORPOT, [value], [cond], [new] ) </span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Subroutine </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt>wu_TORPOT  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm),intent(inout)</tt>

<table>
<tr><td valign="top"> :</td><td> (inout) 境界条件を適用するデータ. 修正された値を返す.

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>value  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1)), intent(in), optional</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 両端境界でのトロイダルポテンシャル

<pre>
    粘着条件の時のみ有効
</pre>
</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>cond  </tt></b>  <tt> </tt> :</td><td><tt>character(len=1), intent(in), optional</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 境界条件スイッチ. 省略時は &#8216;R&#8216;

<pre>
    R    : 上側粘着条件
    F    : 上側応力なし条件
</pre>
</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>new  </tt></b>  <tt> </tt> :</td><td><tt>logical, intent(IN), optional</tt>

<table>
<tr><td valign="top"> :</td><td> (in) true だと境界条件計算用行列を強制的に新たに作る.

<pre>
    default は false.
</pre>
</td></tr>
</table>
</td></tr>
</table>
<p>
速度トロイダルポテンシャルに対して境界条件を適用する. Chebyshev
空間での境界条件適用.
</p>
<p>
速度トロイダルポテンシャルΨに対して与えられる境界条件は
</p>
<pre>
  * 粘着条件 : Ψ = Ψb(lon,lat). Ψb は境界球面での速度分布.
                                  default は 0(静止状態).

  * 応力なし条件 : ∂(Ψ/r)/∂r = 0.
</pre>
<p>
最初に呼ばれるときはオプショナル引数 new に関係なく行列が設定される.
</p>
<p>
Original external subprogram is <a
href="wu_module.html#M000447">wu_module#wu_TorBoundary</a>
</p>


        </div>
      </div>


      <div id="method-M001853" class="method-detail">
        <a name="M001853"></a>

        <div class="method-heading">




          <span class="method-name">wu_TorBoundaryGrid</span><span class="method-args">( wu_TORPOT, [value], [cond], [new] ) </span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Subroutine </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt>wu_TORPOT  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm),intent(inout)</tt>

<table>
<tr><td valign="top"> :</td><td> (inout) 境界条件を適用するデータ. 修正された値を返す.

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>value  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1)), intent(in), optional</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 両端境界でのトロイダルポテンシャル

<pre>
    粘着条件の時のみ有効
</pre>
</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>cond  </tt></b>  <tt> </tt> :</td><td><tt>character(len=1), intent(in), optional</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 境界条件スイッチ. 省略時は &#8216;R&#8216;

<pre>
    R    : 上側粘着条件
    F    : 上側応力なし条件
</pre>
</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>new  </tt></b>  <tt> </tt> :</td><td><tt>logical, intent(IN), optional</tt>

<table>
<tr><td valign="top"> :</td><td> (in) true だと境界条件計算用行列を強制的に新たに作る.

<pre>
    default は false.
</pre>
</td></tr>
</table>
</td></tr>
</table>
<p>
速度トロイダルポテンシャルに対して境界条件を適用する.
実空間での境界条件適用
</p>
<p>
鉛直実格子点空間において内部領域の値と境界条件を満たすように
条件を課している(選点法). このルーチンを用いるためには wu_Initial
にて設定するチェビシェフ切断波数(lm)と鉛直格子点数(km)を
等しくしておく必要がある.
</p>
<p>
速度トロイダルポテンシャルΨに対して与えられる境界条件は
</p>
<pre>
  * 粘着条件 : Ψ = Ψb(lon,lat). Ψb は境界球面での速度分布.
                                  default は 0 (静止状態).

  * 応力なし条件 : ∂(Ψ/r)/∂r = 0.
</pre>
<p>
最初に呼ばれるときはオプショナル引数 new に関係なく行列が設定される.
</p>
<p>
Original external subprogram is <a
href="wu_module.html#M000439">wu_module#wu_TorBoundaryGrid</a>
</p>


        </div>
      </div>


      <div id="method-M001852" class="method-detail">
        <a name="M001852"></a>

        <div class="method-heading">




          <span class="method-name">wu_TorBoundaryTau</span><span class="method-args">( wu_TORPOT, [value], [cond], [new] ) </span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Subroutine </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt>wu_TORPOT  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm),intent(inout)</tt>

<table>
<tr><td valign="top"> :</td><td> (inout) 境界条件を適用するデータ. 修正された値を返す.

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>value  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1)), intent(in), optional</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 両端境界でのトロイダルポテンシャル

<pre>
    粘着条件の時のみ有効
</pre>
</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>cond  </tt></b>  <tt> </tt> :</td><td><tt>character(len=1), intent(in), optional</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 境界条件スイッチ. 省略時は &#8216;R&#8216;

<pre>
    R    : 上側粘着条件
    F    : 上側応力なし条件
</pre>
</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>new  </tt></b>  <tt> </tt> :</td><td><tt>logical, intent(IN), optional</tt>

<table>
<tr><td valign="top"> :</td><td> (in) true だと境界条件計算用行列を強制的に新たに作る.

<pre>
    default は false.
</pre>
</td></tr>
</table>
</td></tr>
</table>
<p>
速度トロイダルポテンシャルに対して境界条件を適用する. Chebyshev
空間での境界条件適用.
</p>
<p>
速度トロイダルポテンシャルΨに対して与えられる境界条件は
</p>
<pre>
  * 粘着条件 : Ψ = Ψb(lon,lat). Ψb は境界球面での速度分布.
                                  default は 0(静止状態).

  * 応力なし条件 : ∂(Ψ/r)/∂r = 0.
</pre>
<p>
最初に呼ばれるときはオプショナル引数 new に関係なく行列が設定される.
</p>
<p>
Original external subprogram is <a
href="wu_module.html#M000438">wu_module#wu_TorBoundaryTau</a>
</p>


        </div>
      </div>


      <div id="method-M001862" class="method-detail">
        <a name="M001862"></a>

        <div class="method-heading">




          <span class="method-name">wu_TorMagBoundary</span><span class="method-args">( wu_TOR, [new] ) </span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Subroutine </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt>wu_TOR  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm),intent(inout)</tt>

<table>
<tr><td valign="top"> :</td><td> (inout) 境界条件を適用するデータ. 修正された値を返す.

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>new  </tt></b>  <tt> </tt> :</td><td><tt>logical, intent(IN), optional</tt>

<table>
<tr><td valign="top"> :</td><td> (in) true だと境界条件計算用行列を強制的に新たに作る.

<pre>
    default は false.
</pre>
</td></tr>
</table>
</td></tr>
</table>
<p>
Original external subprogram is <a
href="wu_module.html#M000448">wu_module#wu_TorMagBoundary</a>
</p>


        </div>
      </div>


      <div id="method-M001857" class="method-detail">
        <a name="M001857"></a>

        <div class="method-heading">




          <span class="method-name">wu_TormagBoundaryGrid</span><span class="method-args">( wu_TOR, [new] ) </span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Subroutine </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt>wu_TOR  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm),intent(inout)</tt>

<table>
<tr><td valign="top"> :</td><td> (inout) 境界条件を適用するデータ. 修正された値を返す.

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>new  </tt></b>  <tt> </tt> :</td><td><tt>logical, intent(IN), optional</tt>

<table>
<tr><td valign="top"> :</td><td> (in) true だと境界条件計算用行列を強制的に新たに作る.

<pre>
    default は false.
</pre>
</td></tr>
</table>
</td></tr>
</table>
<p>
磁場トロイダルポテンシャルに対して境界条件を適用する.
鉛直実空間での境界条件適用.
</p>
<p>
鉛直実格子点空間において内部領域の値と境界条件を満たすように
条件を課している(選点法). このルーチンを用いるためには wu_Initial
にて設定するチェビシェフ切断波数(lm)と鉛直格子点数(km)を
等しくしておく必要がある.
</p>
<p>
現在のところ境界物質が非電気伝導体の場合のみ対応している. その場合,
磁場トロイダルポテンシャルの境界条件は
</p>
<p>
外側
</p>
<pre>
   wu_psi = 0   at the outer boundary
</pre>
<p>
であるので <a href="wtu_module.html#M001860">wu_Boundary</a>
で対応可能だが, 将来のため別途作成しておく
</p>
<p>
最初に呼ばれるときはオプショナル引数 new に関係なく行列が設定される.
</p>
<p>
Original external subprogram is <a
href="wu_module.html#M000443">wu_module#wu_TormagBoundaryGrid</a>
</p>


        </div>
      </div>


      <div id="method-M001856" class="method-detail">
        <a name="M001856"></a>

        <div class="method-heading">




          <span class="method-name">wu_TormagBoundaryTau</span><span class="method-args">( wu_TOR, [new] ) </span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Subroutine </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt>wu_TOR  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm),intent(inout)</tt>

<table>
<tr><td valign="top"> :</td><td> (inout) 境界条件を適用するデータ. 修正された値を返す.

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>new  </tt></b>  <tt> </tt> :</td><td><tt>logical, intent(IN), optional</tt>

<table>
<tr><td valign="top"> :</td><td> (in) true だと境界条件計算用行列を強制的に新たに作る.

<pre>
    default は false.
</pre>
</td></tr>
</table>
</td></tr>
</table>
<p>
Original external subprogram is <a
href="wu_module.html#M000442">wu_module#wu_TormagBoundaryTau</a>
</p>


        </div>
      </div>


      <div id="method-M001792" class="method-detail">
        <a name="M001792"></a>

        <div class="method-heading">




          <span class="method-name">wu_VMiss</span><span class="method-args"></span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em>Variable</em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001792">wu_VMiss</a>  </tt></b>  <tt> = -999.0        </tt> :</td><td><tt>real(8)</tt>

<table>
<tr><td valign="top"> :</td><td> 欠損値

</td></tr>
</table>
</td></tr>
</table>
<p>
Original external subprogram is <a
href="wu_module.html#M000377">wu_module#wu_VMiss</a>
</p>


        </div>
      </div>


      <div id="method-M001794" class="method-detail">
        <a name="M001794"></a>

        <div class="method-heading">




          <span class="method-name">wu_xyr</span><span class="method-args">( xyr ) result(wu_xyr)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001794">wu_xyr</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 2 次元球面調和函数チェビシェフスペクトルデータ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xyr  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 3 次元経度緯度動径格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
3 次元格子点データからスペクトルデータへ(正)変換する.
</p>
<p>
Original external subprogram is <a
href="wu_module.html#M000380">wu_module#wu_xyr</a>
</p>


        </div>
      </div>


      <div id="method-M001776" class="method-detail">
        <a name="M001776"></a>

        <div class="method-heading">




          <span class="method-name">wz_LaplaPol2Pol_wz</span><span class="method-args">( wz, [cond], [new] ) result(wz_LaplaPol2Pol_wz)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001776">wz_LaplaPol2Pol_wz</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:km)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 出力ポロイダルポテンシャル分布

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>wz  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:km),intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 入力▽^2φ分布

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>cond  </tt></b>  <tt> </tt> :</td><td><tt>character(len=2), intent(in), optional</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 境界条件スイッチ. 省略時は &#8216;RR&#8216;

<pre>
    RR    : 両端粘着条件
    RF    : 上端粘着, 下端応力なし条件
    FR    : 上端応力なし, 下端粘着条件
    FF    : 両端応力なし条件
</pre>
</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>new  </tt></b>  <tt> </tt> :</td><td><tt>logical, intent(IN), optional</tt>

<table>
<tr><td valign="top"> :</td><td> (in) true だと境界条件計算用行列を強制的に新たに作る.

<pre>
    default は false.
</pre>
</td></tr>
</table>
</td></tr>
</table>
<p>
速度ポロイダルポテンシャルΦを▽^2Φから計算する.
</p>
<p>
チェビシェフ格子点空間で境界条件を適用している. この関数を用いるためには
wt_Initial にて設定する チェビシェフ切断波数(lm)と鉛直格子点数(km)を等しく
しておく必要がある.
</p>
<p>
速度ポロイダルポテンシャルΦを f = ▽^2Φから定める式は
</p>
<pre>
  ▽^2Φ = f
    Φ = const. at boundaries.
    ∂Φ/∂r = 0 at boundaries           (粘着条件)
    or ∂^2Φ/∂r^2 = 0 at boundaries    (応力なし条件)
</pre>
<p>
最初に呼ばれるときはオプショナル引数 new に関係なく行列が設定される.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001463">wt_module#wz_LaplaPol2Pol_wz</a>
</p>


        </div>
      </div>


      <div id="method-M001694" class="method-detail">
        <a name="M001694"></a>

        <div class="method-heading">




          <span class="method-name">wz_RAD</span><span class="method-args"></span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em>Variable</em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001694">wz_RAD</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(:,:), allocatable</tt>

<table>
<tr><td valign="top"> :</td><td> 座標

</td></tr>
</table>
</td></tr>
</table>
<p>
Original external subprogram is <a
href="wt_module.html#M001394">wt_module#wz_RAD</a>
</p>


        </div>
      </div>


      <div id="method-M001706" class="method-detail">
        <a name="M001706"></a>

        <div class="method-heading">




          <span class="method-name">wz_wt</span><span class="method-args">( wt ) result(wz_wt)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001706">wz_wt</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:km)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 2 次元球面調和函数スペクトル・動径格子点データ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>wt  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 2 次元球面調和函数チェビシェフスペクトルデータ

</td></tr>
</table>
</td></tr>
</table>
<p>
スペクトルデータから水平スペクトル・動径格子点データへ(正)変換する.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001401">wt_module#wz_wt</a>
</p>


        </div>
      </div>


      <div id="method-M001705" class="method-detail">
        <a name="M001705"></a>

        <div class="method-heading">




          <span class="method-name">wz_xyz</span><span class="method-args">( xyz ) result(wz_xyz)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001705">wz_xyz</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:km)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 2 次元球面調和函数スペクトル・動径格子点データ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xyz  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 3 次元経度緯度動径格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
3 次元格子データから水平スペクトル・動径格子点データへ(正)変換する.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001400">wt_module#wz_xyz</a>
</p>


        </div>
      </div>


      <div id="method-M001826" class="method-detail">
        <a name="M001826"></a>

        <div class="method-heading">




          <span class="method-name">x_AvrLatRad_xyr</span><span class="method-args">( xyr ) result(x_AvrLatRad_xyr)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001826">x_AvrLatRad_xyr</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 緯度動径(子午面)平均された 1 次元経度格子点データ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xyr  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 3 次元経度緯度動径格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
緯度動径(子午面)積分
</p>
<p>
3 次元格子点データの緯度動径(子午面)平均
</p>
<p>
3 次元データ f(λ,φ,r) に対して
</p>
<pre>
   ∫f(λ,,r) r^2cosφ dφdr /(2(r[o]^3-r[i]^3)/3)
</pre>
<p>
を計算する.
</p>
<p>
Original external subprogram is <a
href="wu_module.html#M000412">wu_module#x_AvrLatRad_xyr</a>
</p>


        </div>
      </div>


      <div id="method-M001743" class="method-detail">
        <a name="M001743"></a>

        <div class="method-heading">




          <span class="method-name">x_AvrLatRad_xyz</span><span class="method-args">( xyz ) result(x_AvrLatRad_xyz)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001743">x_AvrLatRad_xyz</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 緯度動径(子午面)平均された 1 次元経度格子点データ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xyz  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 3 次元経度緯度動径格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
緯度動径(子午面)積分
</p>
<p>
3 次元格子点データの緯度動径(子午面)平均
</p>
<p>
3 次元データ f(λ,φ,r) に対して
</p>
<pre>
   ∫f(λ,,r) r^2cosφ dφdr /(2(r[o]^3-r[i]^3)/3)
</pre>
<p>
を計算する.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001433">wt_module#x_AvrLatRad_xyz</a>
</p>


        </div>
      </div>


      <div id="method-M001747" class="method-detail">
        <a name="M001747"></a>

        <div class="method-heading">




          <span class="method-name">x_AvrLat_xy</span><span class="method-args">( xy_data ) result(x_AvrLat_xy)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001747">x_AvrLat_xy</a>(im)  </tt></b>  <tt> </tt> :</td><td><tt>real(8)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 平均された 1 次元経度(X)格子点データ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xy_data(0:im-1,1:jm)  </tt></b>  <tt> </tt> :</td><td><tt>real(8), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 2 次元経度緯度格子点データ(0:im-1,1:jm)

</td></tr>
</table>
</td></tr>
</table>
<p>
2 次元緯度経度格子点データの緯度(Y)方向平均(1 層用).
</p>
<p>
実際には格子点データ各点毎に y_Y_Weight をかけた総和を計算し, y_Y_Weight
の総和で割ることで平均している.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001498">wt_module#x_AvrLat_xy</a>
</p>


        </div>
      </div>


      <div id="method-M001834" class="method-detail">
        <a name="M001834"></a>

        <div class="method-heading">




          <span class="method-name">x_AvrRad_xr</span><span class="method-args">( xr ) result(x_AvrRad_xr)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001834">x_AvrRad_xr</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 動径平均された 1 次元経度格子点データ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xr  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 2 次元緯度動径格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
動径積分
</p>
<p>
2 次元(XR)格子点データの動径方向域平均.
</p>
<p>
2 次元データ f(λ,r) に対して
</p>
<pre>
  ∫f(λ,r) r^2dr /((r[o]^3-r[i]^3)/3)
</pre>
<p>
を計算する.
</p>
<p>
Original external subprogram is <a
href="wu_module.html#M000420">wu_module#x_AvrRad_xr</a>
</p>


        </div>
      </div>


      <div id="method-M001754" class="method-detail">
        <a name="M001754"></a>

        <div class="method-heading">




          <span class="method-name">x_AvrRad_xz</span><span class="method-args">( xz ) result(x_AvrRad_xz)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001754">x_AvrRad_xz</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 動径平均された 1 次元経度格子点データ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xz  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 2 次元緯度動径格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
動径積分
</p>
<p>
2 次元(XZ)格子点データの動径方向域平均.
</p>
<p>
2 次元データ f(λ,r) に対して
</p>
<pre>
  ∫f(λ,r) r^2dr /((r[o]^3-r[i]^3)/3)
</pre>
<p>
を計算する.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001441">wt_module#x_AvrRad_xz</a>
</p>


        </div>
      </div>


      <div id="method-M001812" class="method-detail">
        <a name="M001812"></a>

        <div class="method-heading">




          <span class="method-name">x_IntLatRad_xyr</span><span class="method-args">( xyr ) result(x_IntLatRad_xyr)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001812">x_IntLatRad_xyr</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 緯度動径(子午面)積分された 1 次元経度格子点データ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xyr  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 3 次元経度緯度動径格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
3 次元格子点データの緯度動径(子午面)積分
</p>
<p>
3 次元データ f(λ,φ,r) に対して
</p>
<pre>
   ∫f(λ,φ,r) r^2cosφ dφdr
</pre>
<p>
を計算する.
</p>
<p>
Original external subprogram is <a
href="wu_module.html#M000398">wu_module#x_IntLatRad_xyr</a>
</p>


        </div>
      </div>


      <div id="method-M001724" class="method-detail">
        <a name="M001724"></a>

        <div class="method-heading">




          <span class="method-name">x_IntLatRad_xyz</span><span class="method-args">( xyz ) result(x_IntLatRad_xyz)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001724">x_IntLatRad_xyz</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 緯度動径(子午面)積分された 1 次元経度格子点データ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xyz  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 3 次元経度緯度動径格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
3 次元格子点データの緯度動径(子午面)積分
</p>
<p>
3 次元データ f(λ,φ,r) に対して
</p>
<pre>
   ∫f(λ,φ,r) r^2cosφ dφdr
</pre>
<p>
を計算する.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001419">wt_module#x_IntLatRad_xyz</a>
</p>


        </div>
      </div>


      <div id="method-M001728" class="method-detail">
        <a name="M001728"></a>

        <div class="method-heading">




          <span class="method-name">x_IntLat_xy</span><span class="method-args">( xy_data ) result(x_IntLat_xy)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001728">x_IntLat_xy</a>(0:im-1)  </tt></b>  <tt> </tt> :</td><td><tt>real(8)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 積分された 1 次元経度(X)格子点データ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xy_data(0:im-1,1:jm)  </tt></b>  <tt> </tt> :</td><td><tt>real(8), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 2 次元経度緯度格子点データ(0:im-1,1:jm)

</td></tr>
</table>
</td></tr>
</table>
<p>
2 次元緯度経度格子点データの緯度(Y)方向積分(1 層用).
</p>
<p>
実際には格子点データ各点毎に y_Y_Weight をかけた総和を計算している.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001493">wt_module#x_IntLat_xy</a>
</p>


        </div>
      </div>


      <div id="method-M001820" class="method-detail">
        <a name="M001820"></a>

        <div class="method-heading">




          <span class="method-name">x_IntRad_xr</span><span class="method-args">( xr ) result(x_IntRad_xr)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001820">x_IntRad_xr</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 動径積分された 1 次元経度格子点データ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xr  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 2 次元緯度動径格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
2 次元(XR)格子点データの動径方向域積分.
</p>
<p>
2 次元データ f(λ,r) に対して ∫f(λ,r) r^2dr を計算する.
</p>
<p>
Original external subprogram is <a
href="wu_module.html#M000406">wu_module#x_IntRad_xr</a>
</p>


        </div>
      </div>


      <div id="method-M001735" class="method-detail">
        <a name="M001735"></a>

        <div class="method-heading">




          <span class="method-name">x_IntRad_xz</span><span class="method-args">( xz ) result(x_IntRad_xz)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001735">x_IntRad_xz</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 動径積分された 1 次元経度格子点データ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xz  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 2 次元緯度動径格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
2 次元(XZ)格子点データの動径方向域積分.
</p>
<p>
2 次元データ f(λ,r) に対して ∫f(λ,r) r^2dr を計算する.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001427">wt_module#x_IntRad_xz</a>
</p>


        </div>
      </div>


      <div id="method-M001677" class="method-detail">
        <a name="M001677"></a>

        <div class="method-heading">




          <span class="method-name">x_Lon</span><span class="method-args"></span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em>Variable</em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001677">x_Lon</a>(:)  </tt></b>  <tt> </tt> :</td><td><tt>real(8), allocatable</tt>

<table>
<tr><td valign="top"> :</td><td> 緯度経度

</td></tr>
</table>
</td></tr>
</table>
<p>
Original external subprogram is <a
href="wt_module.html#M001473">wt_module#x_Lon</a>
</p>


        </div>
      </div>


      <div id="method-M001678" class="method-detail">
        <a name="M001678"></a>

        <div class="method-heading">




          <span class="method-name">x_Lon_Weight</span><span class="method-args"></span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em>Variable</em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001678">x_Lon_Weight</a>(:)  </tt></b>  <tt> </tt> :</td><td><tt>real(8), allocatable</tt>

<table>
<tr><td valign="top"> :</td><td> 座標重み

</td></tr>
</table>
</td></tr>
</table>
<p>
Original external subprogram is <a
href="wt_module.html#M001474">wt_module#x_Lon_Weight</a>
</p>


        </div>
      </div>


      <div id="method-M001824" class="method-detail">
        <a name="M001824"></a>

        <div class="method-heading">




          <span class="method-name">xr_AvrLat_xyr</span><span class="method-args">( xyr ) result(xr_AvrLat_xyr)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001824">xr_AvrLat_xyr</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,0:km)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 緯度平均された 2 次元緯度動径格子点データ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xyr  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 3 次元経度緯度動径格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
緯度積分
</p>
<p>
3 次元格子点データの緯度方向域平均.
</p>
<p>
3 次元データ f(λ,φ,r) に対して ∫f(λ,φ,r)cosφ dφ/2 を計算する.
</p>
<p>
Original external subprogram is <a
href="wu_module.html#M000410">wu_module#xr_AvrLat_xyr</a>
</p>


        </div>
      </div>


      <div id="method-M001810" class="method-detail">
        <a name="M001810"></a>

        <div class="method-heading">




          <span class="method-name">xr_IntLat_xyr</span><span class="method-args">( xyr ) result(xr_IntLat_xyr)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001810">xr_IntLat_xyr</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,0:km)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 緯度積分された 2 次元緯度動径格子点データ 緯度円格子点データ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xyr  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 3 次元経度緯度動径格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
3 次元格子点データの緯度方向域積分.
</p>
<p>
3 次元データ f(λ,φ,r) に対して∫f(λ,φ,r) cosφ dφ を計算する.
</p>
<p>
Original external subprogram is <a
href="wu_module.html#M000396">wu_module#xr_IntLat_xyr</a>
</p>


        </div>
      </div>


      <div id="method-M001825" class="method-detail">
        <a name="M001825"></a>

        <div class="method-heading">




          <span class="method-name">xy_AvrRad_xyr</span><span class="method-args">( xyr ) result(xy_AvrRad_xyr)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001825">xy_AvrRad_xyr</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm)</tt>

<table>
<tr><td valign="top"> :</td><td> 水平格子点データ (out) 動径平均された 2 次元経度緯度(水平,
球面)格子点データ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xyr  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 3 次元経度緯度動径格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
3 次元格子点データの動径方向域平均.
</p>
<p>
3 次元データ f(λ,φ,r) に対して
</p>
<pre>
   ∫f(λ,φ,r) r^2dr/((r[o]^3-r[i]^3)/3)
</pre>
<p>
を計算する.
</p>
<p>
Original external subprogram is <a
href="wu_module.html#M000411">wu_module#xy_AvrRad_xyr</a>
</p>


        </div>
      </div>


      <div id="method-M001742" class="method-detail">
        <a name="M001742"></a>

        <div class="method-heading">




          <span class="method-name">xy_AvrRad_xyz</span><span class="method-args">( xyz ) result(xy_AvrRad_xyz)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001742">xy_AvrRad_xyz</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 動径平均された 2 次元経度緯度(水平, 球面)格子点データ
水平格子点データ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xyz  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 3 次元経度緯度動径格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
3 次元格子点データの動径方向域平均.
</p>
<p>
3 次元データ f(λ,φ,r) に対して
</p>
<pre>
   ∫f(λ,φ,r) r^2dr/((r[o]^3-r[i]^3)/3)
</pre>
<p>
を計算する.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001432">wt_module#xy_AvrRad_xyz</a>
</p>


        </div>
      </div>


      <div id="method-M001811" class="method-detail">
        <a name="M001811"></a>

        <div class="method-heading">




          <span class="method-name">xy_IntRad_xyr</span><span class="method-args">( xyr ) result(xy_IntRad_xyr)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001811">xy_IntRad_xyr</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 動径積分された 2 次元経度緯度(水平, 球面)格子点データ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xyr  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 3 次元経度緯度動径格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
動径積分
</p>
<p>
3 次元格子点データの動径方向域積分.
</p>
<p>
3 次元データ f(λ,φ,r) に対して∫f(λ,φ,r) r^2dr を計算する.
</p>
<p>
Original external subprogram is <a
href="wu_module.html#M000397">wu_module#xy_IntRad_xyr</a>
</p>


        </div>
      </div>


      <div id="method-M001723" class="method-detail">
        <a name="M001723"></a>

        <div class="method-heading">




          <span class="method-name">xy_IntRad_xyz</span><span class="method-args">( xyz ) result(xy_IntRad_xyz)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001723">xy_IntRad_xyz</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 動径積分された 2 次元経度緯度(水平, 球面)格子点データ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xyz  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 3 次元経度緯度動径格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
動径積分
</p>
<p>
3 次元格子点データの動径方向域積分.
</p>
<p>
3 次元データ f(λ,φ,r) に対して∫f(λ,φ,r) r^2dr を計算する.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001418">wt_module#xy_IntRad_xyz</a>
</p>


        </div>
      </div>


      <div id="method-M001690" class="method-detail">
        <a name="M001690"></a>

        <div class="method-heading">




          <span class="method-name">xy_Lat</span><span class="method-args"></span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em>Variable</em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001690">xy_Lat</a>(:,:)  </tt></b>  <tt> </tt> :</td><td><tt>real(8), allocatable</tt>

</td></tr>
</table>
<p>
Original external subprogram is <a
href="wt_module.html#M001486">wt_module#xy_Lat</a>
</p>


        </div>
      </div>


      <div id="method-M001689" class="method-detail">
        <a name="M001689"></a>

        <div class="method-heading">




          <span class="method-name">xy_Lon</span><span class="method-args"></span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em>Variable</em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001689">xy_Lon</a>(:,:)  </tt></b>  <tt> </tt> :</td><td><tt>real(8), allocatable</tt>

</td></tr>
</table>
<p>
Original external subprogram is <a
href="wt_module.html#M001485">wt_module#xy_Lon</a>
</p>


        </div>
      </div>


      <div id="method-M001697" class="method-detail">
        <a name="M001697"></a>

        <div class="method-heading">




          <span class="method-name">xy_w</span><span class="method-args">( w_data, [ipow], [iflag] ) result(xy_w)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001697">xy_w</a>(0:im-1,1:jm)  </tt></b>  <tt> </tt> :</td><td><tt>real(8)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 格子点データ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>w_data((nm+1)*(nm+1))  </tt></b>  <tt> </tt> :</td><td><tt>real(8), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) スペクトルデータ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>ipow  </tt></b>  <tt> </tt> :</td><td><tt>integer, intent(in), optional</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 作用させる 1/cosφ の次数. 省略時は 0.

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>iflag  </tt></b>  <tt> </tt> :</td><td><tt>integer, intent(in), optional</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 変換の種類

<pre>
   0 : 通常の正変換
  -1 : 経度微分を作用させた逆変換
   1 : 緯度微分 cosφ・∂/∂φ を作用させた逆変換
   2 : sinφを作用させた逆変換
   省略時は 0.
</pre>
</td></tr>
</table>
</td></tr>
</table>
<p>
スペクトルデータから格子データへ変換する(1 層用).
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001488">wt_module#xy_w</a>
</p>


        </div>
      </div>


      <div id="method-M001805" class="method-detail">
        <a name="M001805"></a>

        <div class="method-heading">




          <span class="method-name">xyr_Div_xyr_xyr_xyr</span><span class="method-args">( xyr_Vlon, xyr_Vlat, xyr_Vrad ) result(xyr_Div_xyr_xyr_xyr)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001805">xyr_Div_xyr_xyr_xyr</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) ベクトル場の発散

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xyr_Vlon  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) ベクトル場の経度成分

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xyr_Vlat  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) ベクトル場の緯度成分

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xyr_Vrad  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) ベクトル場の動径成分

</td></tr>
</table>
</td></tr>
</table>
<p>
ベクトル成分である 3 つの格子データに発散を作用させる.
</p>
<p>
第 1, 2 ,3 引数(u,v,w)がそれぞれベクトルの経度成分, 緯度成分,
動径成分を表す.
</p>
<p>
極の特異性を回避するためにベクトル場に cosφ/r の重みをかけて 計算している.
</p>
<pre>
     div V = (r/cosφ)・div (Vcosφ/r) + V_φtanφ/r + V_r/r
</pre>
<p>
Original external subprogram is <a
href="wu_module.html#M000391">wu_module#xyr_Div_xyr_xyr_xyr</a>
</p>


        </div>
      </div>


      <div id="method-M001801" class="method-detail">
        <a name="M001801"></a>

        <div class="method-heading">




          <span class="method-name">xyr_GradLat_wu</span><span class="method-args">( wu ) result(xyr_GradLat_wu)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001801">xyr_GradLat_wu</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 勾配型緯度微分を作用された 2 次元スペクトルデータ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>wu  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 2 次元球面調和函数チェビシェフスペクトルデータ

</td></tr>
</table>
</td></tr>
</table>
<p>
スペクトルデータに勾配型経度微分 1/r ∂/∂φ を作用させる.
</p>
<p>
Original external subprogram is <a
href="wu_module.html#M000387">wu_module#xyr_GradLat_wu</a>
</p>


        </div>
      </div>


      <div id="method-M001800" class="method-detail">
        <a name="M001800"></a>

        <div class="method-heading">




          <span class="method-name">xyr_GradLon_wu</span><span class="method-args">( wu ) result(xyr_GradLon_wu)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001800">xyr_GradLon_wu</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 勾配型経度微分を作用された 2 次元スペクトルデータ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>wu  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 2 次元球面調和函数チェビシェフスペクトルデータ

</td></tr>
</table>
</td></tr>
</table>
<p>
スペクトルデータに勾配型経度微分 1/rcosφ・∂/∂λ を作用させる.
</p>
<p>
Original external subprogram is <a
href="wu_module.html#M000386">wu_module#xyr_GradLon_wu</a>
</p>


        </div>
      </div>


      <div id="method-M001838" class="method-detail">
        <a name="M001838"></a>

        <div class="method-heading">




          <span class="method-name">xyr_KGrad_wu</span><span class="method-args">( wu ) result(xyr_KGrad_wu)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001838">xyr_KGrad_wu</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 軸方向微分を作用された 2 次元スペクトルデータ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>wu  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 2 次元球面調和函数チェビシェフスペクトルデータ

</td></tr>
</table>
</td></tr>
</table>
<p>
k・▽ = cosφ/r ∂/∂φ + sinφ∂/∂r
</p>
<p>
入力スペクトルデータに対応する格子データに軸方向微分
</p>
<pre>
   k・▽ = cosφ/r ∂/∂φ + sinφ∂/∂r
</pre>
<p>
を作用させた格子データが返される. ここでベクトル k
は球の中心から北極向きの単位ベクトルである.
</p>
<p>
Original external subprogram is <a
href="wu_module.html#M000424">wu_module#xyr_KGrad_wu</a>
</p>


        </div>
      </div>


      <div id="method-M001789" class="method-detail">
        <a name="M001789"></a>

        <div class="method-heading">




          <span class="method-name">xyr_LAT</span><span class="method-args"></span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em>Variable</em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001789">xyr_LAT</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(:,:,:), allocatable</tt>

<table>
<tr><td valign="top"> :</td><td> 座標

</td></tr>
</table>
</td></tr>
</table>
<p>
Original external subprogram is <a
href="wu_module.html#M000374">wu_module#xyr_LAT</a>
</p>


        </div>
      </div>


      <div id="method-M001788" class="method-detail">
        <a name="M001788"></a>

        <div class="method-heading">




          <span class="method-name">xyr_LON</span><span class="method-args"></span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em>Variable</em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001788">xyr_LON</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(:,:,:), allocatable</tt>

<table>
<tr><td valign="top"> :</td><td> 座標

</td></tr>
</table>
</td></tr>
</table>
<p>
Original external subprogram is <a
href="wu_module.html#M000373">wu_module#xyr_LON</a>
</p>


        </div>
      </div>


      <div id="method-M001790" class="method-detail">
        <a name="M001790"></a>

        <div class="method-heading">




          <span class="method-name">xyr_RAD</span><span class="method-args"></span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em>Variable</em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001790">xyr_RAD</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(:,:,:), allocatable</tt>

<table>
<tr><td valign="top"> :</td><td> 座標

</td></tr>
</table>
</td></tr>
</table>
<p>
Original external subprogram is <a
href="wu_module.html#M000375">wu_module#xyr_RAD</a>
</p>


        </div>
      </div>


      <div id="method-M001807" class="method-detail">
        <a name="M001807"></a>

        <div class="method-heading">




          <span class="method-name">xyr_RotLat_wu_wu</span><span class="method-args">( wu_Vlon, wu_Vrad ) result(xyr_RotLat_wu_wu)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001807">xyr_RotLat_wu_wu</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) ベクトル場の回転の緯度成分

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>wu_Vlon  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) ベクトル場の経度成分

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>wu_Vrad  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) ベクトル場の動径成分

</td></tr>
</table>
</td></tr>
</table>
<p>
ベクトル場の経度成分, 動径成分である第 1, 2 引数 Vlon, Vrad から
回転の緯度成分
</p>
<pre>
   1/r ∂(r Vlon)/∂r - 1/rcosφ・∂Vrad/∂λ
</pre>
<p>
を計算する.
</p>
<p>
Original external subprogram is <a
href="wu_module.html#M000393">wu_module#xyr_RotLat_wu_wu</a>
</p>


        </div>
      </div>


      <div id="method-M001806" class="method-detail">
        <a name="M001806"></a>

        <div class="method-heading">




          <span class="method-name">xyr_RotLon_wu_wu</span><span class="method-args">( wu_Vrad, wu_Vlat ) result(xyr_RotLon_wu_wu)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001806">xyr_RotLon_wu_wu</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) ベクトル場の回転の経度成分

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>wu_Vrad  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) ベクトル場の動径成分

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>wu_Vlat  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) ベクトル場の緯度成分

</td></tr>
</table>
</td></tr>
</table>
<p>
ベクトル場の動径成分, 緯度成分である第 1, 2 引数 Vrad, Vlat から
回転の経度成分
</p>
<pre>
   1/r ∂Vrad/∂φ-1/r ∂(r Vlat)/∂r を計算する.
</pre>
<p>
を計算する
</p>
<p>
Original external subprogram is <a
href="wu_module.html#M000392">wu_module#xyr_RotLon_wu_wu</a>
</p>


        </div>
      </div>


      <div id="method-M001795" class="method-detail">
        <a name="M001795"></a>

        <div class="method-heading">




          <span class="method-name">xyr_wr</span><span class="method-args">( wr ) result(xyr_wr)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001795">xyr_wr</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 3 次元経度緯度動径格子点データ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>wr  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 2 次元球面調和函数スペクトル・動径格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
水平スペクトル・動径格子点データから 3 次元格子点データへ(逆)変換する.
</p>
<p>
Original external subprogram is <a
href="wu_module.html#M000381">wu_module#xyr_wr</a>
</p>


        </div>
      </div>


      <div id="method-M001793" class="method-detail">
        <a name="M001793"></a>

        <div class="method-heading">




          <span class="method-name">xyr_wu</span><span class="method-args">( wu ) result(xyr_wu)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001793">xyr_wu</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 3 次元経度緯度動径格子点データ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>wu  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 2 次元球面調和函数チェビシェフスペクトルデータ

</td></tr>
</table>
</td></tr>
</table>
<p>
スペクトルデータから 3 次元格子点データへ(逆)変換する.
</p>
<p>
Original external subprogram is <a
href="wu_module.html#M000379">wu_module#xyr_wu</a>
</p>


        </div>
      </div>


      <div id="method-M001717" class="method-detail">
        <a name="M001717"></a>

        <div class="method-heading">




          <span class="method-name">xyz_Div_xyz_xyz_xyz</span><span class="method-args">( xyz_Vlon, xyz_Vlat, xyz_Vrad ) result(xyz_Div_xyz_xyz_xyz)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001717">xyz_Div_xyz_xyz_xyz</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) ベクトル場の発散

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xyz_Vlon  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) ベクトル場の経度成分

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xyz_Vlat  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) ベクトル場の緯度成分

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xyz_Vrad  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) ベクトル場の動径成分

</td></tr>
</table>
</td></tr>
</table>
<p>
ベクトル成分である 3 つの格子データに発散を作用させる.
</p>
<p>
第 1, 2 ,3 引数(u,v,w)がそれぞれベクトルの経度成分, 緯度成分,
動径成分を表す.
</p>
<p>
極の特異性を回避するためにベクトル場に cosφ/r の重みをかけて 計算している.
</p>
<pre>
     div V = (r/cosφ)・div (Vcosφ/r) + V_φtanφ/r + V_r/r
</pre>
<p>
Original external subprogram is <a
href="wt_module.html#M001412">wt_module#xyz_Div_xyz_xyz_xyz</a>
</p>


        </div>
      </div>


      <div id="method-M001713" class="method-detail">
        <a name="M001713"></a>

        <div class="method-heading">




          <span class="method-name">xyz_GradLat_wt</span><span class="method-args">( wt ) result(xyz_GradLat_wt)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001713">xyz_GradLat_wt</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 勾配型緯度微分を作用された 2 次元スペクトルデータ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>wt  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 2 次元球面調和函数チェビシェフスペクトルデータ

</td></tr>
</table>
</td></tr>
</table>
<p>
スペクトルデータに勾配型経度微分 1/r ∂/∂φ を作用させる.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001408">wt_module#xyz_GradLat_wt</a>
</p>


        </div>
      </div>


      <div id="method-M001712" class="method-detail">
        <a name="M001712"></a>

        <div class="method-heading">




          <span class="method-name">xyz_GradLon_wt</span><span class="method-args">( wt ) result(xyz_GradLon_wt)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001712">xyz_GradLon_wt</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 勾配型経度微分を作用された 2 次元スペクトルデータ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>wt  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 2 次元球面調和函数チェビシェフスペクトルデータ

</td></tr>
</table>
</td></tr>
</table>
<p>
スペクトルデータに勾配型経度微分 1/rcosφ・∂/∂λ を作用させる.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001407">wt_module#xyz_GradLon_wt</a>
</p>


        </div>
      </div>


      <div id="method-M001760" class="method-detail">
        <a name="M001760"></a>

        <div class="method-heading">




          <span class="method-name">xyz_KGrad_wt</span><span class="method-args">( wt ) result(xyz_KGrad_wt)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001760">xyz_KGrad_wt</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 軸方向微分を作用された 2 次元スペクトルデータ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>wt  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 2 次元球面調和函数チェビシェフスペクトルデータ

</td></tr>
</table>
</td></tr>
</table>
<p>
k・▽ = cosφ/r ∂/∂φ + sinφ∂/∂r
</p>
<p>
入力スペクトルデータに対応する格子データに軸方向微分
</p>
<pre>
   k・▽ = cosφ/r ∂/∂φ + sinφ∂/∂r
</pre>
<p>
を作用させた格子データが返される. ここでベクトル k
は球の中心から北極向きの単位ベクトルである.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001445">wt_module#xyz_KGrad_wt</a>
</p>


        </div>
      </div>


      <div id="method-M001692" class="method-detail">
        <a name="M001692"></a>

        <div class="method-heading">




          <span class="method-name">xyz_LAT</span><span class="method-args"></span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em>Variable</em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001692">xyz_LAT</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(:,:,:), allocatable</tt>

<table>
<tr><td valign="top"> :</td><td> 座標

</td></tr>
</table>
</td></tr>
</table>
<p>
Original external subprogram is <a
href="wt_module.html#M001392">wt_module#xyz_LAT</a>
</p>


        </div>
      </div>


      <div id="method-M001691" class="method-detail">
        <a name="M001691"></a>

        <div class="method-heading">




          <span class="method-name">xyz_LON</span><span class="method-args"></span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em>Variable</em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001691">xyz_LON</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(:,:,:), allocatable</tt>

<table>
<tr><td valign="top"> :</td><td> 座標

</td></tr>
</table>
</td></tr>
</table>
<p>
Original external subprogram is <a
href="wt_module.html#M001391">wt_module#xyz_LON</a>
</p>


        </div>
      </div>


      <div id="method-M001693" class="method-detail">
        <a name="M001693"></a>

        <div class="method-heading">




          <span class="method-name">xyz_RAD</span><span class="method-args"></span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em>Variable</em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001693">xyz_RAD</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(:,:,:), allocatable</tt>

<table>
<tr><td valign="top"> :</td><td> 座標

</td></tr>
</table>
</td></tr>
</table>
<p>
Original external subprogram is <a
href="wt_module.html#M001393">wt_module#xyz_RAD</a>
</p>


        </div>
      </div>


      <div id="method-M001719" class="method-detail">
        <a name="M001719"></a>

        <div class="method-heading">




          <span class="method-name">xyz_RotLat_wt_wt</span><span class="method-args">( wt_Vlon, wt_Vrad ) result(xyz_RotLat_wt_wt)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001719">xyz_RotLat_wt_wt</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) ベクトル場の回転の緯度成分

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>wt_Vlon  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) ベクトル場の経度成分

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>wt_Vrad  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) ベクトル場の動径成分

</td></tr>
</table>
</td></tr>
</table>
<p>
ベクトル場の経度成分, 動径成分である第 1, 2 引数 Vlon, Vrad から
回転の緯度成分
</p>
<pre>
   1/r ∂(r Vlon)/∂r - 1/rcosφ・∂Vrad/∂λ
</pre>
<p>
を計算する.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001414">wt_module#xyz_RotLat_wt_wt</a>
</p>


        </div>
      </div>


      <div id="method-M001718" class="method-detail">
        <a name="M001718"></a>

        <div class="method-heading">




          <span class="method-name">xyz_RotLon_wt_wt</span><span class="method-args">( wt_Vrad, wt_Vlat ) result(xyz_RotLon_wt_wt)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001718">xyz_RotLon_wt_wt</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) ベクトル場の回転の経度成分

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>wt_Vrad  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) ベクトル場の動径成分

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>wt_Vlat  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) ベクトル場の緯度成分

</td></tr>
</table>
</td></tr>
</table>
<p>
ベクトル場の動径成分, 緯度成分である第 1, 2 引数 Vrad, Vlat から
回転の経度成分
</p>
<pre>
   1/r ∂Vrad/∂φ-1/r ∂(r Vlat)/∂r を計算する.
</pre>
<p>
を計算する
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001413">wt_module#xyz_RotLon_wt_wt</a>
</p>


        </div>
      </div>


      <div id="method-M001702" class="method-detail">
        <a name="M001702"></a>

        <div class="method-heading">




          <span class="method-name">xyz_wt</span><span class="method-args">( wt ) result(xyz_wt)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001702">xyz_wt</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 3 次元経度緯度動径格子点データ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>wt  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 2 次元球面調和函数チェビシェフスペクトルデータ

</td></tr>
</table>
</td></tr>
</table>
<p>
スペクトルデータから 3 次元格子点データへ(逆)変換する.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001397">wt_module#xyz_wt</a>
</p>


        </div>
      </div>


      <div id="method-M001704" class="method-detail">
        <a name="M001704"></a>

        <div class="method-heading">




          <span class="method-name">xyz_wz</span><span class="method-args">( wz ) result(xyz_wz)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001704">xyz_wz</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 3 次元経度緯度動径格子点データ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>wz  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 2 次元球面調和函数スペクトル・動径格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
水平スペクトル・動径格子点データから 3 次元格子点データへ(逆)変換する.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001399">wt_module#xyz_wz</a>
</p>


        </div>
      </div>


      <div id="method-M001741" class="method-detail">
        <a name="M001741"></a>

        <div class="method-heading">




          <span class="method-name">xz_AvrLat_xyz</span><span class="method-args">( xyz ) result(xz_AvrLat_xyz)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001741">xz_AvrLat_xyz</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,0:km)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 緯度平均された 2 次元緯度動径格子点データ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xyz  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 3 次元経度緯度動径格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
緯度積分
</p>
<p>
3 次元格子点データの緯度方向域平均.
</p>
<p>
3 次元データ f(λ,φ,r) に対して ∫f(λ,φ,r)cosφ dφ/2 を計算する.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001431">wt_module#xz_AvrLat_xyz</a>
</p>


        </div>
      </div>


      <div id="method-M001722" class="method-detail">
        <a name="M001722"></a>

        <div class="method-heading">




          <span class="method-name">xz_IntLat_xyz</span><span class="method-args">( xyz ) result(xz_IntLat_xyz)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001722">xz_IntLat_xyz</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,0:km)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 緯度積分された 2 次元緯度動径格子点データ. 緯度円格子点データ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xyz  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 3 次元経度緯度動径格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
3 次元格子点データの緯度方向域積分.
</p>
<p>
3 次元データ f(λ,φ,r) に対して∫f(λ,φ,r) cosφ dφ を計算する.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001417">wt_module#xz_IntLat_xyz</a>
</p>


        </div>
      </div>


      <div id="method-M001827" class="method-detail">
        <a name="M001827"></a>

        <div class="method-heading">




          <span class="method-name">y_AvrLonRad_xyr</span><span class="method-args">( xyr ) result(y_AvrLonRad_xyr)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001827">y_AvrLonRad_xyr</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(1:jm)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 経度動径(緯度円)平均された 1 次元緯度格子点データ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xyr  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 3 次元経度緯度動径格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
経度動径(緯度円)積分
</p>
<p>
3 次元格子点データの経度動径(緯度円)平均.
</p>
<p>
3 次元データ f(λ,φ,r) に対して
</p>
<pre>
    ∫f(λ,φ,r) r^2dλdr /(2π(r[o]^3-r[i]^3)/3)
</pre>
<p>
を計算する.
</p>
<p>
Original external subprogram is <a
href="wu_module.html#M000413">wu_module#y_AvrLonRad_xyr</a>
</p>


        </div>
      </div>


      <div id="method-M001744" class="method-detail">
        <a name="M001744"></a>

        <div class="method-heading">




          <span class="method-name">y_AvrLonRad_xyz</span><span class="method-args">( xyz ) result(y_AvrLonRad_xyz)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001744">y_AvrLonRad_xyz</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(1:jm)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 経度動径(緯度円)平均された 1 次元緯度格子点データ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xyz  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 3 次元経度緯度動径格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
経度動径(緯度円)積分
</p>
<p>
3 次元格子点データの経度動径(緯度円)平均.
</p>
<p>
3 次元データ f(λ,φ,r) に対して
</p>
<pre>
    ∫f(λ,φ,r) r^2dλdr /(2π(r[o]^3-r[i]^3)/3)
</pre>
<p>
を計算する.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001434">wt_module#y_AvrLonRad_xyz</a>
</p>


        </div>
      </div>


      <div id="method-M001748" class="method-detail">
        <a name="M001748"></a>

        <div class="method-heading">




          <span class="method-name">y_AvrLon_xy</span><span class="method-args">( xy_data ) result(y_AvrLon_xy)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001748">y_AvrLon_xy</a>(1:jm)  </tt></b>  <tt> </tt> :</td><td><tt>real(8)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 平均された 1 次元緯度(Y)格子点

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xy_data(0:im-1,1:jm)  </tt></b>  <tt> </tt> :</td><td><tt>real(8), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 2 次元経度緯度格子点データ(0:im-1,1:jm)

</td></tr>
</table>
</td></tr>
</table>
<p>
2 次元緯度経度格子点データの経度(X)方向平均(1 層用).
</p>
<p>
実際には格子点データ各点毎に x_X_Weight をかけた総和を計算し, x_X_Weight
の総和で割ることで平均している.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001499">wt_module#y_AvrLon_xy</a>
</p>


        </div>
      </div>


      <div id="method-M001831" class="method-detail">
        <a name="M001831"></a>

        <div class="method-heading">




          <span class="method-name">y_AvrRad_yr</span><span class="method-args">( yr ) result(y_AvrRad_yr)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001831">y_AvrRad_yr</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(1:jm)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 動径平均された 1 次元緯度格子点データ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>yr  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(1:jm,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 2 次元緯度動径(子午面)格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
2 次元(YR)格子点データの動径方向域平均.
</p>
<p>
2 次元データ f(φ,r) に対して ∫f(φ,r) r^2dr /((r[o]^3-r[i]^3)/3)
を計算する.
</p>
<p>
Original external subprogram is <a
href="wu_module.html#M000417">wu_module#y_AvrRad_yr</a>
</p>


        </div>
      </div>


      <div id="method-M001751" class="method-detail">
        <a name="M001751"></a>

        <div class="method-heading">




          <span class="method-name">y_AvrRad_yz</span><span class="method-args">( yz ) result(y_AvrRad_yz)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001751">y_AvrRad_yz</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(1:jm)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 動径平均された 1 次元緯度格子点データ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>yz  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(1:jm,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 2 次元緯度動径(子午面)格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
2 次元(YZ)格子点データの動径方向域平均.
</p>
<p>
2 次元データ f(φ,r) に対して ∫f(φ,r) r^2dr /((r[o]^3-r[i]^3)/3)
を計算する.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001438">wt_module#y_AvrRad_yz</a>
</p>


        </div>
      </div>


      <div id="method-M001813" class="method-detail">
        <a name="M001813"></a>

        <div class="method-heading">




          <span class="method-name">y_IntLonRad_xyr</span><span class="method-args">( xyr ) result(y_IntLonRad_xyr)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001813">y_IntLonRad_xyr</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(1:jm)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 経度動径(緯度円)積分された 1 次元緯度格子点データ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xyr  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 3 次元経度緯度動径格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
3 次元格子点データの経度動径(緯度円)積分.
</p>
<p>
3 次元データ f(λ,φ,r) に対して∫f(λ,φ,r) r^2dλdr を計算する.
</p>
<p>
Original external subprogram is <a
href="wu_module.html#M000399">wu_module#y_IntLonRad_xyr</a>
</p>


        </div>
      </div>


      <div id="method-M001725" class="method-detail">
        <a name="M001725"></a>

        <div class="method-heading">




          <span class="method-name">y_IntLonRad_xyz</span><span class="method-args">( xyz ) result(y_IntLonRad_xyz)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001725">y_IntLonRad_xyz</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(1:jm)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 経度動径(緯度円)積分された 1 次元緯度格子点データ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xyz  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 3 次元経度緯度動径格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
3 次元格子点データの経度動径(緯度円)積分.
</p>
<p>
3 次元データ f(λ,φ,r) に対して∫f(λ,φ,r) r^2dλdr を計算する.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001420">wt_module#y_IntLonRad_xyz</a>
</p>


        </div>
      </div>


      <div id="method-M001729" class="method-detail">
        <a name="M001729"></a>

        <div class="method-heading">




          <span class="method-name">y_IntLon_xy</span><span class="method-args">( xy_data ) result(y_IntLon_xy)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001729">y_IntLon_xy</a>(1:jm)  </tt></b>  <tt> </tt> :</td><td><tt>real(8)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 積分された 1 次元緯度(Y)格子点データ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xy_data(0:im-1,1:jm)  </tt></b>  <tt> </tt> :</td><td><tt>real(8), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 2 次元経度緯度格子点データ(0:im-1,1:jm)

</td></tr>
</table>
</td></tr>
</table>
<p>
2 次元緯度経度格子点データの経度(X)方向積分(1 層用).
</p>
<p>
実際には格子点データ各点毎に x_X_Weight をかけた総和を計算している.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001494">wt_module#y_IntLon_xy</a>
</p>


        </div>
      </div>


      <div id="method-M001817" class="method-detail">
        <a name="M001817"></a>

        <div class="method-heading">




          <span class="method-name">y_IntRad_yr</span><span class="method-args">( yr ) result(y_IntRad_yr)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001817">y_IntRad_yr</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(1:jm)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 動径積分された 1 次元緯度格子点データ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>yr  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(1:jm,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 2 次元緯度動径(子午面)格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
動径積分
</p>
<p>
2 次元(YR)格子点データの動径方向域積分.
</p>
<p>
2 次元データ f(φ,r) に対して∫f(φ,r) r^2dr を計算する.
</p>
<p>
Original external subprogram is <a
href="wu_module.html#M000403">wu_module#y_IntRad_yr</a>
</p>


        </div>
      </div>


      <div id="method-M001732" class="method-detail">
        <a name="M001732"></a>

        <div class="method-heading">




          <span class="method-name">y_IntRad_yz</span><span class="method-args">( yz ) result(y_IntRad_yz)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001732">y_IntRad_yz</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(1:jm)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 動径積分された 1 次元緯度格子点データ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>yz  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(1:jm,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 2 次元緯度動径(子午面)格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
動径積分
</p>
<p>
2 次元(YZ)格子点データの動径方向域積分.
</p>
<p>
2 次元データ f(φ,r) に対して∫f(φ,r) r^2dr を計算する.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001424">wt_module#y_IntRad_yz</a>
</p>


        </div>
      </div>


      <div id="method-M001679" class="method-detail">
        <a name="M001679"></a>

        <div class="method-heading">




          <span class="method-name">y_Lat</span><span class="method-args"></span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em>Variable</em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001679">y_Lat</a>(:)  </tt></b>  <tt> </tt> :</td><td><tt>real(8), allocatable</tt>

<table>
<tr><td valign="top"> :</td><td> 緯度経度

</td></tr>
</table>
</td></tr>
</table>
<p>
Original external subprogram is <a
href="wt_module.html#M001475">wt_module#y_Lat</a>
</p>


        </div>
      </div>


      <div id="method-M001680" class="method-detail">
        <a name="M001680"></a>

        <div class="method-heading">




          <span class="method-name">y_Lat_Weight</span><span class="method-args"></span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em>Variable</em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001680">y_Lat_Weight</a>(:)  </tt></b>  <tt> </tt> :</td><td><tt>real(8), allocatable</tt>

<table>
<tr><td valign="top"> :</td><td> 座標重み

</td></tr>
</table>
</td></tr>
</table>
<p>
Original external subprogram is <a
href="wt_module.html#M001476">wt_module#y_Lat_Weight</a>
</p>


        </div>
      </div>


      <div id="method-M001823" class="method-detail">
        <a name="M001823"></a>

        <div class="method-heading">




          <span class="method-name">yr_AvrLon_xyr</span><span class="method-args">( xyr ) result(yr_AvrLon_xyr)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001823">yr_AvrLon_xyr</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(1:jm,0:km)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 経度方向(帯状)平均された 2 次元子午面格子点データ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xyr  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 3 次元経度緯度動径格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
経度(帯状)積分
</p>
<p>
3 次元格子点データの経度方向(帯状)平均.
</p>
<p>
3 次元データ f(λ,φ,r) に対して ∫f(λ,φ,r)dλ/2π を計算する.
</p>
<p>
Original external subprogram is <a
href="wu_module.html#M000409">wu_module#yr_AvrLon_xyr</a>
</p>


        </div>
      </div>


      <div id="method-M001809" class="method-detail">
        <a name="M001809"></a>

        <div class="method-heading">




          <span class="method-name">yr_IntLon_xyr</span><span class="method-args">( xyr ) result(yr_IntLon_xyr)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001809">yr_IntLon_xyr</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(1:jm,0:km)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 経度方向(帯状)積分された 2 次元子午面格子点データ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xyr  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 3 次元経度緯度動径格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
経度(帯状)積分
</p>
<p>
3 次元格子点データの経度方向(帯状)積分.
</p>
<p>
3 次元データ f(λ,φ,r) に対して ∫f(λ,φ,r)dλ を計算する.
</p>
<p>
Original external subprogram is <a
href="wu_module.html#M000395">wu_module#yr_IntLon_xyr</a>
</p>


        </div>
      </div>


      <div id="method-M001740" class="method-detail">
        <a name="M001740"></a>

        <div class="method-heading">




          <span class="method-name">yz_AvrLon_xyz</span><span class="method-args">( xyz ) result(yz_AvrLon_xyz)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001740">yz_AvrLon_xyz</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(1:jm,0:km)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 経度方向(帯状)平均された 2 次元子午面格子点データ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xyz  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 3 次元経度緯度動径格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
経度(帯状)積分
</p>
<p>
3 次元格子点データの経度方向(帯状)平均.
</p>
<p>
3 次元データ f(λ,φ,r) に対して ∫f(λ,φ,r)dλ/2π を計算する.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001430">wt_module#yz_AvrLon_xyz</a>
</p>


        </div>
      </div>


      <div id="method-M001721" class="method-detail">
        <a name="M001721"></a>

        <div class="method-heading">




          <span class="method-name">yz_IntLon_xyz</span><span class="method-args">( xyz ) result(yz_IntLon_xyz)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001721">yz_IntLon_xyz</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(1:jm,0:km)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 経度方向(帯状)積分された 2 次元子午面格子点データ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xyz  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 3 次元経度緯度動径格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
経度(帯状)積分
</p>
<p>
3 次元格子点データの経度方向(帯状)積分.
</p>
<p>
3 次元データ f(λ,φ,r) に対して ∫f(λ,φ,r)dλ を計算する.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001416">wt_module#yz_IntLon_xyz</a>
</p>


        </div>
      </div>


      <div id="method-M001750" class="method-detail">
        <a name="M001750"></a>

        <div class="method-heading">




          <span class="method-name">z_AvrLat_yz</span><span class="method-args">( yz ) result(z_AvrLat_yz)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001750">z_AvrLat_yz</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:km)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 緯度平均された 1 次元動径格子点データ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>yz  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(1:jm,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 2 次元緯度動径(子午面)格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
2 次元(YZ)格子点データの緯度方向域平均.
</p>
<p>
2 次元データ f(φ,r) に対して ∫f(φ,r) cosφ dφ/2 を計算する.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001437">wt_module#z_AvrLat_yz</a>
</p>


        </div>
      </div>


      <div id="method-M001745" class="method-detail">
        <a name="M001745"></a>

        <div class="method-heading">




          <span class="method-name">z_AvrLonLat_xyz</span><span class="method-args">( xyz ) result(z_AvrLonLat_xyz)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001745">z_AvrLonLat_xyz</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:km)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 緯度経度(水平, 球面)平均された 1 次元動径格子点データ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xyz  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 3 次元経度緯度動径格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
緯度経度(水平)積分
</p>
<p>
3 次元格子点データの緯度経度(水平, 球面)積分
</p>
<p>
3 次元データ f(λ,φ,r) に対して
</p>
<pre>
   ∫f(λ,φ,r) cosφ dλdφ /4π
</pre>
<p>
を計算する.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001435">wt_module#z_AvrLonLat_xyz</a>
</p>


        </div>
      </div>


      <div id="method-M001753" class="method-detail">
        <a name="M001753"></a>

        <div class="method-heading">




          <span class="method-name">z_AvrLon_xz</span><span class="method-args">( xz ) result(z_AvrLon_xz)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001753">z_AvrLon_xz</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:km)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 経度平均された 1 次元動径格子点データ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xz  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 2 次元緯度動径格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
経度(帯状)積分
</p>
<p>
2 次元(XZ)格子点データの経度方向平均.
</p>
<p>
2 次元データ f(λ,r) に対して ∫f(λ,r)dλ/2π を計算する.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001440">wt_module#z_AvrLon_xz</a>
</p>


        </div>
      </div>


      <div id="method-M001731" class="method-detail">
        <a name="M001731"></a>

        <div class="method-heading">




          <span class="method-name">z_IntLat_yz</span><span class="method-args">( yz ) result(z_IntLat_yz)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001731">z_IntLat_yz</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:km)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 緯度積分された 1 次元動径格子点データ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>yz  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(jm,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 2 次元緯度動径(子午面)格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
緯度積分
</p>
<p>
2 次元(YZ)格子点データの緯度方向域積分.
</p>
<p>
2 次元データ f(φ,r) に対して∫f(φ,r) cosφ dφ を計算する.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001423">wt_module#z_IntLat_yz</a>
</p>


        </div>
      </div>


      <div id="method-M001726" class="method-detail">
        <a name="M001726"></a>

        <div class="method-heading">




          <span class="method-name">z_IntLonLat_xyz</span><span class="method-args">( xyz ) result(z_IntLonLat_xyz)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001726">z_IntLonLat_xyz</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:km)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 緯度経度(水平, 球面)積分された 1 次元動径格子点データ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xyz  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 3 次元経度緯度動径格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
緯度経度(水平)積分
</p>
<p>
3 次元格子点データの緯度経度(水平, 球面)積分
</p>
<p>
3 次元データ f(λ,φ,r) に対して
</p>
<pre>
   ∫f(λ,φ,r) cosφ dλdφ
</pre>
<p>
を計算する.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001421">wt_module#z_IntLonLat_xyz</a>
</p>


        </div>
      </div>


      <div id="method-M001734" class="method-detail">
        <a name="M001734"></a>

        <div class="method-heading">




          <span class="method-name">z_IntLon_xz</span><span class="method-args">( xz ) result(z_IntLon_xz)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wtu_module.html#M001734">z_IntLon_xz</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:km)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 経度積分された 1 次元動径格子点データ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xz  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 2 次元緯度動径格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
2 次元(XZ)格子点データの経度方向積分.
</p>
<p>
2 次元データ f(λ,r) に対して ∫f(λ,r)dλ を計算する.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001426">wt_module#z_IntLon_xz</a>
</p>


        </div>
      </div>


      <div id="method-M001681" class="method-detail">
        <a name="M001681"></a>

        <div class="method-heading">




          <span class="method-name">z_RAD</span><span class="method-args"></span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em>Variable</em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt>g_X(:)  </tt></b>  <tt> </tt> :</td><td><tt>real(8), allocatable</tt>

<table>
<tr><td valign="top"> :</td><td> 格子点座標 km 次のチェビシェフ多項式の零点から定まる格子点

</td></tr>
</table>
</td></tr>
</table>
<p>
Original external subprogram is <a
href="wt_module.html#M001477">wt_module#z_RAD</a>
</p>


        </div>
      </div>


      <div id="method-M001682" class="method-detail">
        <a name="M001682"></a>

        <div class="method-heading">




          <span class="method-name">z_RAD_WEIGHT</span><span class="method-args"></span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em>Variable</em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt>g_X_Weight(:)  </tt></b>  <tt> </tt> :</td><td><tt>real(8), allocatable</tt>

<table>
<tr><td valign="top"> :</td><td> 格子点重み座標 各格子点における積分のための重みが格納してある

</td></tr>
</table>
</td></tr>
</table>
<p>
Original external subprogram is <a
href="wt_module.html#M001478">wt_module#z_RAD_WEIGHT</a>
</p>


        </div>
      </div>



    </div>



  </div>

<div id="validator-badges">
  <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
</div>

</body>
</html>
