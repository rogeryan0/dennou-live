\documentclass[a4j,12pt]{jarticle}
\usepackage{Dennou6}
\Dtitle{球および円盤領域での\\スペクトル法による定式化}
\Dauthor{竹広真一}
\Ddate{2007 年 12 月 28 日}

\begin{document}

\maketitle

ここではとある支配方程式と境界条件を球および円において解くための
スペクトル法の定式化を行う. 動径方向の展開に用いるチェビシェフ関数の
性質については別文書「チェビシェフ関数変換法」を参照されたい. 

\section{動径方向の離散化}

  \subsection{正変換・逆変換}

    動径方向には原点の特異性をかわすために, 
    シフトされた 2 次の引き数のチェビシェフ関数展開を用いる. 
    %
    \begin{equation}
      f(r) = \sum_{k=0}^{N}\tilde{f}_k r^nT_k\left(2\frac{r^2}{a^2}-1\right),
      \quad 0\le r \le a.
    \end{equation}
    %
    ここで $r$ は動径座標, $a$ は球および円盤の半径である. 
    重み $r^n$ は水平方向の離散化された波数成分毎に定まる指数であり, 
    原点で連続微分可能である条件から導かれる. 
    %
    正変換は
    %
    \begin{equation}
      \tilde{f}_k
      = \frac{2}{\pi c_k}\int_{-1}^{1}\frac{f(x)}{r^n}T_k(x)w(x)dx, \quad
      x = 2(r/a)^2 -1
    \end{equation}
    %
    ただし $c_k$ は $k=0$ で 2, $k\ge 1$ で 1 をとる係数である. 
    これを原点に格子点を持たないチェビシェフ--ガウス--ラダウ
    (Chebyshev-Gauss-Radau)格子点で離散化する. すなわち
    %
    \begin{equation}
      x_j = \cos\frac{2\pi j}{2N+1}, \quad w_j = \left\{
        \begin{array}[]{ll}
          \frac{\pi}{2N+1} & (j=0)\\ \frac{2\pi}{2N+1} & (1\le j\le N)
        \end{array}
        \right.
    \end{equation}
    %
    $T_k(\cos\theta) = \cos(k\theta)$ であることを用いると, 正変換の積分は
    %
    \begin{equation}
      \tilde{f}_k
      = \frac{2}{\pi c_k}\sum_{j=0}^{N}
          \frac{f(x_j)}{r_j^n}\cos\frac{2\pi kj}{2N+1} w_j, 
      \quad r_j = a\sqrt{\frac{1+x_j}{2}}
    \end{equation}
    %
    逆変換は
    %
    \begin{equation}
      f(x_j) = r_j^n\sum_{k=0}^{K}
              \tilde{f}_k\cos\frac{2\pi jk}{2N+1}
    \end{equation}

  \subsubsection{微分}

    $f(x_j) = \sum_{k=0}^{K} \tilde{f}_k T_k(x_j)$ に対して
    その $x$ 微分を
    %
    \begin{displaymath}
      f'(x_j) = \sum_{k=0}^{K}d_k T_k(x_j)
    \end{displaymath}
    %
    を表すチェビシェフ変換係数 $\{d_k\}$ は
    もとのチェビシェフ変換係数 $\{c_k\}$ から次のように計算される
    \footnote{
      実際に $f'(x)$ を積分してみると, チェビシェフ関数の積分の公式から
      \begin{eqnarray*}
        \int f'(x)dx &=& \sum_{k=0}^{K} d_k \int T_k(x) dx\\
              &=& C + d_0 T_1(x)
                + \frac{1}{4}d_1 T_2(x)
                +\sum_{k=2}^{K} d_k
                  \frac{1}{2}\left\{\frac{1}{n+1}T_{k+1}(x)
                                    -\frac{1}{n-1}T_{k-1}(x)\right\}\\
              &=& C + d_0 T_1(x)
                + \frac{1}{4}d_1 T_2(x)
                +\frac{1}{2}\sum_{k=3}^{K+1} d_{k-1}
                  \frac{1}{k}T_{k}(x)
                -\frac{1}{2}\sum_{k=1}^{K-1} d_{k+1} 
                       \frac{1}{k}T_{k}(x)\\
              &=& C + d_0 T_1(x)
                + \frac{1}{4}d_1 T_2(x)
                + \sum_{n=3}^{K-1}\frac{1}{2k}(d_{k-1}-d_{k+1})T_{k}(x)\\
              &&+ \frac{1}{2K}d_{K-1}T_K(x) + \frac{1}{2(K+1)}d_{K}T_{K+1}(x)
                - \frac{1}{2}d_2T_1(x) - \frac{1}{4}d_3T_2(x)\\
              &=& C
                + \frac{1}{2}(2d_0 - d_2)T_1(x)
                + \frac{1}{4}(d_1 - d_3)T_2(x)
                + \sum_{n=3}^{K-1} \frac{1}{2n}(d_{n-1}-d_{n+1})T_{n}(x)\\
              &&+ \frac{1}{2K}d_{K-1}T_K(x) + \frac{1}{2(K+1)}d_{K}T_{K+1}(x)\\
              &=& C + \frac{1}{2}(2d_0 - d_2)T_1(x)
                + \sum_{n=2}^{K-1} \frac{1}{2n}(d_{n-1}-d_{n+1})T_{n}(x)\\
              &&+ \frac{1}{2K}d_{K-1}T_K(x) + \frac{1}{2(K+1)}d_{K}T_{K+1}(x)
      \end{eqnarray*}
      %
      ただし C は積分定数である. 
      これと $f(x)dx = \sum_{k=0}^{K} c_kT_k(x)$ を比較して, 
      %
      \begin{displaymath}
        C = c_0 \quad
        c_1 = \frac{1}{2}(2d_0 - d_2) \quad
        c_n = \frac{1}{2n}(d_{n-1}-d_{n+1}) \quad (n=2,2,\ldots K-1), \quad
        c_K = \frac{1}{2K}d_{K-1}, \quad d_K = 0.
      \end{displaymath}
    }.
    %
    \begin{equation}
      d_{n-1} = d_{n+1} + 2 n c_n \quad(n=K-1,k-2,\ldots,2), \quad
      d_0 = (d_2 + 2 c_1)/2
    \end{equation}
    %
    これを $d_K=0, d_{K-1}= 2Kc_K$ から再帰的に計算すれば良い. 

    さらに, 
    %
    \begin{displaymath}
      f(r) = \sum_{k=0}^{N}\tilde{f}_k r^n T_k\left(2\frac{r^2}{a^2}-1\right)
    \end{displaymath}
    %
    に対しての $r$ に関する微分は
    %
    \begin{eqnarray*}
      f'(r) &=& 
          \sum_{k=0}^{K}\tilde{f}_k \frac{4r^{n+1}}{a^2}
                                  T_k'\left(2\frac{r^2}{a^2}-1\right)
               + \sum_{k=0}^{K}\tilde{f}_k nr^{n-1}
                                  T_k\left(2\frac{r^2}{a^2}-1\right)\\
            &=& \frac{4r}{a^2}\sum_{k=0}^{K}r^n\tilde{f}_k 
                                  T_k'\left(2\frac{r^2}{a^2}-1\right)
               + \sum_{k=0}^{K}\tilde{f}_knr^{n-1} 
                                  T_k\left(2\frac{r^2}{a^2}-1\right)\\
            &=& \frac{4r}{a^2}\sum_{k=0}^{K}r^n\tilde{g}_k 
                                  T_k\left(2\frac{r^2}{a^2}-1\right)
               + \frac{n}{r}\sum_{k=0}^{K}\tilde{f}_k r^n
                                  T_k\left(2\frac{r^2}{a^2}-1\right).
    \end{eqnarray*}
    %
    $g_k$ は先の漸化式を用いてそのチェビシェフ係数を
    計算することができる. 

    $r$ に関する 2 階微分はさらに $r$ で微分して
    \begin{eqnarray*}
      f''(r) &=& 
                \sum_{k=0}^{K}\tilde{f}_k \frac{16r^{n+2}}{a^4}
                                  T_k''\left(2\frac{r^2}{a^2}-1\right)
               + \sum_{k=0}^{K}\tilde{f}_k \frac{4(n+1)r^n}{a^2}
                                  T_k'\left(2\frac{r^2}{a^2}-1\right)\\
             &&+ \sum_{k=0}^{K}\tilde{f}_k \frac{4nr^{n}}{a^2}
                                  T_k'\left(2\frac{r^2}{a^2}-1\right)
               + \sum_{k=0}^{K}\tilde{f}_k n(n-1)r^{n-2}
                                  T_k\left(2\frac{r^2}{a^2}-1\right)\\
             &=& \sum_{k=0}^{K}\tilde{f}_k \frac{16r^{n+2}}{a^4}
                                  T_k''\left(2\frac{r^2}{a^2}-1\right)
               + \sum_{k=0}^{K}\tilde{f}_k \frac{4(2n+1)r^n}{a^2}
                                  T_k'\left(2\frac{r^2}{a^2}-1\right)\\
             & &+ \sum_{k=0}^{K}\tilde{f}_k n(n-1)r^{n-2}
                                  T_k\left(2\frac{r^2}{a^2}-1\right)\\
             &=& \frac{16r^2}{a^4}\sum_{k=0}^{K}\tilde{f}_k r^n
                                  T_k''\left(2\frac{r^2}{a^2}-1\right)
               + \frac{4(2n+1)}{a^2}\sum_{k=0}^{K}\tilde{f}_k r^n
                                  T_k'\left(2\frac{r^2}{a^2}-1\right)\\
             & &+ \frac{n(n-1)}{r^2}\sum_{k=0}^{K}\tilde{f}_k r^n
                                  T_k\left(2\frac{r^2}{a^2}-1\right)\\
             &=& \frac{16r^2}{a^4}\sum_{k=0}^{K}\tilde{h}_k r^n
                                  T_k\left(2\frac{r^2}{a^2}-1\right)
               + \frac{4(2n+1)}{a^2}\sum_{k=0}^{K}\tilde{g}_k r^n
                                  T_k\left(2\frac{r^2}{a^2}-1\right)\\
             & &+ \frac{n(n-1)}{r^2}\sum_{k=0}^{K}\tilde{f}_k r^n
                                  T_k\left(2\frac{r^2}{a^2}-1\right)
    \end{eqnarray*}
    $h_k$ は先の漸化式を 2 度用いてそのチェビシェフ係数を
    計算することができる. 


  \subsubsection{領域定積分}

    $f(r)$ の領域積分 $\Ddsty \int_{0}^a f(r) dr$ を離散格子点上の値
    %
    \begin{displaymath}
      f(r_j), \quad
      r_j= a\sqrt{\frac{1+\cos x_j}{2}}, 
      \quad x_j=\frac{2j\pi}{2N+1} \quad j=0,\ldots,N
    \end{displaymath}
    %
    の線形和として表したい. そのために関数 f(r) を重みの指数 $n=0$ で
    変換する. 
    %
    \begin{eqnarray*}
      & &\int_{0}^a f(r) dr
       = \int_{0}^a \sum_{k=0}^{K} f_k T_k\left(2\frac{r^2}{a^2}-1\right)dr
    \end{eqnarray*}
    %
    $\cos\theta=2(r/a)^2 -1 $ と変数変換する.
    $\Ddsty r=a\sqrt{\frac{1+\cos\theta}{2}},
      -\sin \theta d\theta= 4r/a^2 dr$ であるから
    %
    \begin{eqnarray*}
      & & \int_{0}^a f(r) dr 
       = \int_{\pi}^{0} \sum_{k=0}^{K}
              \tilde{f}_k T_k(\cos\theta)
                 (-\sin\theta)\frac{a}{4}\sqrt{\frac{2}{1+\cos\theta}}d\theta\\
      &=& \frac{a}{4} \sum_{k=0}^{K}\tilde{f}_k 
            \int_{0}^{\pi}\cos(k\theta)2\sin\left(\frac{\theta}{2}\right)
           d\theta 
       = \frac{a}{4} \sum_{k=0}^{K}\tilde{f}_k 
            \int_{0}^{\pi}\sin\left(k+\frac{1}{2}\right)\theta
                          -\sin\left(k+\frac{1}{2}\right)\theta
           d\theta\\
      &=& \frac{a}{4} \sum_{k=0}^{K}\tilde{f}_k 
            \left[-\frac{\cos\left(k+\frac{1}{2}\right)\theta}
                        {k+\frac{1}{2}}
                  +\frac{\cos\left(k-\frac{1}{2}\right)\theta}
                        {k-\frac{1}{2}}
            \right]_0^\pi
      = \frac{a}{4} \sum_{k=0}^{K}\tilde{f}_k 
            \left[\frac{1}{k+\frac{1}{2}}
                  -\frac{1}{k-\frac{1}{2}}
            \right]\\
      &=& \frac{a}{4} \sum_{k=0}^{K}\tilde{f}_k 
                  \frac{1}{\frac{1}{4}-k^2}
    \end{eqnarray*}
    %
    これに再度 
    \begin{displaymath}
       \tilde{f}_k = \frac{2}{\pi c_k}\sum_{j=0}^{N}
                       f(x_j)\cos\frac{2\pi kj}{2N+1} w_j, 
    \end{displaymath}
    %
    を代入して和のとり方を逆にすると
    %
    \begin{eqnarray*}
      & & \int_0^a f(r) dr
       = \frac{a}{4}\sum_{k=0}^{K}\frac{1}{\frac{1}{4}-k^2}\tilde{f}_k 
       = \frac{a}{4}\sum_{k=0}^{K}
              \frac{1}{\frac{1}{4}-k^2}
               \frac{2}{\pi c_k}\sum_{j=0}^{N}
                       f(x_j)\cos\left(\frac{2\pi kj}{2N+1}\right)w_j\\
      &=& \frac{a}{2\pi}\sum_{j=0}^{N}f(x_j) w_j
            \sum_{k=0}^{K}\frac{1}{c_k}\cos\left(\frac{2\pi kj}{2N+1}\right)w_j
              \frac{1}{\frac{1}{4}-k^2}\\
      &=& \sum_{j=0}^{N} f(x_j) w_j \frac{a}{2\pi}
           \sum_{k=0}^{N}\frac{1}{c_k}
              \frac{1}{\frac{1}{4}-k^2}
                \cos\frac{2\pi kj}{2N+1}
    \end{eqnarray*}
    %
    したがって
    %
    \begin{displaymath}
      \int_{-1}^1 f(x) dx = \sum_{j=0}^{N}v_j f(x_j), \quad
      v_j \equiv \frac{2}{a\pi}w_j 
               \sum_{k=0}^{K}\frac{1}{c_k}
                       \frac{1}{\frac{1}{4}-k^2}
                       \cos\frac{2\pi kj}{2N+1}
    \end{displaymath}
    


\section{球の場合}

  \subsection{球面調和函数展開}

    球内部の $C^{\infty}$ 級の連続関数 
    \begin{equation}
    f(\lambda,\varphi,r), \quad 0 \le \lambda \le 2\pi, 
                        -\pi/2\le \varphi \le\pi/2, 0 \le r \le a,
    \end{equation}
    %
    を考える. $\lambda,\varphi,r$ はそれぞれ経度, 緯度, 動径である. 

    水平方向には球面調和函数
    %
    \begin{equation}
      Y_n^m(\lambda,\varphi) = P_n^m(\sin\varphi)e^{im\lambda}
    \end{equation}
    %
    で展開して扱う. すなわち
    %
    \begin{equation}
      f(\lambda,\varphi,r) 
      = \sum_{n=0}^{N}\sum_{m=-n}^n \hat{f}_{nm}(r)Y_n^m(\lambda,\varphi).
    \end{equation}
    %
    このとき, $f_{nm}(r)$ は, $f$ の $C^{\infty}$ 級の連続性から 
    $r^n$ 次以上の式であることが示される. 
    \footnote{
      球座標(緯度経度動径座標)を直交直線座標で表わすと
      %
      \begin{equation}
        x=r\cos\varphi\cos\lambda, \quad
        y=r\cos\varphi\sin\lambda, \quad
        z=r\sin\varphi
      \end{equation}
      %
      である. 
      球面調和函数 $Y_n^m(\lambda,\varphi)$ に $r^n$ をかけたものは
      $x,y,z$ の $n$ 次の同次式として書き表せる(寺沢, 1954, 森口ら 1959). 
      なぜならば
      ルジャンドル陪函数は
      %
      \begin{displaymath}
        P_n^m(\sin\varphi) 
        = \cos^m\varphi\sum_{k=0}^{\ge\frac{n-m}{2}} c_k \sin^{n-m-2k}\varphi
      \end{displaymath}
      %
      と表わされる. この各項に $r^n e^{i m\lambda}$ 
      をかけると $x+iy=e^{i\lambda}\cos\varphi$ であるから
      %
      \begin{eqnarray*}
         r^n e^{i m\lambda} \sin^m\varphi\cos^{n-m-2k}\varphi 
          = (x+iy)^m z^{n-m-2k}(x^2 + y^2 + z^2)^k.
      \end{eqnarray*}
      %
      したがって, 
      $f(\lambda,\varphi,r)$ を球面調和函数展開した $n$ 次の式
      $\hat{f}_{nm}(r)Y_n^m(\lambda,\varphi)$ に対して
      $\hat{f}_{nm}$ が原点近傍で $r^n$ の振舞をすれば, 
      それは $x,y,z$ の $n$ 次多項式となり原点で特異性をもたず
      $C^{\infty}$ 級であることになる. 

      逆に,$\hat{f}_{nm}$ がゆるやかに $r^l, l<n$ と振る舞うならば, 
      $x,y,z$ の同次式を $r^{n-l}$ で割ったものになるので特異性を
      持つことになる. 
    }
    動径方向には, 原点での球面調和函数展開成分の偶奇性だけを考慮して
    %
    \begin{equation}
      \hat{f}_{nm}(r)
      = \sum_{l=0}^{L}\tilde{f}_{nml}r^{[1-(-1)^l]/2}
             T_l\left(2\frac{r^2}{a^2}-1\right)
    \end{equation}
    %
    と展開することにする(Boyd, 2001)
    \footnote{
      原点での振る舞いから展開を
      %
      \begin{displaymath}
        \hat{f}_{nm}(r)
        = \sum_{l=0}^{L}\tilde{f}_{nml}r^l T_l\left(2\frac{r^2}{a^2}-1\right)
      \end{displaymath}
      %
      としたいところだが, 数値的に十分な精度が得られなかったので
      このような展開の仕方に変更した. 
    }.


\section{円の場合}

  \subsection{フーリエ展開}

    円内部の $C^{\infty}$ 級の連続関数 
    \begin{equation}
       f(r,\phi) \quad 0\le r \le a, 0 \le \phi \le 2\pi, 
    \end{equation}
    %
    を考える. $r,\phi$ はそれぞれ動径と方位角である. 
    
    水平方向にはフーリエ展開して扱う. すなわち
    %
    \begin{equation}
      g(r,\phi) 
      = g^-(r) + 2 \mbox{\rm Re}\left\{
                   \sum_{m=1}^\infty \hat{g}_{m}(r)e^{im\phi}\right\}
    \end{equation}
    %
    このとき, $g_{m}(r)$ は, $g$ の $C^{\infty}$ 級の連続性から 
    $r^m$ 次以上の式であることが示される(石岡, 2003). 
    \footnote{
      2 次元極座標を直交直線座標で表わすと
      %
      \begin{equation}
        x=r\cos\varphi, \quad y=r\sin\varphi. 
      \end{equation}
      %
      $g(x,y)$ が原点近傍で $C^\infty$ であるには
      $x,y$ でテイラー展開可能でなければならない. 
      このとき $z=x+iy=re^{i\phi}, z^*=x-iy=re^{-i\phi}$
      でも展開できねばならない. 
      非正数の $m$ に対して $m=k-l$ なる $k,l$ を選ぶと
      %
      \begin{displaymath}
        z^k (z^*)^l = r^k e^{ik\phi} r^l e^{il\phi}
                    = r^{k+l} e^{i(k-l)\phi}
                    = r^{m+2l} e^{im\phi}
      \end{displaymath}
      %
      したがって $e^{im\phi}$ の係数 $\hat{g}^m(r)$ は原点近傍で
      $r^m$ で振る舞わなければならない. 
    }


\begin{Dreference}
  \item 寺沢 寛一, 1954: 
    自然科学者のための数学概論, 岩波 722pp. 

  \item 森口 繁一, 宇田川 かね久, 一松 信, 1959:
    数学公式 III -- 特殊関数 --, 岩波 310pp. 

  \item 石岡圭一, 2003:
    円盤領域の浅水方程式に対するスペクトル法 I. 原理. 
    ながれ, 22, 345--358.

  \item Boyd, J. P., 2001:
    Chebyshev and Fourier spectral methods (2nd Edition).
    Dover, 668pp.     

\end{Dreference}
 

\end{document}

%%% Local Variables: 
%%% mode: latex
%%% TeX-master: t
%%% End: 
