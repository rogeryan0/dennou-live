%表題  SPMODEL レファレンスマニュアル
%      球面調和函数
%
%履歴  2009/09/05 竹広真一 
%
\documentclass[a4j,12pt]{jarticle}
\usepackage{Dennou6}

\Dtitle[球面調和函数変換]{球面調和函数変換(SJPACK,w\_module\_sjpack)}
\Dauthor{竹広真一}
\Ddate{平成 21 年 9 月 5 日}

\Dparskip

\begin{document}

\maketitle

この文書は, ISPACK/SJPACK とそのラッパー w\_module\_sjpack を用いる上で必要と
なる球面調和関数変換の基本的な定式化を行う. 

\section{球面調和函数変換}

  東西切断波数 $M$ 全波数切断 $N$ の球面調和函数逆変換は次のように表される. 
  \begin{equation}
    g(\lambda,\mu)
    = \sum_{m=-M}^{M} \sum_{n=0}^N  s_n^m P_n^m(\mu)\exp(im\lambda)
  \end{equation}
  %
  ここで $\lambda$ は経度, $\mu=sin\varphi$ は sin 緯度である. 
  $P_n^m(\mu)$ はルジャンドル陪函数であり, ISPACK では 2 に正規化された
  ものを用いている. 
  %
  \begin{equation}
    P_n^m(\mu)= \sqrt{(2n+1)\frac{(n-|m|)!}{(n+|m|)}}
                 \frac{1}{2^n n!}(1-\mu^2)^{|m|/2}
                   \frac{d^{n+|m|}}{d\mu^{n+|m|}}(\mu^2-1)^n, \quad
    \int_{-1}^{1}\{P_n^m(\mu)\}^2 d\mu =2.
  \end{equation}

  $g(\lambda,\mu)$ が実数であることから $s_n^m$ は
  \begin{equation}
    s_n^{-m} = \{s_n^m\}^* 
  \end{equation}
  の関係を満たしている
  \footnote{
    $ \sum_{m=-n}^{n}s_n^m e^{im\lambda}$ を展開して 
    $\cos(m\lambda)$, $\sin(m\lambda)$ の項を取りだすと
    \begin{eqnarray*}
      s_n^m e^{im\lambda} + s_n^{-m}e^{-im\lambda}
     &=& Re[s_n^m]\cos(m\lambda) + i Re[s_n^m]\sin(m\lambda)
      + iIm[s_n^m]\cos(m\lambda) - Im[s_n^m]\sin(m\lambda)\\
     & &+ Re[s_n^{-m}]\cos(m\lambda) - i Re[s_n^{-m}]\sin(m\lambda)
      + iIm[s_n^{-m}]\cos(m\lambda) +  Im[s_n^{-m}]\sin(m\lambda)\\
      &=& (Re[s_n^m]+Re[s_n^{-m}])\cos(m\lambda)
        + (- Im[s_n^m]+Im[s_n^{-m}])\sin(m\lambda)\\
      &&+ i(Im[s_n^m]+Im[s_n^{-m}])\cos(m\lambda)
        + i(Re[s_n^m]-Re[s_n^{-m}])\sin(m\lambda).
    \end{eqnarray*}
    %
    虚数部が 0 になる条件から 
    $Re[s_n^m]=Re[s_n^{-m}],Im[s_n^m]=-Im[s_n^{-m}]$,
    すなわち $s_n^{-m} = \{s_n^m\}^*$ である. 
  }. 


\section{ルジャンドル陪函数}

  補間の際必要となるルジャンドル陪函数の性質を記しておく. 
  2 で正規化されているため通常のルジャンドル陪函数と性質が変わる
  ことに注意されたい. 通常のルジャンドル陪函数を $\tilde{P}_n^m$, 
  2 で正規化されたルジャンドル陪函数を $P_n^m$ と表すと
  %
  \begin{equation}
    \tilde{P}_n^m(\mu) 
    = (-i)^m\sqrt{\frac{1}{2n+1}\frac{(n+m)!}{(n-m)!}} P_n^m(\mu)
  \end{equation}
  %
  である\footnote{
    ISPACK で用いているルジャンドル陪函数は
    符号の定義も違っていることに注意されたい}. 
  通常のルジャンドル函数の性質として, 
  %
  \begin{equation}
    \tilde{P}_m^m(\mu) = (-1)^m(2m-1)!!(1-\mu^2)^{m/2}, 
    \quad \tilde{P}_{m+1}^m(\mu) = \mu(2m+1)\tilde{P}_m^m.
  \end{equation}
  %
  三項漸化式
  \begin{equation}
    \tilde{P}_{n+1}^m(\mu) = \frac{2n+1}{n-m+1}\mu \tilde{P}_n^m(\mu) 
                           - \frac{n+m}{n-m+1}\tilde{P}_{n-1}^m(\mu).
  \end{equation}
  %
  低次のルジャンドル陪函数
  %
  \begin{eqnarray}
    & & \tilde{P}_1^0(\mu) = \mu, \quad
        \tilde{P}_1^1(\mu) = -\sqrt{1-\mu^2}, \\
    & & \tilde{P}_2^0(\mu) = \frac{1}{2}(3\mu^2-1), \quad
        \tilde{P}_2^1(\mu) = -3\mu\sqrt{1-\mu^2}, \quad
        \tilde{P}_2^2(\mu) = 3(1-\mu^2).
  \end{eqnarray}
  %
  積分
  %
  \begin{equation}
    \int_{-1}^1 \{\tilde{P}_n^m(\mu)\}^2 d\mu 
    = \frac{2}{2n+1}\frac{(n+m)!}{(n-m)!}.
  \end{equation}
  %
  2 で正規化されたルジャンドル陪函数に書き換えると, m, m+1 次の
  ルジャンドル陪函数は
  \footnote{
    \begin{eqnarray*}
      \tilde{P}_m^m(\mu) &=&(-1)^m\sqrt{\frac{(2m)!}{2m+1}} P_m^m(\mu)
                         = (-1)^m(2m-1)!!(1-\mu^2)^{m/2},\\
     P_m^m(\mu) &=& \sqrt{\frac{2m+1}{(2m)!}}(2m-1)!!(1-\mu^2)^{m/2}
                 =  \sqrt{\frac{2m+1}{(2m)!}}
                               \frac{(2m)!}{2^m m!}(1-\mu^2)^{m/2} 
                   \\
                &=& \frac{\sqrt{(2m+1)(2m)!}}{2^m m!}(1-\mu^2)^{m/2},
                   \\
                &=& \frac{\sqrt{(2m+1)!}}{2^m m!}(1-\mu^2)^{m/2}. \\
     \tilde{P}_{m+1}^m(\mu) &=& \sqrt{\frac{(2m+1)!}{2m+3}} P_{m+1}^m(\mu)
                             = \mu(2m+1)\tilde{P}_m^m
                             = \mu(2m+1)\sqrt{\frac{(2m)!}{2m+1}} P_m^m(\mu),
                               \\
     P_{m+1}^m(\mu) &=& \mu(2m+1)\sqrt{\frac{(2m)!}{2m+1}
                                     \frac{2m+3}{(2m+1)!}}P_m^m(\mu)
                     = \mu(2m+1)\sqrt{\frac{2m+3}{(2m+1)^2}}P_m^m(\mu)\\
                    &=& \mu\sqrt{2m+3}P_m^m(\mu).
    \end{eqnarray*}
  },
  %
  \begin{eqnarray}
     P_m^m(\mu) &=& \frac{\sqrt{(2m+1)!}}{2^m m!}(1-\mu^2)^{m/2}. \\
     P_{m+1}^m(\mu)&=& \mu\sqrt{2m+3}P_m^m(\mu).
  \end{eqnarray}
  %
  三項漸化式は
  \footnote{
    \begin{eqnarray*}
     & & 
     \sqrt{\frac{1}{2n+3}\frac{(n+m+1)!}{(n-m+1)!}} P_{n+1}^m(\mu) = 
     \sqrt{\frac{1}{2n+1}\frac{(n+m)!}{(n-m)!}}
            \frac{2n+1}{n-m+1}\mu P_n^m(\mu) \\
     & & - \sqrt{\frac{1}{2n-1}\frac{(n+m-1)!}{(n-m-1)!}}
               \frac{n+m}{n-m+1}P_{n-1}^m(\mu), \\
     & &             
     P_{n+1}^m(\mu) =\sqrt{\frac{2n+3}{2n+1}\frac{(n-m+1)!}{(n+m+1)!}
                              \frac{(n+m)!}{(n-m)!}}
                             \frac{2n+1}{n-m+1}\mu P_n^m(\mu) \\
     & &                - \sqrt{\frac{2n+3}{2n-1}\frac{(n-m+1)!}{(n+m+1)!}
                               \frac{(n+m-1)!}{(n-m-1)!}}
                           \frac{n+m}{n-m+1}P_{n-1}^m(\mu), \\
     & &
                    = \sqrt{\frac{2n+3}{2n+1}\frac{n-m+1}{n+m+1}}
                             \frac{2n+1}{n-m+1}\mu P_n^m(\mu) 
                     -\sqrt{\frac{2n+3}{2n-1}\frac{(n-m+1)(n-m)}{(n+m+1)(n+m)}}
                             \frac{n+m}{n-m+1}P_{n-1}^m(\mu),\\
     & &
                  = \sqrt{\frac{(2n+3)(2n+1)}{(n-m+1)(n+m+1)}} \mu P_n^m(\mu) 
                       -\sqrt{\frac{(2n+3)(n+m)(n-m)}{(2n-1)(n+m+1)(n-m+1)}}
                             P_{n-1}^m(\mu).
     \end{eqnarray*}
   }
   \begin{equation}
     P_{n+1}^m(\mu)  = \sqrt{\frac{(2n+3)(2n+1)}{(n-m+1)(n+m+1)}}\mu P_n^m(\mu)
                       -\sqrt{\frac{(2n+3)(n+m)(n-m)}{(2n-1)(n+m+1)(n-m+1)}}
                             P_{n-1}^m(\mu).
  \end{equation}
  %
  低次のルジャンドル陪函数は
  %
  \begin{eqnarray}
    & & P_1^0(\mu) = \sqrt{3}\mu, \quad
        P_1^1(\mu) = \sqrt{\frac{3}{2}}\sqrt{1-\mu^2}
                   = \frac{\sqrt{6}}{2}\sqrt{1-\mu^2}, \\
    & & P_2^0(\mu) = \frac{\sqrt{5}}{2}(3\mu^2-1) , \quad
        P_2^1(\mu) = \sqrt{\frac{5}{6}}3\mu\sqrt{1-\mu^2}, \quad
                   = \sqrt{\frac{30}{2}}\mu\sqrt{1-\mu^2}, \\
    & & P_2^2(\mu) = \sqrt{\frac{5}{24}}3(1-\mu^2)
                   = \frac{\sqrt{120}}{24}3(1-\mu^2)
                   = \frac{\sqrt{30}}{4}(1-\mu^2).
  \end{eqnarray}
  %
  積分
  %
  \begin{equation}
    \int_{-1}^1 \{P_n^m(\mu)\}^2 d\mu = 2.
  \end{equation}



\section{補間の計算}

  今, 関数 $g(\lambda,\mu)$ の球面調和関数変換 $s_n^m$ が与えられたとき
  任意の点$(\lambda,\mu)$における関数の値を
  Clenshow's Recurrence Formula 
    \footnote{Clenshow's Recurrence Formula:\\
      関数 $f(x)$ がとある関数系 $F_k(x)$ で 
      %
      \begin{displaymath}
        f(x)=\sum_0^N c_k F_k(x)
      \end{displaymath}
      %
      と表されているとする. さらに関数系が次の漸化式
      %
      \begin{displaymath}
        F_{n+1}(x)=\alpha(n,x)F_n(x)+\beta(n,x)F_{n-1}(x)
      \end{displaymath}
      %
      を満たしているとする. このとき漸化式 
      \begin{displaymath}
        y_{N+2}=y_{N+1}=0, \quad
        y_k = \alpha(k,x)y_{k+1} + \beta(k+1,x)y_{k+2} + c_k
      \end{displaymath}
      %
      で定義される量 $y_k, (k=N,N-1,\ldots,m)$ を用いると
      $f(x)$ を求めるための関数系の和は
      %
      \begin{displaymath}
        f(x) = \beta(m+1,x)F_m(x)y_{m+2} + F_{m+1}(x)y_{m+1} + F_m(x) c_m
      \end{displaymath}
      %
      と計算することができる. \\

      ☆「証明」\\
      $y_k$ に関する漸化式を $c_k$ について解き, $f(x)$ の式に代入すると
      \begin{eqnarray*}
        f(x) &=& \sum_0^N c_k F_k(x)\\
             &=& y_N F_N(x) \\
             & & + [y_{N-1}-\alpha(N-1,x)y_N]F_{N-1}(x) \\
             & & + [y_{N-2}-\alpha(N-2,x)y_{N-1}-\beta(N-1,x)y_{N}]F_{N-2}(x)\\
             & & + [y_{N-3}-\alpha(N-3,x)y_{N-2}-\beta(N-2,x)y_{N-1}]F_{N-3}(x)\\
             & & \ldots\\
             & & + [y_{m+2}-\alpha(m+2,x)y_{m+3}-\beta(m+3,x)y_{m+4}]F_{m+2}(x)\\
             & & + [y_{m+1}-\alpha(m+1,x)y_{m+2}-\beta(m+2,x)y_{m+3}]F_{m+1}(x)\\
             & & + [c_m+\beta(m+1,x)y_{m+2}-\beta(m+1,x)y_{m+2}]F_m(x)
      \end{eqnarray*}
      %
      最後の項だけ $c_0$ のまま残し, $\beta(1,x)y_2$ をわざと足し引きしている.
      各 $y_k$ について整理すると
      %
      \begin{eqnarray*}
        f(x) &=& y_N[F_N-\alpha(N-1,x)F_{N-1}-\beta(N-1,x)F_{N-2}]\\
             & & +y_{N-1}[F_{N-1}-\alpha(N-2,x)F_{N-2}-\beta(N-2,x)F_{N-3}]\\
             & & \ldots\\
             & & + y_{m+2}[F_{m+2}-\alpha(m+1,x)F_{m+1}-\beta(m+1,x)F_m]\\
             & & + y_{m+1}F_{m+1}+c_mF_m+\beta(m+1,x)y_{m+2}F_m
      \end{eqnarray*}
      %
      $F_k(x)$ の漸化式より $k=N,N-1,\ldots,2$ まではキャンセルし, 
      残りの項は最後の行だけになる. したがって
      %
      \begin{displaymath}
        f(x) = \beta(m+1,x)y_{m+2}F_m + y_{m+1}F_{m+1} + c_mF_m
      \end{displaymath}
    }
  を用いて計算する. 

  三角波数切断の場合 $M=N$ を考えて, 
  %
  \begin{eqnarray}
    g(\lambda,\mu)
   &=& \sum_{m=-M}^{M} \sum_{n=0}^M s_n^m P_n^m(\mu)\exp(im\lambda)
        \nonumber\\
   &=&  \sum_{n=0}^M s_n^0 P_n^0(\mu)
      + \sum_{m=1}^{M} \sum_{n=0}^M 
        (s_n^m P_n^m(\mu)\exp(im\lambda)+s_n^{-m} P_n^m(\mu)\exp(-im\lambda))
        \nonumber\\
   &=& \sum_{n=0}^M s_n^0 P_n^0(\mu)
      +\sum_{m=1}^{M} \sum_{n=|m|}^M
       (Re[s_n^m] P_n^m(\mu)\cos(m\lambda)-Im[s_n^m] P_n^m(\mu)\sin(m\lambda)) 
       \nonumber\\
   & & +(Re[s_n^{-m}]
         P_n^m(\mu)\cos(m\lambda)+Im[s_n^{-m}]P_n^m(\mu)\sin(m\lambda))
       \nonumber\\
   & & +i(Im[s_n^m] P_n^m(\mu)\cos(m\lambda)+Re[s_n^m] P_n^m(\mu)\sin(m\lambda))
       \nonumber\\
   & & +i(Im[s_n^{-m}] P_n^m(\mu)\cos(m\lambda)-Re[s_n^{-m}] P_n^m(\mu)\sin(m\lambda))
       \nonumber\\
   &=& \sum_{n=0}^M s_n^0 P_n^0(\mu)
      +\sum_{m=1}^{M} \sum_{n=|m|}^M
       (Re[s_n^m] P_n^m(\mu)\cos(m\lambda)-Im[s_n^m] P_n^m(\mu)\sin(m\lambda)) 
       \nonumber\\
   & & +(Re[s_n^m]
         P_n^m(\mu)\cos(m\lambda)-Im[s_n^m]P_n^m(\mu)\sin(m\lambda))
       \nonumber\\
   & & +i(Im[s_n^m] P_n^m(\mu)\cos(m\lambda)+Re[s_n^m] P_n^m(\mu)\sin(m\lambda))
       \nonumber\\
   & & +i(-Im[s_n^m] P_n^m(\mu)\cos(m\lambda)-Re[s_n^m] P_n^m(\mu)\sin(m\lambda))
       \nonumber\\
   &=& \sum_{n=0}^M s_n^0 P_n^0(\mu)
      +\sum_{m=1}^{M} \sum_{n=|m|}^M
       (2Re[s_n^m] P_n^m(\mu)\cos(m\lambda)-2Im[s_n^m] P_n^m(\mu)\sin(m\lambda)).
  \end{eqnarray}
  %
  ただしスペクトル係数の関係式 $(s_n^-m)^* = s_n^m$ より
  $Re[s_n^{-m}]=Re[s_n^m], Im[s_n^{-m}]=-Im[s_n^m]$ を用いた. 
  $n$ についての和は Clenshow's Recurrence Formula 
  で計算できる. 
  漸化式から
  \begin{displaymath}
    \alpha(n,m,x)=\sqrt{\frac{(2n+3)(2n+1)}{(n-m+1)(n+m+1)}}x, \quad
    \beta(n,m)=-\sqrt{\frac{(2n+3)(n+m)(n-m)}{(2n-1)(n+m+1)(n-m+1)}}
  \end{displaymath}
  とおいて, 
  $\Ddsty f_m(\mu)=\sum_{n=m}^M a_n^m P_n^m(\mu)$ は
  %
  \begin{eqnarray}
    & & y_{K+2}=y_{K+1} = 0, \nonumber\\
    & & y_{k} = \alpha(k,m,\mu) y_{k+1} 
              + \beta(k+1,m) y_{k+2} + a_k^m, \quad (k=K,K-1,\ldots,m+1),\\
    & & f_m(\mu) = \beta(m+1,m) y_{m+2} P_m^m(\mu)
                + P_{m+1}^m(\mu) y_{m+1} + a_m^m P_m^m(\mu) \nonumber\\
    & &         =  \beta(m+1,m)y_{m+2} P_m^m(\mu)
                + \mu\sqrt{2m+3}P_m^m(\mu) y_{m+1} 
                + a_m^m P_m^m(\mu)\nonumber\\
    & &         = \left[a_m^m+\beta(m+1,m)y_{m+2} 
                     + \mu\sqrt{2m+3}y_{m+1} \right]P_m^m(\mu).
  \end{eqnarray}
  %
  ただし $\Ddsty P_m^m(\mu) =\frac{\sqrt{(2m+1)!}}{2^m m!}(1-\mu^2)^{m/2}$ 
  と計算することができる. 
  $\Ddsty\sum_{n=m}^M b_n^m P_n^m(\mu)$ の和も同様に計算できる. 
  $\Ddsty\sum_{n=0}^M a_n^0P_n^0(\mu)$ の場合は
  $\Ddsty f_0(\mu)=\sum_{n=0}^M a_n^0 P_n^0(\mu)$ は
  %
  \begin{eqnarray}
    & & y_{K+2}=y_{K+1} = 0, \nonumber\\
    & & y_{k} = \alpha(k,0,\mu) y_{k+1} 
              + \beta(k+1,0)y_{k+2} + a_k^0, \quad (k=K,K-1,\ldots,1),\\
    & & f_0(\mu) = \beta(1,0)y_2 P_m^m(\mu)
                + P_1^0(\mu) y_1 + a_0^0 P_0^0(\mu)
                = \beta(1,0)y_2 + \sqrt{3}\mu y_1 + a_0^0
  \end{eqnarray}


\section{エネルギー・エンストロフィースペクトルの計算}

  今, 流線関数 $\psi(\lambda,\varphi)$ の球面調和函数展開係数 
  $s_n^m$ が与えられたとき全エネルギー $E$
  次のように計算される. 
  %
  \begin{eqnarray}
    E &=& \int_0^{2\pi}\int_{-\pi/2}^{\pi/2}
           \left[ \DP[][]{\psi}{\varphi}^2 
                    + \frac{1}{\cos^2\varphi}\DP[][]{\psi}{\lambda}^2
                  \right] \cos\varphi d\varphi d\lambda 
         \nonumber \\
      &=& \frac{1}{2}\left\{ 
           \int_0^{2\pi}\left[
                          \psi\cos\varphi\DP[][]{\psi}{\varphi} 
                        \right]_{-\pi/2}^{\pi/2} d\lambda
          -\int_0^{2\pi}\int_{-\pi/2}^{\pi/2}
                    \psi\frac{1}{\cos\varphi}
                     \DP{}{\psi}\left(\cos\varphi\DP{\psi}{\varphi}\right)
              \cos\varphi d\varphi d\lambda \right.
         \nonumber \\
      & & \left. 
         +\int_{-\pi/2}^{\pi/2}
             \left[
                \frac{\psi}{\cos^2\varphi}\DP[][]{\psi}{\lambda}
             \right]_0^{2\pi} \cos\varphi d\varphi
         - \int_0^{2\pi}\int_{-\pi/2}^{\pi/2}
                \frac{\psi}{\cos^2\varphi}\DP[2]{\psi}{\lambda}
                 \cos\varphi d\varphi d\lambda \right\}
         \nonumber \\
      &=&\frac{1}{2}\left\{ 
          -\int_0^{2\pi}\int_{-\pi/2}^{\pi/2}
              \left[ \psi\frac{1}{\cos\varphi}
                     \DP{}{\psi}\left(\cos\varphi\DP{\psi}{\varphi}\right)\right]
              \cos\varphi d\varphi d\lambda \right.
         \nonumber \\
      & & \left.
          - \int_0^{2\pi}\int_{-\pi/2}^{\pi/2}
                \frac{1}{\cos^2\varphi}\DP[2]{\psi}{\lambda}
                 \cos\varphi d\varphi d\lambda \right\}
         \nonumber \\
      &=& \frac{1}{2}\left\{ 
          -\int_0^{2\pi}\int_{-\pi/2}^{\pi/2} \psi
              \left[ \frac{1}{\cos\varphi}
                     \DP{}{\psi}\left(\cos\varphi\DP{\psi}{\varphi}\right)
                    + \frac{\psi}{\cos^2\varphi}\DP[2]{\psi}{\lambda}
               \right]
              \cos\varphi d\varphi d\lambda \right\}
         \nonumber \\
      &=& -\frac{1}{2}
           \int_0^{2\pi}\int_{-\pi/2}^{\pi/2} \psi \Dlapla\psi
              \cos\varphi d\varphi d\lambda. 
  \end{eqnarray}
  %
  ここで, 球面調和函数展開係数を用いると
  %
  \begin{equation}
    \psi = \sum_{n=0}^M\sum_{m=-n}^n
               s_n^m P_n^m(\sin\varphi)\exp(im\lambda)
  \end{equation}
  %
  であるから, 
  \begin{eqnarray}
    E &=& -\frac{1}{2}
           \int_0^{2\pi}\int_{-\pi/2}^{\pi/2} \psi \Dlapla\psi
              \cos\varphi d\varphi d\lambda
         \nonumber \\
      &=& \frac{1}{2}
         \int_0^{2\pi}\int_{-\pi/2}^{\pi/2} 
          \left[\sum_{n=0}^M\sum_{m=-n}^n
               s_n^m P_n^m(\sin\varphi)\exp(im\lambda)
          \right]
         \nonumber \\
      & & \left[\sum_{n'=0}^M\sum_{m'=-{n'}}^{n'}
               n'(n'+1)s_{n'}^{m'}P_{n'}^{m'}(\sin\varphi)\exp(im'\lambda)
          \right]
              \cos\varphi d\varphi d\lambda
         \nonumber \\
      &=& \frac{1}{2}
         \int_0^{2\pi}\int_{-\pi/2}^{\pi/2} 
          \sum_{n=0}^M\sum_{m=-n}^n\sum_{n'=0}^M\sum_{m'=-n'}^{n'}\nonumber \\
      & &      n'(n'+1)s_{n'}^{m'} s_n^m 
               P_n^m(\sin\varphi)P_{n'}^{m'}(\sin\varphi)
               \exp(im'\lambda)\exp(im\lambda)
              \cos\varphi d\varphi d\lambda
         \nonumber \\
      &=& \frac{1}{2}
         \int_{-\pi/2}^{\pi/2} 
          \sum_{n=0}^M\sum_{m=-n}^n\sum_{n'=0}^M\sum_{m'=-n'}^{n'}\nonumber \\
      & &      n'(n'+1)s_{n'}^{m'} s_n^m 
               P_n^m(\sin\varphi)P_{n'}^{m'}(\sin\varphi)
              \cos\varphi d\varphi \delta_{m,-m'} 2\pi
          \nonumber \\
      &=& \pi
          \sum_{n=0}^M\sum_{m=-n}^n\sum_{n'=0}^M
           n'(n'+1)s_{n'}^{-m} s_n^m 
           \int_{-\pi/2}^{\pi/2} 
               P_n^m(\sin\varphi)P_{n'}^{-m}(\sin\varphi)
              \cos\varphi d\varphi 
          \nonumber \\
      &=& \pi
          \sum_{n=0}^M\sum_{m=-n}^n\sum_{n'=0}^M
           n'(n'+1)s_{n'}^{-m} s_n^m 2\delta_{n,n'} \nonumber \\
      &=& 2\pi
          \sum_{n=0}^M\sum_{m=-n}^n
           n(n+1)s_{n}^{-m} s_n^m  \nonumber \\
      &=& 2\pi
          \sum_{n=0}^M\sum_{m=-n}^n
           n(n+1)(s_{n}^{m})^* s_n^m  \nonumber \\
      &=& 2\pi
          \sum_{n=0}^M\sum_{m=-n}^n n(n+1)|s_n^m|^2\\
      &=& 4\pi\cdot \frac{1}{2}
          \sum_{n=0}^M\sum_{m=-n}^n n(n+1)(Re[s_n^m]^2+Im[s_n^m]^2)\\
      &=& 4\pi\cdot \frac{1}{2}
          \sum_{n=0}^M\sum_{m=-n}^n n(n+1)|s_n^m|^2.
  \end{eqnarray}
  %
  途中, 元の関数が実数であることからでてくる $s_n^{-m} = (s_{n}^{m})^*$ を
  用いた. 
  これより全エネルギーを $(n,m)$ 各成分にわけることができて, 
  $\Ddsty\frac{1}{2} n(n+1) |s_n^m|^2$ を
  エネルギースペクトルの $(n,m)$ 成分という. 
  また $m$ について和をとった各成分
  $\Ddsty\frac{1}{2}\sum_{m=-n}^n n(n+1)|s_n^m|^2$
  をエネルギースペクトルの $n$ 成分と呼ぶ. 

  同じような計算を全エンストロフィーにも行うことができる. 
  %
  \begin{eqnarray}
    Q &=& \frac{1}{2}
           \int_0^{2\pi}\int_{-\pi/2}^{\pi/2} (\Dlapla\psi)^2
              \cos\varphi d\varphi d\lambda
         \nonumber \\
      &=& \frac{1}{2}
         \int_0^{2\pi}\int_{-\pi/2}^{\pi/2} 
          \left[\sum_{n=0}^M\sum_{m=-n}^n
               n(n+1)s_n^m P_n^m(\sin\varphi)\exp(im\lambda)
          \right]
         \nonumber \\
      & & \left[\sum_{n'=0}^M\sum_{m'=-{n'}}^{n'}
               n'(n'+1)s_{n'}^{m'}P_{n'}^{m'}(\sin\varphi)\exp(im'\lambda)
          \right]
              \cos\varphi d\varphi d\lambda
         \nonumber \\
      &=& \frac{1}{2}
         \int_0^{2\pi}\int_{-\pi/2}^{\pi/2} 
          \sum_{n=0}^M\sum_{m=-n}^n\sum_{n'=0}^M\sum_{m'=-n'}^{n'}\nonumber \\
      & &      n(n+1)n'(n'+1)s_{n'}^{m'} s_n^m 
               P_n^m(\sin\varphi)P_{n'}^{m'}(\sin\varphi)
               \exp(im'\lambda)\exp(im\lambda)
              \cos\varphi d\varphi d\lambda
         \nonumber \\
      &=& \frac{1}{2}
         \int_{-\pi/2}^{\pi/2} 
          \sum_{n=0}^M\sum_{m=-n}^n\sum_{n'=0}^M\sum_{m'=-n'}^{n'}\nonumber \\
      & &      n(n+1)n'(n'+1)s_{n'}^{m'} s_n^m 
               P_n^m(\sin\varphi)P_{n'}^{m'}(\sin\varphi)
              \cos\varphi d\varphi \delta_{m,-m'} 2\pi
          \nonumber \\
      &=& \pi
          \sum_{n=0}^M\sum_{m=-n}^n\sum_{n'=0}^M
           n(n+1)n'(n'+1)s_{n'}^{-m} s_n^m 
           \int_{-\pi/2}^{\pi/2} 
               P_n^m(\sin\varphi)P_{n'}^{-m}(\sin\varphi)
              \cos\varphi d\varphi 
          \nonumber \\
      &=& \pi
          \sum_{n=0}^M\sum_{m=-n}^n\sum_{n'=0}^M
           n(n+1)n'(n'+1)s_{n'}^{-m} s_n^m 2\delta_{n,n'} \nonumber \\
      &=& 2\pi
          \sum_{n=0}^M\sum_{m=-n}^n
           n^2(n+1)^2s_{n}^{-m} s_n^m  \nonumber \\
      &=& 2\pi
          \sum_{n=0}^M\sum_{m=-n}^n
           n^2(n+1)^2(s_{n}^{m})^* s_n^m  \nonumber \\
      &=& 2\pi
          \sum_{n=0}^M\sum_{m=-n}^n n^2(n+1)^2|s_n^m|^2\\
      &=& 4\pi\cdot \frac{1}{2}
          \sum_{n=0}^M\sum_{m=-n}^n n^2(n+1)^2(Re[s_n^m]^2+Im[s_n^m]^2)\\
      &=& 4\pi\cdot \frac{1}{2}
          \sum_{n=0}^M\sum_{m=-n}^n n^2(n+1)^2|s_n^m|^2.
  \end{eqnarray}
  %
  これより全エンストロフィーを $(n,m)$ 各成分にわけることができて, 
  $\Ddsty\frac{1}{2} n^2(n+1)^2 |s_n^m|^2$ を
  エンストロフィースペクトルの $(n,m)$ 成分と呼ぶ. 
  また, $\Ddsty\frac{1}{2}\sum_{m=-n}^n n^2(n+1)^2|s_n^m|^2$
  エンストロフィースペクトルの $n$ 成分と呼ぶ.

\end{document}

%%% Local Variables: 
%%% mode: latex
%%% TeX-master: t
%%% End: 
