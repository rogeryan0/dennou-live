<?xml version="1.0" encoding="euc-jp"?>
<!DOCTYPE html
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>Class: wa_spectrum_module</title>
  <meta http-equiv="Content-Type" content="text/html; charset=euc-jp" />
  <meta http-equiv="Content-Script-Type" content="text/javascript" />
  <link rel="stylesheet" href=".././rdoc-style.css" type="text/css" media="screen" />
  <script type="text/javascript">
  // <![CDATA[

  function popupCode( url ) {
    window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
  }

  function toggleCode( id ) {
    if ( document.getElementById )
      elem = document.getElementById( id );
    else if ( document.all )
      elem = eval( "document.all." + id );
    else
      return false;

    elemStyle = elem.style;

    if ( elemStyle.display != "block" ) {
      elemStyle.display = "block"
    } else {
      elemStyle.display = "none"
    }

    return true;
  }

  // Make codeblocks hidden by default
  document.writeln( "<style type=\"text/css\">div.method-source-code { display: none }</style>" )

  // ]]>
  </script>

</head>
<body>


    <div id="classHeader">
        <table class="header-table">
        <tr class="top-aligned-row">
          <td><strong>Class</strong></td>
          <td class="class-name-in-header">wa_spectrum_module</td>
        </tr>
        <tr class="top-aligned-row">
            <td><strong>In:</strong></td>
            <td>


                <a href="../files/src/wa_spectrum_module_f90.html">

                src/wa_spectrum_module.f90

                </a>


        <br />
            </td>
        </tr>


        </table>
    </div>
  <!-- banner header -->

  <div id="bodyContent">


  <div id="contextContent">



    <div id="description">
      <h1><a href="wa_spectrum_module.html">wa_spectrum_module</a></h1>
<table>
<tr><td valign="top">Authors:</td><td>Shin-ichi Takehiro, Youhei SASAKI

</td></tr>
<tr><td valign="top">Version:</td><td>$Id: <a
href="../files/src/wa_spectrum_module_f90.html">wa_spectrum_module.f90</a>,v
1.6 2009-02-28 21:33:48 uwabami Exp $

</td></tr>
<tr><td valign="top">Copyright&amp;License:</td><td>See <a href="../../COPYRIGHT">COPYRIGHT</a>

</td></tr>
</table>
<h2>概要</h2>
<p>
spml/wa_spectrum_module モジュールは球面上での流体運動を
球面調和函数を用いたスペクトル法によって数値計算するための モジュール <a
href="wa_module.html">wa_module</a> の下部モジュールであり,
スペクトル解析計算のための Fortran90 関数を提供する.
</p>
<p>
球面上の 1 層モデル用 <a
href="w_spectrum_module.html">w_spectrum_module</a>
モジュールを多層モデル用に 拡張したものであり,
同時に複数個のスペクトルデータ, 格子点データに 対する変換が行える.
</p>
<p>
内部で ISPACK の SPPACK と SNPACK の Fortran77 サブルーチンを呼んでいる.
スペクトルデータおよび格子点データの格納方法や変換の詳しい計算法に ついては
ISPACK/SNPACK,SPPACK のマニュアルを参照されたい.
</p>

    </div>





   </div>


    <div id="method-list">
      <h3 class="section-bar">Methods</h3>

      <div class="name-list">

        <a href="#M000865">na_EnergyFromStreamfunc_wa</a>&nbsp;&nbsp;

        <a href="#M000867">na_EnstrophyFromStreamfunc_wa</a>&nbsp;&nbsp;

        <a href="#M000864">nma_EnergyFromStreamfunc_wa</a>&nbsp;&nbsp;

        <a href="#M000866">nma_EnstrophyFromStreamfunc_wa</a>&nbsp;&nbsp;

        <a href="#M000863">wa_spectrum_VMiss</a>&nbsp;&nbsp;
      </div>
    </div>


  </div>


    <!-- if includes -->

    <div id="includes">
      <h3 class="section-bar">Included Modules</h3>

      <div id="includes-list">

        <span class="include-name"><a href="w_base_module.html">w_base_module</a></span>
      </div>
    </div>



    <div id="section">










      


    <!-- if method_list -->

    <div id="methods">


      <h3 class="section-bar">Public Instance methods</h3>


      <div id="method-M000865" class="method-detail">
        <a name="M000865"></a>

        <div class="method-heading">


          <a href="#M000865" class="method-signature">



          <span class="method-name">na_EnergyFromStreamfunc_wa</span><span class="method-args">( wa_Strfunc ) result(na_EnergyFromStreamfunc_wa)</span>



          </a>

        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wa_spectrum_module.html#M000865">na_EnergyFromStreamfunc_wa</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:nm,size(wa_Strfunc,2))</tt>

<table>
<tr><td valign="top"> :</td><td> (out) エネルギースペクトル (水平全波数 n 空間)

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>wa_Strfunc(:,:)  </tt></b>  <tt> </tt> :</td><td><tt>real(8), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 流線関数(スペクトルデータ)

</td></tr>
</table>
</td></tr>
</table>
<p>
流線関数のスペクトルデータから各全波数のエネルギー成分(スペクトル)を
計算する(多層用).
</p>
<pre>
 * 全波数 n の流線関数のスペクトル成分ψ(n,m) から
   エネルギースペクトルはΣ[m=-nm]^nm(1/2)n(n+1)ψ(n,m)^2
   と計算される.

 * 全てのエネルギースペクトル成分の和に 4πをかけたものが
   球面上での全エネルギーに等しい.
</pre>


          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000865-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000865-source">
<pre>
    function na_EnergyFromStreamfunc_wa(wa_Strfunc)
      !
      ! 流線関数のスペクトルデータから各全波数のエネルギー成分(スペクトル)を
      ! 計算する(多層用).
      !
      !  * 全波数 n の流線関数のスペクトル成分ψ(n,m) から
      !    エネルギースペクトルはΣ[m=-nm]^nm(1/2)n(n+1)ψ(n,m)^2 
      !    と計算される.
      !
      !  * 全てのエネルギースペクトル成分の和に 4πをかけたものが
      !    球面上での全エネルギーに等しい.
      !
      real(8), intent(in)   :: wa_Strfunc(:,:)
      !(in) 流線関数(スペクトルデータ)

      real(8), dimension(0:nm,size(wa_Strfunc,2)) :: na_EnergyFromStreamfunc_wa
      !(out) エネルギースペクトル (水平全波数 n 空間) 

      do n=0,nm
         na_EnergyFromStreamfunc_wa(n,:) = 0.5 * n*(n+1) * sum(wa_StrFunc(l_nm(n,(/(m,m=-n,n)/)),:)**2,1)
      enddo

    end function na_EnergyFromStreamfunc_wa
</pre>
          </div>

        </div>
      </div>


      <div id="method-M000867" class="method-detail">
        <a name="M000867"></a>

        <div class="method-heading">


          <a href="#M000867" class="method-signature">



          <span class="method-name">na_EnstrophyFromStreamfunc_wa</span><span class="method-args">( wa_Strfunc ) result(na_EnstrophyFromStreamfunc_wa)</span>



          </a>

        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wa_spectrum_module.html#M000867">na_EnstrophyFromStreamfunc_wa</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:nm,size(wa_Strfunc,2))</tt>

<table>
<tr><td valign="top"> :</td><td> エンストロフィースペクトル (out) エンストロフィースペクトル(水平全波数 n
空間)

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>wa_Strfunc(:,:)  </tt></b>  <tt> </tt> :</td><td><tt>real(8), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 流線関数(スペクトルデータ)

</td></tr>
</table>
</td></tr>
</table>
<p>
流線関数のスペクトルデータから各全波数のエネルギー成分(スペクトル)を
計算する(多層用)
</p>
<ul>
<li>全波数 n の流線関数のスペクトル成分ψ(n,m) からエンストロフィー
スペクトルはΣ[m=-nm]^nm(1/2)n^2(n+1)^2ψ(n,m)^2 と計算される.

</li>
<li>全てのエネルギースペクトル成分の和に 4π/R^2 をかけたものが
球面上での全エンストフィーに等しい.

</li>
</ul>


          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000867-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000867-source">
<pre>
    function na_EnstrophyFromStreamfunc_wa(wa_Strfunc)  ! 
      !
      ! 流線関数のスペクトルデータから各全波数のエネルギー成分(スペクトル)を
      ! 計算する(多層用)
      !
      ! * 全波数 n の流線関数のスペクトル成分ψ(n,m) からエンストロフィー
      !   スペクトルはΣ[m=-nm]^nm(1/2)n^2(n+1)^2ψ(n,m)^2 と計算される.
      !    
      ! * 全てのエネルギースペクトル成分の和に 4π/R^2 をかけたものが
      !   球面上での全エンストフィーに等しい.
      !
      real(8), intent(in)   :: wa_Strfunc(:,:)
      !(in) 流線関数(スペクトルデータ)

      real(8), dimension(0:nm,size(wa_Strfunc,2)) :: na_EnstrophyFromStreamfunc_wa      ! エンストロフィースペクトル
      !(out) エンストロフィースペクトル(水平全波数 n 空間)

      do n=0,nm
         na_EnstrophyFromStreamfunc_wa(n,:) = 0.5 * n**2 * (n+1)**2 * sum(wa_StrFunc(l_nm(n,(/(m,m=-n,n)/)),:)**2,1)
      enddo

    end function na_EnstrophyFromStreamfunc_wa
</pre>
          </div>

        </div>
      </div>


      <div id="method-M000864" class="method-detail">
        <a name="M000864"></a>

        <div class="method-heading">


          <a href="#M000864" class="method-signature">



          <span class="method-name">nma_EnergyFromStreamfunc_wa</span><span class="method-args">( wa_Strfunc ) result(nma_EnergyFromStreamfunc_wa)</span>



          </a>

        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wa_spectrum_module.html#M000864">nma_EnergyFromStreamfunc_wa</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:nm,-nm:nm,size(wa_Strfunc,2))</tt>

<table>
<tr><td valign="top"> :</td><td> (out) エネルギースペクトル(水平全波数 n, 帯状波数 m 空間)

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>wa_Strfunc(:,:)  </tt></b>  <tt> </tt> :</td><td><tt>real(8), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 流線関数(スペクトルデータ)

</td></tr>
</table>
</td></tr>
</table>
<p>
流線関数のスペクトルデータからエネルギーの球面調和函数成分
(スペクトル)を計算する(多層用).
</p>
<pre>
 * 全波数 n, 帯状波数 m の流線関数のスペクトル成分ψ(n,m) から
   エネルギースペクトルは (1/2)n(n+1)ψ(n,m)^2 と計算される.

 * 全てのエネルギースペクトル成分の和に4πをかけたものが球面上での
   全エネルギーに等しい.

 * データの存在しない全波数 n, 帯状波数 m の配列には欠損値が格納される.
   欠損値の値はモジュール変数 w_spectrum_VMiss によって設定できる
   (初期値は -999.0)
</pre>


          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000864-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000864-source">
<pre>
    function nma_EnergyFromStreamfunc_wa(wa_Strfunc)
      ! 
      ! 流線関数のスペクトルデータからエネルギーの球面調和函数成分
      ! (スペクトル)を計算する(多層用).
      !
      !  * 全波数 n, 帯状波数 m の流線関数のスペクトル成分ψ(n,m) から
      !    エネルギースペクトルは (1/2)n(n+1)ψ(n,m)^2 と計算される.
      !
      !  * 全てのエネルギースペクトル成分の和に4πをかけたものが球面上での
      !    全エネルギーに等しい.
      !
      !  * データの存在しない全波数 n, 帯状波数 m の配列には欠損値が格納される.
      !    欠損値の値はモジュール変数 w_spectrum_VMiss によって設定できる
      !    (初期値は -999.0)
      !
      real(8), intent(in)   :: wa_Strfunc(:,:)
      !(in) 流線関数(スペクトルデータ)

      real(8), dimension(0:nm,-nm:nm,size(wa_Strfunc,2)) :: nma_EnergyFromStreamfunc_wa
      !(out) エネルギースペクトル(水平全波数 n, 帯状波数 m 空間)

      nma_EnergyFromStreamfunc_wa = wa_spectrum_VMiss

      do n=0,nm
         do m=-n,n
            nma_EnergyFromStreamfunc_wa(n,m,:) = 0.5 * n*(n+1) * wa_Strfunc(l_nm(n,m),:)**2
         enddo
      enddo
    end function nma_EnergyFromStreamfunc_wa
</pre>
          </div>

        </div>
      </div>


      <div id="method-M000866" class="method-detail">
        <a name="M000866"></a>

        <div class="method-heading">


          <a href="#M000866" class="method-signature">



          <span class="method-name">nma_EnstrophyFromStreamfunc_wa</span><span class="method-args">( wa_Strfunc ) result(nma_EnstrophyFromStreamfunc_wa)</span>



          </a>

        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wa_spectrum_module.html#M000866">nma_EnstrophyFromStreamfunc_wa</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:nm,-nm:nm,size(wa_Strfunc,2))</tt>

<table>
<tr><td valign="top"> :</td><td> エンストロフィースペクトル (水平全波数 n, 帯状波数 m 空間)

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>wa_Strfunc(:,:)  </tt></b>  <tt> </tt> :</td><td><tt>real(8), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 流線関数(スペクトルデータ)

</td></tr>
</table>
</td></tr>
</table>
<p>
流線関数のスペクトルデータからエンストロフィーの球面調和函数成分
(スペクトル)を計算する(多層用).
</p>
<ul>
<li>全波数 n, 帯状波数 m の流線関数のスペクトル成分ψ(n,m) から

<pre>
 エンストロフィースペクトルは (1/2)n^2(n+1)^2ψ(n,m)^2 と計算される.
</pre>
</li>
<li>全てのエンストロフィースペクトル成分の和に4π/R^2をかけたものが
球面上での全エンストロフィーに等しい. ここで R は球面の半径である.

</li>
<li>データの存在しない全波数 n, 帯状波数 m の配列には欠損値が格納される.
欠損値の値はモジュール変数 w_spectrum_VMiss によって設定できる (初期値は
-999.0)

</li>
</ul>


          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000866-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000866-source">
<pre>
    function nma_EnstrophyFromStreamfunc_wa(wa_Strfunc)  ! 
      !
      ! 流線関数のスペクトルデータからエンストロフィーの球面調和函数成分
      ! (スペクトル)を計算する(多層用). 
      !
      ! * 全波数 n, 帯状波数 m の流線関数のスペクトル成分ψ(n,m) から
      !    エンストロフィースペクトルは (1/2)n^2(n+1)^2ψ(n,m)^2 と計算される.
      !
      ! * 全てのエンストロフィースペクトル成分の和に4π/R^2をかけたものが
      !   球面上での全エンストロフィーに等しい. ここで R は球面の半径である.
      !
      ! * データの存在しない全波数 n, 帯状波数 m の配列には欠損値が格納される.
      !   欠損値の値はモジュール変数 w_spectrum_VMiss によって設定できる
      !   (初期値は -999.0)
      !
      real(8), intent(in)   :: wa_Strfunc(:,:)
      !(in) 流線関数(スペクトルデータ)

      real(8), dimension(0:nm,-nm:nm,size(wa_Strfunc,2)) :: nma_EnstrophyFromStreamfunc_wa
      ! エンストロフィースペクトル (水平全波数 n, 帯状波数 m 空間)

      nma_EnstrophyFromStreamfunc_wa = wa_spectrum_VMiss

      do n=0,nm
         do m=-n,n
            nma_EnstrophyFromStreamfunc_wa(n,m,:) = 0.5 * n**2 * (n+1)**2 * wa_Strfunc(l_nm(n,m),:)**2

         enddo
      enddo
    end function nma_EnstrophyFromStreamfunc_wa
</pre>
          </div>

        </div>
      </div>


      <div id="method-M000863" class="method-detail">
        <a name="M000863"></a>

        <div class="method-heading">




          <span class="method-name">wa_spectrum_VMiss</span><span class="method-args"></span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em>Variable</em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wa_spectrum_module.html#M000863">wa_spectrum_VMiss</a>  </tt></b>  <tt> = -999.000 </tt> :</td><td><tt>real(8)</tt>

<table>
<tr><td valign="top"> :</td><td> 欠損値初期値

</td></tr>
</table>
</td></tr>
</table>


        </div>
      </div>



    </div>



  </div>

<div id="validator-badges">
  <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
</div>

</body>
</html>
