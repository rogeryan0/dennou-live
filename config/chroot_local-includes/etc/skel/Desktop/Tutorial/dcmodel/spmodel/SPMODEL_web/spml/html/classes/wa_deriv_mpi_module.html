<?xml version="1.0" encoding="euc-jp"?>
<!DOCTYPE html
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>Class: wa_deriv_mpi_module</title>
  <meta http-equiv="Content-Type" content="text/html; charset=euc-jp" />
  <meta http-equiv="Content-Script-Type" content="text/javascript" />
  <link rel="stylesheet" href=".././rdoc-style.css" type="text/css" media="screen" />
  <script type="text/javascript">
  // <![CDATA[

  function popupCode( url ) {
    window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
  }

  function toggleCode( id ) {
    if ( document.getElementById )
      elem = document.getElementById( id );
    else if ( document.all )
      elem = eval( "document.all." + id );
    else
      return false;

    elemStyle = elem.style;

    if ( elemStyle.display != "block" ) {
      elemStyle.display = "block"
    } else {
      elemStyle.display = "none"
    }

    return true;
  }

  // Make codeblocks hidden by default
  document.writeln( "<style type=\"text/css\">div.method-source-code { display: none }</style>" )

  // ]]>
  </script>

</head>
<body>


    <div id="classHeader">
        <table class="header-table">
        <tr class="top-aligned-row">
          <td><strong>Class</strong></td>
          <td class="class-name-in-header">wa_deriv_mpi_module</td>
        </tr>
        <tr class="top-aligned-row">
            <td><strong>In:</strong></td>
            <td>


                <a href="../files/src-mpi/wa_deriv_mpi_module_f90.html">

                src-mpi/wa_deriv_mpi_module.f90

                </a>


        <br />
            </td>
        </tr>


        </table>
    </div>
  <!-- banner header -->

  <div id="bodyContent">


  <div id="contextContent">



    <div id="description">
      <p>
<a href="wa_deriv_mpi_module.html">wa_deriv_mpi_module</a>
</p>
<pre>
 spml/wa_deriv_module モジュールは球面上での流体運動を
 球面調和函数を用いたスペクトル法と MPI 並列化によって
 数値計算するためのモジュール wa_mpi_module の下部モジュールであり,
 スペクトル法の微分計算のための Fortran90 関数を提供する.

 球面上の 1 層モデル用 w_deriv_mpi_module モジュールを多層モデル用に
 拡張したものであり, 同時に複数個のスペクトルデータ, 格子点データに
 対する変換が行える.

 内部で ISPACK の SPPACK と SNPACK の Fortran77 サブルーチンを呼んでいる.
 スペクトルデータおよび格子点データの格納方法や変換の詳しい計算法に
 ついては ISPACK/SNPACK,SPPACK のマニュアルを参照されたい.
</pre>

    </div>





   </div>


    <div id="method-list">
      <h3 class="section-bar">Methods</h3>

      <div class="name-list">

        <a href="#M000840">im</a>&nbsp;&nbsp;

        <a href="#M000838">im</a>&nbsp;&nbsp;

        <a href="#M000836">im</a>&nbsp;&nbsp;

        <a href="#M000839">im</a>&nbsp;&nbsp;

        <a href="#M000837">im</a>&nbsp;&nbsp;

        <a href="#M000835">im</a>&nbsp;&nbsp;

        <a href="#M000846">jm</a>&nbsp;&nbsp;

        <a href="#M000844">jm</a>&nbsp;&nbsp;

        <a href="#M000842">jm</a>&nbsp;&nbsp;

        <a href="#M000845">jm</a>&nbsp;&nbsp;

        <a href="#M000843">jm</a>&nbsp;&nbsp;

        <a href="#M000841">jm</a>&nbsp;&nbsp;

        <a href="#M000852">nm</a>&nbsp;&nbsp;

        <a href="#M000850">nm</a>&nbsp;&nbsp;

        <a href="#M000848">nm</a>&nbsp;&nbsp;

        <a href="#M000851">nm</a>&nbsp;&nbsp;

        <a href="#M000849">nm</a>&nbsp;&nbsp;

        <a href="#M000847">nm</a>&nbsp;&nbsp;

        <a href="#M000833">wa_DivLambda_xva</a>&nbsp;&nbsp;

        <a href="#M000828">wa_DivLat_xva</a>&nbsp;&nbsp;

        <a href="#M000827">wa_DivLon_xva</a>&nbsp;&nbsp;

        <a href="#M000834">wa_DivMu_xva</a>&nbsp;&nbsp;

        <a href="#M000829">wa_Div_xva_xva</a>&nbsp;&nbsp;

        <a href="#M000830">wa_JacobianMPI_wa_wa</a>&nbsp;&nbsp;

        <a href="#M000831">xva_GradLambda_wa</a>&nbsp;&nbsp;

        <a href="#M000826">xva_GradLat_wa</a>&nbsp;&nbsp;

        <a href="#M000825">xva_GradLon_wa</a>&nbsp;&nbsp;

        <a href="#M000832">xva_GradMu_wa</a>&nbsp;&nbsp;
      </div>
    </div>


  </div>


    <!-- if includes -->

    <div id="includes">
      <h3 class="section-bar">Included Modules</h3>

      <div id="includes-list">

        <span class="include-name">dc_message</span>

        <span class="include-name"><a href="w_base_module.html">w_base_module</a></span>

        <span class="include-name"><a href="w_base_mpi_module.html">w_base_mpi_module</a></span>

        <span class="include-name"><a href="wa_base_mpi_module.html">wa_base_mpi_module</a></span>

        <span class="include-name"><a href="w_deriv_mpi_module.html">w_deriv_mpi_module</a></span>
      </div>
    </div>



    <div id="section">










      


    <!-- if method_list -->

    <div id="methods">


      <h3 class="section-bar">Public Instance methods</h3>


      <div id="method-M000840" class="method-detail">
        <a name="M000840"></a>

        <div class="method-heading">




          <span class="method-name">im</span><span class="method-args"></span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em>Variable</em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wa_deriv_mpi_module.html#M000835">im</a>  </tt></b>  <tt> =64            </tt> :</td><td><tt>integer</tt>

<table>
<tr><td valign="top"> :</td><td> 格子点の設定(東西)

</td></tr>
</table>
</td></tr>
</table>
<p>
Original external subprogram is <a
href="w_deriv_mpi_module.html#M001385">w_deriv_mpi_module#im</a>
</p>


        </div>
      </div>


      <div id="method-M000838" class="method-detail">
        <a name="M000838"></a>

        <div class="method-heading">




          <span class="method-name">im</span><span class="method-args"></span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em>Variable</em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wa_deriv_mpi_module.html#M000835">im</a>  </tt></b>  <tt> =64            </tt> :</td><td><tt>integer</tt>

<table>
<tr><td valign="top"> :</td><td> 格子点の設定(東西)

</td></tr>
</table>
</td></tr>
</table>
<p>
Original external subprogram is <a
href="wa_base_mpi_module.html#M001664">wa_base_mpi_module#im</a>
</p>


        </div>
      </div>


      <div id="method-M000836" class="method-detail">
        <a name="M000836"></a>

        <div class="method-heading">




          <span class="method-name">im</span><span class="method-args"></span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em>Variable</em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wa_deriv_mpi_module.html#M000835">im</a>  </tt></b>  <tt> =64            </tt> :</td><td><tt>integer</tt>

<table>
<tr><td valign="top"> :</td><td> 格子点の設定(東西)

</td></tr>
</table>
</td></tr>
</table>
<p>
Original external subprogram is <a
href="w_base_mpi_module.html#M000196">w_base_mpi_module#im</a>
</p>


        </div>
      </div>


      <div id="method-M000839" class="method-detail">
        <a name="M000839"></a>

        <div class="method-heading">




          <span class="method-name">im</span><span class="method-args"></span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em>Variable</em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wa_deriv_mpi_module.html#M000835">im</a>  </tt></b>  <tt> =64            </tt> :</td><td><tt>integer</tt>

<table>
<tr><td valign="top"> :</td><td> 格子点の設定(東西)

</td></tr>
</table>
</td></tr>
</table>
<p>
Original external subprogram is <a
href="w_deriv_mpi_module.html#M001385">w_deriv_mpi_module#im</a>
</p>


        </div>
      </div>


      <div id="method-M000837" class="method-detail">
        <a name="M000837"></a>

        <div class="method-heading">




          <span class="method-name">im</span><span class="method-args"></span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em>Variable</em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wa_deriv_mpi_module.html#M000835">im</a>  </tt></b>  <tt> =64            </tt> :</td><td><tt>integer</tt>

<table>
<tr><td valign="top"> :</td><td> 格子点の設定(東西)

</td></tr>
</table>
</td></tr>
</table>
<p>
Original external subprogram is <a
href="wa_base_mpi_module.html#M001664">wa_base_mpi_module#im</a>
</p>


        </div>
      </div>


      <div id="method-M000835" class="method-detail">
        <a name="M000835"></a>

        <div class="method-heading">




          <span class="method-name">im</span><span class="method-args"></span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em>Variable</em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wa_deriv_mpi_module.html#M000835">im</a>  </tt></b>  <tt> =64            </tt> :</td><td><tt>integer</tt>

<table>
<tr><td valign="top"> :</td><td> 格子点の設定(東西)

</td></tr>
</table>
</td></tr>
</table>
<p>
Original external subprogram is <a
href="w_base_module.html#M001503">w_base_module#im</a>
</p>


        </div>
      </div>


      <div id="method-M000846" class="method-detail">
        <a name="M000846"></a>

        <div class="method-heading">




          <span class="method-name">jm</span><span class="method-args"></span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em>Variable</em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wa_deriv_mpi_module.html#M000841">jm</a>  </tt></b>  <tt> =32            </tt> :</td><td><tt>integer</tt>

<table>
<tr><td valign="top"> :</td><td> 格子点の設定(南北)

</td></tr>
</table>
</td></tr>
</table>
<p>
Original external subprogram is <a
href="w_deriv_mpi_module.html#M001387">w_deriv_mpi_module#jm</a>
</p>


        </div>
      </div>


      <div id="method-M000844" class="method-detail">
        <a name="M000844"></a>

        <div class="method-heading">




          <span class="method-name">jm</span><span class="method-args"></span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em>Variable</em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wa_deriv_mpi_module.html#M000841">jm</a>  </tt></b>  <tt> =32            </tt> :</td><td><tt>integer</tt>

<table>
<tr><td valign="top"> :</td><td> 格子点の設定(南北)

</td></tr>
</table>
</td></tr>
</table>
<p>
Original external subprogram is <a
href="wa_base_mpi_module.html#M001666">wa_base_mpi_module#jm</a>
</p>


        </div>
      </div>


      <div id="method-M000842" class="method-detail">
        <a name="M000842"></a>

        <div class="method-heading">




          <span class="method-name">jm</span><span class="method-args"></span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em>Variable</em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wa_deriv_mpi_module.html#M000841">jm</a>  </tt></b>  <tt> =32            </tt> :</td><td><tt>integer</tt>

<table>
<tr><td valign="top"> :</td><td> 格子点の設定(南北)

</td></tr>
</table>
</td></tr>
</table>
<p>
Original external subprogram is <a
href="w_base_mpi_module.html#M000197">w_base_mpi_module#jm</a>
</p>


        </div>
      </div>


      <div id="method-M000845" class="method-detail">
        <a name="M000845"></a>

        <div class="method-heading">




          <span class="method-name">jm</span><span class="method-args"></span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em>Variable</em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wa_deriv_mpi_module.html#M000841">jm</a>  </tt></b>  <tt> =32            </tt> :</td><td><tt>integer</tt>

<table>
<tr><td valign="top"> :</td><td> 格子点の設定(南北)

</td></tr>
</table>
</td></tr>
</table>
<p>
Original external subprogram is <a
href="w_deriv_mpi_module.html#M001387">w_deriv_mpi_module#jm</a>
</p>


        </div>
      </div>


      <div id="method-M000843" class="method-detail">
        <a name="M000843"></a>

        <div class="method-heading">




          <span class="method-name">jm</span><span class="method-args"></span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em>Variable</em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wa_deriv_mpi_module.html#M000841">jm</a>  </tt></b>  <tt> =32            </tt> :</td><td><tt>integer</tt>

<table>
<tr><td valign="top"> :</td><td> 格子点の設定(南北)

</td></tr>
</table>
</td></tr>
</table>
<p>
Original external subprogram is <a
href="wa_base_mpi_module.html#M001666">wa_base_mpi_module#jm</a>
</p>


        </div>
      </div>


      <div id="method-M000841" class="method-detail">
        <a name="M000841"></a>

        <div class="method-heading">




          <span class="method-name">jm</span><span class="method-args"></span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em>Variable</em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wa_deriv_mpi_module.html#M000841">jm</a>  </tt></b>  <tt> =32            </tt> :</td><td><tt>integer</tt>

<table>
<tr><td valign="top"> :</td><td> 格子点の設定(南北)

</td></tr>
</table>
</td></tr>
</table>
<p>
Original external subprogram is <a
href="w_base_module.html#M001504">w_base_module#jm</a>
</p>


        </div>
      </div>


      <div id="method-M000852" class="method-detail">
        <a name="M000852"></a>

        <div class="method-heading">




          <span class="method-name">nm</span><span class="method-args"></span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em>Variable</em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wa_deriv_mpi_module.html#M000847">nm</a>  </tt></b>  <tt> =21            </tt> :</td><td><tt>integer</tt>

<table>
<tr><td valign="top"> :</td><td> 切断波数の設定

</td></tr>
</table>
</td></tr>
</table>
<p>
Original external subprogram is <a
href="w_deriv_mpi_module.html#M001389">w_deriv_mpi_module#nm</a>
</p>


        </div>
      </div>


      <div id="method-M000850" class="method-detail">
        <a name="M000850"></a>

        <div class="method-heading">




          <span class="method-name">nm</span><span class="method-args"></span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em>Variable</em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wa_deriv_mpi_module.html#M000847">nm</a>  </tt></b>  <tt> =21            </tt> :</td><td><tt>integer</tt>

<table>
<tr><td valign="top"> :</td><td> 切断波数の設定

</td></tr>
</table>
</td></tr>
</table>
<p>
Original external subprogram is <a
href="wa_base_mpi_module.html#M001668">wa_base_mpi_module#nm</a>
</p>


        </div>
      </div>


      <div id="method-M000848" class="method-detail">
        <a name="M000848"></a>

        <div class="method-heading">




          <span class="method-name">nm</span><span class="method-args"></span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em>Variable</em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wa_deriv_mpi_module.html#M000847">nm</a>  </tt></b>  <tt> =21            </tt> :</td><td><tt>integer</tt>

<table>
<tr><td valign="top"> :</td><td> 切断波数の設定

</td></tr>
</table>
</td></tr>
</table>
<p>
Original external subprogram is <a
href="w_base_mpi_module.html#M000198">w_base_mpi_module#nm</a>
</p>


        </div>
      </div>


      <div id="method-M000851" class="method-detail">
        <a name="M000851"></a>

        <div class="method-heading">




          <span class="method-name">nm</span><span class="method-args"></span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em>Variable</em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wa_deriv_mpi_module.html#M000847">nm</a>  </tt></b>  <tt> =21            </tt> :</td><td><tt>integer</tt>

<table>
<tr><td valign="top"> :</td><td> 切断波数の設定

</td></tr>
</table>
</td></tr>
</table>
<p>
Original external subprogram is <a
href="w_deriv_mpi_module.html#M001389">w_deriv_mpi_module#nm</a>
</p>


        </div>
      </div>


      <div id="method-M000849" class="method-detail">
        <a name="M000849"></a>

        <div class="method-heading">




          <span class="method-name">nm</span><span class="method-args"></span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em>Variable</em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wa_deriv_mpi_module.html#M000847">nm</a>  </tt></b>  <tt> =21            </tt> :</td><td><tt>integer</tt>

<table>
<tr><td valign="top"> :</td><td> 切断波数の設定

</td></tr>
</table>
</td></tr>
</table>
<p>
Original external subprogram is <a
href="wa_base_mpi_module.html#M001668">wa_base_mpi_module#nm</a>
</p>


        </div>
      </div>


      <div id="method-M000847" class="method-detail">
        <a name="M000847"></a>

        <div class="method-heading">




          <span class="method-name">nm</span><span class="method-args"></span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em>Variable</em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wa_deriv_mpi_module.html#M000847">nm</a>  </tt></b>  <tt> =21            </tt> :</td><td><tt>integer</tt>

<table>
<tr><td valign="top"> :</td><td> 切断波数の設定

</td></tr>
</table>
</td></tr>
</table>
<p>
Original external subprogram is <a
href="w_base_module.html#M001505">w_base_module#nm</a>
</p>


        </div>
      </div>


      <div id="method-M000833" class="method-detail">
        <a name="M000833"></a>

        <div class="method-heading">


          <a href="#M000833" class="method-signature">



          <span class="method-name">wa_DivLambda_xva</span><span class="method-args">( xva_data ) result(wa_DivLambda_xva)</span>



          </a>

        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wa_deriv_mpi_module.html#M000833">wa_DivLambda_xva</a>((<a href="wa_deriv_mpi_module.html#M000847">nm</a>+1)*(<a href="wa_deriv_mpi_module.html#M000847">nm</a>+1),size(xva_data,3))  </tt></b>  <tt> </tt> :</td><td><tt>real(8)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 格子点データを発散型経度微分したスペクトルデータ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xva_data(:,:,:)  </tt></b>  <tt> </tt> :</td><td><tt>real(8), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 入力格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
格子点データに発散型経度微分 1/(1-μ^2)・∂/∂λ (μ=sinφ)
を作用させてスペクトルデータに変換して返す(多層用).
</p>


          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000833-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000833-source">
<pre>
    function wa_DivLambda_xva(xva_data)
      !
      ! 格子点データに発散型経度微分 1/(1-μ^2)・∂/∂λ (μ=sinφ) 
      ! を作用させてスペクトルデータに変換して返す(多層用).
      !
      real(8), intent(in)  :: xva_data(:,:,:)
      !(in) 入力格子点データ

      real(8)              :: wa_DivLambda_xva((nm+1)*(nm+1),size(xva_data,3))
      !(out) 格子点データを発散型経度微分したスペクトルデータ

      wa_DivLambda_xva = wa_xva(xva_data,ipow=2,iflag=-1)
    end function wa_DivLambda_xva
</pre>
          </div>

        </div>
      </div>


      <div id="method-M000828" class="method-detail">
        <a name="M000828"></a>

        <div class="method-heading">


          <a href="#M000828" class="method-signature">



          <span class="method-name">wa_DivLat_xva</span><span class="method-args">( xva_data ) result(wa_DivLat_xva)</span>



          </a>

        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wa_deriv_mpi_module.html#M000828">wa_DivLat_xva</a>((<a href="wa_deriv_mpi_module.html#M000847">nm</a>+1)*(<a href="wa_deriv_mpi_module.html#M000847">nm</a>+1),size(xva_data,3))  </tt></b>  <tt> </tt> :</td><td><tt>real(8)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 格子点データを発散型緯度微分したスペクトルデータ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xva_data(:,:,:)  </tt></b>  <tt> </tt> :</td><td><tt>real(8), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 入力格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
格子点データに発散型緯度微分 1/cosφ・∂(f cosφ)/∂φ を作用させて
スペクトルデータに変換して返す(多層用).
</p>


          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000828-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000828-source">
<pre>
    function wa_DivLat_xva(xva_data)
      !
      ! 格子点データに発散型緯度微分 1/cosφ・∂(f cosφ)/∂φ を作用させて
      ! スペクトルデータに変換して返す(多層用).
      !

      real(8), intent(in)  :: xva_data(:,:,:)
      !(in) 入力格子点データ

      real(8)              :: wa_DivLat_xva((nm+1)*(nm+1),size(xva_data,3))
      !(out) 格子点データを発散型緯度微分したスペクトルデータ

      wa_DivLat_xva = wa_xva(xva_data,ipow=1,iflag=1)
    end function wa_DivLat_xva
</pre>
          </div>

        </div>
      </div>


      <div id="method-M000827" class="method-detail">
        <a name="M000827"></a>

        <div class="method-heading">


          <a href="#M000827" class="method-signature">



          <span class="method-name">wa_DivLon_xva</span><span class="method-args">( xva_data ) result(wa_DivLon_xva)</span>



          </a>

        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wa_deriv_mpi_module.html#M000827">wa_DivLon_xva</a>((<a href="wa_deriv_mpi_module.html#M000847">nm</a>+1)*(<a href="wa_deriv_mpi_module.html#M000847">nm</a>+1),size(xva_data,3))  </tt></b>  <tt> </tt> :</td><td><tt>real(8)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 格子点データを発散型経度微分したスペクトルデータ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xva_data(:,:,:)  </tt></b>  <tt> </tt> :</td><td><tt>real(8), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 入力格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
格子点データに発散型経度微分 1/cosφ・∂/∂λ を作用させて
スペクトルデータに変換して返す(多層用).
</p>


          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000827-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000827-source">
<pre>
    function wa_DivLon_xva(xva_data)
      !
      ! 格子点データに発散型経度微分 1/cosφ・∂/∂λ を作用させて
      ! スペクトルデータに変換して返す(多層用).
      !
      real(8), intent(in)  :: xva_data(:,:,:)
      !(in) 入力格子点データ

      real(8)              :: wa_DivLon_xva((nm+1)*(nm+1),size(xva_data,3))
      !(out) 格子点データを発散型経度微分したスペクトルデータ

      wa_DivLon_xva = wa_xva(xva_data,ipow=1,iflag=-1)
    end function wa_DivLon_xva
</pre>
          </div>

        </div>
      </div>


      <div id="method-M000834" class="method-detail">
        <a name="M000834"></a>

        <div class="method-heading">


          <a href="#M000834" class="method-signature">



          <span class="method-name">wa_DivMu_xva</span><span class="method-args">( xva_data ) result(wa_DivMu_xva)</span>



          </a>

        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wa_deriv_mpi_module.html#M000834">wa_DivMu_xva</a>((<a href="wa_deriv_mpi_module.html#M000847">nm</a>+1)*(<a href="wa_deriv_mpi_module.html#M000847">nm</a>+1),size(xva_data,3))  </tt></b>  <tt> </tt> :</td><td><tt>real(8)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 格子点データを発散型緯度微分したスペクトルデータ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xva_data(:,:,:)  </tt></b>  <tt> </tt> :</td><td><tt>real(8), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 入力格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
格子点データに発散型緯度微分 ∂/∂μ (μ=sinφ)を作用させて
スペクトルデータに変換して返す(多層用).
</p>


          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000834-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000834-source">
<pre>
    function wa_DivMu_xva(xva_data)
      !
      ! 格子点データに発散型緯度微分 ∂/∂μ (μ=sinφ)を作用させて
      ! スペクトルデータに変換して返す(多層用).
      !

      real(8), intent(in)  :: xva_data(:,:,:)
      !(in) 入力格子点データ

      real(8)              :: wa_DivMu_xva((nm+1)*(nm+1),size(xva_data,3))
      !(out) 格子点データを発散型緯度微分したスペクトルデータ

      wa_DivMu_xva = wa_xva(xva_data,ipow=2,iflag=1)
    end function wa_DivMu_xva
</pre>
          </div>

        </div>
      </div>


      <div id="method-M000829" class="method-detail">
        <a name="M000829"></a>

        <div class="method-heading">


          <a href="#M000829" class="method-signature">



          <span class="method-name">wa_Div_xva_xva</span><span class="method-args">( xva_u, xva_v ) result(wa_Div_xva_xva)</span>



          </a>

        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wa_deriv_mpi_module.html#M000829">wa_Div_xva_xva</a>((<a href="wa_deriv_mpi_module.html#M000847">nm</a>+1)*(<a href="wa_deriv_mpi_module.html#M000847">nm</a>+1),size(xva_u,3))  </tt></b>  <tt> </tt> :</td><td><tt>real(8)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 2 つの入力格子点データをベクトル成分とする発散のスペクトルデータ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xva_u(:,:,:)  </tt></b>  <tt> </tt> :</td><td><tt>real(8), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) ベクトル経度成分の格子点データ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xva_v(:,:,:)  </tt></b>  <tt> </tt> :</td><td><tt>real(8), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) ベクトル緯度成分の格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
2 つの入力格子点データをベクトル成分とする発散を計算し,
スペクトルデータとして返す(多層用).
</p>


          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000829-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000829-source">
<pre>
    function wa_Div_xva_xva(xva_u,xva_v)
      !
      ! 2 つの入力格子点データをベクトル成分とする発散を計算し, 
      ! スペクトルデータとして返す(多層用).
      !
      real(8), intent(in)  :: xva_u(:,:,:)
      !(in) ベクトル経度成分の格子点データ

      real(8), intent(in)  :: xva_v(:,:,:)
      !(in) ベクトル緯度成分の格子点データ

      real(8)              :: wa_Div_xva_xva((nm+1)*(nm+1),size(xva_u,3))
      !(out) 2 つの入力格子点データをベクトル成分とする発散のスペクトルデータ

      wa_Div_xva_xva = wa_DivLon_xva(xva_u) + wa_DivLat_xva(xva_v)
    end function wa_Div_xva_xva
</pre>
          </div>

        </div>
      </div>


      <div id="method-M000830" class="method-detail">
        <a name="M000830"></a>

        <div class="method-heading">


          <a href="#M000830" class="method-signature">



          <span class="method-name">wa_JacobianMPI_wa_wa</span><span class="method-args">( wa_a, wa_b ) result(wa_JacobianMPI_wa_wa)</span>



          </a>

        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wa_deriv_mpi_module.html#M000830">wa_JacobianMPI_wa_wa</a>((<a href="wa_deriv_mpi_module.html#M000847">nm</a>+1)*(<a href="wa_deriv_mpi_module.html#M000847">nm</a>+1),size(wa_a,2))  </tt></b>  <tt> </tt> :</td><td><tt>real(8)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 2 つのスペクトルデータのヤコビアン

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>wa_a(:,:)  </tt></b>  <tt> </tt> :</td><td><tt>real(8), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 1つ目の入力スペクトルデータ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>wa_b(:,:)  </tt></b>  <tt> </tt> :</td><td><tt>real(8), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 2つ目の入力スペクトルデータ

</td></tr>
</table>
</td></tr>
</table>
<p>
2 つのスペクトルデータにヤコビアン
</p>
<pre>
  J(f,g) = ∂f/∂λ・∂g/∂μ - ∂g/∂λ・∂f/∂μ
         = ∂f/∂λ・1/cosφ・∂g/∂φ
            - ∂g/∂λ・1/cosφ・∂f/∂φ
</pre>
<p>
を作用させる(多層用).
</p>


          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000830-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000830-source">
<pre>
    function wa_JacobianMPI_wa_wa(wa_a,wa_b)
      ! 2 つのスペクトルデータにヤコビアン
      !
      !   J(f,g) = ∂f/∂λ・∂g/∂μ - ∂g/∂λ・∂f/∂μ
      !          = ∂f/∂λ・1/cosφ・∂g/∂φ
      !             - ∂g/∂λ・1/cosφ・∂f/∂φ
      !
      ! を作用させる(多層用).
      !
      real(8), intent(in) :: wa_a(:,:)
      !(in) 1つ目の入力スペクトルデータ

      real(8), intent(in) :: wa_b(:,:)
      !(in) 2つ目の入力スペクトルデータ

      real(8)             :: wa_JacobianMPI_wa_wa((nm+1)*(nm+1),size(wa_a,2))
      !(out) 2 つのスペクトルデータのヤコビアン

      integer :: k

      do k=1,size(wa_a,2)
         wa_JacobianMPI_wa_wa(:,k) = w_JacobianMPI_w_w(wa_a(:,k),wa_b(:,k))
      end do
    end function wa_JacobianMPI_wa_wa
</pre>
          </div>

        </div>
      </div>


      <div id="method-M000831" class="method-detail">
        <a name="M000831"></a>

        <div class="method-heading">


          <a href="#M000831" class="method-signature">



          <span class="method-name">xva_GradLambda_wa</span><span class="method-args">( wa_data ) result(xva_GradLambda_wa)</span>



          </a>

        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wa_deriv_mpi_module.html#M000831">xva_GradLambda_wa</a>(<a href="wa_deriv_mpi_module.html#M000835">im</a>,jc,size(wa_data,2))  </tt></b>  <tt> </tt> :</td><td><tt>real(8)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 入力スペクトルデータ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>wa_data(:,:)  </tt></b>  <tt> </tt> :</td><td><tt>real(8), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) スペクトルデータを勾配型経度微分した格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
スペクトルデータに勾配型経度微分 ∂/∂λ を作用する(多層用).
</p>


          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000831-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000831-source">
<pre>
    function xva_GradLambda_wa(wa_data)
      !
      ! スペクトルデータに勾配型経度微分 ∂/∂λ を作用する(多層用).
      !
      real(8), intent(in)  :: wa_data(:,:)
      !(out) スペクトルデータを勾配型経度微分した格子点データ

      real(8)              :: xva_GradLambda_wa(im,jc,size(wa_data,2))
      !(in) 入力スペクトルデータ

      xva_GradLambda_wa = xva_wa(wa_data,ipow=0,iflag=-1)
    end function xva_GradLambda_wa
</pre>
          </div>

        </div>
      </div>


      <div id="method-M000826" class="method-detail">
        <a name="M000826"></a>

        <div class="method-heading">


          <a href="#M000826" class="method-signature">



          <span class="method-name">xva_GradLat_wa</span><span class="method-args">( wa_data ) result(xva_GradLat_wa)</span>



          </a>

        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wa_deriv_mpi_module.html#M000826">xva_GradLat_wa</a>(<a href="wa_deriv_mpi_module.html#M000835">im</a>,jc,size(wa_data,2))  </tt></b>  <tt> </tt> :</td><td><tt>real(8)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) スペクトルデータを勾配型緯度微分した格子点データ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>wa_data(:,:)  </tt></b>  <tt> </tt> :</td><td><tt>real(8), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 入力スペクトルデータ

</td></tr>
</table>
</td></tr>
</table>
<p>
スペクトルデータに勾配型緯度微分 ∂/∂φ を作用させて
格子点データに変換して返す(多層用).
</p>


          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000826-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000826-source">
<pre>
    function xva_GradLat_wa(wa_data)
      !
      ! スペクトルデータに勾配型緯度微分 ∂/∂φ を作用させて
      ! 格子点データに変換して返す(多層用).
      !
      real(8), intent(in)  :: wa_data(:,:)
      !(in) 入力スペクトルデータ

      real(8)              :: xva_GradLat_wa(im,jc,size(wa_data,2))
      !(out) スペクトルデータを勾配型緯度微分した格子点データ

      xva_GradLat_wa = xva_wa(wa_data,ipow=1,iflag=1)
    end function xva_GradLat_wa
</pre>
          </div>

        </div>
      </div>


      <div id="method-M000825" class="method-detail">
        <a name="M000825"></a>

        <div class="method-heading">


          <a href="#M000825" class="method-signature">



          <span class="method-name">xva_GradLon_wa</span><span class="method-args">( wa_data ) result(xva_GradLon_wa)</span>



          </a>

        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wa_deriv_mpi_module.html#M000825">xva_GradLon_wa</a>(<a href="wa_deriv_mpi_module.html#M000835">im</a>,jc,size(wa_data,2))  </tt></b>  <tt> </tt> :</td><td><tt>real(8)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) スペクトルデータを勾配型経度微分した格子点データ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>wa_data(:,:)  </tt></b>  <tt> </tt> :</td><td><tt>real(8), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 入力スペクトルデータ

</td></tr>
</table>
</td></tr>
</table>
<p>
スペクトルデータに勾配型経度微分 1/cosφ・∂/∂λ を
作用させた格子点データを返す(多層用).
</p>


          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000825-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000825-source">
<pre>
    function xva_GradLon_wa(wa_data)
      !
      ! スペクトルデータに勾配型経度微分 1/cosφ・∂/∂λ を
      ! 作用させた格子点データを返す(多層用).
      !
      real(8), intent(in)  :: wa_data(:,:)
      !(in) 入力スペクトルデータ

      real(8)              :: xva_GradLon_wa(im,jc,size(wa_data,2))
      !(out) スペクトルデータを勾配型経度微分した格子点データ

      xva_GradLon_wa = xva_wa(wa_data,ipow=1,iflag=-1)
    end function xva_GradLon_wa
</pre>
          </div>

        </div>
      </div>


      <div id="method-M000832" class="method-detail">
        <a name="M000832"></a>

        <div class="method-heading">


          <a href="#M000832" class="method-signature">



          <span class="method-name">xva_GradMu_wa</span><span class="method-args">( wa_data ) result(xva_GradMu_wa)</span>



          </a>

        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wa_deriv_mpi_module.html#M000832">xva_GradMu_wa</a>(<a href="wa_deriv_mpi_module.html#M000835">im</a>,jc,size(wa_data,2))  </tt></b>  <tt> </tt> :</td><td><tt>real(8)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) スペクトルデータを勾配型緯度微分した格子点データ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>wa_data(:,:)  </tt></b>  <tt> </tt> :</td><td><tt>real(8), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 入力スペクトルデータ

</td></tr>
</table>
</td></tr>
</table>
<p>
スペクトルデータに勾配型緯度微分 (1-μ^2)∂/∂μ (μ=sinφ)
を作用させて格子点データに変換して返す(多層用).
</p>


          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000832-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000832-source">
<pre>
    function xva_GradMu_wa(wa_data)
      !
      ! スペクトルデータに勾配型緯度微分 (1-μ^2)∂/∂μ  (μ=sinφ)
      ! を作用させて格子点データに変換して返す(多層用).
      !
      real(8), intent(in)  :: wa_data(:,:)
      !(in) 入力スペクトルデータ

      real(8)              :: xva_GradMu_wa(im,jc,size(wa_data,2))
      !(out) スペクトルデータを勾配型緯度微分した格子点データ

      xva_GradMu_wa = xva_wa(wa_data,ipow=0,iflag=1)
    end function xva_GradMu_wa
</pre>
          </div>

        </div>
      </div>



    </div>



  </div>

<div id="validator-badges">
  <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
</div>

</body>
</html>
