%#LPRdvips main.dvi; lpr main.ps
%#!platex main.tex
\section{水平離散化}

 水平方向の離散化には擬スペクトル変換を用いる(Glatzmaier,1984).
 線形項に関する水平微分については
 球面調和関数を基底とする直行関数展開によって評価し,
 非線形項は格子点上で値を計算する.
 
%------------------------------------------------------------------------
 \subsection{スペクトル展開}

 水平方向の展開関数系として, 
 演算子 $L_{2}$ の固有関数である
 球面調和関数 $Y^{m}_{n}(\lambda,\mu)$ を用いる.
 $Y^{m}_{n}(\lambda,\mu)$ はルジャンドル陪関数 $P^{m}_{n}(\mu)$ を用いて
 \begin{equation}
  Y^{m}_{n}(\lambda,\mu) \equiv P^{m}_{n}(\mu) e^{im\lambda}
 \end{equation}
 で定義され, 演算子 $L_{2}$ について
 \begin{equation}
  L_{2} Y^{m}_{n}(\lambda,\mu) = n(n+1)Y^{m}_{n}(\lambda,\mu)
 \end{equation}
 を満たす. ただし $n \geq |m|$ である.

 ポテンシャル $\psi$ の $Y^{m}_{n}(\lambda,\mu)$ による
 離散的な展開 $\psi_{ij}$ は
 \begin{equation}
  \psi_{ij} \equiv \psi(\lambda_{i},\mu_{j}) 
   = \mathcal{R}_{e} \sum^{N}_{m=-N}\sum^{N}_{n=|m|}
     \tilde{\psi}^{m}_{n}Y^{m}_{n}(\lambda_{i},\mu_{j}),
 \end{equation}
 その逆変換 $\tilde{\psi}^{m}_{n}$ は
 \begin{eqnarray}
  \tilde{\psi}^{m}_{n}
   &=& \frac{1}{4\pi}\int^{1}_{-1}\Dd \mu\int^{\pi}_{0}\Dd \lambda
       \psi(\lambda,\mu)Y^{m*}_{n}(\lambda,\mu) \nonumber \\
   &=& \frac{1}{I}\sum^{I}_{i=1}\sum^{J}_{j=1}
       \psi(\lambda_{i},\mu_{j})Y^{m*}_{n}(\lambda_{i},\mu_{j})\omega_{j}
 \end{eqnarray}
 である
 \footnote{
 ここでは波数切断として三角形切断を用いている.
 }.
 逆変換において積分を和に置き換えて評価する際は,
 $\lambda$ 積分について Gauss の台形公式を,
 $\mu$ 積分については Gauss--Legendre の積分公式を用いた.
 $\mu_{j}$ は Gauss 緯度, $\omega_{j}$ は Gauss 荷重,
 $\lambda_{i}$ は等間隔の格子である.

 以下では簡単のため, 和の記号を 
 $\displaystyle{\sum^{N}_{m=-N}\sum^{N}_{n=|m|}=\sum_{m,n},\quad \sum^{I}_{i=1}\sum^{J}_{j=1}=\sum_{i,j}}$
 と表す事とする.

 水平微分を含む項の格子点における値は,
 スペクトル展開により各々次式で求められる:
 \begin{eqnarray}
  \biggl(\DP{\psi}{\lambda}\biggr)_{ij} 
   &=& 
     \mathcal{R}_{e}\sum_{m,n}\sum_{i,j}
     im\tilde{\psi}^{m}_{n}Y^{m}_{n}(\lambda_{i},\mu_{j}), \\
  %
  \biggl( (1-\mu^{2}) \DP{\psi}{\mu} \biggr)_{ij} 
   &=&
     \mathcal{R}_{e}\sum_{m,n}\sum_{i,j}
     \tilde{\psi}^{m}_{n}(1-\mu^{2})\DP{}{\mu}Y^{m}_{n}(\lambda_{i},\mu_{j}). 
 \end{eqnarray}

 また, 非線形項を格子点上で評価する際に現れる水平微分を計算しておく:
 \begin{eqnarray}
  \biggl(\widetilde{\frac{1}{1-\mu^2}\DP{\psi}{\lambda}}\biggr)^{m}_{n}   
   &=& 
     \frac{1}{4\pi}\int^{1}_{-1}\Dd \mu\int^{\pi}_{0}\Dd \lambda
     \biggl(\frac{1}{1-\mu^{2}}\DP{\psi}{\lambda}\biggr)Y^{m*}_{n}(\lambda,\mu) 
     \nonumber \\
   &=& 
     \frac{1}{4\pi}\int^{1}_{-1}\Dd \mu\int^{\pi}_{0}\Dd \lambda
     ~im\psi(\lambda,\mu)\frac{1}{1-\mu^{2}}Y^{m*}_{n}(\lambda,\mu) 
     \nonumber \\
   &=& 
     \frac{1}{I}\sum_{i,j}
     im\psi_{ij}Y^{m*}_{n}(\lambda_{i},\mu_{j}) \frac{\omega_{j}}{1-\mu^{2}} \\
  \biggl(\widetilde{\DP{\psi}{\mu}}\biggr)^{m}_{n} 
   &=&
     \frac{1}{4\pi}\int^{1}_{-1}\Dd \mu \int^{\pi}_{0}\Dd \lambda
     \biggl(\DP{\psi}{\mu}\biggr)Y^{m*}_{n}(\lambda,\mu) \nonumber \\
   &=&
    -\frac{1}{4\pi}\int^{1}_{-1}\Dd \mu \int^{\pi}_{0}\Dd \lambda
     ~\psi\DP{}{\mu}Y^{m*}_{n}(\lambda,\mu) \nonumber \\
   &=&
     \frac{1}{I}\sum_{ij}
     ~\psi_{ij}(1-\mu_{j}^{2})
      \DP{}{\mu}Y^{m*}_{n}(\lambda_{i},\mu_{j})\frac{\omega_{j}}{1-\mu^{2}}.
 \end{eqnarray}
 ここで $U\psi$ が極 $\displaystyle{\mu=\pm1(\varphi=\pm\frac{\pi}{2})}$
 において $0$ となる事を用いている.
 
 さらに $L_{2}$ を含む項の評価には,
 \begin{equation}
  (\widetilde{L_{2}\psi})^{m}_{n}= n(n+1)\tilde{\psi}^{m}_{n}
 \end{equation}
 を用いる.
 
 以上の計算結果は, 
 $\psi$ だけではなく $\phi,g,h,\theta$ についてもそのまま成立する.

\iffalse
%--------------------------------------------------------------------------
\newpage 
 \subsection{非線形項の評価}
 
 運動方程式, 熱の式, 誘導方程式の非線形項を計算し,
 それらを展開する. 
 速度ベクトル $\Dvect{u}$ の各成分を $U,V$ で表すと
 \begin{equation}
  \Dvect{u} = (u,v,w) 
            = \biggl(\frac{U}{\cos\varphi},\frac{V}{\cos\varphi},w\biggr) 
 \end{equation}
 となる. 
 これを用いて非線形項を表す($f$ は任意のスカラー量とする): 
 \begin{eqnarray}
  \Dvect{u}\cdot\Dgrad f
   &=& 
     \frac{u}{r\cos\varphi}\DP{f}{\lambda}
   + \frac{v}{r}\DP{f}{\varphi} 
   + w \DP{f}{r}
   \nonumber\\         
   &=& 
     \frac{U}{r\cos^{2}\varphi}\DP{f}{\lambda}
   + \frac{V}{r\cos\varphi}\DP{f}{\varphi} 
   + w \DP{f}{r}
   \nonumber\\         
   &=& 
     \frac{U}{r(1-\mu^{2})}\DP{f}{\lambda}
   + \frac{V}{r}\DP{f}{\mu} 
   + w \DP{f}{r}
   \nonumber\\         
  %
   \Ddiv\Dvect{u} 
   &=& 
      \frac{1}{r\cos\varphi}\DP{u}{\lambda}
    + \frac{1}{r\cos\varphi}\DP{}{\varphi} ( v\cos\varphi)
    + \frac{1}{r^2}\DP{}{r}(r^2 w) \nonumber\\
   &=&  
      \frac{1}{r\cos^2\varphi}\DP{U}{\lambda} 
    + \frac{1}{r\cos\varphi}\DP{V}{\varphi}
    + \frac{1}{r^2}\DP{}{r}(r^2 w) \nonumber\\
   &=&  
      \frac{1}{r(1-\mu^2)}\DP{U}{\lambda}
    + \DP{V}{\mu}
    + \frac{1}{r^2}\DP{}{r}(r^2 w), \\ 
    %
  \Dvect{r}\cdot(\Drot\Dvect{u})
   &=&  
     \frac{1}{\cos\varphi}
      \left\{
       \DP{ v }{\lambda} - \DP{}{\varphi}( u\cos\varphi )
      \right\}  \nonumber\\
   &=&   
      \frac{1}{\cos^{2}\varphi}\DP{V}{\lambda} 
    - \frac{1}{\cos\varphi}\DP{U}{\varphi} \nonumber\\
   &=&   
      \frac{1}{1-\mu^{2}}\DP{V}{\lambda} - \DP{U}{\mu}, \\
    %
  \Dvect{r}\cdot (\Drot\Drot\Dvect{u})
   &=&  
      \frac{1}{\cos\varphi}
       \left\{
	   \DP{}{\lambda} (\Drot\Dvect{u})_{\varphi}  
	 - \DP{}{\varphi} (\Drot\Dvect{u})_{\lambda}\cos\varphi
       \right\} \nonumber\\
   &=&  
      \frac{1}{\cos\varphi}
       \biggl[
	   \DP{}{\lambda}\frac{1}{r}
	    \left\{ 
	     \DP{}{r}( r u )  -  \frac{1}{\cos\varphi}\DP{w}{\lambda} 
	    \right\} \nonumber \\
   &&{}
    - \DP{}{\varphi}\frac{1}{r}
	    \left\{
	     \DP{w}{\varphi} - \DP{}{r}(r v) 
            \right\} 
	    \cos\varphi
       \biggr]  \nonumber\\
   &=&  
   \frac{1}{r}\DP{}{r}
      \biggl\{
        \frac{1}{\cos^{2}\varphi}\DP{}{\lambda}(ru\cos\varphi)
      \biggr\}
    +
    \frac{1}{r}\DP{}{r}
      \biggl\{
        \frac{1}{\cos\varphi}\DP{}{\varphi}(rv\cos\varphi)
      \biggr\}
    \nonumber\\
   && 
    -\frac{1}{r\cos^{2}\varphi}\DP[2]{w}{\lambda}
    -\frac{1}{r\cos\varphi}\DP{}{\phi}\biggl(\cos\varphi\DP{w}{\varphi}\biggr)
    \nonumber\\
   &=&  
    \frac{1}{r}\DP{}{r}
      \biggl\{
        r\biggl(\frac{1}{1-\mu^{2}}\DP{U}{\lambda}\biggr)
      \biggr\}
    +
    \frac{1}{r}\DP{}{r}
      \biggl(r\DP{V}{\mu}\biggr)
    +
    \frac{L_{2}w}{r}.
 \end{eqnarray}
 よってスペクトル空間では
 \begin{eqnarray}
  (\Ddiv\Dvect{u})^{m}_{n} 
   &=& 
      \frac{1}{r}\biggl(\frac{1}{1-\mu^2}\DP{U}{\lambda}\biggr)^{m}_{n} 
    + \frac{1}{r}\biggl(\DP{V}{\mu}\biggr)^{m}_{n} 
    + \frac{1}{r^2}\DP{}{r}r^2 (w)^{m}_{n} , \\ 
  (\Dvect{r}\cdot\Drot\Dvect{u})^{m}_{n} 
   &=& 
      \biggl(\frac{1}{1-\mu^{2}}\DP{V}{\lambda} \biggr)^{m}_{n} 
      - \biggl(\DP{U}{\mu}\biggr)^{m}_{n} ,\\
  (\Dvect{r}\cdot\Drot\Drot\Dvect{u})^{m}_{n}
   &=& 
    \frac{1}{r}\DP{}{r}
      \biggl\{
        r\biggl(\frac{1}{1-\mu^{2}}\DP{U}{\lambda}\biggr)^{m}_{n}
      \biggr\}
    +
    \frac{1}{r}\DP{}{r}\biggl\{
    r\biggl(\DP{V}{\mu}\biggr)^{m}_{n}
    \biggr\}
    +
    \frac{n(n+1)}{r}(w)^{m}_{n}. \nonumber \\
 \end{eqnarray}
\fi
%---------------------------------------------------------------------------
\newpage 
 \subsection{方程式のスペクトル表現}
 
 スペクトル展開されたポテンシャルで方程式系を書き表す.
 %ここで, $n=0$ の展開係数は格子点での値を求めるためには不用であるから
 %以下では

 \subsubsection{運動方程式}

 トロイダルポテンシャル:
 \begin{eqnarray}
  \DP{}{t}\tilde{\psi}^{m}_{n}
   &=&
   G^{m}_{n}\tilde{\psi}^{m}_{n} -\tau\frac{1}{n(n+1)}(\tilde{Q\phi})^{m}_{n}
   \nonumber \\
   &&{} - \frac{1}{n(n+1)}
    [ \Dvect{r}\cdot\Drot(\Dvect{u}\cdot\Dgrad\Dvect{u}-\Dvect{B}\cdot\Dgrad\Dvect{B})]^{m}_{n}.\quad(n\neq 0)
 \end{eqnarray}
 ポロイダルポテンシャル:
 \begin{eqnarray}
  \DP{}{t}(D_{n}\tilde{\phi}^{m}_{n})
   &=&
   G^{m}_{n}(D_{n}\tilde{\phi}^{m}_{n}) 
   + \tau\frac{1}{n(n+1)}(\tilde{Q\psi})^{m}_{n} 
   - P_{r}^{-1}R_{a}\tilde{\theta}^{m}_{n}
   \nonumber \\
   &&{} + \frac{1}{n(n+1)}
    [ \Dvect{r}\cdot\Drot\Drot(\Dvect{u}\cdot\Dgrad\Dvect{u}-\Dvect{B}\cdot\Dgrad\Dvect{B})]^{m}_{n}.\quad(n\neq 0)
 \end{eqnarray}
 ここで $G^{m}_{n}, D_{n}$ は次式で定義される:
 \begin{eqnarray}
  D_{n} \equiv \DP[]{}{r}+\frac{2}{r}\DP{}{r} -\frac{n(n+1)}{r^{2}}, \quad 
  G^{m}_{n} \equiv \frac{im}{n(n+1)} + D_{n}.
 \end{eqnarray}
 
 \subsubsection{熱の式}
 \begin{equation}
  \DP{}{t}\tilde{\theta}^{m}_{n}
   =   D_{n}\tilde{\theta}^{m}_{n} + n(n+1)\tilde{\theta}^{m}_{n} 
     - P_{r}^{-1}(\Dvect{u}\cdot\Dgrad\theta)^{m}_{n}
 \end{equation}

 \subsubsection{誘導方程式}
 トロイダルポテンシャル
 \begin{eqnarray}
  \DP{}{t}\tilde{g}^{m}_{n}
   &=&
     P_{m}^{-1}D_{n}\tilde{g}^{m}_{n} 
   + \frac{1}{n(n+1)}
    [ \Dvect{r}\cdot\Drot(\Dvect{u}\times\Dvect{B})]^{m}_{n}.\quad(n\neq 0)
 \end{eqnarray} 
 ポロイダルポテンシャル
 \begin{eqnarray}
  \DP{}{t}\tilde{h}^{m}_{n}
   &=&
     P_{m}^{-1}D_{n}\tilde{h}^{m}_{n} 
   - \frac{1}{n(n+1)}
    [ \Dvect{r}\cdot\Drot\Drot(\Dvect{u}\times\Dvect{B})]^{m}_{n}.\quad(n\neq 0)
 \end{eqnarray} 
 
 \subsubsection{速度場の表現}

 \begin{eqnarray}
  U_{ij}(r,t) 
   &=& 
   \sum_{m,n}
     \biggl\{
         \tilde{\psi}^{m}_{n}(1-\mu^{2})\DP{}{\mu}Y^{m}_{n}(\lambda_{i},\mu_{j})
       + im\frac{1}{r}\DP{}{r}(r\tilde{\phi}^{m}_{n})Y^{m}_{n}(\lambda_{i},\mu_{j})
     \biggr\} \nonumber \\ \\
  V_{ij}(r,t) 
   &=& 
   \sum_{m,n}
     \biggl\{
       - im\tilde{\psi}^{m}_{n}Y^{m}_{n}(\lambda_{i},\mu_{j})
       + \frac{1}{r}\DP{}{r}(r\tilde{\phi}^{m}_{n})(1-\mu^{2})\DP{}{\mu}Y^{m}_{n}(\lambda_{i},\mu_{j})
     \biggr\} \nonumber \\ \\
  w_{ij}(r,t) 
   &=& 
   \sum_{m,n} \frac{n(n+1)}{r}\tilde{\phi}^{m}_{n}Y^{m}_{n}(\lambda_{i},\mu_{j})
 \end{eqnarray}

\subsubsection{磁場の表現}

 \begin{eqnarray}
  \Deqlab{磁場経度}
   B_{\lambda_{ij}}(r,t)\cos\varphi 
   &=& 
   \sum_{m,n}
     \biggl\{
         \tilde{g}^{m}_{n}(1-\mu^{2})\DP{}{\mu}Y^{m}_{n}(\lambda_{i},\mu_{j})
       + im\frac{1}{r}\DP{}{r}(r\tilde{h}^{m}_{n})Y^{m}_{n}(\lambda_{i},\mu_{j})
     \biggr\} \nonumber \\ \\
  \Deqlab{磁場緯度}
  B_{\mu_{ij}}(r,t)\cos\varphi 
   &=& 
   \sum_{m,n}
     \biggl\{
       - im\tilde{g}^{m}_{n}Y^{m}_{n}(\lambda_{i},\mu_{j})
       + \frac{1}{r}\DP{}{r}(r\tilde{h}^{m}_{n})(1-\mu^{2})\DP{}{\mu}Y^{m}_{n}(\lambda_{i},\mu_{j})
     \biggr\} \nonumber \\ \\
  \Deqlab{磁場鉛直}
  B_{r_{ij}}(r,t) 
   &=& 
   \sum_{m,n} \frac{n(n+1)}{r}\tilde{h}^{m}_{n}Y^{m}_{n}(\lambda_{i},\mu_{j})
 \end{eqnarray}


