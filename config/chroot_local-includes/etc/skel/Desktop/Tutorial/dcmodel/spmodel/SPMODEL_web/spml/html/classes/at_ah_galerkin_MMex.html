<?xml version="1.0" encoding="euc-jp"?>
<!DOCTYPE html
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>Class: at_ah_galerkin_MMex</title>
  <meta http-equiv="Content-Type" content="text/html; charset=euc-jp" />
  <meta http-equiv="Content-Script-Type" content="text/javascript" />
  <link rel="stylesheet" href=".././rdoc-style.css" type="text/css" media="screen" />
  <script type="text/javascript">
  // <![CDATA[

  function popupCode( url ) {
    window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
  }

  function toggleCode( id ) {
    if ( document.getElementById )
      elem = document.getElementById( id );
    else if ( document.all )
      elem = eval( "document.all." + id );
    else
      return false;

    elemStyle = elem.style;

    if ( elemStyle.display != "block" ) {
      elemStyle.display = "block"
    } else {
      elemStyle.display = "none"
    }

    return true;
  }

  // Make codeblocks hidden by default
  document.writeln( "<style type=\"text/css\">div.method-source-code { display: none }</style>" )

  // ]]>
  </script>

</head>
<body>


    <div id="classHeader">
        <table class="header-table">
        <tr class="top-aligned-row">
          <td><strong>Class</strong></td>
          <td class="class-name-in-header">at_ah_galerkin_MMex</td>
        </tr>
        <tr class="top-aligned-row">
            <td><strong>In:</strong></td>
            <td>


                <a href="../files/src/at_ah_galerkin_MMex_f90.html">

                src/at_ah_galerkin_MMex.f90

                </a>


        <br />
            </td>
        </tr>


        </table>
    </div>
  <!-- banner header -->

  <div id="bodyContent">


  <div id="contextContent">



    <div id="description">
      <h1><a href="at_ah_galerkin_MMex.html">at_ah_galerkin_MMex</a></h1>
<table>
<tr><td valign="top">Authors:</td><td>Shin-ichi Takehiro, Youhei SASAKI

</td></tr>
<tr><td valign="top">Version:</td><td>$Id: <a
href="../files/src/at_ah_galerkin_MMex_f90.html">at_ah_galerkin_MMex.f90</a>,v
1.3 2009-02-28 21:33:46 uwabami Exp $

</td></tr>
<tr><td valign="top">Copyright&amp;License:</td><td>See <a href="../../COPYRIGHT">COPYRIGHT</a>

</td></tr>
</table>
<h2>概要</h2>
<p>
spml/at_ah_galerkin_MMex はチェビシェフ−ガラーキン法,
ディリクレ・ノイマン混合境界条件(可変係数)
</p>
<pre>
         cfdx1_xmax(j) f'(j,i=0)  + cfdx0_xmax f(j,i=0)  = 0,
         cfdx1_xmin(j) f'(j,i=im) + cfdx0_xmin f(j,i=im) = 0,
</pre>
<p>
を k 次のガラーキン基底が
</p>
<pre>
       \phi_k(x)=T_k(x) + C_1 T_1(x) + C_0 T_0(x)
</pre>
<p>
の型式(Type2)を用いて計算するためのモジュールである.
</p>
<p>
定式化については解説文書「チェビシェフ関数展開を利用したガラーキン法」 (<a
href=".././link:cheb_gal.pdf">cheb_gal.pdf</a>)を参照のこと.
</p>

    </div>





   </div>


    <div id="method-list">
      <h3 class="section-bar">Methods</h3>

      <div class="name-list">

        <a href="#M000745">HT</a>&nbsp;&nbsp;

        <a href="#M000744">TH</a>&nbsp;&nbsp;

        <a href="#M000752">ag_ah</a>&nbsp;&nbsp;

        <a href="#M000753">ah_Dx_ah</a>&nbsp;&nbsp;

        <a href="#M000751">ah_ag</a>&nbsp;&nbsp;

        <a href="#M000749">ah_at</a>&nbsp;&nbsp;

        <a href="#M000746">alpha</a>&nbsp;&nbsp;

        <a href="#M000750">at_ah</a>&nbsp;&nbsp;

        <a href="#M000748">at_ah_galerkin_MMex_Initial</a>&nbsp;&nbsp;

        <a href="#M000747">beta</a>&nbsp;&nbsp;
      </div>
    </div>


  </div>


    <!-- if includes -->

    <div id="includes">
      <h3 class="section-bar">Included Modules</h3>

      <div id="includes-list">

        <span class="include-name"><a href="lumatrix.html">lumatrix</a></span>

        <span class="include-name"><a href="at_module.html">at_module</a></span>

        <span class="include-name">dc_message</span>
      </div>
    </div>



    <div id="section">










      


    <!-- if method_list -->

    <div id="methods">


      <h3 class="section-bar">Public Instance methods</h3>


      <div id="method-M000745" class="method-detail">
        <a name="M000745"></a>

        <div class="method-heading">




          <span class="method-name">HT</span><span class="method-args"></span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em>Variable</em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="at_ah_galerkin_MMex.html#M000745">HT</a>(:,:,:)  </tt></b>  <tt> </tt> :</td><td><tt>real(8), allocatable</tt>

<table>
<tr><td valign="top"> :</td><td> チェビシェフ-&gt;ガラーキン変換行列

</td></tr>
</table>
</td></tr>
</table>


        </div>
      </div>


      <div id="method-M000744" class="method-detail">
        <a name="M000744"></a>

        <div class="method-heading">




          <span class="method-name">TH</span><span class="method-args"></span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em>Variable</em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="at_ah_galerkin_MMex.html#M000744">TH</a>(:,:,:)  </tt></b>  <tt> </tt> :</td><td><tt>real(8), allocatable</tt>

<table>
<tr><td valign="top"> :</td><td> ガラーキン-&gt;チェビシェフ変換行列

</td></tr>
</table>
</td></tr>
</table>


        </div>
      </div>


      <div id="method-M000752" class="method-detail">
        <a name="M000752"></a>

        <div class="method-heading">


          <a href="#M000752" class="method-signature">



          <span class="method-name">ag_ah</span><span class="method-args">( ah_data ) result(ag_ah)</span>



          </a>

        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="at_ah_galerkin_MMex.html#M000752">ag_ah</a>(size(ah_data,1),0:im)  </tt></b>  <tt> </tt> :</td><td><tt>real(8)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 格子点データ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>ah_data(:,ks:)  </tt></b>  <tt> </tt> :</td><td><tt>real(8), intent(IN)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) ガラーキン係数

</td></tr>
</table>
</td></tr>
</table>
<p>
チェビシェフ−ガラーキン法 ディリクレ・ノイマン混合境界条件
</p>
<p>
ガラーキン係数 -&gt; 格子点データ変換(2次元データ)
</p>


          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000752-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000752-source">
<pre>
  function ag_ah(ah_data)
    !
    ! チェビシェフ−ガラーキン法
    ! ディリクレ・ノイマン混合境界条件
    !
    ! ガラーキン係数 -&gt; 格子点データ変換(2次元データ)
    !
    real(8), intent(IN) :: ah_data(:,ks:)              !(in)  ガラーキン係数  
    real(8)             :: ag_ah(size(ah_data,1),0:im) !(out) 格子点データ  
    
    ag_ah = ag_at(at_ah(ah_data))
  end function ag_ah
</pre>
          </div>

        </div>
      </div>


      <div id="method-M000753" class="method-detail">
        <a name="M000753"></a>

        <div class="method-heading">


          <a href="#M000753" class="method-signature">



          <span class="method-name">ah_Dx_ah</span><span class="method-args">( ah_data ) result(ah_Dx_ah)</span>



          </a>

        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="at_ah_galerkin_MMex.html#M000753">ah_Dx_ah</a>(size(ah_data,1),ks:km)  </tt></b>  <tt> </tt> :</td><td><tt>real(8)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 微分ガラーキン

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>ah_data(:,ks:)  </tt></b>  <tt> </tt> :</td><td><tt>real(8), intent(IN)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) ガラーキン係数

</td></tr>
</table>
</td></tr>
</table>
<p>
チェビシェフ−ガラーキン法 ディリクレ・ノイマン混合境界条件
</p>
<p>
X 微分計算(2 次元)
</p>


          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000753-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000753-source">
<pre>
  function ah_Dx_ah(ah_data)
    !
    ! チェビシェフ−ガラーキン法
    ! ディリクレ・ノイマン混合境界条件
    !
    ! X 微分計算(2 次元)
    !
    real(8), intent(IN) :: ah_data(:,ks:)                  !(in) ガラーキン係数
    real(8)             :: ah_Dx_ah(size(ah_data,1),ks:km) !(out) 微分ガラーキン
    ah_Dx_ah = ah_at(at_Dx_at(at_ah(ah_data)))
  end function ah_Dx_ah
</pre>
          </div>

        </div>
      </div>


      <div id="method-M000751" class="method-detail">
        <a name="M000751"></a>

        <div class="method-heading">


          <a href="#M000751" class="method-signature">



          <span class="method-name">ah_ag</span><span class="method-args">( ag_data ) result(ah_ag)</span>



          </a>

        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="at_ah_galerkin_MMex.html#M000751">ah_ag</a>(size(ag_data,1),ks:km)  </tt></b>  <tt> </tt> :</td><td><tt>real(8)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) ガラーキン係数

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>ag_data(:,0:)  </tt></b>  <tt> </tt> :</td><td><tt>real(8), intent(IN)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
チェビシェフ−ガラーキン法 ディリクレ・ノイマン混合境界条件
</p>
<p>
格子点データ -&gt; ガラーキン係数変換(2次元データ)
</p>


          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000751-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000751-source">
<pre>
  function ah_ag(ag_data)
    !
    ! チェビシェフ−ガラーキン法
    ! ディリクレ・ノイマン混合境界条件
    !
    ! 格子点データ -&gt; ガラーキン係数変換(2次元データ)
    !
    real(8), intent(IN)  :: ag_data(:,0:)                !(in)  格子点データ
    real(8)              :: ah_ag(size(ag_data,1),ks:km) !(out) ガラーキン係数

    ah_ag = ah_at(at_ag(ag_data))
  end function ah_ag
</pre>
          </div>

        </div>
      </div>


      <div id="method-M000749" class="method-detail">
        <a name="M000749"></a>

        <div class="method-heading">


          <a href="#M000749" class="method-signature">



          <span class="method-name">ah_at</span><span class="method-args">( at_data ) result(ah_at)</span>



          </a>

        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="at_ah_galerkin_MMex.html#M000749">ah_at</a>(size(at_data,1),ks:km)  </tt></b>  <tt> </tt> :</td><td><tt>real(8)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) ガラーキン係数

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>at_data(:,0:)  </tt></b>  <tt> </tt> :</td><td><tt>real(8), intent(IN)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) チェビシェフ係数

</td></tr>
</table>
</td></tr>
</table>
<p>
チェビシェフ−ガラーキン法 ディリクレ・ノイマン混合境界条件
</p>
<p>
チェビシェフ係数 -&gt; ガラーキン係数変換(2次元データ)
</p>


          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000749-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000749-source">
<pre>
  function ah_at(at_data)
    !
    ! チェビシェフ−ガラーキン法
    ! ディリクレ・ノイマン混合境界条件
    !
    ! チェビシェフ係数 -&gt; ガラーキン係数変換(2次元データ)
    !
    real(8), intent(IN) :: at_data(:,0:)                !(in)  チェビシェフ係数
    real(8)             :: ah_at(size(at_data,1),ks:km) !(out) ガラーキン係数  

    real(8)             :: ah_work(size(at_data,1),ks:km)  ! 作業用配列

    integer :: k,m

    if ( .not. MMex_Initialized ) call MessageNotify('E','ah_at', 'at_ah_galerkin_MMex_module not initialized')

    ah_work =0.0
    do m=ks,km
       do k=0,km
          ah_work(:,m) = ah_work(:,m) + alpha(k) * beta(k) * at_data(:,k) * TH(:,k,m)
       enddo
    enddo

    ah_at = LUSolve(HT,kp,ah_work)
  end function ah_at
</pre>
          </div>

        </div>
      </div>


      <div id="method-M000746" class="method-detail">
        <a name="M000746"></a>

        <div class="method-heading">




          <span class="method-name">alpha</span><span class="method-args"></span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em>Variable</em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="at_ah_galerkin_MMex.html#M000746">alpha</a>(:)  </tt></b>  <tt> </tt> :</td><td><tt>real(8), allocatable</tt>

<table>
<tr><td valign="top"> :</td><td> チェビシェフ&lt;-&gt;ガラーキン行列積係数

</td></tr>
</table>
</td></tr>
</table>


        </div>
      </div>


      <div id="method-M000750" class="method-detail">
        <a name="M000750"></a>

        <div class="method-heading">


          <a href="#M000750" class="method-signature">



          <span class="method-name">at_ah</span><span class="method-args">( ah_data ) result(at_ah)</span>



          </a>

        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="at_ah_galerkin_MMex.html#M000750">at_ah</a>(size(ah_data,1),0:km)  </tt></b>  <tt> </tt> :</td><td><tt>real(8)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) チェビシェフ係数

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>ah_data(:,ks:)  </tt></b>  <tt> </tt> :</td><td><tt>real(8), intent(IN)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) ガラーキン係数

</td></tr>
</table>
</td></tr>
</table>
<p>
チェビシェフ−ガラーキン法 ディリクレ・ノイマン混合境界条件
</p>
<p>
ガラーキン係数 -&gt; チェビシェフ係数変換(2次元データ)
</p>


          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000750-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000750-source">
<pre>
  function at_ah(ah_data)
    !
    ! チェビシェフ−ガラーキン法
    ! ディリクレ・ノイマン混合境界条件
    !
    ! ガラーキン係数 -&gt; チェビシェフ係数変換(2次元データ)
    !
    real(8), intent(IN)  :: ah_data(:,ks:)              !(in)  ガラーキン係数
    real(8)              :: at_ah(size(ah_data,1),0:km) !(out) チェビシェフ係数

    integer :: m, n

    if ( .not. MMex_Initialized ) call MessageNotify('E','at_ah', 'at_ah_galerkin_MMex_module not initialized')
    at_ah = 0.0D0
    do m=0,km
       do n=ks,km
          at_ah(:,m) = at_ah(:,m) + TH(:,m,n)*ah_data(:,n)/beta(m)
       enddo
    enddo

  end function at_ah
</pre>
          </div>

        </div>
      </div>


      <div id="method-M000748" class="method-detail">
        <a name="M000748"></a>

        <div class="method-heading">


          <a href="#M000748" class="method-signature">



          <span class="method-name">at_ah_galerkin_MMex_Initial</span><span class="method-args">( i_in, k_in, j_in, [cfdx0_xmax], [cfdx1_xmax], [cfdx0_xmin], [cfdx1_xmin] ) </span>



          </a>

        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Subroutine </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt>i_in  </tt></b>  <tt> </tt> :</td><td><tt>integer, intent(IN)</tt>

<table>
<tr><td valign="top"> :</td><td> (in)格子点数

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>k_in  </tt></b>  <tt> </tt> :</td><td><tt>integer, intent(IN)</tt>

<table>
<tr><td valign="top"> :</td><td> (in)チェビシェフ切断波数

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>j_in  </tt></b>  <tt> </tt> :</td><td><tt>integer, intent(IN)</tt>

<table>
<tr><td valign="top"> :</td><td> (in)第 1 次元の大きさ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>cfdx0_xmax(j_in)  </tt></b>  <tt> </tt> :</td><td><tt>real(8), intent(IN),optional</tt>

<table>
<tr><td valign="top"> :</td><td> 境界条件係数(0階微分@x=xmax)

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>cfdx1_xmax(j_in)  </tt></b>  <tt> </tt> :</td><td><tt>real(8), intent(IN),optional</tt>

<table>
<tr><td valign="top"> :</td><td> 境界条件係数(1階微分@x=xmax)

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>cfdx0_xmin(j_in)  </tt></b>  <tt> </tt> :</td><td><tt>real(8), intent(IN),optional</tt>

<table>
<tr><td valign="top"> :</td><td> 境界条件係数(0階微分@x=xmin)

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>cfdx1_xmin(j_in)  </tt></b>  <tt> </tt> :</td><td><tt>real(8), intent(IN),optional</tt>

<table>
<tr><td valign="top"> :</td><td> 境界条件係数(1階微分@x=xmin)

</td></tr>
</table>
</td></tr>
</table>
<p>
チェビシェフ−ガラーキン法 ディリクレ・ノイマン混合境界条件用モジュール
</p>
<p>
初期化サブルーチン
</p>


          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000748-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000748-source">
<pre>
  subroutine at_ah_galerkin_MMex_Initial(i_in,k_in,j_in, cfdx0_xmax,cfdx1_xmax, cfdx0_xmin,cfdx1_xmin    )
    !
    ! チェビシェフ−ガラーキン法 
    ! ディリクレ・ノイマン混合境界条件用モジュール
    !
    ! 初期化サブルーチン
    !

    integer, intent(IN) :: i_in      ! (in)格子点数
    integer, intent(IN) :: k_in      ! (in)チェビシェフ切断波数  
    integer, intent(IN) :: j_in      ! (in)第 1 次元の大きさ

    real(8), intent(IN),optional :: cfdx0_xmin(j_in) ! 境界条件係数(0階微分@x=xmin)
    real(8), intent(IN),optional :: cfdx1_xmin(j_in) ! 境界条件係数(1階微分@x=xmin)
    real(8), intent(IN),optional :: cfdx0_xmax(j_in) ! 境界条件係数(0階微分@x=xmax)
    real(8), intent(IN),optional :: cfdx1_xmax(j_in) ! 境界条件係数(1階微分@x=xmax)

    real(8) :: Dfac                  ! 微分変換係数
    real(8) :: Delta(j_in)           ! 係数行列の行列式

    integer :: j, k, l, m, n
    real(8) :: a, b, c, d, e, f
    character(len=10) :: cnumber

    !---------- 格子点数・切断波数設定 ----------
    im=i_in 
     km=k_in 
     jm = j_in

    !---------- 境界条件係数設定 ----------
    if ( allocated(cfd0_xmin) ) deallocate(cfd0_xmin)
    if ( allocated(cfd1_xmin) ) deallocate(cfd1_xmin)
    if ( allocated(cfd0_xmax) ) deallocate(cfd0_xmax)
    if ( allocated(cfd1_xmax) ) deallocate(cfd1_xmax)
    if ( allocated(MMex_Delta0) ) deallocate(MMex_Delta0)

    allocate(cfd0_xmin(jm),cfd1_xmin(jm))
    allocate(cfd0_xmax(jm),cfd1_xmax(jm))
    allocate(MMex_Delta0(jm))

    Dfac = (g_X(0)-g_X(im))/2.0D0

    if( present(cfdx0_xmin) ) then
       cfd0_xmin = cfdx0_xmin
    else
       call MessageNotify('M','at_ah_galerkin_MM_Initial', 'cfdx0_xmin set to zero internally.')
       cfd0_xmin = 0.0D0
    endif

    if( present(cfdx0_xmax) ) then
       cfd0_xmax = cfdx0_xmax
    else
       call MessageNotify('M','at_ah_galerkin_MM_Initial', 'cfdx0_xmax set to zero internally.')
       cfd0_xmax = 0.0D0
    endif

    if( present(cfdx1_xmin) ) then
       cfd1_xmin = cfdx1_xmin/Dfac
    else
       call MessageNotify('M','at_ah_galerkin_MM_Initial', 'cfdx1_xmin set to zero internally.')
       cfd1_xmin = 0.0D0
    endif

    if( present(cfdx1_xmax) ) then
       cfd1_xmax = cfdx1_xmax/Dfac
    else
       call MessageNotify('M','at_ah_galerkin_MM_Initial', 'cfdx1_xmax set to zero internally.')
       cfd1_xmax = 0.0D0
    endif

    !---------- 境界条件係数チェック ----------

    Delta = cfd1_xmin*cfd0_xmax-cfd1_xmax*cfd0_xmin -2 * cfd0_xmin*cfd0_xmax

    do j=1,jm
       if ( abs(Delta(j)) /max(abs(cfd1_xmin(j)),abs(cfd0_xmin(j)), abs(cfd1_xmax(j)),abs(cfd0_xmax(j))) .LT. EPS ) then

          write(cnumber,'(I10)') j
          MMex_Delta0(j) = .true.
          call MessageNotify('W','at_ah_galerkin_MM_Initial', 'Determinant of coefficent matrix equals zero.' )
          call MessageNotify('M','at_ah_galerkin_MM_Initial', 'T2 and T1 are used for Galerkin base functions at the ' //trim(adjustl(cnumber))//'-th element.' )
         else
            MMex_Delta0(j) = .false.
         endif
    enddo

    !---------- ディリクレ・ノイマン混合条件用変換行列設定 ----------
    if ( allocated(TH) ) deallocate(TH)
    if ( allocated(HT) ) deallocate(HT)
    if ( allocated(kp) ) deallocate(kp)
    if ( allocated(alpha) ) deallocate(alpha)
    if ( allocated(beta) ) deallocate(beta)
    allocate(TH(jm,0:km,ks:km),HT(jm,ks:km,ks:km),kp(jm,ks:km))
    allocate(alpha(0:km),beta(0:km))

    TH = 0.0D0
    do j=1,jm
       if ( MMex_Delta0(j) ) then
          a = 4 * cfd1_xmax(j) + cfd0_xmax(j)
          b = cfd1_xmax(j) + cfd0_xmax(j)
          c = -4 * cfd1_xmin(j) + cfd0_xmin(j)
          d = cfd1_xmin(j) - cfd0_xmin(j)
          Delta(j) = a*d - b*c

          TH(j,0,2) = cfd1_xmax(j) + cfd0_xmax(j)
          TH(j,1,2) = -cfd0_xmax(j)
          do k=ks+1,km
             e = cfd1_xmax(j) * k**2 + cfd0_xmax(j)
             f = cfd1_xmin(j) * (-1)**(k+1) * k**2 + cfd0_xmin(j)*(-1)**k
             TH(j,1,k) = -1.0D0/Delta(j)*(-c*e+a*f)
             TH(j,2,k) = -1.0D0/Delta(j)*(d*e-b*f)
             TH(j,k,k) = 1.0D0
          enddo
       else
          do k=ks,km
             TH(j,0,k) = 1.0D0/Delta(j) * (   (-cfd1_xmin(j)+cfd0_xmin(j)) *(cfd1_xmax(j)*k**2+cfd0_xmax(j)) + (cfd1_xmax(j)+cfd0_xmax(j)) *(    cfd1_xmin(j)*(-1)**(k+1)*k**2 + (-1)**k*cfd0_xmin(j)         ) )
             TH(j,1,k) = 1.0D0/Delta(j) * (   cfd0_xmin(j) *(cfd1_xmax(j)*k**2+cfd0_xmax(j)) - cfd0_xmax(j) *(   cfd1_xmin(j)*(-1)**(k+1)*k**2 + (-1)**k*cfd0_xmin(j)         ) )
             TH(j,k,k) = 1.0D0
          enddo
       endif
    end do

    beta=1.0 
     beta(0)=0.5D0
    if (im .eq. km ) beta(km)=0.5D0

    ! ディリクレ・ノイマン混合条件用変換逆行列
    alpha=1.0 
     alpha(0)=2.0D0

    HT = 0.0D0
    do m=ks,km
       do n=ks,km
          do l=0,km
             HT(:,m,n) = HT(:,m,n) + alpha(l)*TH(:,l,m)*TH(:,l,n)
          enddo
       enddo
    enddo

    call LUDecomp(HT,kp)

    call MessageNotify('M','at_ah_galerkin_MMex_Initial', 'Conversion matrices initialized')

    MMex_Initialized=.true.

  end subroutine at_ah_galerkin_MMex_Initial
</pre>
          </div>

        </div>
      </div>


      <div id="method-M000747" class="method-detail">
        <a name="M000747"></a>

        <div class="method-heading">




          <span class="method-name">beta</span><span class="method-args"></span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em>Variable</em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="at_ah_galerkin_MMex.html#M000747">beta</a>(:)  </tt></b>  <tt> </tt> :</td><td><tt>real(8), allocatable</tt>

<table>
<tr><td valign="top"> :</td><td> チェビシェフ&lt;-&gt;ガラーキン行列和係数

</td></tr>
</table>
</td></tr>
</table>


        </div>
      </div>



    </div>



  </div>

<div id="validator-badges">
  <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
</div>

</body>
</html>
