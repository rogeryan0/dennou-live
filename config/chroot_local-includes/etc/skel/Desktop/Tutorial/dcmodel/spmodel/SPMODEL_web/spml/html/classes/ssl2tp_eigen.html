<?xml version="1.0" encoding="euc-jp"?>
<!DOCTYPE html
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>Class: ssl2tp_eigen</title>
  <meta http-equiv="Content-Type" content="text/html; charset=euc-jp" />
  <meta http-equiv="Content-Script-Type" content="text/javascript" />
  <link rel="stylesheet" href=".././rdoc-style.css" type="text/css" media="screen" />
  <script type="text/javascript">
  // <![CDATA[

  function popupCode( url ) {
    window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
  }

  function toggleCode( id ) {
    if ( document.getElementById )
      elem = document.getElementById( id );
    else if ( document.all )
      elem = eval( "document.all." + id );
    else
      return false;

    elemStyle = elem.style;

    if ( elemStyle.display != "block" ) {
      elemStyle.display = "block"
    } else {
      elemStyle.display = "none"
    }

    return true;
  }

  // Make codeblocks hidden by default
  document.writeln( "<style type=\"text/css\">div.method-source-code { display: none }</style>" )

  // ]]>
  </script>

</head>
<body>


    <div id="classHeader">
        <table class="header-table">
        <tr class="top-aligned-row">
          <td><strong>Class</strong></td>
          <td class="class-name-in-header">ssl2tp_eigen</td>
        </tr>
        <tr class="top-aligned-row">
            <td><strong>In:</strong></td>
            <td>


                <a href="../files/src/ssl2tp_eigen_f90.html">

                src/ssl2tp_eigen.f90

                </a>


        <br />
            </td>
        </tr>


        </table>
    </div>
  <!-- banner header -->

  <div id="bodyContent">


  <div id="contextContent">



    <div id="description">
      <h1><a href="ssl2tp_eigen.html">ssl2tp_eigen</a></h1>
<table>
<tr><td valign="top">Authors:</td><td>Shin-ichi Takehiro, Youhei SASAKI

</td></tr>
<tr><td valign="top">Version:</td><td>$Id: <a href="../files/src/ssl2tp_eigen_f90.html">ssl2tp_eigen.f90</a>,v
1.3 2009-02-28 21:33:47 uwabami Exp $

</td></tr>
<tr><td valign="top">Copyright&amp;License:</td><td>See <a href="../../COPYRIGHT">COPYRIGHT</a>

</td></tr>
</table>
<h2>概要</h2>
<p>
spml/ssl2tp_eigen は <a href="eigmatrix.html">eigmatrix</a>
モジュールの公開サブルーチン eigen
用の固有値計算用共通インターフェースを与える.
</p>
<pre>
  * 行列 AMAT の i 番目固有値を eigen_r(i), eigen_i(i) に格納
  * 対応する固有ベクトルを eigvec_r(:,i), eigvec_i(:,i) に格納
  * 格納する固有値の数は引数 eigen_r の大きさで決まる
  * 固有値の順番は sort と order で定められる.
  * sort によって順番を定めるために用いる量を指定する.
    実部(R), 実部の絶対値(RA), 虚部(I), 虚部の絶対値(IA)
  * reverse によって小さい順(.false.), 大きい順(.true.)を指定できる.
  * デフォルトは sort='R', reverse=.false.
</pre>
<p>
内部では DM_EIG1/SSL2TP ルーチンによる実行列の固有値/固有ベクトル計算を
行っている. が, ユーザーは用いているライブラリとサブルーチンを意識
することなく使うことができる.
</p>

    </div>





   </div>


    <div id="method-list">
      <h3 class="section-bar">Methods</h3>

      <div class="name-list">

        <a href="#M001910">dm_eig1_ssl2tp</a>&nbsp;&nbsp;
      </div>
    </div>


  </div>


    <!-- if includes -->

    <div id="includes">
      <h3 class="section-bar">Included Modules</h3>

      <div id="includes-list">

        <span class="include-name">dc_message</span>
      </div>
    </div>



    <div id="section">










      


    <!-- if method_list -->

    <div id="methods">


      <h3 class="section-bar">Public Instance methods</h3>


      <div id="method-M001910" class="method-detail">
        <a name="M001910"></a>

        <div class="method-heading">


          <a href="#M001910" class="method-signature">



          <span class="method-name">dm_eig1_ssl2tp</span><span class="method-args">( amat, eigen_r, eigen_i, eigvec_r, eigvec_i, info, [sort], [reverse] ) </span>



          </a>

        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Subroutine </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt>amat  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(:,:)</tt>

<table>
<tr><td valign="top"> :</td><td> 入力正方行列

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>eigen_r  </tt></b>  <tt> </tt> :</td><td><tt>real(8), intent(out), dimension(:)</tt>

<table>
<tr><td valign="top"> :</td><td> 固有値実数部

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>eigen_i  </tt></b>  <tt> </tt> :</td><td><tt>real(8), intent(out), dimension(:)</tt>

<table>
<tr><td valign="top"> :</td><td> 固有値虚数部

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>eigvec_r  </tt></b>  <tt> </tt> :</td><td><tt>real(8), intent(out), dimension(size(amat,1),size(eigen_r))</tt>

<table>
<tr><td valign="top"> :</td><td> 固有ベクトル実部

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>eigvec_i  </tt></b>  <tt> </tt> :</td><td><tt>real(8), intent(out), dimension(size(amat,1),size(eigen_i))</tt>

<table>
<tr><td valign="top"> :</td><td> 固有ベクトル虚部

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>info  </tt></b>  <tt> </tt> :</td><td><tt>integer, intent(out)</tt>

<table>
<tr><td valign="top"> :</td><td> ステータス

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>sort  </tt></b>  <tt> </tt> :</td><td><tt>character(len=2), intent(in), optional</tt>

<table>
<tr><td valign="top"> :</td><td> 並び変えの量

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>reverse  </tt></b>  <tt> </tt> :</td><td><tt>logical, intent(in), optional</tt>

<table>
<tr><td valign="top"> :</td><td> 並び変えスイッチ

</td></tr>
</table>
</td></tr>
</table>
<p>
このサブルーチンは固有値計算用共通インターフェースを与える <a
href="eigmatrix.html">eigmatrix</a> モジュールの公開サブルーチン eigen
として用いられる.
</p>
<pre>
  * 行列 AMAT の i 番目固有値を eigen_r(i), eigen_i(i) に格納
  * 対応する固有ベクトルを eigvec_r(:,i), eigvec_i(:,i) に格納
  * 格納する固有値の数は引数 eigen_r の大きさで決まる

  * 固有値の順番は sort と order で定められる.
  * sort によって順番を定めるために用いる量を指定する.
    実部(R), 実部の絶対値(RA), 虚部(I), 虚部の絶対値(IA)
  * reverse によって小さい順(.false.), 大きい順(.true.)を指定できる.
  * デフォルトは sort='R', reverse=.false.
</pre>
<p>
内部では DM_EIG1/SSL2TP ルーチンによる実行列の固有値/固有ベクトル計算を
行っている. が, ユーザーは用いているライブラリとサブルーチンを意識
することなく使うことができる.
</p>


          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M001910-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M001910-source">
<pre>
  subroutine dm_eig1_ssl2tp(amat,eigen_r,eigen_i,eigvec_r,eigvec_i, info,sort,reverse )
    !
    ! このサブルーチンは固有値計算用共通インターフェースを与える
    ! eigmatrix モジュールの公開サブルーチン eigen として用いられる. 
    !
    !   * 行列 AMAT の i 番目固有値を eigen_r(i), eigen_i(i) に格納
    !   * 対応する固有ベクトルを eigvec_r(:,i), eigvec_i(:,i) に格納
    !   * 格納する固有値の数は引数 eigen_r の大きさで決まる
    !
    !   * 固有値の順番は sort と order で定められる. 
    !   * sort によって順番を定めるために用いる量を指定する. 
    !     実部(R), 実部の絶対値(RA), 虚部(I), 虚部の絶対値(IA)
    !   * reverse によって小さい順(.false.), 大きい順(.true.)を指定できる.
    !   * デフォルトは sort='R', reverse=.false.
    !
    ! 内部では DM_EIG1/SSL2TP ルーチンによる実行列の固有値/固有ベクトル計算を
    ! 行っている. が, ユーザーは用いているライブラリとサブルーチンを意識
    ! することなく使うことができる. 
    !


   !------------ 引数 ------------
    real(8), dimension(:,:)                   :: amat      ! 入力正方行列
    real(8), intent(out), dimension(:)        :: eigen_r   ! 固有値実数部
    real(8), intent(out), dimension(:)        :: eigen_i   ! 固有値虚数部
    real(8), intent(out), dimension(size(amat,1),size(eigen_r))   :: eigvec_r  ! 固有ベクトル実部
    real(8), intent(out), dimension(size(amat,1),size(eigen_i))   :: eigvec_i  ! 固有ベクトル虚部
    integer, intent(out)                      :: info      ! ステータス
    character(len=2), intent(in), optional    :: sort      ! 並び変えの量
    logical, intent(in), optional             :: reverse   ! 並び変えスイッチ

   !------------ 作業変数 ------------
    real(8), dimension(size(amat,1))              :: wr    ! 固有値実数部
    real(8), dimension(size(amat,1))              :: wi    ! 固有値虚数部
    real(8), dimension(size(amat,1),size(amat,1)) :: vec   ! 固有ベクトル
    real(8), dimension(size(amat,1))              :: work  ! 作業変数
    integer, dimension(size(amat,1))              :: index ! 並び変え用
    integer, parameter :: mode=0! DM_EIG1へ渡すスイッチ

    integer :: nm, i, j

    !------- 形状チェック ------
    if (size(amat,1) /= size(amat,2))then
       call MessageNotify('E','DM_EIG1_SSL2','Input matrix not square')
    else
       nm = size(amat,1)
    endif

    !------- DM_EIG1/SSL2TP による計算 ------
    call dm_eig1(amat,nm,nm,mode,wr,wi,vec,work,info)

    !------- サブルーチンエラー処理 -------
    if ( info /= 0 ) then
       call MessageNotify('W','DM_EIG1_SSL2', 'Error in calculating eigenvalues/vectors...',i=(/info/) )
       return
    endif

    !------- 固有ベクトル入れ換え -------
    if ( present(sort) ) then
       if ( sort == 'RA' ) then          ! 固有値実部の絶対値
          index=indexx(abs(wr))
       elseif ( trim(sort) == 'I' ) then ! 固有値虚部
          index=indexx(wi)
       elseif ( sort == 'IA' ) then      ! 固有値虚部の絶対値
          index=indexx(abs(wi))
       else
          index=indexx(wr)               ! defaultは固有値実部
       endif
    else
       index=indexx(wr)                  ! defaultは固有値実部
    endif

    if ( present(reverse) )then
       if ( reverse ) then               ! 大きい順
          index=index(size(index):1:-1)
       endif
    endif

    do i=1,size(eigen_r)
       j = index(i)
       eigen_r(i) = wr(j)
       eigen_i(i) = wi(j)

       if ( wi(j) == 0 ) then
          eigvec_r(:,i) = vec(:,j)
          eigvec_i(:,i) = 0.0
       else if ( wi(j) == -wi(j+1) ) then
          eigvec_r(:,i) = vec(:,j)
          eigvec_i(:,i) = vec(:,j+1)
       else
          eigvec_r(:,i) = vec(:,j-1)
          eigvec_i(:,i) = -vec(:,j)
       endif
    enddo

  end subroutine dm_eig1_ssl2tp
</pre>
          </div>

        </div>
      </div>



    </div>



  </div>

<div id="validator-badges">
  <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
</div>

</body>
</html>
