<?xml version="1.0" encoding="euc-jp"?>
<!DOCTYPE html
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>Class: wt_mpi_module</title>
  <meta http-equiv="Content-Type" content="text/html; charset=euc-jp" />
  <meta http-equiv="Content-Script-Type" content="text/javascript" />
  <link rel="stylesheet" href=".././rdoc-style.css" type="text/css" media="screen" />
  <script type="text/javascript">
  // <![CDATA[

  function popupCode( url ) {
    window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
  }

  function toggleCode( id ) {
    if ( document.getElementById )
      elem = document.getElementById( id );
    else if ( document.all )
      elem = eval( "document.all." + id );
    else
      return false;

    elemStyle = elem.style;

    if ( elemStyle.display != "block" ) {
      elemStyle.display = "block"
    } else {
      elemStyle.display = "none"
    }

    return true;
  }

  // Make codeblocks hidden by default
  document.writeln( "<style type=\"text/css\">div.method-source-code { display: none }</style>" )

  // ]]>
  </script>

</head>
<body>


    <div id="classHeader">
        <table class="header-table">
        <tr class="top-aligned-row">
          <td><strong>Class</strong></td>
          <td class="class-name-in-header">wt_mpi_module</td>
        </tr>
        <tr class="top-aligned-row">
            <td><strong>In:</strong></td>
            <td>


                <a href="../files/src-mpi/wt_mpi_module_f90.html">

                src-mpi/wt_mpi_module.f90

                </a>


        <br />
            </td>
        </tr>


        </table>
    </div>
  <!-- banner header -->

  <div id="bodyContent">


  <div id="contextContent">



    <div id="description">
      <h1><a href="wt_mpi_module.html">wt_mpi_module</a></h1>
<table>
<tr><td valign="top">Authors:</td><td>Shin-ichi Takehiro, Youhei SASAKI

</td></tr>
<tr><td valign="top">Version:</td><td>$Id: <a
href="../files/src-mpi/wt_mpi_module_f90.html">wt_mpi_module.f90</a>,v 1.8
2009-02-27 05:21:52 uwabami Exp $

</td></tr>
<tr><td valign="top">Copyright&amp;License:</td><td>See <a href="../../../COPYRIGHT">COPYRIGHT</a>

</td></tr>
</table>
<h2>概要</h2>
<p>
spml/wt_mpi_module モジュールは球面上および球殻内での流体運動を
スペクトル法と MPI 並列化によって数値計算するための Fortran90
関数を提供するものである.
</p>
<p>
水平方向に球面調和函数変換および上下の境界壁を扱うための
チェビシェフ変換を用いる場合のスペクトル計算のためのさまざまな
関数を提供する.
</p>
<p>
内部で <a href="wt_module.html">wt_module</a>, <a
href="wa_mpi_module.html">wa_mpi_module</a> を用いている.
最下部では球面調和変換 およびチェビシェフ変換のエンジンとして ISPACK の
Fortran77 サブルーチンを用いている.
</p>
<h2>関数・変数の名前と型について</h2>
<h3>命名法</h3>
<ul>
<li>関数名の先頭(wt_, nmz_, nz_, xyz_, xvz_ wz_, w_, xy_, x_, y_, z_, a_)は,
返す値の形を示している.

<pre>
   wt_ :: スペクトルデータ(球面調和函数・チェビシェフ変換)
   nmz_:: 水平スペクトルデータ(全波数 n, 帯状波数各成分, 動径)
   nz_ :: 水平スペクトルデータ(全波数 n, 動径)
  xyz_ :: 3 次元格子点データ(経度・緯度・動径)
  xvz_ :: 3 次元分散格子点データ(経度・緯度・動径)
   wz_ :: 水平スペクトル, 動径格子点データ
</pre>
</li>
<li>関数名の間の文字列(DLon, GradLat, GradLat, DivLon, DivLat, Lapla,..) は,
その関数の作用を表している.

</li>
<li>関数名の最後 (_wt, _xyz, _xvz, <em>wz</em>, _w, _xy, _xv, _x, _y, _z, _a)
は, 入力変数の形がスペクトルデータおよび格子点データであることを示している.

<pre>
      _wt :: スペクトルデータ
     _xyz :: 3 次元格子点データ
 _xyz_xyz :: 2 つの3 次元格子点データ, ...
     _xvz :: 3 次元分散格子点データ
 _xvz_xvz :: 2 つの3 次元分散格子点データ, ...
</pre>
</li>
</ul>
<h3>各データの種類の説明</h3>
<ul>
<li>xyz : 3 次元格子点データ(経度・緯度・動径)

<ul>
<li>変数の種類と次元は real(8), dimension(0:im-1,jm,0:km).

</li>
<li>im, jm, km はそれぞれ経度, 緯度, 動径座標の格子点数であり, サブルーチン <a
href="wt_mpi_module.html#M000013">wt_mpi_Initial</a>
にてあらかじめ設定しておく.

</li>
</ul>
</li>
<li>xvz : 3 次元分散格子点データ(経度・緯度・動径)

<ul>
<li>変数の種類と次元は real(8), dimension(0:im-1,<a
href="wt_mpi_module.html#M000053">jc</a>,0:km).

</li>
<li>im, km はそれぞれ経度, 動径座標の格子点数であり,

</li>
<li><a href="wt_mpi_module.html#M000053">jc</a>
はこのプロセスで保有する緯度格子点数である. サブルーチン <a
href="wt_mpi_module.html#M000013">wt_mpi_Initial</a> を呼ぶと <a
href="wt_mpi_module.html#M000053">jc</a> が設定される.

</li>
</ul>
</li>
<li>wt : スペクトルデータ

<ul>
<li>変数の種類と次元は real(8), dimension((nm+1)*(nm+1),0:lm).

</li>
<li>nm は球面調和函数の最大全波数, lm はチェビシェフ多項式の最大次数 であり,
サブルーチン wt_Initial にてあらかじめ設定しておく.

</li>
<li>水平スペクトルデータの格納のされ方は関数 <a
href="wt_mpi_module.html#M000062">l_nm</a>, <a
href="wt_mpi_module.html#M000066">nm_l</a> によって調べる ことができる.

</li>
</ul>
</li>
<li>nmz : 水平スペクトルデータの並んだ 3 次元配列.

<ul>
<li>変数の種類と次元は real(8), dimension(0:nm,-nm:nm,0:km).

</li>
<li>第 1 次元が水平全波数, 第 2 次元が帯状波数, 第 3 次元が動径座標を表す.

</li>
<li>nm は球面調和函数の最大全波数であり, サブルーチン wt_Initial にて
あらかじめ設定しておく.

</li>
</ul>
</li>
<li>nz : スペクトルデータの並んだ 2 次元配列.

<ul>
<li>変数の種類と次元は real(8), dimension(0:nm,0:km). 第 1
次元が水平全波数を表す.

</li>
<li>nm は球面調和函数の最大全波数であり, サブルーチン wt_Initial
にてあらかじめ設定しておく.

</li>
</ul>
</li>
<li>wz : 水平スペクトル, 動径格子点データ.

<ul>
<li>変数の種類と次元は real(8), dimension((nm+1)*(nm+1),0:km).

</li>
</ul>
</li>
<li>wt_ で始まる関数が返す値はスペクトルデータに同じ.

</li>
<li>xyz_ で始まる関数が返す値は 3 次元格子点データに同じ.

</li>
<li>xvz_ で始まる関数が返す値は 3 次元分散格子点データに同じ.

</li>
<li>wz_ で始まる関数が返す値は水平スペクトル, 動径格子点データに同じ.

</li>
<li>スペクトルデータに対する微分等の作用とは, 対応する格子点データに
微分などを作用させたデータをスペクトル変換したものことである.

</li>
</ul>
<h2>変数・手続き群の要約</h2>
<h4>初期化</h4>
<table>
<tr><td valign="top"><a href="wt_mpi_module.html#M000013">wt_mpi_Initial</a> :</td><td>スペクトル変換の格子点数, 波数, 領域の大きさの設定

</td></tr>
</table>
<h4>座標変数</h4>
<table>
<tr><td valign="top"><a href="wt_mpi_module.html#M000054">x_Lon</a>, <a href="wt_mpi_module.html#M000055">x_Lon_Weight</a>,  :</td><td>格子点座標(経度)と重みを格納した 1 次元配列

</td></tr>
<tr><td valign="top"><a href="wt_mpi_module.html#M000056">y_Lat</a>, <a href="wt_mpi_module.html#M000057">y_Lat_Weight</a>   :</td><td>格子点座標(緯度)と重みを格納した 1 次元配列

</td></tr>
<tr><td valign="top"><a href="wt_mpi_module.html#M000058">v_Lat</a>, <a href="wt_mpi_module.html#M000059">v_Lat_Weight</a>   :</td><td>分散格子点座標(緯度)と重みを格納した 1 次元配列

</td></tr>
<tr><td valign="top"><a href="wt_mpi_module.html#M000060">z_Rad</a>, <a href="wt_mpi_module.html#M000061">z_Rad_Weight</a>   :</td><td>格子点座標(同形)と重みを格納した 1 次元配列

</td></tr>
<tr><td valign="top"><a href="wt_mpi_module.html#M000072">xyz_Lon</a>, <a href="wt_mpi_module.html#M000073">xyz_Lat</a>, <a href="wt_mpi_module.html#M000074">xyz_Rad</a> :</td><td>格子点データの経度・緯度・動径座標(X,Y,Z) (格子点データ型 3 次元配列)

</td></tr>
<tr><td valign="top"><a href="wt_mpi_module.html#M000010">xvz_Lon</a>, <a href="wt_mpi_module.html#M000011">xvz_Lat</a>, <a href="wt_mpi_module.html#M000012">xvz_Rad</a> :</td><td>格子点データの経度・緯度・動径座標(X,Y,Z) (分散格子点データ型 3 次元配列)

</td></tr>
</table>
<h4>基本変換</h4>
<table>
<tr><td valign="top"><a href="wt_mpi_module.html#M000085">xyz_wt</a>, <a href="wt_mpi_module.html#M000086">wt_xyz</a> :</td><td>スペクトルデータと 3 次元格子データの間の変換 (球面調和函数,
チェビシェフ変換)

</td></tr>
<tr><td valign="top"><a href="wt_mpi_module.html#M000014">xvz_wt</a>, <a href="wt_mpi_module.html#M000015">wt_xvz</a> :</td><td>スペクトルデータと 3 次元分散格子データの間の変換 (球面調和函数,
チェビシェフ変換)

</td></tr>
<tr><td valign="top"><a href="wt_mpi_module.html#M000087">xyz_wz</a>, <a href="wt_mpi_module.html#M000088">wz_xyz</a> :</td><td>3 次元格子データと水平スペクトル・動径格子データとの間の変換 (球面調和函数)

</td></tr>
<tr><td valign="top"><a href="wt_mpi_module.html#M000016">xvz_wz</a>, <a href="wt_mpi_module.html#M000017">wz_xvz</a> :</td><td>3 次元分散格子データと水平スペクトル・動径格子データとの間の変換
(球面調和函数)

</td></tr>
<tr><td valign="top"><a href="wt_mpi_module.html#M000089">wz_wt</a>, <a href="wt_mpi_module.html#M000090">wt_wz</a>   :</td><td>スペクトルデータと水平スペクトル・動径格子データとの間の変換
(チェビシェフ変換)

</td></tr>
<tr><td valign="top"><a href="wt_mpi_module.html#M000077">w_xy</a>, <a href="wt_mpi_module.html#M000078">xy_w</a>     :</td><td>スペクトルデータと 2 次元水平格子データの間の変換(球面調和函数変換)

</td></tr>
<tr><td valign="top"><a href="wt_mpi_module.html#M000079">w_xv</a>, <a href="wt_mpi_module.html#M000080">xv_w</a>     :</td><td>スペクトルデータと 2 次元水平分散格子データの間の変換(球面調和函数変換)

</td></tr>
<tr><td valign="top"><a href="wt_mpi_module.html#M000083">az_at</a>, <a href="wt_mpi_module.html#M000084">at_az</a>   :</td><td>同時に複数個行う
(チェビシェフ変換)格子データとチェビシェフデータの間の変換を

</td></tr>
<tr><td valign="top"><a href="wt_mpi_module.html#M000062">l_nm</a>, <a href="wt_mpi_module.html#M000066">nm_l</a>     :</td><td>スペクトルデータの格納位置と全波数・帯状波数の変換

</td></tr>
</table>
<h4>微分</h4>
<table>
<tr><td valign="top"><a href="wt_mpi_module.html#M000091">wt_DRad_wt</a>     :</td><td>スペクトルデータに動径微分∂/∂r を作用させる

</td></tr>
<tr><td valign="top"><a href="wt_mpi_module.html#M000092">wt_DivRad_wt</a>   :</td><td>スペクトルデータに発散型動径微分 1 /r^2 ∂/∂r r^2 = ∂/∂r + 2/r
を作用させる

</td></tr>
<tr><td valign="top"><a href="wt_mpi_module.html#M000093">wt_RotRad_wt</a>   :</td><td>スペクトルデータに回転型動径微分 1/r ∂/∂rr = ∂/∂r + 1/r を作用させる

</td></tr>
<tr><td valign="top"><a href="wt_mpi_module.html#M000094">wt_Lapla_wt</a>    :</td><td>スペクトルデータにラプラシアンを作用させる

</td></tr>
<tr><td valign="top"><a href="wt_mpi_module.html#M000095">xyz_GradLon_wt</a> :</td><td>スペクトルデータに勾配型経度微分 1/rcosφ・∂/∂λを作用させる

</td></tr>
<tr><td valign="top"><a href="wt_mpi_module.html#M000018">xvz_GradLon_wt</a> :</td><td>スペクトルデータに勾配型経度微分 1/rcosφ・∂/∂λを作用させる

</td></tr>
<tr><td valign="top"><a href="wt_mpi_module.html#M000096">xyz_GradLat_wt</a> :</td><td>スペクトルデータに勾配型緯度微分 1/r・∂/∂φを作用させる

</td></tr>
<tr><td valign="top"><a href="wt_mpi_module.html#M000019">xvz_GradLat_wt</a> :</td><td>スペクトルデータに勾配型緯度微分 1/r・∂/∂φを作用させる(分散格子)

</td></tr>
<tr><td valign="top"><a href="wt_mpi_module.html#M000097">wt_DivLon_xyz</a>  :</td><td>格子データに発散型経度微分 1/rcosφ・∂/∂λを作用させる

</td></tr>
<tr><td valign="top"><a href="wt_mpi_module.html#M000020">wt_DivLon_xvz</a>  :</td><td>分散格子データに発散型経度微分 1/rcosφ・∂/∂λを作用させるa

</td></tr>
</table>

    </div>





   </div>


    <div id="method-list">
      <h3 class="section-bar">Methods</h3>

      <div class="name-list">

        <a href="#M000052">AvrLatRad_vz</a>&nbsp;&nbsp;

        <a href="#M000139">AvrLatRad_yz</a>&nbsp;&nbsp;

        <a href="#M000149">AvrLat_v</a>&nbsp;&nbsp;

        <a href="#M000144">AvrLat_y</a>&nbsp;&nbsp;

        <a href="#M000049">AvrLonLatRad_xvz</a>&nbsp;&nbsp;

        <a href="#M000133">AvrLonLatRad_xyz</a>&nbsp;&nbsp;

        <a href="#M000148">AvrLonLat_xv</a>&nbsp;&nbsp;

        <a href="#M000136">AvrLonLat_xy</a>&nbsp;&nbsp;

        <a href="#M000142">AvrLonRad_xz</a>&nbsp;&nbsp;

        <a href="#M000143">AvrLon_x</a>&nbsp;&nbsp;

        <a href="#M000145">AvrRad_z</a>&nbsp;&nbsp;

        <a href="#M000042">IntLatRad_vz</a>&nbsp;&nbsp;

        <a href="#M000116">IntLatRad_yz</a>&nbsp;&nbsp;

        <a href="#M000126">IntLat_v</a>&nbsp;&nbsp;

        <a href="#M000121">IntLat_y</a>&nbsp;&nbsp;

        <a href="#M000039">IntLonLatRad_xvz</a>&nbsp;&nbsp;

        <a href="#M000110">IntLonLatRad_xyz</a>&nbsp;&nbsp;

        <a href="#M000125">IntLonLat_xv</a>&nbsp;&nbsp;

        <a href="#M000113">IntLonLat_xy</a>&nbsp;&nbsp;

        <a href="#M000119">IntLonRad_xz</a>&nbsp;&nbsp;

        <a href="#M000120">IntLon_x</a>&nbsp;&nbsp;

        <a href="#M000122">IntRad_z</a>&nbsp;&nbsp;

        <a href="#M000159">Interpolate_wt</a>&nbsp;&nbsp;

        <a href="#M000081">at_Dr_at</a>&nbsp;&nbsp;

        <a href="#M000084">at_az</a>&nbsp;&nbsp;

        <a href="#M000083">az_at</a>&nbsp;&nbsp;

        <a href="#M000053">jc</a>&nbsp;&nbsp;

        <a href="#M000062">l_nm</a>&nbsp;&nbsp;

        <a href="#M000063">l_nm</a>&nbsp;&nbsp;

        <a href="#M000064">l_nm</a>&nbsp;&nbsp;

        <a href="#M000065">l_nm</a>&nbsp;&nbsp;

        <a href="#M000066">nm_l</a>&nbsp;&nbsp;

        <a href="#M000067">nm_l</a>&nbsp;&nbsp;

        <a href="#M000162">nmz_PoloidalEnergySpectrum_wt</a>&nbsp;&nbsp;

        <a href="#M000160">nmz_ToroidalEnergySpectrum_wt</a>&nbsp;&nbsp;

        <a href="#M000163">nz_PoloidalEnergySpectrum_wt</a>&nbsp;&nbsp;

        <a href="#M000161">nz_ToroidalEnergySpectrum_wt</a>&nbsp;&nbsp;

        <a href="#M000082">t_Dr_t</a>&nbsp;&nbsp;

        <a href="#M000047">v_AvrLonRad_xvz</a>&nbsp;&nbsp;

        <a href="#M000147">v_AvrLon_xv</a>&nbsp;&nbsp;

        <a href="#M000051">v_AvrRad_vz</a>&nbsp;&nbsp;

        <a href="#M000037">v_IntLonRad_xvz</a>&nbsp;&nbsp;

        <a href="#M000124">v_IntLon_xv</a>&nbsp;&nbsp;

        <a href="#M000041">v_IntRad_vz</a>&nbsp;&nbsp;

        <a href="#M000058">v_Lat</a>&nbsp;&nbsp;

        <a href="#M000059">v_Lat_Weight</a>&nbsp;&nbsp;

        <a href="#M000043">vz_AvrLon_xvz</a>&nbsp;&nbsp;

        <a href="#M000033">vz_IntLon_xvz</a>&nbsp;&nbsp;

        <a href="#M000079">w_xv</a>&nbsp;&nbsp;

        <a href="#M000077">w_xy</a>&nbsp;&nbsp;

        <a href="#M000164">wt_Boundaries</a>&nbsp;&nbsp;

        <a href="#M000173">wt_BoundariesGrid</a>&nbsp;&nbsp;

        <a href="#M000169">wt_BoundariesTau</a>&nbsp;&nbsp;

        <a href="#M000091">wt_DRad_wt</a>&nbsp;&nbsp;

        <a href="#M000021">wt_DivLat_xvz</a>&nbsp;&nbsp;

        <a href="#M000098">wt_DivLat_xyz</a>&nbsp;&nbsp;

        <a href="#M000020">wt_DivLon_xvz</a>&nbsp;&nbsp;

        <a href="#M000097">wt_DivLon_xyz</a>&nbsp;&nbsp;

        <a href="#M000092">wt_DivRad_wt</a>&nbsp;&nbsp;

        <a href="#M000022">wt_Div_xvz_xvz_xvz</a>&nbsp;&nbsp;

        <a href="#M000099">wt_Div_xyz_xyz_xyz</a>&nbsp;&nbsp;

        <a href="#M000150">wt_KxRGrad_wt</a>&nbsp;&nbsp;

        <a href="#M000152">wt_L2Inv_wt</a>&nbsp;&nbsp;

        <a href="#M000151">wt_L2_wt</a>&nbsp;&nbsp;

        <a href="#M000175">wt_LaplaPol2PolGrid_wt</a>&nbsp;&nbsp;

        <a href="#M000094">wt_Lapla_wt</a>&nbsp;&nbsp;

        <a href="#M000168">wt_PolMagBoundaries</a>&nbsp;&nbsp;

        <a href="#M000177">wt_PolmagBoundariesGrid</a>&nbsp;&nbsp;

        <a href="#M000172">wt_PolmagBoundariesTau</a>&nbsp;&nbsp;

        <a href="#M000157">wt_Potential2Rotation</a>&nbsp;&nbsp;

        <a href="#M000031">wt_Potential2RotationMPI</a>&nbsp;&nbsp;

        <a href="#M000156">wt_Potential2Vector</a>&nbsp;&nbsp;

        <a href="#M000030">wt_Potential2VectorMPI</a>&nbsp;&nbsp;

        <a href="#M000153">wt_QOperator_wt</a>&nbsp;&nbsp;

        <a href="#M000029">wt_RadRotRot_xvz_xvz_xvz</a>&nbsp;&nbsp;

        <a href="#M000155">wt_RadRotRot_xyz_xyz_xyz</a>&nbsp;&nbsp;

        <a href="#M000028">wt_RadRot_xvz_xvz</a>&nbsp;&nbsp;

        <a href="#M000154">wt_RadRot_xyz_xyz</a>&nbsp;&nbsp;

        <a href="#M000093">wt_RotRad_wt</a>&nbsp;&nbsp;

        <a href="#M000026">wt_RotRad_xvz_xvz</a>&nbsp;&nbsp;

        <a href="#M000103">wt_RotRad_xyz_xyz</a>&nbsp;&nbsp;

        <a href="#M000165">wt_TorBoundaries</a>&nbsp;&nbsp;

        <a href="#M000174">wt_TorBoundariesGrid</a>&nbsp;&nbsp;

        <a href="#M000170">wt_TorBoundariesTau</a>&nbsp;&nbsp;

        <a href="#M000167">wt_TorMagBoundaries</a>&nbsp;&nbsp;

        <a href="#M000176">wt_TormagBoundariesGrid</a>&nbsp;&nbsp;

        <a href="#M000171">wt_TormagBoundariesTau</a>&nbsp;&nbsp;

        <a href="#M000158">wt_VGradV</a>&nbsp;&nbsp;

        <a href="#M000032">wt_VGradVMPI</a>&nbsp;&nbsp;

        <a href="#M000076">wt_VMiss</a>&nbsp;&nbsp;

        <a href="#M000013">wt_mpi_Initial</a>&nbsp;&nbsp;

        <a href="#M000090">wt_wz</a>&nbsp;&nbsp;

        <a href="#M000015">wt_xvz</a>&nbsp;&nbsp;

        <a href="#M000086">wt_xyz</a>&nbsp;&nbsp;

        <a href="#M000166">wz_LaplaPol2Pol_wz</a>&nbsp;&nbsp;

        <a href="#M000075">wz_RAD</a>&nbsp;&nbsp;

        <a href="#M000089">wz_wt</a>&nbsp;&nbsp;

        <a href="#M000017">wz_xvz</a>&nbsp;&nbsp;

        <a href="#M000088">wz_xyz</a>&nbsp;&nbsp;

        <a href="#M000046">x_AvrLatRad_xvz</a>&nbsp;&nbsp;

        <a href="#M000130">x_AvrLatRad_xyz</a>&nbsp;&nbsp;

        <a href="#M000146">x_AvrLat_xv</a>&nbsp;&nbsp;

        <a href="#M000134">x_AvrLat_xy</a>&nbsp;&nbsp;

        <a href="#M000141">x_AvrRad_xz</a>&nbsp;&nbsp;

        <a href="#M000036">x_IntLatRad_xvz</a>&nbsp;&nbsp;

        <a href="#M000107">x_IntLatRad_xyz</a>&nbsp;&nbsp;

        <a href="#M000123">x_IntLat_xv</a>&nbsp;&nbsp;

        <a href="#M000111">x_IntLat_xy</a>&nbsp;&nbsp;

        <a href="#M000118">x_IntRad_xz</a>&nbsp;&nbsp;

        <a href="#M000054">x_Lon</a>&nbsp;&nbsp;

        <a href="#M000055">x_Lon_Weight</a>&nbsp;&nbsp;

        <a href="#M000045">xv_AvrRad_xvz</a>&nbsp;&nbsp;

        <a href="#M000035">xv_IntRad_xvz</a>&nbsp;&nbsp;

        <a href="#M000071">xv_Lat</a>&nbsp;&nbsp;

        <a href="#M000070">xv_Lon</a>&nbsp;&nbsp;

        <a href="#M000080">xv_w</a>&nbsp;&nbsp;

        <a href="#M000023">xvz_Div_xvz_xvz_xvz</a>&nbsp;&nbsp;

        <a href="#M000019">xvz_GradLat_wt</a>&nbsp;&nbsp;

        <a href="#M000018">xvz_GradLon_wt</a>&nbsp;&nbsp;

        <a href="#M000027">xvz_KGrad_wt</a>&nbsp;&nbsp;

        <a href="#M000011">xvz_LAT</a>&nbsp;&nbsp;

        <a href="#M000010">xvz_LON</a>&nbsp;&nbsp;

        <a href="#M000012">xvz_RAD</a>&nbsp;&nbsp;

        <a href="#M000025">xvz_RotLat_wt_wt</a>&nbsp;&nbsp;

        <a href="#M000024">xvz_RotLon_wt_wt</a>&nbsp;&nbsp;

        <a href="#M000014">xvz_wt</a>&nbsp;&nbsp;

        <a href="#M000016">xvz_wz</a>&nbsp;&nbsp;

        <a href="#M000129">xy_AvrRad_xyz</a>&nbsp;&nbsp;

        <a href="#M000106">xy_IntRad_xyz</a>&nbsp;&nbsp;

        <a href="#M000069">xy_Lat</a>&nbsp;&nbsp;

        <a href="#M000068">xy_Lon</a>&nbsp;&nbsp;

        <a href="#M000078">xy_w</a>&nbsp;&nbsp;

        <a href="#M000100">xyz_Div_xyz_xyz_xyz</a>&nbsp;&nbsp;

        <a href="#M000096">xyz_GradLat_wt</a>&nbsp;&nbsp;

        <a href="#M000095">xyz_GradLon_wt</a>&nbsp;&nbsp;

        <a href="#M000073">xyz_LAT</a>&nbsp;&nbsp;

        <a href="#M000072">xyz_LON</a>&nbsp;&nbsp;

        <a href="#M000074">xyz_RAD</a>&nbsp;&nbsp;

        <a href="#M000102">xyz_RotLat_wt_wt</a>&nbsp;&nbsp;

        <a href="#M000101">xyz_RotLon_wt_wt</a>&nbsp;&nbsp;

        <a href="#M000085">xyz_wt</a>&nbsp;&nbsp;

        <a href="#M000087">xyz_wz</a>&nbsp;&nbsp;

        <a href="#M000044">xz_AvrLat_xvz</a>&nbsp;&nbsp;

        <a href="#M000128">xz_AvrLat_xyz</a>&nbsp;&nbsp;

        <a href="#M000034">xz_IntLat_xvz</a>&nbsp;&nbsp;

        <a href="#M000105">xz_IntLat_xyz</a>&nbsp;&nbsp;

        <a href="#M000131">y_AvrLonRad_xyz</a>&nbsp;&nbsp;

        <a href="#M000135">y_AvrLon_xy</a>&nbsp;&nbsp;

        <a href="#M000138">y_AvrRad_yz</a>&nbsp;&nbsp;

        <a href="#M000108">y_IntLonRad_xyz</a>&nbsp;&nbsp;

        <a href="#M000112">y_IntLon_xy</a>&nbsp;&nbsp;

        <a href="#M000115">y_IntRad_yz</a>&nbsp;&nbsp;

        <a href="#M000056">y_Lat</a>&nbsp;&nbsp;

        <a href="#M000057">y_Lat_Weight</a>&nbsp;&nbsp;

        <a href="#M000127">yz_AvrLon_xyz</a>&nbsp;&nbsp;

        <a href="#M000104">yz_IntLon_xyz</a>&nbsp;&nbsp;

        <a href="#M000050">z_AvrLat_vz</a>&nbsp;&nbsp;

        <a href="#M000137">z_AvrLat_yz</a>&nbsp;&nbsp;

        <a href="#M000048">z_AvrLonLat_xvz</a>&nbsp;&nbsp;

        <a href="#M000132">z_AvrLonLat_xyz</a>&nbsp;&nbsp;

        <a href="#M000140">z_AvrLon_xz</a>&nbsp;&nbsp;

        <a href="#M000040">z_IntLat_vz</a>&nbsp;&nbsp;

        <a href="#M000114">z_IntLat_yz</a>&nbsp;&nbsp;

        <a href="#M000038">z_IntLonLat_xvz</a>&nbsp;&nbsp;

        <a href="#M000109">z_IntLonLat_xyz</a>&nbsp;&nbsp;

        <a href="#M000117">z_IntLon_xz</a>&nbsp;&nbsp;

        <a href="#M000060">z_RAD</a>&nbsp;&nbsp;

        <a href="#M000061">z_RAD_WEIGHT</a>&nbsp;&nbsp;
      </div>
    </div>


  </div>


    <!-- if includes -->

    <div id="includes">
      <h3 class="section-bar">Included Modules</h3>

      <div id="includes-list">

        <span class="include-name">dc_message</span>

        <span class="include-name"><a href="lumatrix.html">lumatrix</a></span>

        <span class="include-name"><a href="w_base_mpi_module.html">w_base_mpi_module</a></span>

        <span class="include-name"><a href="w_deriv_mpi_module.html">w_deriv_mpi_module</a></span>

        <span class="include-name"><a href="w_integral_mpi_module.html">w_integral_mpi_module</a></span>

        <span class="include-name"><a href="wa_base_mpi_module.html">wa_base_mpi_module</a></span>

        <span class="include-name"><a href="wa_deriv_mpi_module.html">wa_deriv_mpi_module</a></span>

        <span class="include-name"><a href="wt_module.html">wt_module</a></span>
      </div>
    </div>



    <div id="section">










      


    <!-- if method_list -->

    <div id="methods">


      <h3 class="section-bar">Public Instance methods</h3>


      <div id="method-M000052" class="method-detail">
        <a name="M000052"></a>

        <div class="method-heading">


          <a href="#M000052" class="method-signature">



          <span class="method-name">AvrLatRad_vz</span><span class="method-args">( vz ) result(AvrLatRad_vz)</span>



          </a>

        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000052">AvrLatRad_vz</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 平均値

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>vz  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(<a href="wt_mpi_module.html#M000053">jc</a>,0:km),
intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 2 次元緯度動径(子午面)格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
緯度動径(子午面)積分
</p>
<p>
2 次元(VZ)格子点データの緯度動径(子午面)平均
</p>
<p>
2 次元データ f(φ,r) に対して
</p>
<pre>
   ∫f(φ,r) r^2cosφ dφdr /(2(r[o]^3-r[i]^3)/3)
</pre>
<p>
を計算する.
</p>


          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000052-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000052-source">
<pre>
    function AvrLatRad_vz(vz)  ! 緯度動径(子午面)積分
      !
      ! 2 次元(VZ)格子点データの緯度動径(子午面)平均
      !
      ! 2 次元データ f(φ,r) に対して
      !
      !    ∫f(φ,r) r^2cosφ dφdr /(2(r[o]^3-r[i]^3)/3) 
      !
      ! を計算する.
      !
      real(8), dimension(jc,0:km), intent(in) :: vz
      !(in) 2 次元緯度動径(子午面)格子点データ

      real(8)                   :: AvrLatRad_vz
      !(out) 平均値

      AvrLatRad_vz = IntLatRad_vz(vz)/(sum(y_Lat_Weight)*sum(z_Rad_Weight))

    end function AvrLatRad_vz
</pre>
          </div>

        </div>
      </div>


      <div id="method-M000139" class="method-detail">
        <a name="M000139"></a>

        <div class="method-heading">




          <span class="method-name">AvrLatRad_yz</span><span class="method-args">( yz ) result(AvrLatRad_yz)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000139">AvrLatRad_yz</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 平均値

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>yz  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(1:jm,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 2 次元緯度動径(子午面)格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
緯度動径(子午面)積分
</p>
<p>
2 次元(YZ)格子点データの緯度動径(子午面)平均
</p>
<p>
2 次元データ f(φ,r) に対して
</p>
<pre>
   ∫f(φ,r) r^2cosφ dφdr /(2(r[o]^3-r[i]^3)/3)
</pre>
<p>
を計算する.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001439">wt_module#AvrLatRad_yz</a>
</p>


        </div>
      </div>


      <div id="method-M000149" class="method-detail">
        <a name="M000149"></a>

        <div class="method-heading">




          <span class="method-name">AvrLat_v</span><span class="method-args">( v_data ) result(AvrLat_v)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000149">AvrLat_v</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 平均値

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>v_data(<a href="wt_mpi_module.html#M000053">jc</a>)  </tt></b>  <tt> </tt> :</td><td><tt>real(8), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 1 次元緯度格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
1 次元(Y)格子点データの緯度(Y)方向平均(1 層用).
</p>
<p>
実際には格子点データ各点毎に v_Y_Weight をかけた総和を計算し, v_Y_Weight
の総和で割ることで平均している.
</p>
<p>
Original external subprogram is <a
href="w_integral_mpi_module.html#M000860">w_integral_mpi_module#AvrLat_v</a>
</p>


        </div>
      </div>


      <div id="method-M000144" class="method-detail">
        <a name="M000144"></a>

        <div class="method-heading">




          <span class="method-name">AvrLat_y</span><span class="method-args">( y_data ) result(AvrLat_y)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000144">AvrLat_y</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 平均値

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>y_data(1:jm)  </tt></b>  <tt> </tt> :</td><td><tt>real(8), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 1 次元緯度格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
1 次元(Y)格子点データの緯度(Y)方向平均(1 層用).
</p>
<p>
実際には格子点データ各点毎に y_Y_Weight をかけた総和を計算し, y_Y_Weight
の総和で割ることで平均している.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001502">wt_module#AvrLat_y</a>
</p>


        </div>
      </div>


      <div id="method-M000049" class="method-detail">
        <a name="M000049"></a>

        <div class="method-heading">


          <a href="#M000049" class="method-signature">



          <span class="method-name">AvrLonLatRad_xvz</span><span class="method-args">( xvz ) result(AvrLonLatRad_xvz)</span>



          </a>

        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000049">AvrLonLatRad_xvz</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 全球平均値

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xvz  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,<a
href="wt_mpi_module.html#M000053">jc</a>,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 3 次元経度緯度動径格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
緯度経度動径(全球)積分
</p>
<p>
3 次元格子点データの緯度経度動径(全球)積分
</p>
<p>
3 次元データ f(λ,φ,r) に対して
</p>
<pre>
   ∫f(λ,φ,r) r^2cosφ dλdφdr /(4π(r[o]^3-r[i]^3)/3)
</pre>
<p>
を計算する.
</p>


          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000049-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000049-source">
<pre>
    function AvrLonLatRad_xvz(xvz) ! 緯度経度動径(全球)積分
      !
      ! 3 次元格子点データの緯度経度動径(全球)積分
      !
      ! 3 次元データ f(λ,φ,r) に対して
      !
      !    ∫f(λ,φ,r) r^2cosφ dλdφdr /(4π(r[o]^3-r[i]^3)/3) 
      !
      ! を計算する.
      !
      real(8), dimension(0:im-1,jc,0:km), intent(in) :: xvz
      !(in) 3 次元経度緯度動径格子点データ

      real(8)                     :: AvrLonLatRad_xvz
      !(out) 全球平均値

      AvrLonLatRad_xvz = IntLonLatRad_xvz(xvz) /(sum(x_Lon_Weight)*sum(y_Lat_Weight) * sum(z_Rad_Weight))

    end function AvrLonLatRad_xvz
</pre>
          </div>

        </div>
      </div>


      <div id="method-M000133" class="method-detail">
        <a name="M000133"></a>

        <div class="method-heading">




          <span class="method-name">AvrLonLatRad_xyz</span><span class="method-args">( xyz ) result(AvrLonLatRad_xyz)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000133">AvrLonLatRad_xyz</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 全球平均値

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xyz  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 3 次元経度緯度動径格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
緯度経度動径(全球)積分
</p>
<p>
3 次元格子点データの緯度経度動径(全球)積分
</p>
<p>
3 次元データ f(λ,φ,r) に対して
</p>
<pre>
   ∫f(λ,φ,r) r^2cosφ dλdφdr /(4π(r[o]^3-r[i]^3)/3)
</pre>
<p>
を計算する.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001436">wt_module#AvrLonLatRad_xyz</a>
</p>


        </div>
      </div>


      <div id="method-M000148" class="method-detail">
        <a name="M000148"></a>

        <div class="method-heading">




          <span class="method-name">AvrLonLat_xv</span><span class="method-args">( xv_data ) result(AvrLonLat_xv)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000148">AvrLonLat_xv</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 平均値

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xv_data(0:im-1,<a href="wt_mpi_module.html#M000053">jc</a>)  </tt></b>  <tt> </tt> :</td><td><tt>real(8), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 2 次元経度緯度格子点データ(0:im-1,<a
href="wt_mpi_module.html#M000053">jc</a>)

</td></tr>
</table>
</td></tr>
</table>
<p>
2 次元緯度経度格子点データの全領域平均(1 層用).
</p>
<p>
実際には格子点データ各点毎に x_X_Weight, v_Y_Weight をかけた 総和を計算し,
x_X_Weight*v_Y_Weight の総和で割ることで平均している.
</p>
<p>
Original external subprogram is <a
href="w_integral_mpi_module.html#M000857">w_integral_mpi_module#AvrLonLat_xv</a>
</p>


        </div>
      </div>


      <div id="method-M000136" class="method-detail">
        <a name="M000136"></a>

        <div class="method-heading">




          <span class="method-name">AvrLonLat_xy</span><span class="method-args">( xy_data ) result(AvrLonLat_xy)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000136">AvrLonLat_xy</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 平均値

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xy_data(0:im-1,1:jm)  </tt></b>  <tt> </tt> :</td><td><tt>real(8), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 2 次元経度緯度格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
2 次元緯度経度格子点データの全領域平均(1 層用).
</p>
<p>
実際には格子点データ各点毎に x_X_Weight, y_Y_Weight をかけた 総和を計算し,
x_X_Weight*y_Y_Weight の総和で割ることで平均している.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001500">wt_module#AvrLonLat_xy</a>
</p>


        </div>
      </div>


      <div id="method-M000142" class="method-detail">
        <a name="M000142"></a>

        <div class="method-heading">




          <span class="method-name">AvrLonRad_xz</span><span class="method-args">( xz ) result(AvrLonRad_xz)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000142">AvrLonRad_xz</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8)</tt>

<table>
<tr><td valign="top"> :</td><td> 積分値

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xz  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 2 次元格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
経度動径(緯度円)積分
</p>
<p>
2 次元(XZ)格子点データの経度動径平均
</p>
<p>
2 次元データ f(λ,r) に対して
</p>
<pre>
   ∫f(λ,r) r^2dλdr /(2π(r[o]^3-r[i]^3)/3)
</pre>
<p>
を計算する.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001442">wt_module#AvrLonRad_xz</a>
</p>


        </div>
      </div>


      <div id="method-M000143" class="method-detail">
        <a name="M000143"></a>

        <div class="method-heading">




          <span class="method-name">AvrLon_x</span><span class="method-args">( x_data ) result(AvrLon_x)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000143">AvrLon_x</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 平均値

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>x_data(0:im-1)  </tt></b>  <tt> </tt> :</td><td><tt>real(8), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 1 次元経度(X)格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
1 次元(X)格子点データの経度(X)方向平均(1 層用).
</p>
<p>
実際には格子点データ各点毎に x_X_Weight をかけた総和を計算し, x_X_Weight
の総和で割ることで平均している.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001501">wt_module#AvrLon_x</a>
</p>


        </div>
      </div>


      <div id="method-M000145" class="method-detail">
        <a name="M000145"></a>

        <div class="method-heading">




          <span class="method-name">AvrRad_z</span><span class="method-args">( z ) result(AvrRad_z)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000145">AvrRad_z</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 平均値

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>z  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 1 次元動径格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
1 次元(Z)格子点データの動径方向域平均.
</p>
<p>
1 次元データ f(r) に対して ∫f(r) r^2dr /((r[o]^3-r[i]^3)/3) を 計算する.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001443">wt_module#AvrRad_z</a>
</p>


        </div>
      </div>


      <div id="method-M000042" class="method-detail">
        <a name="M000042"></a>

        <div class="method-heading">


          <a href="#M000042" class="method-signature">



          <span class="method-name">IntLatRad_vz</span><span class="method-args">( vz ) result(IntLatRad_vz)</span>



          </a>

        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000042">IntLatRad_vz</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 積分値

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>vz  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(<a href="wt_mpi_module.html#M000053">jc</a>,0:km),
intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 2 次元緯度動径(子午面)格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
2 次元(VZ)格子点データの緯度動径積分(子午面)および平均
</p>
<p>
2 次元データ f(φ,r) に対して ∫f(φ,r) r^2cosφ dφdr を計算する.
</p>


          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000042-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000042-source">
<pre>
    function IntLatRad_vz(vz)
      !
      ! 2 次元(VZ)格子点データの緯度動径積分(子午面)および平均
      !
      ! 2 次元データ f(φ,r) に対して ∫f(φ,r) r^2cosφ dφdr を計算する.
      !
      real(8), dimension(jc,0:km), intent(in) :: vz
      !(in) 2 次元緯度動径(子午面)格子点データ

      real(8)                   :: IntLatRad_vz
      !(out) 積分値

      real(8)                   :: IntLatRadTMP
      integer :: j, k

      IntLatRad_vz = 0
      do k=0,km
         do j=1,jc
            IntLatRad_vz = IntLatRad_vz + vz(j,k) * v_Lat_Weight(j) * z_Rad_Weight(k)
         enddo
      enddo

      IntLatRadTmp=IntLatRad_vz
      CALL MPI_ALLREDUCE(IntLatRadTMP,IntLatRad_vz,1,MPI_REAL8, MPI_SUM,MPI_COMM_WORLD,IERR)

    end function IntLatRad_vz
</pre>
          </div>

        </div>
      </div>


      <div id="method-M000116" class="method-detail">
        <a name="M000116"></a>

        <div class="method-heading">




          <span class="method-name">IntLatRad_yz</span><span class="method-args">( yz ) result(IntLatRad_yz)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000116">IntLatRad_yz</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 積分値

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>yz  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(1:jm,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 2 次元緯度動径(子午面)格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
2 次元(YZ)格子点データの緯度動径積分(子午面)および平均
</p>
<p>
2 次元データ f(φ,r) に対して ∫f(φ,r) r^2cosφ dφdr を計算する.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001425">wt_module#IntLatRad_yz</a>
</p>


        </div>
      </div>


      <div id="method-M000126" class="method-detail">
        <a name="M000126"></a>

        <div class="method-heading">




          <span class="method-name">IntLat_v</span><span class="method-args">( v_data ) result(IntLat_v)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000126">IntLat_v</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 積分値

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>v_data(<a href="wt_mpi_module.html#M000053">jc</a>)  </tt></b>  <tt> </tt> :</td><td><tt>real(8), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 1 次元緯度(Y)格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
1 次元緯度(Y)格子点データの Y 方向積分(1 層用).
</p>
<p>
実際には格子点データ各点毎に v_Y_Weight をかけた総和を計算している.
</p>
<p>
Original external subprogram is <a
href="w_integral_mpi_module.html#M000856">w_integral_mpi_module#IntLat_v</a>
</p>


        </div>
      </div>


      <div id="method-M000121" class="method-detail">
        <a name="M000121"></a>

        <div class="method-heading">




          <span class="method-name">IntLat_y</span><span class="method-args">( y_data ) result(IntLat_y)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000121">IntLat_y</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 積分値

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>y_data(1:jm)  </tt></b>  <tt> </tt> :</td><td><tt>real(8), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 1 次元緯度(Y)格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
1 次元緯度(Y)格子点データの Y 方向積分(1 層用).
</p>
<p>
実際には格子点データ各点毎に y_Y_Weight をかけた総和を計算している.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001497">wt_module#IntLat_y</a>
</p>


        </div>
      </div>


      <div id="method-M000039" class="method-detail">
        <a name="M000039"></a>

        <div class="method-heading">


          <a href="#M000039" class="method-signature">



          <span class="method-name">IntLonLatRad_xvz</span><span class="method-args">( xvz ) result(IntLonLatRad_xvz)</span>



          </a>

        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000039">IntLonLatRad_xvz</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 全球積分値

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xvz  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,<a
href="wt_mpi_module.html#M000053">jc</a>,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 3 次元経度緯度動径格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
緯度経度動径(全球)積分
</p>
<p>
3 次元格子点データの緯度経度動径(全球)積分
</p>
<p>
3 次元データ f(λ,φ,r) に対して
</p>
<pre>
    ∫f(λ,φ,r) r^2cosφ dλdφdr
</pre>
<p>
を計算する.
</p>


          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000039-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000039-source">
<pre>
    function IntLonLatRad_xvz(xvz) ! 緯度経度動径(全球)積分
      !
      ! 3 次元格子点データの緯度経度動径(全球)積分
      !
      ! 3 次元データ f(λ,φ,r) に対して
      !
      !     ∫f(λ,φ,r) r^2cosφ dλdφdr 
      !
      ! を計算する.
      !
      real(8), dimension(0:im-1,jc,0:km), intent(in) :: xvz 
      !(in) 3 次元経度緯度動径格子点データ

      real(8)                     :: IntLonLatRad_xvz 
      !(out) 全球積分値

      real(8)                     :: IntLonLatRadTMP
      integer :: i, j, k

      IntLonLatRad_xvz = 0
      do k=0,km
         do j=1,jc
            do i=0,im-1
               IntLonLatRad_xvz = IntLonLatRad_xvz + xvz(i,j,k) * x_Lon_Weight(i) * v_Lat_Weight(j) * z_Rad_Weight(k)
            enddo
         enddo
      enddo

      IntLonLatRadTmp=IntLonLatRad_xvz
      CALL MPI_ALLREDUCE(IntLonLatRadTMP,IntLonLatRad_xvz,1,MPI_REAL8, MPI_SUM,MPI_COMM_WORLD,IERR)

    end function IntLonLatRad_xvz
</pre>
          </div>

        </div>
      </div>


      <div id="method-M000110" class="method-detail">
        <a name="M000110"></a>

        <div class="method-heading">




          <span class="method-name">IntLonLatRad_xyz</span><span class="method-args">( xyz ) result(IntLonLatRad_xyz)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000110">IntLonLatRad_xyz</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 全球積分値

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xyz  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 3 次元経度緯度動径格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
緯度経度動径(全球)積分
</p>
<p>
3 次元格子点データの緯度経度動径(全球)積分
</p>
<p>
3 次元データ f(λ,φ,r) に対して
</p>
<pre>
    ∫f(λ,φ,r) r^2cosφ dλdφdr
</pre>
<p>
を計算する.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001422">wt_module#IntLonLatRad_xyz</a>
</p>


        </div>
      </div>


      <div id="method-M000125" class="method-detail">
        <a name="M000125"></a>

        <div class="method-heading">




          <span class="method-name">IntLonLat_xv</span><span class="method-args">( xv_data ) result(IntLonLat_xv)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000125">IntLonLat_xv</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 積分値

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xv_data(0:im-1,<a href="wt_mpi_module.html#M000053">jc</a>)  </tt></b>  <tt> </tt> :</td><td><tt>real(8), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 2 次元経度緯度格子点データ(0:im-1,<a
href="wt_mpi_module.html#M000053">jc</a>)

</td></tr>
</table>
</td></tr>
</table>
<p>
2 次元緯度経度格子点データの全領域積分(1 層用).
</p>
<p>
実際には格子点データ各点毎に x_X_Weight, v_V_Weight をかけた
総和を計算している.
</p>
<p>
Original external subprogram is <a
href="w_integral_mpi_module.html#M000853">w_integral_mpi_module#IntLonLat_xv</a>
</p>


        </div>
      </div>


      <div id="method-M000113" class="method-detail">
        <a name="M000113"></a>

        <div class="method-heading">




          <span class="method-name">IntLonLat_xy</span><span class="method-args">( xy_data ) result(IntLonLat_xy)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000113">IntLonLat_xy</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 積分値

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xy_data(0:im-1,1:jm)  </tt></b>  <tt> </tt> :</td><td><tt>real(8), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 2 次元経度緯度格子点データ(0:im-1,1:jm)

</td></tr>
</table>
</td></tr>
</table>
<p>
2 次元緯度経度格子点データの全領域積分(1 層用).
</p>
<p>
実際には格子点データ各点毎に x_X_Weight, y_Y_Weight をかけた
総和を計算している.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001495">wt_module#IntLonLat_xy</a>
</p>


        </div>
      </div>


      <div id="method-M000119" class="method-detail">
        <a name="M000119"></a>

        <div class="method-heading">




          <span class="method-name">IntLonRad_xz</span><span class="method-args">( xz ) result(IntLonRad_xz)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000119">IntLonRad_xz</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 積分値

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xz  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 2 次元緯度動径格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
経度動径(緯度円)積分
</p>
<p>
2 次元(XZ)格子点データの経度動径積分
</p>
<p>
2 次元データ f(λ,r) に対して∫f(λ,r) r^2dλdr を計算する.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001428">wt_module#IntLonRad_xz</a>
</p>


        </div>
      </div>


      <div id="method-M000120" class="method-detail">
        <a name="M000120"></a>

        <div class="method-heading">




          <span class="method-name">IntLon_x</span><span class="method-args">( x_data ) result(IntLon_x)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000120">IntLon_x</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 積分値

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>x_data(0:im-1)  </tt></b>  <tt> </tt> :</td><td><tt>real(8), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 1 次元経度(X)格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
1 次元経度(X)格子点データの X 方向積分(1 層用).
</p>
<p>
実際には格子点データ各点毎に x_X_Weight をかけた総和を計算している.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001496">wt_module#IntLon_x</a>
</p>


        </div>
      </div>


      <div id="method-M000122" class="method-detail">
        <a name="M000122"></a>

        <div class="method-heading">




          <span class="method-name">IntRad_z</span><span class="method-args">( z ) result(IntRad_z)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000122">IntRad_z</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 積分値

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>z  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 1 次元動径格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
動径積分
</p>
<p>
1 次元(Z)格子点データの動径方向域積分.
</p>
<p>
1 次元データ f(r) に対して ∫f(r) r^2dr を計算する.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001429">wt_module#IntRad_z</a>
</p>


        </div>
      </div>


      <div id="method-M000159" class="method-detail">
        <a name="M000159"></a>

        <div class="method-heading">




          <span class="method-name">Interpolate_wt</span><span class="method-args">( wt_data, alon, alat, arad ) result(Interpolate_wt)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000159">Interpolate_wt</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8)</tt>

<table>
<tr><td valign="top"> :</td><td> 補間した値

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>wt_data((nm+1)**2,0:km)  </tt></b>  <tt> </tt> :</td><td><tt>real(8), intent(IN)</tt>

<table>
<tr><td valign="top"> :</td><td> スペクトルデータ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>alon  </tt></b>  <tt> </tt> :</td><td><tt>real(8), intent(IN)</tt>

<table>
<tr><td valign="top"> :</td><td> 補間する位置(経度)

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>alat  </tt></b>  <tt> </tt> :</td><td><tt>real(8), intent(IN)</tt>

<table>
<tr><td valign="top"> :</td><td> 補間する位置(緯度)

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>arad  </tt></b>  <tt> </tt> :</td><td><tt>real(8), intent(IN)</tt>

<table>
<tr><td valign="top"> :</td><td> 補間する位置(動径)

</td></tr>
</table>
</td></tr>
</table>
<p>
緯度 alon, 経度 alat 動径 arad における関数値を その球面調和変換係数
wa_data から補間計算する
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001454">wt_module#Interpolate_wt</a>
</p>


        </div>
      </div>


      <div id="method-M000081" class="method-detail">
        <a name="M000081"></a>

        <div class="method-heading">




          <span class="method-name">at_Dr_at</span><span class="method-args">( at_data ) result(at_Dx_at)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt>at_Dx_at  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(size(at_data,1),0:size(at_data,2)-1)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) チェビシェフデータの X 微分

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>at_data  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(:,0:), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 入力チェビシェフデータ

</td></tr>
</table>
</td></tr>
</table>
<p>
入力チェビシェフデータに X 微分を作用する(2 次元配列用).
</p>
<p>
チェビシェフデータの X 微分とは, 対応する格子点データに X 微分を
作用させたデータのチェビシェフ変換のことである.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001489">wt_module#at_Dr_at</a>
</p>


        </div>
      </div>


      <div id="method-M000084" class="method-detail">
        <a name="M000084"></a>

        <div class="method-heading">




          <span class="method-name">at_az</span><span class="method-args">( ag_data ) result(at_ag)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt>at_ag  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(size(ag_data,1),0:km)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) チェビシェフデータ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>ag_data  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(:,:), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
格子データからチェビシェフデータへ変換する(2 次元配列用).
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001492">wt_module#at_az</a>
</p>


        </div>
      </div>


      <div id="method-M000083" class="method-detail">
        <a name="M000083"></a>

        <div class="method-heading">




          <span class="method-name">az_at</span><span class="method-args">( at_data ) result(ag_at)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt>ag_at  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(size(at_data,1),0:im)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 格子点データ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>at_data  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(:,:), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) チェビシェフデータ

</td></tr>
</table>
</td></tr>
</table>
<p>
チェビシェフデータから格子データへ変換する(2 次元配列用).
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001491">wt_module#az_at</a>
</p>


        </div>
      </div>


      <div id="method-M000053" class="method-detail">
        <a name="M000053"></a>

        <div class="method-heading">




          <span class="method-name">jc</span><span class="method-args"></span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em>Variable</em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000053">jc</a>  </tt></b>  <tt> </tt> :</td><td><tt>integer</tt>

<table>
<tr><td valign="top"> :</td><td> 分散配置用変数

</td></tr>
</table>
</td></tr>
</table>
<p>
Original external subprogram is <a
href="w_base_mpi_module.html#M000186">w_base_mpi_module#jc</a>
</p>


        </div>
      </div>


      <div id="method-M000062" class="method-detail">
        <a name="M000062"></a>

        <div class="method-heading">




          <span class="method-name">l_nm</span><span class="method-args">( n, m ) result(l_nm_array00)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt>l_nm_array00  </tt></b>  <tt> </tt> :</td><td><tt>integer</tt>

<table>
<tr><td valign="top"> :</td><td> (out) スペクトルデータの格納位置

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>n  </tt></b>  <tt> </tt> :</td><td><tt>integer, intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 全波数

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>m  </tt></b>  <tt> </tt> :</td><td><tt>integer, intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 帯状波数

</td></tr>
</table>
</td></tr>
</table>
<p>
全波数(n)と東西波数(m)からそのスペクトルデータの格納位置を返す.
</p>
<p>
引数 n,m がともに整数値の場合, 整数値を返す.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001479">wt_module#l_nm</a>
</p>


        </div>
      </div>


      <div id="method-M000063" class="method-detail">
        <a name="M000063"></a>

        <div class="method-heading">




          <span class="method-name">l_nm</span><span class="method-args">( n, marray ) result(l_nm_array01)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt>l_nm_array01(size(marray))  </tt></b>  <tt> </tt> :</td><td><tt>integer</tt>

<table>
<tr><td valign="top"> :</td><td> (out) スペクトルデータ位置

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>n  </tt></b>  <tt> </tt> :</td><td><tt>integer, intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 全波数

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>marray(:)  </tt></b>  <tt> </tt> :</td><td><tt>integer, intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 帯状波数

</td></tr>
</table>
</td></tr>
</table>
<p>
スペクトルデータの格納位置
</p>
<p>
全波数(n)と東西波数(m)からそのスペクトルデータの格納位置を返す.
</p>
<p>
第 1 引数 n が整数, 第 2 引数 marray が整数 1 次元配列の場合, marray
と同じ大きさの 1 次元整数配列を返す.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001479">wt_module#l_nm</a>
</p>


        </div>
      </div>


      <div id="method-M000064" class="method-detail">
        <a name="M000064"></a>

        <div class="method-heading">




          <span class="method-name">l_nm</span><span class="method-args">( narray, m ) result(l_nm_array10)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt>l_nm_array10(size(narray))  </tt></b>  <tt> </tt> :</td><td><tt>integer</tt>

<table>
<tr><td valign="top"> :</td><td> (out) スペクトルデータ位置

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>narray(:)  </tt></b>  <tt> </tt> :</td><td><tt>integer, intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 全波数

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>m  </tt></b>  <tt> </tt> :</td><td><tt>integer, intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 帯状波数

</td></tr>
</table>
</td></tr>
</table>
<p>
全波数(n)と東西波数(m)からそのスペクトルデータの格納位置を返す.
</p>
<p>
第 1 引数 narray が整数 1 次元配列, 第 2 引数 m が整数の場合, narray
と同じ大きさの 1 次元整数配列を返す.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001479">wt_module#l_nm</a>
</p>


        </div>
      </div>


      <div id="method-M000065" class="method-detail">
        <a name="M000065"></a>

        <div class="method-heading">




          <span class="method-name">l_nm</span><span class="method-args">( narray, marray ) result(l_nm_array11)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt>l_nm_array11(size(narray))  </tt></b>  <tt> </tt> :</td><td><tt>integer</tt>

<table>
<tr><td valign="top"> :</td><td> (out) スペクトルデータ位置

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>narray(:)  </tt></b>  <tt> </tt> :</td><td><tt>integer, intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 全波数

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>marray(:)  </tt></b>  <tt> </tt> :</td><td><tt>integer, intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 帯状波数

</td></tr>
</table>
</td></tr>
</table>
<p>
全波数(n)と東西波数(m)からそのスペクトルデータの格納位置を返す.
</p>
<p>
第 1,2 引数 narray, marray がともに整数 1 次元配列の場合, narray, marray
と同じ大きさの 1 次元整数配列を返す. narray, marray
は同じ大きさでなければならない.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001479">wt_module#l_nm</a>
</p>


        </div>
      </div>


      <div id="method-M000066" class="method-detail">
        <a name="M000066"></a>

        <div class="method-heading">




          <span class="method-name">nm_l</span><span class="method-args">( l ) result(nm_l_int)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt>nm_l_int(2)  </tt></b>  <tt> </tt> :</td><td><tt>integer</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 全波数, 帯状波数

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>l  </tt></b>  <tt> </tt> :</td><td><tt>integer, intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) スペクトルデータの格納位置

</td></tr>
</table>
</td></tr>
</table>
<p>
スペクトルデータの格納位置(l)から全波数(n)と東西波数(m)を返す.
</p>
<p>
引数 l が整数値の場合, 対応する全波数と帯状波数を 長さ 2 の 1
次元整数値を返す. <a href="wt_mpi_module.html#M000066">nm_l</a>(1)
が全波数, <a href="wt_mpi_module.html#M000066">nm_l</a>(2)
が帯状波数である.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001483">wt_module#nm_l</a>
</p>


        </div>
      </div>


      <div id="method-M000067" class="method-detail">
        <a name="M000067"></a>

        <div class="method-heading">




          <span class="method-name">nm_l</span><span class="method-args">( larray ) result(nm_l_array)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt>nm_l_array(size(larray),2)  </tt></b>  <tt> </tt> :</td><td><tt>integer</tt>

<table>
<tr><td valign="top"> :</td><td> (in) スペクトルデータの格納位置

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>larray(:)  </tt></b>  <tt> </tt> :</td><td><tt>integer, intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 全波数, 帯状波数

</td></tr>
</table>
</td></tr>
</table>
<p>
スペクトルデータの格納位置(l)から全波数(n)と東西波数(m)を返す.
</p>
<p>
引数 larray が整数 1 次元配列の場合, larray に対応する n, m を格納した 2
次元整数配列を返す. nm_l_array(:,1) が全波数, nm_l_array(:,2)
が帯状波数である.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001483">wt_module#nm_l</a>
</p>


        </div>
      </div>


      <div id="method-M000162" class="method-detail">
        <a name="M000162"></a>

        <div class="method-heading">




          <span class="method-name">nmz_PoloidalEnergySpectrum_wt</span><span class="method-args">( wt_POLPOT ) result(nmz_PoloidalEnergySpectrum_wt)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000162">nmz_PoloidalEnergySpectrum_wt</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:nm,-nm:nm,0:km)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) エネルギースペクトルポロイダル成分

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>wt_POLPOT  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) ポロイダルポテンシャル

</td></tr>
</table>
</td></tr>
</table>
<p>
ポロイダルポテンシャルから, ポロイダルエネルギーの 球面調和函数全波数 n,
帯状波数 m の各成分を計算する.
</p>
<pre>
 * 全波数 n, 帯状波数 m のポロイダルポテンシャルのスペクトル成分
   φ(n,m,r)から全波数 n, 帯状波数 m 成分のポロイダルエネルギー
   スペクトルは

     (1/2)n(n+1)4πr^2{[d(rφ(n,m,r))/dr]^2 + n(n+1)φ(n,m,r)^2}

   と計算される.

 * 全てのエネルギースペクトル成分の和を動径積分したもの(r^2の重み無し)
   が球殻内での全エネルギーに等しい.

 * データの存在しない全波数 n, 帯状波数 m の配列には欠損値が格納される.
   欠損値の値はモジュール変数 wt_VMiss によって設定できる
   (初期値は -999.0)
</pre>
<p>
Original external subprogram is <a
href="wt_module.html#M001457">wt_module#nmz_PoloidalEnergySpectrum_wt</a>
</p>


        </div>
      </div>


      <div id="method-M000160" class="method-detail">
        <a name="M000160"></a>

        <div class="method-heading">




          <span class="method-name">nmz_ToroidalEnergySpectrum_wt</span><span class="method-args">( wt_TORPOT ) result(nmz_ToroidalEnergySpectrum_wt)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000160">nmz_ToroidalEnergySpectrum_wt</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:nm,-nm:nm,0:km)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) エネルギースペクトルトロイダル成分

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>wt_TORPOT  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) トロイダルポテンシャル

</td></tr>
</table>
</td></tr>
</table>
<p>
トロイダルポテンシャルから, トロイダルエネルギーの 球面調和函数全波数 n,
帯状波数 m の各成分を計算する
</p>
<pre>
 * 全波数 n, 帯状波数 m のトロイダルポテンシャルのスペクトル成分
   ψ(n,m,r)から全波数 n, 帯状波数 m 成分のトロイダルエネルギー
   スペクトルは  (1/2)n(n+1)4πr^2ψ(n,m,r)^2  と計算される.

 * 全てのエネルギースペクトル成分の和を動径積分したもの(r^2の重み無し)
   が球殻内での全エネルギーに等しい.

 * データの存在しない全波数 n, 帯状波数 m の配列には欠損値が格納される.
   wt_VMiss によって設定できる (初期値は -999.0)
</pre>
<p>
Original external subprogram is <a
href="wt_module.html#M001455">wt_module#nmz_ToroidalEnergySpectrum_wt</a>
</p>


        </div>
      </div>


      <div id="method-M000163" class="method-detail">
        <a name="M000163"></a>

        <div class="method-heading">




          <span class="method-name">nz_PoloidalEnergySpectrum_wt</span><span class="method-args">( wt_POLPOT ) result(nz_PoloidalEnergySpectrum_wt)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000163">nz_PoloidalEnergySpectrum_wt</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:nm,0:km)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) エネルギースペクトルポロイダル成分

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>wt_POLPOT  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) ポロイダルポテンシャル

</td></tr>
</table>
</td></tr>
</table>
<p>
ポロイダルポテンシャルから, ポロイダルエネルギーの
球面調和函数全波数の各成分を計算する
</p>
<pre>
 * 全波数 n, 帯状波数 m のポロイダルポテンシャルのスペクトル成分
   φ(n,m,r)から全波数 n 成分のポロイダルエネルギースペクトルは

     Σ[m=-n]^n ((1/2)n(n+1)4πr^2{[d(rφ(n,m,r))/dr]^2
                + n(n+1)φ(n,m,r)^2}

   と計算される.

 * 全ての全波数に対してのエネルギースペクトル成分の和を動径積分したもの
   (r^2の重み無し)が球殻内での全エネルギーに等しい.
</pre>
<p>
Original external subprogram is <a
href="wt_module.html#M001458">wt_module#nz_PoloidalEnergySpectrum_wt</a>
</p>


        </div>
      </div>


      <div id="method-M000161" class="method-detail">
        <a name="M000161"></a>

        <div class="method-heading">




          <span class="method-name">nz_ToroidalEnergySpectrum_wt</span><span class="method-args">( wt_TORPOT ) result(nz_ToroidalEnergySpectrum_wt)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000161">nz_ToroidalEnergySpectrum_wt</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:nm,0:km)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) エネルギースペクトルトロイダル成分

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>wt_TORPOT  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) トロイダルポテンシャル

</td></tr>
</table>
</td></tr>
</table>
<p>
トロイダルポテンシャルから, トロイダルエネルギーの
球面調和函数全波数の各成分を計算する.
</p>
<pre>
 * 全波数 n, 帯状波数 m のトロイダルポテンシャルのスペクトル成分
   ψ(n,m,r)から全波数 n 成分のトロイダルエネルギースペクトルは
   Σ[m=-n]^n(1/2)n(n+1)4πr^2ψ(n,m,r)^2 と計算される.
</pre>
<ul>
<li>全てのエネルギースペクトル成分の和を動径積分したもの(r^2の重み無し)

<pre>
 が球殻内での全エネルギーに等しい.
</pre>
</li>
</ul>
<p>
Original external subprogram is <a
href="wt_module.html#M001456">wt_module#nz_ToroidalEnergySpectrum_wt</a>
</p>


        </div>
      </div>


      <div id="method-M000082" class="method-detail">
        <a name="M000082"></a>

        <div class="method-heading">




          <span class="method-name">t_Dr_t</span><span class="method-args">( t_data ) result(t_Dx_t)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt>t_Dx_t  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(size(t_data))</tt>

<table>
<tr><td valign="top"> :</td><td> (out) チェビシェフデータの X 微分

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>t_data  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(:), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 入力チェビシェフデータ

</td></tr>
</table>
</td></tr>
</table>
<p>
入力チェビシェフデータに X 微分を作用する(1 次元配列用).
</p>
<p>
チェビシェフデータの X 微分とは, 対応する格子点データに X 微分を
作用させたデータのチェビシェフ変換のことである.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001490">wt_module#t_Dr_t</a>
</p>


        </div>
      </div>


      <div id="method-M000047" class="method-detail">
        <a name="M000047"></a>

        <div class="method-heading">


          <a href="#M000047" class="method-signature">



          <span class="method-name">v_AvrLonRad_xvz</span><span class="method-args">( xvz ) result(v_AvrLonRad_xvz)</span>



          </a>

        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000047">v_AvrLonRad_xvz</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(<a href="wt_mpi_module.html#M000053">jc</a>)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 経度動径(緯度円)平均された 1 次元緯度格子点データ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xvz  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,<a
href="wt_mpi_module.html#M000053">jc</a>,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 3 次元経度緯度動径格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
経度動径(緯度円)積分
</p>
<p>
3 次元格子点データの経度動径(緯度円)平均.
</p>
<p>
3 次元データ f(λ,φ,r) に対して
</p>
<pre>
    ∫f(λ,φ,r) r^2dλdr /(2π(r[o]^3-r[i]^3)/3)
</pre>
<p>
を計算する.
</p>


          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000047-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000047-source">
<pre>
    function v_AvrLonRad_xvz(xvz)  ! 経度動径(緯度円)積分
      !
      ! 3 次元格子点データの経度動径(緯度円)平均.
      !
      ! 3 次元データ f(λ,φ,r) に対して
      !
      !     ∫f(λ,φ,r) r^2dλdr /(2π(r[o]^3-r[i]^3)/3) 
      !
      ! を計算する.
      !
      real(8), dimension(0:im-1,jc,0:km), intent(in) :: xvz
      !(in) 3 次元経度緯度動径格子点データ

      real(8), dimension(jc)       :: v_AvrLonRad_xvz
      !(out) 経度動径(緯度円)平均された 1 次元緯度格子点データ

      v_AvrLonRad_xvz = v_IntLonRad_xvz(xvz) /(sum(x_Lon_Weight)*sum(z_Rad_Weight))

    end function v_AvrLonRad_xvz
</pre>
          </div>

        </div>
      </div>


      <div id="method-M000147" class="method-detail">
        <a name="M000147"></a>

        <div class="method-heading">




          <span class="method-name">v_AvrLon_xv</span><span class="method-args">( xv_data ) result(v_AvrLon_xv)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000147">v_AvrLon_xv</a>(<a href="wt_mpi_module.html#M000053">jc</a>)  </tt></b>  <tt> </tt> :</td><td><tt>real(8)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 平均された 1 次元緯度(Y)格子点

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xv_data(0:im-1,<a href="wt_mpi_module.html#M000053">jc</a>)  </tt></b>  <tt> </tt> :</td><td><tt>real(8), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 2 次元経度緯度格子点データ(0:im-1,<a
href="wt_mpi_module.html#M000053">jc</a>)

</td></tr>
</table>
</td></tr>
</table>
<p>
2 次元緯度経度格子点データの経度(X)方向平均(1 層用).
</p>
<p>
実際には格子点データ各点毎に x_X_Weight をかけた総和を計算し, x_X_Weight
の総和で割ることで平均している.
</p>
<p>
Original external subprogram is <a
href="w_integral_mpi_module.html#M000859">w_integral_mpi_module#v_AvrLon_xv</a>
</p>


        </div>
      </div>


      <div id="method-M000051" class="method-detail">
        <a name="M000051"></a>

        <div class="method-heading">


          <a href="#M000051" class="method-signature">



          <span class="method-name">v_AvrRad_vz</span><span class="method-args">( vz ) result(v_AvrRad_vz)</span>



          </a>

        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000051">v_AvrRad_vz</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(<a href="wt_mpi_module.html#M000053">jc</a>)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 動径平均された 1 次元緯度格子点データ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>vz  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(<a href="wt_mpi_module.html#M000053">jc</a>,0:km),
intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 2 次元緯度動径(子午面)格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
2 次元(VZ)格子点データの動径方向域平均.
</p>
<p>
2 次元データ f(φ,r) に対して ∫f(φ,r) r^2dr /((r[o]^3-r[i]^3)/3)
を計算する.
</p>


          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000051-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000051-source">
<pre>
    function v_AvrRad_vz(vz)
      !
      ! 2 次元(VZ)格子点データの動径方向域平均.
      !
      ! 2 次元データ f(φ,r) に対して ∫f(φ,r) r^2dr /((r[o]^3-r[i]^3)/3) 
      ! を計算する.
      !
      real(8), dimension(jc,0:km), intent(in) :: vz
      !(in) 2 次元緯度動径(子午面)格子点データ

      real(8), dimension(jc)  :: v_AvrRad_vz
      !(out) 動径平均された 1 次元緯度格子点データ

      v_AvrRad_vz = v_IntRad_vz(vz)/sum(z_Rad_Weight)

    end function v_AvrRad_vz
</pre>
          </div>

        </div>
      </div>


      <div id="method-M000037" class="method-detail">
        <a name="M000037"></a>

        <div class="method-heading">


          <a href="#M000037" class="method-signature">



          <span class="method-name">v_IntLonRad_xvz</span><span class="method-args">( xvz ) result(v_IntLonRad_xvz)</span>



          </a>

        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000037">v_IntLonRad_xvz</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(<a href="wt_mpi_module.html#M000053">jc</a>)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 経度動径(緯度円)積分された 1 次元緯度格子点データ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xvz  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,<a
href="wt_mpi_module.html#M000053">jc</a>,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 3 次元経度緯度動径格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
3 次元格子点データの経度動径(緯度円)積分.
</p>
<p>
3 次元データ f(λ,φ,r) に対して∫f(λ,φ,r) r^2dλdr を計算する.
</p>


          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000037-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000037-source">
<pre>
    function v_IntLonRad_xvz(xvz)
      !
      ! 3 次元格子点データの経度動径(緯度円)積分.
      !
      ! 3 次元データ f(λ,φ,r) に対して∫f(λ,φ,r) r^2dλdr を計算する.
      !
      real(8), dimension(0:im-1,jc,0:km), intent(in) :: xvz
      !(in) 3 次元経度緯度動径格子点データ

      real(8), dimension(jc)       :: v_IntLonRad_xvz
      !(out) 経度動径(緯度円)積分された 1 次元緯度格子点データ

      integer :: i, k

      v_IntLonRad_xvz = 0
      do k=0,km
         do i=0,im-1
            v_IntLonRad_xvz = v_IntLonRad_xvz + xvz(i,:,k) * x_Lon_Weight(i) * z_Rad_Weight(k)
         enddo
      enddo
    end function v_IntLonRad_xvz
</pre>
          </div>

        </div>
      </div>


      <div id="method-M000124" class="method-detail">
        <a name="M000124"></a>

        <div class="method-heading">




          <span class="method-name">v_IntLon_xv</span><span class="method-args">( xv_data ) result(v_IntLon_xv)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000124">v_IntLon_xv</a>(<a href="wt_mpi_module.html#M000053">jc</a>)  </tt></b>  <tt> </tt> :</td><td><tt>real(8)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 積分された 1 次元緯度(Y)格子点データ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xv_data(0:im-1,<a href="wt_mpi_module.html#M000053">jc</a>)  </tt></b>  <tt> </tt> :</td><td><tt>real(8), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 2 次元経度緯度格子点データ(0:im-1,<a
href="wt_mpi_module.html#M000053">jc</a>)

</td></tr>
</table>
</td></tr>
</table>
<p>
2 次元緯度経度格子点データの経度(X)方向積分(1 層用).
</p>
<p>
実際には格子点データ各点毎に x_X_Weight をかけた総和を計算している.
</p>
<p>
Original external subprogram is <a
href="w_integral_mpi_module.html#M000855">w_integral_mpi_module#v_IntLon_xv</a>
</p>


        </div>
      </div>


      <div id="method-M000041" class="method-detail">
        <a name="M000041"></a>

        <div class="method-heading">


          <a href="#M000041" class="method-signature">



          <span class="method-name">v_IntRad_vz</span><span class="method-args">( vz ) result(v_IntRad_vz)</span>



          </a>

        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000041">v_IntRad_vz</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(<a href="wt_mpi_module.html#M000053">jc</a>)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 動径積分された 1 次元緯度格子点データ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>vz  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(<a href="wt_mpi_module.html#M000053">jc</a>,0:km),
intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 2 次元緯度動径(子午面)格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
動径積分
</p>
<p>
2 次元(VZ)格子点データの動径方向域積分.
</p>
<p>
2 次元データ f(φ,r) に対して∫f(φ,r) r^2dr を計算する.
</p>


          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000041-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000041-source">
<pre>
    function v_IntRad_vz(vz)  ! 動径積分
      !
      ! 2 次元(VZ)格子点データの動径方向域積分.
      !
      ! 2 次元データ f(φ,r) に対して∫f(φ,r) r^2dr を計算する.
      !
      real(8), dimension(jc,0:km), intent(in) :: vz
      !(in) 2 次元緯度動径(子午面)格子点データ

      real(8), dimension(jc)  :: v_IntRad_vz
      !(out) 動径積分された 1 次元緯度格子点データ

      integer :: k

      v_IntRad_vz = 0.0d0
      do k=0,km
         v_IntRad_vz(:) = v_IntRad_vz(:) + vz(:,k) * z_Rad_Weight(k) 
      enddo
    end function v_IntRad_vz
</pre>
          </div>

        </div>
      </div>


      <div id="method-M000058" class="method-detail">
        <a name="M000058"></a>

        <div class="method-heading">




          <span class="method-name">v_Lat</span><span class="method-args"></span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em>Variable</em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000058">v_Lat</a>(:)  </tt></b>  <tt> </tt> :</td><td><tt>real(8), allocatable</tt>

<table>
<tr><td valign="top"> :</td><td> 緯度経度

</td></tr>
</table>
</td></tr>
</table>
<p>
Original external subprogram is <a
href="w_base_mpi_module.html#M000187">w_base_mpi_module#v_Lat</a>
</p>


        </div>
      </div>


      <div id="method-M000059" class="method-detail">
        <a name="M000059"></a>

        <div class="method-heading">




          <span class="method-name">v_Lat_Weight</span><span class="method-args"></span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em>Variable</em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000059">v_Lat_Weight</a>(:)  </tt></b>  <tt> </tt> :</td><td><tt>real(8), allocatable</tt>

<table>
<tr><td valign="top"> :</td><td> 緯度経度

</td></tr>
</table>
</td></tr>
</table>
<p>
Original external subprogram is <a
href="w_base_mpi_module.html#M000188">w_base_mpi_module#v_Lat_Weight</a>
</p>


        </div>
      </div>


      <div id="method-M000043" class="method-detail">
        <a name="M000043"></a>

        <div class="method-heading">


          <a href="#M000043" class="method-signature">



          <span class="method-name">vz_AvrLon_xvz</span><span class="method-args">( xvz ) result(vz_AvrLon_xvz)</span>



          </a>

        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000043">vz_AvrLon_xvz</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(<a
href="wt_mpi_module.html#M000053">jc</a>,0:km)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 経度方向(帯状)平均された 2 次元子午面格子点データ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xvz  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,<a
href="wt_mpi_module.html#M000053">jc</a>,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 3 次元経度緯度動径格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
経度(帯状)積分
</p>
<p>
3 次元格子点データの経度方向(帯状)平均.
</p>
<p>
3 次元データ f(λ,φ,r) に対して ∫f(λ,φ,r)dλ/2π を計算する.
</p>


          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000043-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000043-source">
<pre>
    function vz_AvrLon_xvz(xvz)  ! 経度(帯状)積分
      !
      ! 3 次元格子点データの経度方向(帯状)平均.
      !
      ! 3 次元データ f(λ,φ,r) に対して ∫f(λ,φ,r)dλ/2π を計算する.
      !
      real(8), dimension(0:im-1,jc,0:km), intent(in) :: xvz
      !(in) 3 次元経度緯度動径格子点データ

      real(8), dimension(jc,0:km)  :: vz_AvrLon_xvz
      !(out) 経度方向(帯状)平均された 2 次元子午面格子点データ

      vz_AvrLon_xvz = vz_IntLon_xvz(xvz)/sum(x_Lon_Weight)

    end function vz_AvrLon_xvz
</pre>
          </div>

        </div>
      </div>


      <div id="method-M000033" class="method-detail">
        <a name="M000033"></a>

        <div class="method-heading">


          <a href="#M000033" class="method-signature">



          <span class="method-name">vz_IntLon_xvz</span><span class="method-args">( xvz ) result(vz_IntLon_xvz)</span>



          </a>

        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000033">vz_IntLon_xvz</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(<a
href="wt_mpi_module.html#M000053">jc</a>,0:km)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 経度方向(帯状)積分された 2 次元子午面格子点データ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xvz  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,<a
href="wt_mpi_module.html#M000053">jc</a>,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 3 次元経度緯度動径格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
経度(帯状)積分
</p>
<p>
3 次元格子点データの経度方向(帯状)積分.
</p>
<p>
3 次元データ f(λ,φ,r) に対して ∫f(λ,φ,r)dλ を計算する.
</p>


          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000033-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000033-source">
<pre>
    function vz_IntLon_xvz(xvz)  ! 経度(帯状)積分
      !
      ! 3 次元格子点データの経度方向(帯状)積分.
      !
      ! 3 次元データ f(λ,φ,r) に対して ∫f(λ,φ,r)dλ を計算する.
      !
      real(8), dimension(0:im-1,jc,0:km), intent(in) :: xvz
      !(in) 3 次元経度緯度動径格子点データ

      real(8), dimension(jc,0:km)  :: vz_IntLon_xvz
      !(out) 経度方向(帯状)積分された 2 次元子午面格子点データ

      integer :: i

      vz_IntLon_xvz = 0.0d0
      do i=0,im-1
         vz_IntLon_xvz(:,:) = vz_IntLon_xvz(:,:) + xvz(i,:,:) * x_Lon_Weight(i)
      enddo
    end function vz_IntLon_xvz
</pre>
          </div>

        </div>
      </div>


      <div id="method-M000079" class="method-detail">
        <a name="M000079"></a>

        <div class="method-heading">




          <span class="method-name">w_xv</span><span class="method-args">( xv_data, [ipow], [iflag] ) result(w_xv)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000079">w_xv</a>((nm+1)*(nm+1))  </tt></b>  <tt> </tt> :</td><td><tt>real(8)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) スペクトルデータ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xv_data(0:im-1,<a href="wt_mpi_module.html#M000053">jc</a>)  </tt></b>  <tt> </tt> :</td><td><tt>real(8), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 格子点データ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>ipow  </tt></b>  <tt> </tt> :</td><td><tt>integer, intent(in), optional</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 変換時に同時に作用させる 1/cosφ の次数. 省略時は 0.

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>iflag  </tt></b>  <tt> </tt> :</td><td><tt>integer, intent(in), optional</tt>

<table>
<tr><td valign="top"> :</td><td> 変換の種類

<pre>
    0 : 通常の正変換
    1 : 経度微分を作用させた正変換
   -1 : 緯度微分を作用させた正変換
    2 : sinφを作用させた正変換
  省略時は 0.
</pre>
</td></tr>
</table>
</td></tr>
</table>
<p>
格子データからスペクトルデータへ(正)変換する(1 層用).
</p>
<p>
Original external subprogram is <a
href="w_base_mpi_module.html#M000195">w_base_mpi_module#w_xv</a>
</p>


        </div>
      </div>


      <div id="method-M000077" class="method-detail">
        <a name="M000077"></a>

        <div class="method-heading">




          <span class="method-name">w_xy</span><span class="method-args">( xy_data, [ipow], [iflag] ) result(w_xy)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000077">w_xy</a>((nm+1)*(nm+1))  </tt></b>  <tt> </tt> :</td><td><tt>real(8)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) スペクトルデータ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xy_data(0:im-1,1:jm)  </tt></b>  <tt> </tt> :</td><td><tt>real(8), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 格子点データ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>ipow  </tt></b>  <tt> </tt> :</td><td><tt>integer, intent(in), optional</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 変換時に同時に作用させる 1/cosφ の次数. 省略時は 0.

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>iflag  </tt></b>  <tt> </tt> :</td><td><tt>integer, intent(in), optional</tt>

<table>
<tr><td valign="top"> :</td><td> 変換の種類

<pre>
   0 : 通常の正変換
  -1 : 経度微分を作用させた正変換
   1 : 緯度微分 1/cosφ・∂(f cos^2φ)/∂φ を作用させた正変換
   2 : sinφを作用させた正変換
 省略時は 0.
</pre>
</td></tr>
</table>
</td></tr>
</table>
<p>
格子データからスペクトルデータへ(正)変換する(1 層用).
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001487">wt_module#w_xy</a>
</p>


        </div>
      </div>


      <div id="method-M000164" class="method-detail">
        <a name="M000164"></a>

        <div class="method-heading">




          <span class="method-name">wt_Boundaries</span><span class="method-args">( wt, [values], [cond] ) </span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Subroutine </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt>wt  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm),intent(inout)</tt>

<table>
<tr><td valign="top"> :</td><td> (inout) 境界条件を適用するデータ. 修正された値を返す.

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>values  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),2), intent(in), optional</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 境界での 値/勾配 分布を水平スペクトル変換したものを与える.

<pre>
    省略時は値/勾配 0 となる.
</pre>
</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>cond  </tt></b>  <tt> </tt> :</td><td><tt>character(len=2), intent(in), optional</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 境界条件. 省略時は &#8216;DD&#8216;

<pre>
       DD : 両端ディリクレ条件
       DN : 上端ディリクレ, 下端ノイマン条件
       ND : 上端ノイマン, 下端ディリクレ条件
       NN : 両端ノイマン条件
</pre>
</td></tr>
</table>
</td></tr>
</table>
<p>
スペクトルデータにディリクレ・ノイマン境界条件を適用する Chebyshev
空間での境界条件適用(タウ法)
</p>
<p>
チェビシェフ空間において境界条件を満たすべく高次の係数を
定める方法をとっている(タウ法).
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001469">wt_module#wt_Boundaries</a>
</p>


        </div>
      </div>


      <div id="method-M000173" class="method-detail">
        <a name="M000173"></a>

        <div class="method-heading">




          <span class="method-name">wt_BoundariesGrid</span><span class="method-args">( wt, [values], [cond] ) </span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Subroutine </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt>wt  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm),intent(inout)</tt>

<table>
<tr><td valign="top"> :</td><td> (inout) 境界条件を適用するデータ. 修正された値を返す.

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>values  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),2), intent(in), optional</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 境界での 値/勾配 分布を水平スペクトル変換したものを与える.

<pre>
   省略時は値/勾配 0 となる.
</pre>
</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>cond  </tt></b>  <tt> </tt> :</td><td><tt>character(len=2), intent(in), optional</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 境界条件. 省略時は &#8216;DD&#8216;

<pre>
       DD : 両端ディリクレ条件
       DN : 上端ディリクレ, 下端ノイマン条件
       ND : 上端ノイマン, 下端ディリクレ条件
       NN : 両端ノイマン条件
</pre>
</td></tr>
</table>
</td></tr>
</table>
<p>
スペクトルデータにディリクレ・ノイマン境界条件を適用する
実空間での境界条件適用
</p>
<p>
鉛直実格子点空間において内部領域の値と境界条件を満たすように
条件を課している(選点法). このルーチンを用いるためには wt_Initial
にて設定するチェビシェフ切断波数(lm)と鉛直格子点数(km)を
等しくしておく必要がある.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001460">wt_module#wt_BoundariesGrid</a>
</p>


        </div>
      </div>


      <div id="method-M000169" class="method-detail">
        <a name="M000169"></a>

        <div class="method-heading">




          <span class="method-name">wt_BoundariesTau</span><span class="method-args">( wt, [values], [cond] ) </span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Subroutine </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt>wt  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm),intent(inout)</tt>

<table>
<tr><td valign="top"> :</td><td> (inout) 境界条件を適用するデータ. 修正された値を返す.

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>values  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),2), intent(in), optional</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 境界での 値/勾配 分布を水平スペクトル変換したものを与える.

<pre>
    省略時は値/勾配 0 となる.
</pre>
</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>cond  </tt></b>  <tt> </tt> :</td><td><tt>character(len=2), intent(in), optional</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 境界条件. 省略時は &#8216;DD&#8216;

<pre>
       DD : 両端ディリクレ条件
       DN : 上端ディリクレ, 下端ノイマン条件
       ND : 上端ノイマン, 下端ディリクレ条件
       NN : 両端ノイマン条件
</pre>
</td></tr>
</table>
</td></tr>
</table>
<p>
スペクトルデータにディリクレ・ノイマン境界条件を適用する Chebyshev
空間での境界条件適用(タウ法)
</p>
<p>
チェビシェフ空間において境界条件を満たすべく高次の係数を
定める方法をとっている(タウ法).
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001459">wt_module#wt_BoundariesTau</a>
</p>


        </div>
      </div>


      <div id="method-M000091" class="method-detail">
        <a name="M000091"></a>

        <div class="method-heading">




          <span class="method-name">wt_DRad_wt</span><span class="method-args">( wt ) result(wt_DRad_wt)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000091">wt_DRad_wt</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 動径微分された2 次元球面調和函数チェビシェフスペクトルデータ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>wt  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 2 次元球面調和函数チェビシェフスペクトルデータ

</td></tr>
</table>
</td></tr>
</table>
<p>
入力スペクトルデータに動径微分 ∂/∂r を作用する.
</p>
<p>
スペクトルデータの動径微分とは, 対応する格子点データに動径微分を
作用させたデータのスペクトル変換のことである.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001403">wt_module#wt_DRad_wt</a>
</p>


        </div>
      </div>


      <div id="method-M000021" class="method-detail">
        <a name="M000021"></a>

        <div class="method-heading">


          <a href="#M000021" class="method-signature">



          <span class="method-name">wt_DivLat_xvz</span><span class="method-args">( xvz ) result(wt_DivLat_xvz)</span>



          </a>

        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000021">wt_DivLat_xvz</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 発散型緯度微分を作用された 2 次元スペクトルデータ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xvz  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,<a
href="wt_mpi_module.html#M000053">jc</a>,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 3 次元経度緯度動径格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
格子データに発散型緯度微分 1/rcosφ・∂(f cosφ)/∂φ を
作用させたスペクトルデータを返す.
</p>


          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000021-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000021-source">
<pre>
    function wt_DivLat_xvz(xvz)
      !
      ! 格子データに発散型緯度微分 1/rcosφ・∂(f cosφ)/∂φ を
      ! 作用させたスペクトルデータを返す.
      !
      real(8), dimension(0:im-1,jc,0:km), intent(in)   :: xvz
      !(in) 3 次元経度緯度動径格子点データ

      real(8), dimension((nm+1)*(nm+1),0:lm)       :: wt_DivLat_xvz
      !(out) 発散型緯度微分を作用された 2 次元スペクトルデータ

      wt_DivLat_xvz = wt_wz(wa_divlat_xva(xvz/xvz_Rad))
    end function wt_DivLat_xvz
</pre>
          </div>

        </div>
      </div>


      <div id="method-M000098" class="method-detail">
        <a name="M000098"></a>

        <div class="method-heading">




          <span class="method-name">wt_DivLat_xyz</span><span class="method-args">( xyz ) result(wt_DivLat_xyz)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000098">wt_DivLat_xyz</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 発散型緯度微分を作用された 2 次元スペクトルデータ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xyz  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 3 次元経度緯度動径格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
格子データに発散型緯度微分 1/rcosφ・∂(f cosφ)/∂φ を
作用させたスペクトルデータを返す.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001410">wt_module#wt_DivLat_xyz</a>
</p>


        </div>
      </div>


      <div id="method-M000020" class="method-detail">
        <a name="M000020"></a>

        <div class="method-heading">


          <a href="#M000020" class="method-signature">



          <span class="method-name">wt_DivLon_xvz</span><span class="method-args">( xvz ) result(wt_DivLon_xvz)</span>



          </a>

        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000020">wt_DivLon_xvz</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 発散型経度微分を作用された 2 次元スペクトルデータ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xvz  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,<a
href="wt_mpi_module.html#M000053">jc</a>,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 3 次元経度緯度動径格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
格子点データに発散型経度微分 1/rcosφ・∂/∂λ を作用させた
スペクトルデータを返す.
</p>


          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000020-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000020-source">
<pre>
    function wt_DivLon_xvz(xvz)
      ! 
      ! 格子点データに発散型経度微分 1/rcosφ・∂/∂λ を作用させた
      ! スペクトルデータを返す.
      !
      real(8), dimension(0:im-1,jc,0:km), intent(in)   :: xvz
      !(in) 3 次元経度緯度動径格子点データ

      real(8), dimension((nm+1)*(nm+1),0:lm)       :: wt_DivLon_xvz
      !(out) 発散型経度微分を作用された 2 次元スペクトルデータ

      wt_DivLon_xvz = wt_wz(wa_DivLon_xva(xvz/xvz_Rad))
    end function wt_DivLon_xvz
</pre>
          </div>

        </div>
      </div>


      <div id="method-M000097" class="method-detail">
        <a name="M000097"></a>

        <div class="method-heading">




          <span class="method-name">wt_DivLon_xyz</span><span class="method-args">( xyz ) result(wt_DivLon_xyz)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000097">wt_DivLon_xyz</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 発散型経度微分を作用された 2 次元スペクトルデータ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xyz  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 3 次元経度緯度動径格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
格子点データに発散型経度微分 1/rcosφ・∂/∂λ を作用させた
スペクトルデータを返す.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001409">wt_module#wt_DivLon_xyz</a>
</p>


        </div>
      </div>


      <div id="method-M000092" class="method-detail">
        <a name="M000092"></a>

        <div class="method-heading">




          <span class="method-name">wt_DivRad_wt</span><span class="method-args">( wt ) result(wt_DivRad_wt)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000092">wt_DivRad_wt</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 発散型動径微分を作用された 2 次元スペクトルデータ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>wt  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 2 次元球面調和函数チェビシェフスペクトルデータ

</td></tr>
</table>
</td></tr>
</table>
<p>
入力スペクトルデータに発散型動径微分
</p>
<pre>
      1/r^2 ∂/∂r (r^2 .)= ∂/∂r + 2/r
</pre>
<p>
を作用する.
</p>
<p>
スペクトルデータの発散型動径微分とは, 対応する格子点データに
発散型動径微分を作用させたデータのスペクトル変換のことである.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001404">wt_module#wt_DivRad_wt</a>
</p>


        </div>
      </div>


      <div id="method-M000022" class="method-detail">
        <a name="M000022"></a>

        <div class="method-heading">


          <a href="#M000022" class="method-signature">



          <span class="method-name">wt_Div_xvz_xvz_xvz</span><span class="method-args">( xvz_Vlon, xvz_Vlat, xvz_Vrad ) result(wt_Div_xvz_xvz_xvz)</span>



          </a>

        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000022">wt_Div_xvz_xvz_xvz</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) ベクトル場の発散

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xvz_Vlon  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,<a
href="wt_mpi_module.html#M000053">jc</a>,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) ベクトル場の経度成分

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xvz_Vlat  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,<a
href="wt_mpi_module.html#M000053">jc</a>,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) ベクトル場の緯度成分

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xvz_Vrad  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,<a
href="wt_mpi_module.html#M000053">jc</a>,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) ベクトル場の動径成分

</td></tr>
</table>
</td></tr>
</table>
<p>
べクトル成分である 3 つの格子データに発散を作用させた
スペクトルデータを返す.
</p>
<p>
第 1, 2 ,3 引数(u,v,w)がそれぞれベクトルの経度成分, 緯度成分,
動径成分を表し, 発散は
</p>
<pre>
     1/rcosφ・∂u/∂λ + 1/rcosφ・∂(v cosφ)/∂φ
   + 1/r^2 ∂/∂r (r^2 w)
</pre>
<p>
と計算される.
</p>


          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000022-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000022-source">
<pre>
    function wt_Div_xvz_xvz_xvz(xvz_Vlon,xvz_Vlat,xvz_Vrad)
      !
      ! べクトル成分である 3 つの格子データに発散を作用させた
      ! スペクトルデータを返す.
      !
      ! 第 1, 2 ,3 引数(u,v,w)がそれぞれベクトルの経度成分, 緯度成分, 
      ! 動径成分を表し, 発散は 
      !
      !      1/rcosφ・∂u/∂λ + 1/rcosφ・∂(v cosφ)/∂φ 
      !    + 1/r^2 ∂/∂r (r^2 w)
      !
      ! と計算される.
      !
      real(8), dimension(0:im-1,jc,0:km), intent(in) :: xvz_Vlon
      !(in) ベクトル場の経度成分

      real(8), dimension(0:im-1,jc,0:km), intent(in) :: xvz_Vlat
      !(in) ベクトル場の緯度成分

      real(8), dimension(0:im-1,jc,0:km), intent(in) :: xvz_Vrad
      !(in) ベクトル場の動径成分

      real(8), dimension((nm+1)*(nm+1),0:lm)     :: wt_Div_xvz_xvz_xvz
      !(out) ベクトル場の発散

      wt_Div_xvz_xvz_xvz =   wt_DivLon_xvz(xvz_Vlon) + wt_DivLat_xvz(xvz_Vlat) + wt_DivRad_wt(wt_xvz(xvz_Vrad))

    end function wt_Div_xvz_xvz_xvz
</pre>
          </div>

        </div>
      </div>


      <div id="method-M000099" class="method-detail">
        <a name="M000099"></a>

        <div class="method-heading">




          <span class="method-name">wt_Div_xyz_xyz_xyz</span><span class="method-args">( xyz_Vlon, xyz_Vlat, xyz_Vrad ) result(wt_Div_xyz_xyz_xyz)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000099">wt_Div_xyz_xyz_xyz</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) ベクトル場の発散

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xyz_Vlon  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) ベクトル場の経度成分

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xyz_Vlat  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) ベクトル場の緯度成分

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xyz_Vrad  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) ベクトル場の動径成分

</td></tr>
</table>
</td></tr>
</table>
<p>
べクトル成分である 3 つの格子データに発散を作用させた
スペクトルデータを返す.
</p>
<p>
第 1, 2 ,3 引数(u,v,w)がそれぞれベクトルの経度成分, 緯度成分,
動径成分を表し, 発散は
</p>
<pre>
     1/rcosφ・∂u/∂λ + 1/rcosφ・∂(v cosφ)/∂φ
   + 1/r^2 ∂/∂r (r^2 w)
</pre>
<p>
と計算される.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001411">wt_module#wt_Div_xyz_xyz_xyz</a>
</p>


        </div>
      </div>


      <div id="method-M000150" class="method-detail">
        <a name="M000150"></a>

        <div class="method-heading">




          <span class="method-name">wt_KxRGrad_wt</span><span class="method-args">( wt ) result(wt_KxRGrad_wt)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000150">wt_KxRGrad_wt</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 経度微分を作用された 2 次元スペクトルデータ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>wt  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 2 次元球面調和函数チェビシェフスペクトルデータ

</td></tr>
</table>
</td></tr>
</table>
<p>
入力スペクトルデータに経度微分 k×r・▽ = ∂/∂λを作用する.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001444">wt_module#wt_KxRGrad_wt</a>
</p>


        </div>
      </div>


      <div id="method-M000152" class="method-detail">
        <a name="M000152"></a>

        <div class="method-heading">




          <span class="method-name">wt_L2Inv_wt</span><span class="method-args">( wt ) result(wt_L2Inv_wt)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000152">wt_L2Inv_wt</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) L^2 演算子の逆演算を作用された 2 次元スペクトルデータ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>wt  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 2 次元球面調和函数チェビシェフスペクトルデータ

</td></tr>
</table>
</td></tr>
</table>
<p>
入力スペクトルデータに L^2 演算子の逆演算(-逆水平ラプラシアン)を 作用する.
</p>
<p>
スペクトルデータに L^2 演算子を作用させる関数 <a
href="wt_mpi_module.html#M000151">wt_L2_wt</a> の逆計算を 行う関数である.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001447">wt_module#wt_L2Inv_wt</a>
</p>


        </div>
      </div>


      <div id="method-M000151" class="method-detail">
        <a name="M000151"></a>

        <div class="method-heading">




          <span class="method-name">wt_L2_wt</span><span class="method-args">( wt ) result(wt_L2_wt)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000151">wt_L2_wt</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) L^2 演算子を作用された 2 次元スペクトルデータ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>wt  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 2 次元球面調和函数チェビシェフスペクトルデータ

</td></tr>
</table>
</td></tr>
</table>
<p>
入力スペクトルデータに L^2 演算子(=-水平ラプラシアン)を作用する.
</p>
<p>
L^2 演算子は単位球面上の水平ラプラシアンの逆符号にあたる.
</p>
<pre>
 入力スペクトルデ ータに対応する格子点データに演算子

    L^2 = -1/cos^2φ・∂^2/∂λ^2 - 1/cosφ・∂/∂φ(cosφ∂/∂φ)
</pre>
<p>
を作用させたデータのスペクトル変換が返される.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001446">wt_module#wt_L2_wt</a>
</p>


        </div>
      </div>


      <div id="method-M000175" class="method-detail">
        <a name="M000175"></a>

        <div class="method-heading">




          <span class="method-name">wt_LaplaPol2PolGrid_wt</span><span class="method-args">( wt, [cond], [new] ) result(wt_LaplaPol2PolGrid_wt)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000175">wt_LaplaPol2PolGrid_wt</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 出力ポロイダルポテンシャル分布

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>wt  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm),intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 入力▽^2φ分布

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>cond  </tt></b>  <tt> </tt> :</td><td><tt>character(len=2), intent(in), optional</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 境界条件スイッチ. 省略時は &#8216;RR&#8216;

<pre>
    RR    : 両端粘着条件
    RF    : 上端粘着, 下端応力なし条件
    FR    : 上端応力なし, 下端粘着条件
    FF    : 両端応力なし条件
</pre>
</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>new  </tt></b>  <tt> </tt> :</td><td><tt>logical, intent(IN), optional</tt>

<table>
<tr><td valign="top"> :</td><td> (in) true だと境界条件計算用行列を強制的に新たに作る.

<pre>
    default は false.
</pre>
</td></tr>
</table>
</td></tr>
</table>
<p>
速度ポロイダルポテンシャルΦを▽^2Φから計算する.
チェビシェフ格子点空間で境界条件を適用している.
</p>
<p>
この関数を用いるためには wt_Initial にて設定する
チェビシェフ切断波数(lm)と鉛直格子点数(km)を等しく しておく必要がある.
</p>
<p>
速度ポロイダルポテンシャルΦを f = ▽^2Φから定める式は
</p>
<pre>
   ▽^2Φ = f
     Φ = const. at boundaries.
     ∂Φ/∂r = 0 at boundaries          (粘着条件)
     or ∂^2Φ/∂r^2 = 0 at boundaries   (応力なし条件)
</pre>
<p>
最初に呼ばれるときはオプショナル引数 new に関係なく行列が設定される.
</p>
<p>
最終的にチェビシェフ係数の解が欲しい場合には, <a
href="wt_mpi_module.html#M000166">wz_LaplaPol2Pol_wz</a> に
比べてチェビシェフ &#8212; 格子点変換が 1 回分少なくて済む.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001464">wt_module#wt_LaplaPol2PolGrid_wt</a>
</p>


        </div>
      </div>


      <div id="method-M000094" class="method-detail">
        <a name="M000094"></a>

        <div class="method-heading">




          <span class="method-name">wt_Lapla_wt</span><span class="method-args">( wt ) result(wt_Lapla_wt)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000094">wt_Lapla_wt</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) ラプラシアンを作用された 2 次元スペクトルデータ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>wt  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 2 次元球面調和函数チェビシェフスペクトルデータ

</td></tr>
</table>
</td></tr>
</table>
<p>
入力スペクトルデータにラプラシアン
</p>
<pre>
    ▽^2 =   1/r^2 cos^2φ・∂^2/∂λ^2
           + 1/r^2 cosφ・∂/∂φ(cosφ∂/∂φ)
           + 1/r^2 ∂/∂r (r^2 ∂/∂r)
</pre>
<p>
を作用する.
</p>
<p>
スペクトルデータのラプラシアンとは, 対応する格子点データに
ラプラシアンを作用させたデータのスペクトル変換のことである.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001406">wt_module#wt_Lapla_wt</a>
</p>


        </div>
      </div>


      <div id="method-M000168" class="method-detail">
        <a name="M000168"></a>

        <div class="method-heading">




          <span class="method-name">wt_PolMagBoundaries</span><span class="method-args">( wt_POL, [new] ) </span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Subroutine </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt>wt_POL  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm),intent(inout)</tt>

<table>
<tr><td valign="top"> :</td><td> (inout) 境界条件を適用するデータ. 修正された値を返す.

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>new  </tt></b>  <tt> </tt> :</td><td><tt>logical, intent(IN), optional</tt>

<table>
<tr><td valign="top"> :</td><td> (in) true だと境界条件計算用行列を強制的に新たに作る.

<pre>
    default は false.
</pre>
</td></tr>
</table>
</td></tr>
</table>
<p>
磁場ポロイダルポテンシャルに対して境界条件を適用する. Chebyshev
空間での境界条件適用
</p>
<p>
チェビシェフ空間において境界条件を満たすべく高次の係数を定める方法を
とっている(タウ法). 現在のところ境界物質が非電気伝導体の場合のみ
対応している. その場合, 磁場ポロイダルポテンシャルの各水平スペクトル 成分 h
にたいして境界条件が与えられ,
</p>
<pre>
 * 外側境界 : dh/dr + (n+1)h/r = 0
 * 内側境界 : dh/dr - nh/r = 0
</pre>
<p>
である. ここで n は h の水平全波数である.
</p>
<p>
最初に呼ばれるときはオプショナル引数 new に関係なく行列が設定される.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001472">wt_module#wt_PolMagBoundaries</a>
</p>


        </div>
      </div>


      <div id="method-M000177" class="method-detail">
        <a name="M000177"></a>

        <div class="method-heading">




          <span class="method-name">wt_PolmagBoundariesGrid</span><span class="method-args">( wt_POL, [new] ) </span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Subroutine </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt>wt_POL  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm),intent(inout)</tt>

<table>
<tr><td valign="top"> :</td><td> (inout) 境界条件を適用するデータ. 修正された値を返す.

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>new  </tt></b>  <tt> </tt> :</td><td><tt>logical, intent(IN), optional</tt>

<table>
<tr><td valign="top"> :</td><td> (in) true だと境界条件計算用行列を強制的に新たに作る.

<pre>
    default は false.
</pre>
</td></tr>
</table>
</td></tr>
</table>
<p>
磁場ポロイダルポテンシャルに対して境界条件を適用する.
鉛直実空間での境界条件適用.
</p>
<p>
鉛直実格子点空間において内部領域の値と境界条件を満たすように
条件を課している(選点法). このルーチンを用いるためには wt_Initial
にて設定するチェビシェフ切断波数(lm)と鉛直格子点数(km)を
等しくしておく必要がある.
</p>
<p>
現在のところ境界物質が非電気伝導体の場合のみ対応している. その場合,
磁場ポロイダルポテンシャルの各水平スペクトル成分 h に
たいして境界条件が与えられ,
</p>
<pre>
 * 外側境界 : dh/dr + (n+1)h/r = 0
 * 内側境界 : dh/dr - nh/r = 0
</pre>
<p>
である. ここで n は h の水平全波数である.
</p>
<p>
最初に呼ばれるときはオプショナル引数 new に関係なく行列が設定される.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001468">wt_module#wt_PolmagBoundariesGrid</a>
</p>


        </div>
      </div>


      <div id="method-M000172" class="method-detail">
        <a name="M000172"></a>

        <div class="method-heading">




          <span class="method-name">wt_PolmagBoundariesTau</span><span class="method-args">( wt_POL, [new] ) </span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Subroutine </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt>wt_POL  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm),intent(inout)</tt>

<table>
<tr><td valign="top"> :</td><td> (inout) 境界条件を適用するデータ. 修正された値を返す.

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>new  </tt></b>  <tt> </tt> :</td><td><tt>logical, intent(IN), optional</tt>

<table>
<tr><td valign="top"> :</td><td> (in) true だと境界条件計算用行列を強制的に新たに作る.

<pre>
    default は false.
</pre>
</td></tr>
</table>
</td></tr>
</table>
<p>
磁場ポロイダルポテンシャルに対して境界条件を適用する. Chebyshev
空間での境界条件適用
</p>
<p>
チェビシェフ空間において境界条件を満たすべく高次の係数を定める方法を
とっている(タウ法). 現在のところ境界物質が非電気伝導体の場合のみ
対応している. その場合, 磁場ポロイダルポテンシャルの各水平スペクトル 成分 h
にたいして境界条件が与えられ,
</p>
<pre>
 * 外側境界 : dh/dr + (n+1)h/r = 0
 * 内側境界 : dh/dr - nh/r = 0
</pre>
<p>
である. ここで n は h の水平全波数である.
</p>
<p>
最初に呼ばれるときはオプショナル引数 new に関係なく行列が設定される.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001467">wt_module#wt_PolmagBoundariesTau</a>
</p>


        </div>
      </div>


      <div id="method-M000157" class="method-detail">
        <a name="M000157"></a>

        <div class="method-heading">




          <span class="method-name">wt_Potential2Rotation</span><span class="method-args">( xyz_RotVLON, xyz_RotVLAT, xyz_RotVRAD, wt_TORPOT, wt_POLPOT ) </span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Subroutine </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt>xyz_RotVLON  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km), intent(OUT)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 回転の経度成分

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xyz_RotVLAT  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km), intent(OUT)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 回転の緯度成分

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xyz_RotVRAD  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km), intent(OUT)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 回転の動径成分

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>wt_TORPOT  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) トロイダルポテンシャル

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>wt_POLPOT  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) ポロイダルポテンシャル

</td></tr>
</table>
</td></tr>
</table>
<p>
トロイダルポロイダルポテンシャルΨ,Φで表される非発散ベクトル場
</p>
<pre>
    v = ▽x(Ψr) + ▽x▽x(Φr)
</pre>
<p>
に対して, その回転
</p>
<pre>
    ▽xv = ▽x▽x(Ψr) + ▽x▽x▽x(Φr) = ▽x▽x(Ψr) - ▽x((▽^2Φ)r)
</pre>
<p>
を計算する.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001452">wt_module#wt_Potential2Rotation</a>
</p>


        </div>
      </div>


      <div id="method-M000031" class="method-detail">
        <a name="M000031"></a>

        <div class="method-heading">


          <a href="#M000031" class="method-signature">



          <span class="method-name">wt_Potential2RotationMPI</span><span class="method-args">( xvz_RotVLON, xvz_RotVLAT, xvz_RotVRAD, wt_TORPOT, wt_POLPOT ) </span>



          </a>

        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Subroutine </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt>xvz_RotVLON  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,<a
href="wt_mpi_module.html#M000053">jc</a>,0:km), intent(OUT)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 回転の経度成分

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xvz_RotVLAT  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,<a
href="wt_mpi_module.html#M000053">jc</a>,0:km), intent(OUT)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 回転の緯度成分

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xvz_RotVRAD  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,<a
href="wt_mpi_module.html#M000053">jc</a>,0:km), intent(OUT)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 回転の動径成分

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>wt_TORPOT  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) トロイダルポテンシャル

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>wt_POLPOT  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) ポロイダルポテンシャル

</td></tr>
</table>
</td></tr>
</table>
<p>
トロイダルポロイダルポテンシャルΨ,Φで表される非発散ベクトル場
</p>
<pre>
    v = ▽x(Ψr) + ▽x▽x(Φr)
</pre>
<p>
に対して, その回転
</p>
<pre>
    ▽xv = ▽x▽x(Ψr) + ▽x▽x▽x(Φr) = ▽x▽x(Ψr) - ▽x((▽^2Φ)r)
</pre>
<p>
を計算する.
</p>


          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000031-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000031-source">
<pre>
    subroutine wt_Potential2RotationMPI( xvz_RotVLON,xvz_RotVLAT,xvz_RotVRAD,wt_TORPOT,wt_POLPOT)
      !
      ! トロイダルポロイダルポテンシャルΨ,Φで表される非発散ベクトル場
      !
      !     v = ▽x(Ψr) + ▽x▽x(Φr) 
      !
      ! に対して, その回転
      !
      !     ▽xv = ▽x▽x(Ψr) + ▽x▽x▽x(Φr) = ▽x▽x(Ψr) - ▽x((▽^2Φ)r)
      !
      ! を計算する. 
      
      ! ベクトル場の回転
      real(8), dimension(0:im-1,jc,0:km), intent(OUT) :: xvz_RotVLON
      !(out) 回転の経度成分

      real(8), dimension(0:im-1,jc,0:km), intent(OUT) :: xvz_RotVLAT
      !(out) 回転の緯度成分

      real(8), dimension(0:im-1,jc,0:km), intent(OUT) :: xvz_RotVRAD
      !(out) 回転の動径成分

      ! 入力ベクトル場を表すポテンシャル
      real(8), dimension((nm+1)*(nm+1),0:lm), intent(in) :: wt_TORPOT
      !(in) トロイダルポテンシャル

      real(8), dimension((nm+1)*(nm+1),0:lm), intent(in) :: wt_POLPOT
      !(in) ポロイダルポテンシャル

      call wt_Potential2VectorMPI( xvz_RotVLON,xvz_RotVLAT,xvz_RotVRAD, -wt_Lapla_wt(wt_POLPOT), wt_TORPOT)

    end subroutine wt_Potential2RotationMPI
</pre>
          </div>

        </div>
      </div>


      <div id="method-M000156" class="method-detail">
        <a name="M000156"></a>

        <div class="method-heading">




          <span class="method-name">wt_Potential2Vector</span><span class="method-args">( xyz_VLON, xyz_VLAT, xyz_VRAD, wt_TORPOT, wt_POLPOT ) </span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Subroutine </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt>xyz_VLON  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) ベクトル場の経度成分

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xyz_VLAT  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) ベクトル場の緯度成分

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xyz_VRAD  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) ベクトル場の動径成分

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>wt_TORPOT  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) トロイダルポテンシャル

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>wt_POLPOT  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) ポロイダルポテンシャル

</td></tr>
</table>
</td></tr>
</table>
<p>
トロイダルポロイダルポテンシャルΨ,Φで表される非発散ベクトル場
</p>
<pre>
    v = ▽x(Ψr) + ▽x▽x(Φr)
</pre>
<p>
の各成分を計算する
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001451">wt_module#wt_Potential2Vector</a>
</p>


        </div>
      </div>


      <div id="method-M000030" class="method-detail">
        <a name="M000030"></a>

        <div class="method-heading">


          <a href="#M000030" class="method-signature">



          <span class="method-name">wt_Potential2VectorMPI</span><span class="method-args">( xvz_VLON, xvz_VLAT, xvz_VRAD, wt_TORPOT, wt_POLPOT ) </span>



          </a>

        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Subroutine </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt>xvz_VLON  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,<a
href="wt_mpi_module.html#M000053">jc</a>,0:km)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) ベクトル場の経度成分

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xvz_VLAT  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,<a
href="wt_mpi_module.html#M000053">jc</a>,0:km)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) ベクトル場の緯度成分

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xvz_VRAD  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,<a
href="wt_mpi_module.html#M000053">jc</a>,0:km)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) ベクトル場の動径成分

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>wt_TORPOT  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) トロイダルポテンシャル

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>wt_POLPOT  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) ポロイダルポテンシャル

</td></tr>
</table>
</td></tr>
</table>
<p>
トロイダルポロイダルポテンシャルΨ,Φで表される非発散ベクトル場
</p>
<pre>
    v = ▽x(Ψr) + ▽x▽x(Φr)
</pre>
<p>
の各成分を計算する
</p>


          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000030-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000030-source">
<pre>
    subroutine wt_Potential2VectorMPI( xvz_VLON,xvz_VLAT,xvz_VRAD,wt_TORPOT,wt_POLPOT)
      !
      ! トロイダルポロイダルポテンシャルΨ,Φで表される非発散ベクトル場
      !
      !     v = ▽x(Ψr) + ▽x▽x(Φr) 
      !
      ! の各成分を計算する
      !
      real(8), dimension(0:im-1,jc,0:km)     :: xvz_VLON
      !(out) ベクトル場の経度成分

      real(8), dimension(0:im-1,jc,0:km)     :: xvz_VLAT
      !(out) ベクトル場の緯度成分

      real(8), dimension(0:im-1,jc,0:km)     :: xvz_VRAD
      !(out) ベクトル場の動径成分

      real(8), dimension((nm+1)*(nm+1),0:lm), intent(in) :: wt_TORPOT
      !(in) トロイダルポテンシャル

      real(8), dimension((nm+1)*(nm+1),0:lm), intent(in) :: wt_POLPOT
      !(in) ポロイダルポテンシャル

      xvz_VLON =   xvz_RAD * xvz_GradLat_wt(wt_TORPOT) + xva_GradLon_wa(wz_wt(wt_RotRad_wt(wt_POLPOT)))
      xvz_VLAT = - xvz_RAD * xvz_GradLon_wt(wt_TORPOT) + xva_GradLat_wa(wz_wt(wt_RotRad_wt(wt_POLPOT)))
      xvz_VRAD = xvz_wt(wt_L2_wt(wt_POLPOT))/xvz_RAD

    end subroutine wt_Potential2VectorMPI
</pre>
          </div>

        </div>
      </div>


      <div id="method-M000153" class="method-detail">
        <a name="M000153"></a>

        <div class="method-heading">




          <span class="method-name">wt_QOperator_wt</span><span class="method-args">( wt ) result(wt_QOperator_wt)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000153">wt_QOperator_wt</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) Q 演算子を作用された 2 次元スペクトルデータ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>wt  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 2 次元球面調和函数チェビシェフスペクトルデータ

</td></tr>
</table>
</td></tr>
</table>
<p>
入力スペクトルデータに対応する格子点データに演算子
</p>
<pre>
   Q=(k・▽-1/2(L2 k・▽+ k・▽L2))
</pre>
<p>
を作用させたデータのスペクトル変換が返される.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001448">wt_module#wt_QOperator_wt</a>
</p>


        </div>
      </div>


      <div id="method-M000029" class="method-detail">
        <a name="M000029"></a>

        <div class="method-heading">


          <a href="#M000029" class="method-signature">



          <span class="method-name">wt_RadRotRot_xvz_xvz_xvz</span><span class="method-args">( xvz_VLON, xvz_VLAT, xvz_VRAD ) result(wt_RadRotRot_xvz_xvz_xvz)</span>



          </a>

        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000029">wt_RadRotRot_xvz_xvz_xvz</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) ベクトル v の r・(▽×▽×v)

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xvz_VLON  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,<a
href="wt_mpi_module.html#M000053">jc</a>,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) ベクトルの経度成分

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xvz_VLAT  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,<a
href="wt_mpi_module.html#M000053">jc</a>,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) ベクトルの緯度成分

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xvz_VRAD  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,<a
href="wt_mpi_module.html#M000053">jc</a>,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) ベクトルの動径成分

</td></tr>
</table>
</td></tr>
</table>
<p>
ベクトル v に対して r・(▽×▽×v) を計算する.
</p>
<p>
第 1, 2, 3 引数(v[λ], v[φ], v[r])がそれぞれベクトルの経度成分, 緯度成分,
動径成分を表す.
</p>
<pre>
   r・(▽×▽×v)  = 1/r ∂/∂r (r・( 1/cosφ・∂v[λ]/∂λ
                                 + 1/cosφ・∂(v[φ] cosφ)/∂φ ) )
                    + L^2 v[r]/r
</pre>
<p>
のスペクトルデータが返される.
</p>


          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000029-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000029-source">
<pre>
    function wt_RadRotRot_xvz_xvz_xvz(xvz_VLON,xvz_VLAT,xvz_VRAD) 
      ! 
      ! ベクトル v に対して r・(▽×▽×v) を計算する.
      !
      ! 第 1, 2, 3 引数(v[λ], v[φ], v[r])がそれぞれベクトルの経度成分, 
      ! 緯度成分, 動径成分を表す. 
      !
      !    r・(▽×▽×v)  = 1/r ∂/∂r (r・( 1/cosφ・∂v[λ]/∂λ 
      !                                  + 1/cosφ・∂(v[φ] cosφ)/∂φ ) ) 
      !                     + L^2 v[r]/r 
      !
      ! のスペクトルデータが返される.
      !
      real(8), dimension(0:im-1,jc,0:km), intent(in) :: xvz_VLON
      !(in) ベクトルの経度成分

      real(8), dimension(0:im-1,jc,0:km), intent(in) :: xvz_VLAT
      !(in) ベクトルの緯度成分

      real(8), dimension(0:im-1,jc,0:km), intent(in) :: xvz_VRAD
      !(in) ベクトルの動径成分

      real(8), dimension((nm+1)*(nm+1),0:lm)     :: wt_RadRotRot_xvz_xvz_xvz
      !(out) ベクトル v の r・(▽×▽×v) 

      wt_RadRotRot_xvz_xvz_xvz = wt_RotRad_wt(wt_wz( (wa_DivLon_xva(xvz_VLON)+ wa_DivLat_xva(xvz_VLAT)))) + wt_L2_wt(wt_xvz(xvz_VRAD/xvz_RAD))

    end function wt_RadRotRot_xvz_xvz_xvz
</pre>
          </div>

        </div>
      </div>


      <div id="method-M000155" class="method-detail">
        <a name="M000155"></a>

        <div class="method-heading">




          <span class="method-name">wt_RadRotRot_xyz_xyz_xyz</span><span class="method-args">( xyz_VLON, xyz_VLAT, xyz_VRAD ) result(wt_RadRotRot_xyz_xyz_xyz)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000155">wt_RadRotRot_xyz_xyz_xyz</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) ベクトル v の r・(▽×▽×v)

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xyz_VLON  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) ベクトルの経度成分

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xyz_VLAT  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) ベクトルの緯度成分

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xyz_VRAD  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) ベクトルの動径成分

</td></tr>
</table>
</td></tr>
</table>
<p>
ベクトル v に対して r・(▽×▽×v) を計算する.
</p>
<p>
第 1, 2, 3 引数(v[λ], v[φ], v[r])がそれぞれベクトルの経度成分, 緯度成分,
動径成分を表す.
</p>
<pre>
   r・(▽×▽×v)  = 1/r ∂/∂r (r・( 1/cosφ・∂v[λ]/∂λ
                                 + 1/cosφ・∂(v[φ] cosφ)/∂φ ) )
                    + L^2 v[r]/r
</pre>
<p>
のスペクトルデータが返される.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001450">wt_module#wt_RadRotRot_xyz_xyz_xyz</a>
</p>


        </div>
      </div>


      <div id="method-M000028" class="method-detail">
        <a name="M000028"></a>

        <div class="method-heading">


          <a href="#M000028" class="method-signature">



          <span class="method-name">wt_RadRot_xvz_xvz</span><span class="method-args">( xvz_VLON, xvz_VLAT ) result(wt_RadRot_xvz_xvz)</span>



          </a>

        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000028">wt_RadRot_xvz_xvz</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) ベクトルの渦度と動径ベクトルの内積

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xvz_VLON  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,<a
href="wt_mpi_module.html#M000053">jc</a>,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) ベクトルの経度成分

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xvz_VLAT  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,<a
href="wt_mpi_module.html#M000053">jc</a>,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) ベクトルの緯度成分

</td></tr>
</table>
</td></tr>
</table>
<p>
r・(▽×v)
</p>
<p>
ベクトルの渦度と動径ベクトルの内積 r・(▽×v) を計算する.
</p>
<p>
第 1, 2 引数(v[λ], v[φ])がそれぞれベクトルの経度成分, 緯度成分を表す.
</p>
<pre>
   r・(▽×v) = 1/cosφ・∂v[φ]/∂λ - 1/cosφ・∂(v[λ] cosφ)/∂φ
</pre>
<p>
のスペクトル データが返される.
</p>


          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000028-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000028-source">
<pre>
    function wt_RadRot_xvz_xvz(xvz_VLON,xvz_VLAT)  ! r・(▽×v)
      !
      ! ベクトルの渦度と動径ベクトルの内積 r・(▽×v) を計算する.
      !
      ! 第 1, 2 引数(v[λ], v[φ])がそれぞれベクトルの経度成分, 緯度成分を表す.
      !
      !    r・(▽×v) = 1/cosφ・∂v[φ]/∂λ - 1/cosφ・∂(v[λ] cosφ)/∂φ
      !
      ! のスペクトル データが返される.
      !
      real(8), dimension(0:im-1,jc,0:km), intent(in) :: xvz_VLON
      !(in) ベクトルの経度成分

      real(8), dimension(0:im-1,jc,0:km), intent(in) :: xvz_VLAT
      !(in) ベクトルの緯度成分

      real(8), dimension((nm+1)*(nm+1),0:lm)     :: wt_RadRot_xvz_xvz
      !(out) ベクトルの渦度と動径ベクトルの内積

      wt_RadRot_xvz_xvz = wt_wz(wa_DivLon_xva(xvz_VLAT) - wa_DivLat_xva(xvz_VLON))
      
    end function wt_RadRot_xvz_xvz
</pre>
          </div>

        </div>
      </div>


      <div id="method-M000154" class="method-detail">
        <a name="M000154"></a>

        <div class="method-heading">




          <span class="method-name">wt_RadRot_xyz_xyz</span><span class="method-args">( xyz_VLON, xyz_VLAT ) result(wt_RadRot_xyz_xyz)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000154">wt_RadRot_xyz_xyz</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) ベクトルの渦度と動径ベクトルの内積

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xyz_VLON  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) ベクトルの経度成分

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xyz_VLAT  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) ベクトルの緯度成分

</td></tr>
</table>
</td></tr>
</table>
<p>
r・(▽×v)
</p>
<p>
ベクトルの渦度と動径ベクトルの内積 r・(▽×v) を計算する.
</p>
<p>
第 1, 2 引数(v[λ], v[φ])がそれぞれベクトルの経度成分, 緯度成分を表す.
</p>
<pre>
   r・(▽×v) = 1/cosφ・∂v[φ]/∂λ - 1/cosφ・∂(v[λ] cosφ)/∂φ
</pre>
<p>
のスペクトル データが返される.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001449">wt_module#wt_RadRot_xyz_xyz</a>
</p>


        </div>
      </div>


      <div id="method-M000093" class="method-detail">
        <a name="M000093"></a>

        <div class="method-heading">




          <span class="method-name">wt_RotRad_wt</span><span class="method-args">( wt ) result(wt_RotRad_wt)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000093">wt_RotRad_wt</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 回転型動径微分を作用された 2 次元スペクトルデータ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>wt  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 2 次元球面調和函数チェビシェフスペクトルデータ

</td></tr>
</table>
</td></tr>
</table>
<p>
入力スペクトルデータに回転型動径微分
</p>
<pre>
     1/r ∂(r.)/∂r = ∂(.)/∂r + (.)/r
</pre>
<p>
を作用する.
</p>
<p>
スペクトルデータの回転型動径微分とは, 対応する格子点データに
回転型動径微分を作用させたデータのスペクトル変換のことである.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001405">wt_module#wt_RotRad_wt</a>
</p>


        </div>
      </div>


      <div id="method-M000026" class="method-detail">
        <a name="M000026"></a>

        <div class="method-heading">


          <a href="#M000026" class="method-signature">



          <span class="method-name">wt_RotRad_xvz_xvz</span><span class="method-args">( xvz_Vlat, xvz_Vlon ) result(wt_RotRad_xvz_xvz)</span>



          </a>

        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000026">wt_RotRad_xvz_xvz</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) ベクトル場の回転の動径成分

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xvz_Vlat  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,<a
href="wt_mpi_module.html#M000053">jc</a>,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) ベクトル場の緯度成分

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xvz_Vlon  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,<a
href="wt_mpi_module.html#M000053">jc</a>,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) ベクトル場の経度成分

</td></tr>
</table>
</td></tr>
</table>
<p>
ベクトルの緯度成分, 経度成分である第 1, 2 引数 Vlat, Vlon に対して
ベクトル場の回転の動径成分
</p>
<pre>
   1/rcosφ・∂Vlat/∂λ - 1/rcosφ・∂(Vlon cosφ)/∂φ
</pre>
<p>
を計算する.
</p>


          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000026-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000026-source">
<pre>
    function wt_RotRad_xvz_xvz(xvz_Vlat,xvz_Vlon) 
      !
      ! ベクトルの緯度成分, 経度成分である第 1, 2 引数 Vlat, Vlon に対して
      ! ベクトル場の回転の動径成分 
      !
      !    1/rcosφ・∂Vlat/∂λ - 1/rcosφ・∂(Vlon cosφ)/∂φ
      !
      ! を計算する.
      !
      real(8), dimension(0:im-1,jc,0:km), intent(in) :: xvz_Vlat
      !(in) ベクトル場の緯度成分

      real(8), dimension(0:im-1,jc,0:km), intent(in) :: xvz_Vlon
      !(in) ベクトル場の経度成分

      real(8), dimension((nm+1)*(nm+1),0:lm)     :: wt_RotRad_xvz_xvz
      !(out) ベクトル場の回転の動径成分

        wt_RotRad_xvz_xvz =   wt_DivLon_xvz(xvz_Vlat) - wt_DivLat_xvz(xvz_Vlon)

    end function wt_RotRad_xvz_xvz
</pre>
          </div>

        </div>
      </div>


      <div id="method-M000103" class="method-detail">
        <a name="M000103"></a>

        <div class="method-heading">




          <span class="method-name">wt_RotRad_xyz_xyz</span><span class="method-args">( xyz_Vlat, xyz_Vlon ) result(wt_RotRad_xyz_xyz)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000103">wt_RotRad_xyz_xyz</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) ベクトル場の回転の動径成分

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xyz_Vlat  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) ベクトル場の緯度成分

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xyz_Vlon  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) ベクトル場の経度成分

</td></tr>
</table>
</td></tr>
</table>
<p>
ベクトルの緯度成分, 経度成分である第 1, 2 引数 Vlat, Vlon に対して
ベクトル場の回転の動径成分
</p>
<pre>
   1/rcosφ・∂Vlat/∂λ - 1/rcosφ・∂(Vlon cosφ)/∂φ
</pre>
<p>
を計算する.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001415">wt_module#wt_RotRad_xyz_xyz</a>
</p>


        </div>
      </div>


      <div id="method-M000165" class="method-detail">
        <a name="M000165"></a>

        <div class="method-heading">




          <span class="method-name">wt_TorBoundaries</span><span class="method-args">( wt_TORPOT, [values], [cond], [new] ) </span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Subroutine </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt>wt_TORPOT  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm),intent(inout)</tt>

<table>
<tr><td valign="top"> :</td><td> (inout) 境界条件を適用するデータ. 修正された値を返す.

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>values  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),2), intent(in), optional</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 両端境界でのトロイダルポテンシャル

<pre>
    粘着条件の時のみ有効
</pre>
</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>cond  </tt></b>  <tt> </tt> :</td><td><tt>character(len=2), intent(in), optional</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 境界条件スイッチ. 省略時は &#8216;RR&#8216;

<pre>
    RR    : 両端粘着条件
    RF    : 上端粘着, 下端応力なし条件
    FR    : 上端応力なし, 下端粘着条件
    FF    : 両端応力なし条件
</pre>
</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>new  </tt></b>  <tt> </tt> :</td><td><tt>logical, intent(IN), optional</tt>

<table>
<tr><td valign="top"> :</td><td> (in) true だと境界条件計算用行列を強制的に新たに作る.

<pre>
    default は false.
</pre>
</td></tr>
</table>
</td></tr>
</table>
<p>
速度トロイダルポテンシャルに対して境界条件を適用する. Chebyshev
空間での境界条件適用.
</p>
<p>
速度トロイダルポテンシャルΨに対して与えられる境界条件は
</p>
<pre>
  * 粘着条件 : Ψ = Ψb(lon,lat). Ψb は境界球面での速度分布.
                                  default は 0(静止状態).

  * 応力なし条件 : ∂(Ψ/r)/∂r = 0.
</pre>
<p>
最初に呼ばれるときはオプショナル引数 new に関係なく行列が設定される.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001470">wt_module#wt_TorBoundaries</a>
</p>


        </div>
      </div>


      <div id="method-M000174" class="method-detail">
        <a name="M000174"></a>

        <div class="method-heading">




          <span class="method-name">wt_TorBoundariesGrid</span><span class="method-args">( wt_TORPOT, [values], [cond], [new] ) </span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Subroutine </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt>wt_TORPOT  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm),intent(inout)</tt>

<table>
<tr><td valign="top"> :</td><td> (inout) 境界条件を適用するデータ. 修正された値を返す.

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>values  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),2), intent(in), optional</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 両端境界でのトロイダルポテンシャル

<pre>
    粘着条件の時のみ有効
</pre>
</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>cond  </tt></b>  <tt> </tt> :</td><td><tt>character(len=2), intent(in), optional</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 境界条件スイッチ. 省略時は &#8216;RR&#8216;

<pre>
    RR    : 両端粘着条件
    RF    : 上端粘着, 下端応力なし条件
    FR    : 上端応力なし, 下端粘着条件
    FF    : 両端応力なし条件
</pre>
</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>new  </tt></b>  <tt> </tt> :</td><td><tt>logical, intent(IN), optional</tt>

<table>
<tr><td valign="top"> :</td><td> (in) true だと境界条件計算用行列を強制的に新たに作る.

<pre>
    default は false.
</pre>
</td></tr>
</table>
</td></tr>
</table>
<p>
速度トロイダルポテンシャルに対して境界条件を適用する.
実空間での境界条件適用
</p>
<p>
鉛直実格子点空間において内部領域の値と境界条件を満たすように
条件を課している(選点法). このルーチンを用いるためには wt_Initial
にて設定するチェビシェフ切断波数(lm)と鉛直格子点数(km)を
等しくしておく必要がある.
</p>
<p>
速度トロイダルポテンシャルΨに対して与えられる境界条件は
</p>
<pre>
  * 粘着条件 : Ψ = Ψb(lon,lat). Ψb は境界球面での速度分布.
                                  default は 0 (静止状態).

  * 応力なし条件 : ∂(Ψ/r)/∂r = 0.
</pre>
<p>
最初に呼ばれるときはオプショナル引数 new に関係なく行列が設定される.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001462">wt_module#wt_TorBoundariesGrid</a>
</p>


        </div>
      </div>


      <div id="method-M000170" class="method-detail">
        <a name="M000170"></a>

        <div class="method-heading">




          <span class="method-name">wt_TorBoundariesTau</span><span class="method-args">( wt_TORPOT, [values], [cond], [new] ) </span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Subroutine </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt>wt_TORPOT  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm),intent(inout)</tt>

<table>
<tr><td valign="top"> :</td><td> (inout) 境界条件を適用するデータ. 修正された値を返す.

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>values  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),2), intent(in), optional</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 両端境界でのトロイダルポテンシャル

<pre>
    粘着条件の時のみ有効
</pre>
</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>cond  </tt></b>  <tt> </tt> :</td><td><tt>character(len=2), intent(in), optional</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 境界条件スイッチ. 省略時は &#8216;RR&#8216;

<pre>
    RR    : 両端粘着条件
    RF    : 上端粘着, 下端応力なし条件
    FR    : 上端応力なし, 下端粘着条件
    FF    : 両端応力なし条件
</pre>
</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>new  </tt></b>  <tt> </tt> :</td><td><tt>logical, intent(IN), optional</tt>

<table>
<tr><td valign="top"> :</td><td> (in) true だと境界条件計算用行列を強制的に新たに作る.

<pre>
    default は false.
</pre>
</td></tr>
</table>
</td></tr>
</table>
<p>
速度トロイダルポテンシャルに対して境界条件を適用する. Chebyshev
空間での境界条件適用.
</p>
<p>
速度トロイダルポテンシャルΨに対して与えられる境界条件は
</p>
<pre>
  * 粘着条件 : Ψ = Ψb(lon,lat). Ψb は境界球面での速度分布.
                                  default は 0(静止状態).

  * 応力なし条件 : ∂(Ψ/r)/∂r = 0.
</pre>
<p>
最初に呼ばれるときはオプショナル引数 new に関係なく行列が設定される.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001461">wt_module#wt_TorBoundariesTau</a>
</p>


        </div>
      </div>


      <div id="method-M000167" class="method-detail">
        <a name="M000167"></a>

        <div class="method-heading">




          <span class="method-name">wt_TorMagBoundaries</span><span class="method-args">( wt_TOR, [new] ) </span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Subroutine </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt>wt_TOR  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm),intent(inout)</tt>

<table>
<tr><td valign="top"> :</td><td> (inout) 境界条件を適用するデータ. 修正された値を返す.

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>new  </tt></b>  <tt> </tt> :</td><td><tt>logical, intent(IN), optional</tt>

<table>
<tr><td valign="top"> :</td><td> (in) true だと境界条件計算用行列を強制的に新たに作る.

<pre>
    default は false.
</pre>
</td></tr>
</table>
</td></tr>
</table>
<p>
Original external subprogram is <a
href="wt_module.html#M001471">wt_module#wt_TorMagBoundaries</a>
</p>


        </div>
      </div>


      <div id="method-M000176" class="method-detail">
        <a name="M000176"></a>

        <div class="method-heading">




          <span class="method-name">wt_TormagBoundariesGrid</span><span class="method-args">( wt_TOR, [new] ) </span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Subroutine </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt>wt_TOR  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm),intent(inout)</tt>

<table>
<tr><td valign="top"> :</td><td> (inout) 境界条件を適用するデータ. 修正された値を返す.

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>new  </tt></b>  <tt> </tt> :</td><td><tt>logical, intent(IN), optional</tt>

<table>
<tr><td valign="top"> :</td><td> (in) true だと境界条件計算用行列を強制的に新たに作る.

<pre>
    default は false.
</pre>
</td></tr>
</table>
</td></tr>
</table>
<p>
磁場トロイダルポテンシャルに対して境界条件を適用する.
鉛直実空間での境界条件適用.
</p>
<p>
鉛直実格子点空間において内部領域の値と境界条件を満たすように
条件を課している(選点法). このルーチンを用いるためには wt_Initial
にて設定するチェビシェフ切断波数(lm)と鉛直格子点数(km)を
等しくしておく必要がある.
</p>
<p>
現在のところ境界物質が非電気伝導体の場合のみ対応している. その場合,
磁場トロイダルポテンシャルの境界条件は
</p>
<p>
外側
</p>
<pre>
   wt_psi = 0   at the outer boundary
</pre>
<p>
内側
</p>
<pre>
   wt_psi = 0       at the inner boundary
</pre>
<p>
であるので <a href="wt_mpi_module.html#M000164">wt_Boundaries</a>
で対応可能だが, 将来のため別途作成しておく
</p>
<p>
最初に呼ばれるときはオプショナル引数 new に関係なく行列が設定される.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001466">wt_module#wt_TormagBoundariesGrid</a>
</p>


        </div>
      </div>


      <div id="method-M000171" class="method-detail">
        <a name="M000171"></a>

        <div class="method-heading">




          <span class="method-name">wt_TormagBoundariesTau</span><span class="method-args">( wt_TOR, [new] ) </span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Subroutine </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt>wt_TOR  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm),intent(inout)</tt>

<table>
<tr><td valign="top"> :</td><td> (inout) 境界条件を適用するデータ. 修正された値を返す.

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>new  </tt></b>  <tt> </tt> :</td><td><tt>logical, intent(IN), optional</tt>

<table>
<tr><td valign="top"> :</td><td> (in) true だと境界条件計算用行列を強制的に新たに作る.

<pre>
    default は false.
</pre>
</td></tr>
</table>
</td></tr>
</table>
<p>
Original external subprogram is <a
href="wt_module.html#M001465">wt_module#wt_TormagBoundariesTau</a>
</p>


        </div>
      </div>


      <div id="method-M000158" class="method-detail">
        <a name="M000158"></a>

        <div class="method-heading">




          <span class="method-name">wt_VGradV</span><span class="method-args">( xyz_VGRADV_LON, xyz_VGRADV_LAT, xyz_VGRADV_RAD, xyz_VLON, xyz_VLAT, xyz_VRAD ) </span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Subroutine </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt>xyz_VGRADV_LON  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km),intent(out)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) (v・▽v) 経度成分

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xyz_VGRADV_LAT  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km),intent(out)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) (v・▽v) 緯度成分

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xyz_VGRADV_RAD  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km),intent(out)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) (v・▽v) 動径成分

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xyz_VLON  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km),intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) ベクトル場 v の経度成分

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xyz_VLAT  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km),intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) ベクトル場 v の緯度成分

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xyz_VRAD  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km),intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) ベクトル場 v の動径成分

</td></tr>
</table>
</td></tr>
</table>
<p>
ベクトル場の v・▽v を計算する.
</p>
<p>
ベクトル場 v=(v[λ],v[φ],v[r]) に対するv・▽vの各成分は
次のように計算される.
</p>
<pre>
  (v・▽v)[λ] = ▽・(v[λ]v) + v[λ]v[r]/r - v[λ]v[φ]tan(φ)/r
  (v・▽v)[φ] = ▽・(v[φ]v) + v[φ]v[r]/r - v[λ]^2tan(φ)/r
  (v・▽v)[r] = ▽・(v[r]v) + (v[λ]^2+v[φ]^2)/r
</pre>
<p>
非発散速度場に対してはポテンシャルから <a
href="wt_mpi_module.html#M000157">wt_Potential2Rotation</a> を
用いて回転を計算し, 恒等式 v・▽v = ▽(v[2^/2) - vx▽xv を
用いる方がよいだろう.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001453">wt_module#wt_VGradV</a>
</p>


        </div>
      </div>


      <div id="method-M000032" class="method-detail">
        <a name="M000032"></a>

        <div class="method-heading">


          <a href="#M000032" class="method-signature">



          <span class="method-name">wt_VGradVMPI</span><span class="method-args">( xvz_VGRADV_LON, xvz_VGRADV_LAT, xvz_VGRADV_RAD, xvz_VLON, xvz_VLAT, xvz_VRAD ) </span>



          </a>

        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Subroutine </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt>xvz_VGRADV_LON  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,<a
href="wt_mpi_module.html#M000053">jc</a>,0:km),intent(out)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) (v・▽v) 経度成分

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xvz_VGRADV_LAT  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,<a
href="wt_mpi_module.html#M000053">jc</a>,0:km),intent(out)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) (v・▽v) 緯度成分

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xvz_VGRADV_RAD  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,<a
href="wt_mpi_module.html#M000053">jc</a>,0:km),intent(out)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) (v・▽v) 動径成分

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xvz_VLON  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,<a
href="wt_mpi_module.html#M000053">jc</a>,0:km),intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) ベクトル場 v の経度成分

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xvz_VLAT  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,<a
href="wt_mpi_module.html#M000053">jc</a>,0:km),intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) ベクトル場 v の緯度成分

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xvz_VRAD  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,<a
href="wt_mpi_module.html#M000053">jc</a>,0:km),intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) ベクトル場 v の動径成分

</td></tr>
</table>
</td></tr>
</table>
<p>
ベクトル場の v・▽v を計算する.
</p>
<p>
ベクトル場 v=(v[λ],v[φ],v[r]) に対するv・▽vの各成分は
次のように計算される.
</p>
<pre>
  (v・▽v)[λ] = ▽・(v[λ]v) + v[λ]v[r]/r - v[λ]v[φ]tan(φ)/r
  (v・▽v)[φ] = ▽・(v[φ]v) + v[φ]v[r]/r - v[λ]^2tan(φ)/r
  (v・▽v)[r] = ▽・(v[r]v) + (v[λ]^2+v[φ]^2)/r
</pre>
<p>
非発散速度場に対してはポテンシャルから <a
href="wt_mpi_module.html#M000157">wt_Potential2Rotation</a> を
用いて回転を計算し, 恒等式 v・▽v = ▽(v[2^/2) - vx▽xv を
用いる方がよいだろう.
</p>


          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000032-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000032-source">
<pre>
    subroutine wt_VGradVMPI(xvz_VGRADV_LON,xvz_VGRADV_LAT,xvz_VGRADV_RAD, xvz_VLON,xvz_VLAT,xvz_VRAD )
      !
      ! ベクトル場の v・▽v を計算する.
      !
      ! ベクトル場 v=(v[λ],v[φ],v[r]) に対するv・▽vの各成分は
      ! 次のように計算される.
      !
      !   (v・▽v)[λ] = ▽・(v[λ]v) + v[λ]v[r]/r - v[λ]v[φ]tan(φ)/r
      !   (v・▽v)[φ] = ▽・(v[φ]v) + v[φ]v[r]/r - v[λ]^2tan(φ)/r
      !   (v・▽v)[r] = ▽・(v[r]v) + (v[λ]^2+v[φ]^2)/r
      !
      ! 非発散速度場に対してはポテンシャルから wt_Potential2Rotation を
      ! 用いて回転を計算し, 恒等式 v・▽v = ▽(v[2^/2) - vx▽xv を
      ! 用いる方がよいだろう.
      !
      real(8), dimension(0:im-1,jc,0:km),intent(out)   :: xvz_VGRADV_LON
      !(out) (v・▽v) 経度成分

      real(8), dimension(0:im-1,jc,0:km),intent(out)   :: xvz_VGRADV_LAT
      !(out) (v・▽v) 緯度成分

      real(8), dimension(0:im-1,jc,0:km),intent(out)   :: xvz_VGRADV_RAD
      !(out) (v・▽v) 動径成分

      real(8), dimension(0:im-1,jc,0:km),intent(in)    :: xvz_VLON
      !(in) ベクトル場 v の経度成分

      real(8), dimension(0:im-1,jc,0:km),intent(in)    :: xvz_VLAT
      !(in) ベクトル場 v の緯度成分

      real(8), dimension(0:im-1,jc,0:km),intent(in)    :: xvz_VRAD
      !(in) ベクトル場 v の動径成分

      xvz_VGRADV_LON = xvz_Div_xvz_xvz_xvz( xvz_VLON * xvz_VLON, xvz_VLON*xvz_VLAT, xvz_VLON*xvz_VRAD ) + xvz_VLON*xvz_VRAD/xvz_RAD - xvz_VLON*xvz_VLAT*tan(xvz_LAT)/xvz_RAD 

      xvz_VGRADV_LAT = xvz_Div_xvz_xvz_xvz( xvz_VLAT*xvz_VLON, xvz_VLAT*xvz_VLAT, xvz_VLAT*xvz_VRAD ) + xvz_VLAT*xvz_VRAD/xvz_RAD + xvz_VLON**2*tan(xvz_LAT)/xvz_RAD 

      xvz_VGRADV_RAD = xvz_Div_xvz_xvz_xvz( xvz_VRAD*xvz_VLON, xvz_VRAD*xvz_VLAT, xvz_VRAD*xvz_VRAD ) - (xvz_VLON**2 + xvz_VLAT**2)/xvz_RAD 

    end subroutine wt_VGradVMPI
</pre>
          </div>

        </div>
      </div>


      <div id="method-M000076" class="method-detail">
        <a name="M000076"></a>

        <div class="method-heading">




          <span class="method-name">wt_VMiss</span><span class="method-args"></span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em>Variable</em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000076">wt_VMiss</a>  </tt></b>  <tt> = -999.0        </tt> :</td><td><tt>real(8)</tt>

<table>
<tr><td valign="top"> :</td><td> 欠損値

</td></tr>
</table>
</td></tr>
</table>
<p>
Original external subprogram is <a
href="wt_module.html#M001395">wt_module#wt_VMiss</a>
</p>


        </div>
      </div>


      <div id="method-M000013" class="method-detail">
        <a name="M000013"></a>

        <div class="method-heading">


          <a href="#M000013" class="method-signature">



          <span class="method-name">wt_mpi_Initial</span><span class="method-args">( i, j, k, n, l, r_in, r_out, [np] ) </span>



          </a>

        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Subroutine </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt>i  </tt></b>  <tt> </tt> :</td><td><tt>integer,intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> 格子点数(経度λ)

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>j  </tt></b>  <tt> </tt> :</td><td><tt>integer,intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> 格子点数(緯度φ)

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>k  </tt></b>  <tt> </tt> :</td><td><tt>integer,intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> 格子点数(動径 r)

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>n  </tt></b>  <tt> </tt> :</td><td><tt>integer,intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> 切断波数(水平全波数)

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>l  </tt></b>  <tt> </tt> :</td><td><tt>integer,intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> 切断波数(動径波数)

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>r_in  </tt></b>  <tt> </tt> :</td><td><tt>real(8),intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> 球殻内半径

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>r_out  </tt></b>  <tt> </tt> :</td><td><tt>real(8),intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> 球殻外半径

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>np  </tt></b>  <tt> </tt> :</td><td><tt>integer,intent(in), optional</tt>

<table>
<tr><td valign="top"> :</td><td> OPENMP での最大スレッド数

</td></tr>
</table>
</td></tr>
</table>
<p>
スペクトル変換の格子点数, 波数, 動径座標の範囲を設定する.
</p>
<p>
他の関数を呼ぶ前に, 最初にこのサブルーチンを呼んで初期設定を
しなければならない.
</p>


          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000013-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000013-source">
<pre>
   subroutine wt_mpi_Initial(i,j,k,n,l,r_in,r_out,np)
     !
     ! スペクトル変換の格子点数, 波数, 動径座標の範囲を設定する.
     !
     ! 他の関数を呼ぶ前に, 最初にこのサブルーチンを呼んで初期設定を
     ! しなければならない. 
     !
     integer,intent(in) :: i              ! 格子点数(経度λ)
     integer,intent(in) :: j              ! 格子点数(緯度φ)
     integer,intent(in) :: k              ! 格子点数(動径 r)
     integer,intent(in) :: n              ! 切断波数(水平全波数)
     integer,intent(in) :: l              ! 切断波数(動径波数)

     real(8),intent(in) :: r_in           ! 球殻内半径
     real(8),intent(in) :: r_out          ! 球殻外半径

     integer,intent(in), optional :: np   ! OPENMP での最大スレッド数

     im = i  
      jm = j 
      km = k
     nm = n  
      lm = l
     ri = r_in 
      ro = r_out

     if ( present(np) ) then
        call wt_Initial(im,jm,km,nm,lm,ri,ro,np=np)
     else
        call wt_Initial(im,jm,km,nm,lm,ri,ro)
     endif
     call w_base_mpi_Initial
     call w_deriv_mpi_Initial
     call wa_base_mpi_Initial

     allocate(xvz_Lon(0:im-1,jc,0:km))
     allocate(xvz_Lat(0:im-1,jc,0:km))
     allocate(xvz_Rad(0:im-1,jc,0:km))

     xvz_Lon = spread(xv_Lon,3,km+1)
     xvz_Lat = spread(xv_Lat,3,km+1)
     xvz_Rad = spread(spread(z_Rad,1,jc),1,im)

   end subroutine wt_mpi_Initial
</pre>
          </div>

        </div>
      </div>


      <div id="method-M000090" class="method-detail">
        <a name="M000090"></a>

        <div class="method-heading">




          <span class="method-name">wt_wz</span><span class="method-args">( wz ) result(wt_wz)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000090">wt_wz</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 2 次元球面調和函数チェビシェフスペクトルデータ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>wz  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 2 次元球面調和函数スペクトル・動径格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
水平スペクトル・動径格子点データからスペクトルデータへ(正)変換する.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001402">wt_module#wt_wz</a>
</p>


        </div>
      </div>


      <div id="method-M000015" class="method-detail">
        <a name="M000015"></a>

        <div class="method-heading">


          <a href="#M000015" class="method-signature">



          <span class="method-name">wt_xvz</span><span class="method-args">( xvz ) result(wt_xvz)</span>



          </a>

        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000015">wt_xvz</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 2 次元球面調和函数チェビシェフスペクトルデータ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xvz  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,<a
href="wt_mpi_module.html#M000053">jc</a>,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 3 次元経度緯度動径格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
3 次元格子点データからスペクトルデータへ(正)変換する.
</p>


          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000015-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000015-source">
<pre>
    function wt_xvz(xvz)
      !
      ! 3 次元格子点データからスペクトルデータへ(正)変換する.
      !
      real(8), dimension((nm+1)*(nm+1),0:lm)             :: wt_xvz
      !(out) 2 次元球面調和函数チェビシェフスペクトルデータ

      real(8), dimension(0:im-1,jc,0:km), intent(in)         :: xvz
      !(in) 3 次元経度緯度動径格子点データ

      wt_xvz = at_az(wa_xva(xvz))

    end function wt_xvz
</pre>
          </div>

        </div>
      </div>


      <div id="method-M000086" class="method-detail">
        <a name="M000086"></a>

        <div class="method-heading">




          <span class="method-name">wt_xyz</span><span class="method-args">( xyz ) result(wt_xyz)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000086">wt_xyz</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 2 次元球面調和函数チェビシェフスペクトルデータ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xyz  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 3 次元経度緯度動径格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
3 次元格子点データからスペクトルデータへ(正)変換する.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001398">wt_module#wt_xyz</a>
</p>


        </div>
      </div>


      <div id="method-M000166" class="method-detail">
        <a name="M000166"></a>

        <div class="method-heading">




          <span class="method-name">wz_LaplaPol2Pol_wz</span><span class="method-args">( wz, [cond], [new] ) result(wz_LaplaPol2Pol_wz)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000166">wz_LaplaPol2Pol_wz</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:km)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 出力ポロイダルポテンシャル分布

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>wz  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:km),intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 入力▽^2φ分布

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>cond  </tt></b>  <tt> </tt> :</td><td><tt>character(len=2), intent(in), optional</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 境界条件スイッチ. 省略時は &#8216;RR&#8216;

<pre>
    RR    : 両端粘着条件
    RF    : 上端粘着, 下端応力なし条件
    FR    : 上端応力なし, 下端粘着条件
    FF    : 両端応力なし条件
</pre>
</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>new  </tt></b>  <tt> </tt> :</td><td><tt>logical, intent(IN), optional</tt>

<table>
<tr><td valign="top"> :</td><td> (in) true だと境界条件計算用行列を強制的に新たに作る.

<pre>
    default は false.
</pre>
</td></tr>
</table>
</td></tr>
</table>
<p>
速度ポロイダルポテンシャルΦを▽^2Φから計算する.
</p>
<p>
チェビシェフ格子点空間で境界条件を適用している. この関数を用いるためには
wt_Initial にて設定する チェビシェフ切断波数(lm)と鉛直格子点数(km)を等しく
しておく必要がある.
</p>
<p>
速度ポロイダルポテンシャルΦを f = ▽^2Φから定める式は
</p>
<pre>
  ▽^2Φ = f
    Φ = const. at boundaries.
    ∂Φ/∂r = 0 at boundaries           (粘着条件)
    or ∂^2Φ/∂r^2 = 0 at boundaries    (応力なし条件)
</pre>
<p>
最初に呼ばれるときはオプショナル引数 new に関係なく行列が設定される.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001463">wt_module#wz_LaplaPol2Pol_wz</a>
</p>


        </div>
      </div>


      <div id="method-M000075" class="method-detail">
        <a name="M000075"></a>

        <div class="method-heading">




          <span class="method-name">wz_RAD</span><span class="method-args"></span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em>Variable</em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000075">wz_RAD</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(:,:), allocatable</tt>

<table>
<tr><td valign="top"> :</td><td> 座標

</td></tr>
</table>
</td></tr>
</table>
<p>
Original external subprogram is <a
href="wt_module.html#M001394">wt_module#wz_RAD</a>
</p>


        </div>
      </div>


      <div id="method-M000089" class="method-detail">
        <a name="M000089"></a>

        <div class="method-heading">




          <span class="method-name">wz_wt</span><span class="method-args">( wt ) result(wz_wt)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000089">wz_wt</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:km)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 2 次元球面調和函数スペクトル・動径格子点データ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>wt  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 2 次元球面調和函数チェビシェフスペクトルデータ

</td></tr>
</table>
</td></tr>
</table>
<p>
スペクトルデータから水平スペクトル・動径格子点データへ(正)変換する.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001401">wt_module#wz_wt</a>
</p>


        </div>
      </div>


      <div id="method-M000017" class="method-detail">
        <a name="M000017"></a>

        <div class="method-heading">


          <a href="#M000017" class="method-signature">



          <span class="method-name">wz_xvz</span><span class="method-args">( xvz ) result(wz_xvz)</span>



          </a>

        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000017">wz_xvz</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:km)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 2 次元球面調和函数スペクトル・動径格子点データ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xvz  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,<a
href="wt_mpi_module.html#M000053">jc</a>,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 3 次元経度緯度動径格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
3 次元格子データから水平スペクトル・動径格子点データへ(正)変換する.
</p>


          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000017-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000017-source">
<pre>
    function wz_xvz(xvz)
      !
      ! 3 次元格子データから水平スペクトル・動径格子点データへ(正)変換する.
      !
      real(8), dimension((nm+1)*(nm+1),0:km)             :: wz_xvz
      !(out) 2 次元球面調和函数スペクトル・動径格子点データ

      real(8), dimension(0:im-1,jc,0:km), intent(in)         :: xvz
      !(in) 3 次元経度緯度動径格子点データ

      wz_xvz = wa_xva(xvz)

    end function wz_xvz
</pre>
          </div>

        </div>
      </div>


      <div id="method-M000088" class="method-detail">
        <a name="M000088"></a>

        <div class="method-heading">




          <span class="method-name">wz_xyz</span><span class="method-args">( xyz ) result(wz_xyz)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000088">wz_xyz</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:km)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 2 次元球面調和函数スペクトル・動径格子点データ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xyz  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 3 次元経度緯度動径格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
3 次元格子データから水平スペクトル・動径格子点データへ(正)変換する.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001400">wt_module#wz_xyz</a>
</p>


        </div>
      </div>


      <div id="method-M000046" class="method-detail">
        <a name="M000046"></a>

        <div class="method-heading">


          <a href="#M000046" class="method-signature">



          <span class="method-name">x_AvrLatRad_xvz</span><span class="method-args">( xvz ) result(x_AvrLatRad_xvz)</span>



          </a>

        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000046">x_AvrLatRad_xvz</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 緯度動径(子午面)平均された 1 次元経度格子点データ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xvz  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,<a
href="wt_mpi_module.html#M000053">jc</a>,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 3 次元経度緯度動径格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
緯度動径(子午面)積分
</p>
<p>
3 次元格子点データの緯度動径(子午面)平均
</p>
<p>
3 次元データ f(λ,φ,r) に対して
</p>
<pre>
   ∫f(λ,,r) r^2cosφ dφdr /(2(r[o]^3-r[i]^3)/3)
</pre>
<p>
を計算する.
</p>


          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000046-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000046-source">
<pre>
    function x_AvrLatRad_xvz(xvz)  ! 緯度動径(子午面)積分
      !
      ! 3 次元格子点データの緯度動径(子午面)平均
      !
      ! 3 次元データ f(λ,φ,r) に対して
      !
      !    ∫f(λ,,r) r^2cosφ dφdr /(2(r[o]^3-r[i]^3)/3) 
      !
      ! を計算する.
      !
      real(8), dimension(0:im-1,jc,0:km), intent(in) :: xvz
      !(in) 3 次元経度緯度動径格子点データ

      real(8), dimension(0:im-1)     :: x_AvrLatRad_xvz
      !(out) 緯度動径(子午面)平均された 1 次元経度格子点データ

      x_AvrLatRad_xvz = x_IntLatRad_xvz(xvz) /( sum(y_Lat_Weight)*sum(z_Rad_Weight) )

    end function x_AvrLatRad_xvz
</pre>
          </div>

        </div>
      </div>


      <div id="method-M000130" class="method-detail">
        <a name="M000130"></a>

        <div class="method-heading">




          <span class="method-name">x_AvrLatRad_xyz</span><span class="method-args">( xyz ) result(x_AvrLatRad_xyz)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000130">x_AvrLatRad_xyz</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 緯度動径(子午面)平均された 1 次元経度格子点データ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xyz  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 3 次元経度緯度動径格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
緯度動径(子午面)積分
</p>
<p>
3 次元格子点データの緯度動径(子午面)平均
</p>
<p>
3 次元データ f(λ,φ,r) に対して
</p>
<pre>
   ∫f(λ,,r) r^2cosφ dφdr /(2(r[o]^3-r[i]^3)/3)
</pre>
<p>
を計算する.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001433">wt_module#x_AvrLatRad_xyz</a>
</p>


        </div>
      </div>


      <div id="method-M000146" class="method-detail">
        <a name="M000146"></a>

        <div class="method-heading">




          <span class="method-name">x_AvrLat_xv</span><span class="method-args">( xv_data ) result(x_AvrLat_xv)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000146">x_AvrLat_xv</a>(im)  </tt></b>  <tt> </tt> :</td><td><tt>real(8)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 平均された 1 次元経度(X)格子点データ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xv_data(0:im-1,<a href="wt_mpi_module.html#M000053">jc</a>)  </tt></b>  <tt> </tt> :</td><td><tt>real(8), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> 格子点(0:im-1,<a href="wt_mpi_module.html#M000053">jc</a>) (in) 2
次元経度緯度格子点データ(0:im-1,<a
href="wt_mpi_module.html#M000053">jc</a>)

</td></tr>
</table>
</td></tr>
</table>
<p>
2 次元緯度経度格子点データの緯度(Y)方向平均(1 層用).
</p>
<p>
実際には格子点データ各点毎に <a
href="wt_mpi_module.html#M000059">v_Lat_Weight</a> をかけた総和を計算し, <a
href="wt_mpi_module.html#M000057">y_Lat_Weight</a>
の総和で割ることで平均している.
</p>
<p>
Original external subprogram is <a
href="w_integral_mpi_module.html#M000858">w_integral_mpi_module#x_AvrLat_xv</a>
</p>


        </div>
      </div>


      <div id="method-M000134" class="method-detail">
        <a name="M000134"></a>

        <div class="method-heading">




          <span class="method-name">x_AvrLat_xy</span><span class="method-args">( xy_data ) result(x_AvrLat_xy)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000134">x_AvrLat_xy</a>(im)  </tt></b>  <tt> </tt> :</td><td><tt>real(8)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 平均された 1 次元経度(X)格子点データ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xy_data(0:im-1,1:jm)  </tt></b>  <tt> </tt> :</td><td><tt>real(8), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 2 次元経度緯度格子点データ(0:im-1,1:jm)

</td></tr>
</table>
</td></tr>
</table>
<p>
2 次元緯度経度格子点データの緯度(Y)方向平均(1 層用).
</p>
<p>
実際には格子点データ各点毎に y_Y_Weight をかけた総和を計算し, y_Y_Weight
の総和で割ることで平均している.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001498">wt_module#x_AvrLat_xy</a>
</p>


        </div>
      </div>


      <div id="method-M000141" class="method-detail">
        <a name="M000141"></a>

        <div class="method-heading">




          <span class="method-name">x_AvrRad_xz</span><span class="method-args">( xz ) result(x_AvrRad_xz)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000141">x_AvrRad_xz</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 動径平均された 1 次元経度格子点データ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xz  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 2 次元緯度動径格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
動径積分
</p>
<p>
2 次元(XZ)格子点データの動径方向域平均.
</p>
<p>
2 次元データ f(λ,r) に対して
</p>
<pre>
  ∫f(λ,r) r^2dr /((r[o]^3-r[i]^3)/3)
</pre>
<p>
を計算する.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001441">wt_module#x_AvrRad_xz</a>
</p>


        </div>
      </div>


      <div id="method-M000036" class="method-detail">
        <a name="M000036"></a>

        <div class="method-heading">


          <a href="#M000036" class="method-signature">



          <span class="method-name">x_IntLatRad_xvz</span><span class="method-args">( xvz ) result(x_IntLatRad_xvz)</span>



          </a>

        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000036">x_IntLatRad_xvz</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 緯度動径(子午面)積分された 1 次元経度格子点データ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xvz  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,<a
href="wt_mpi_module.html#M000053">jc</a>,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 3 次元経度緯度動径格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
3 次元格子点データの緯度動径(子午面)積分
</p>
<p>
3 次元データ f(λ,φ,r) に対して
</p>
<pre>
   ∫f(λ,φ,r) r^2cosφ dφdr
</pre>
<p>
を計算する.
</p>


          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000036-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000036-source">
<pre>
    function x_IntLatRad_xvz(xvz)
      !
      ! 3 次元格子点データの緯度動径(子午面)積分
      !
      ! 3 次元データ f(λ,φ,r) に対して
      !
      !    ∫f(λ,φ,r) r^2cosφ dφdr 
      !
      ! を計算する.
      !
      real(8), dimension(0:im-1,jc,0:km), intent(in) :: xvz
      !(in) 3 次元経度緯度動径格子点データ

      real(8), dimension(0:im-1)     :: x_IntLatRad_xvz
      !(out) 緯度動径(子午面)積分された 1 次元経度格子点データ

      real(8), dimension(0:im-1)     :: x_IntLatRadTMP
      integer :: j, k

      x_IntLatRad_xvz = 0
      do k=0,km
         do j=1,jc
            x_IntLatRad_xvz = x_IntLatRad_xvz + xvz(:,j,k) * v_Lat_Weight(j) * z_Rad_Weight(k)
         enddo
      enddo

      x_IntLatRadTmp=x_IntLatRad_xvz
      CALL MPI_ALLREDUCE(x_IntLatRadTMP,x_IntLatRad_xvz,im,MPI_REAL8, MPI_SUM,MPI_COMM_WORLD,IERR)

    end function x_IntLatRad_xvz
</pre>
          </div>

        </div>
      </div>


      <div id="method-M000107" class="method-detail">
        <a name="M000107"></a>

        <div class="method-heading">




          <span class="method-name">x_IntLatRad_xyz</span><span class="method-args">( xyz ) result(x_IntLatRad_xyz)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000107">x_IntLatRad_xyz</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 緯度動径(子午面)積分された 1 次元経度格子点データ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xyz  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 3 次元経度緯度動径格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
3 次元格子点データの緯度動径(子午面)積分
</p>
<p>
3 次元データ f(λ,φ,r) に対して
</p>
<pre>
   ∫f(λ,φ,r) r^2cosφ dφdr
</pre>
<p>
を計算する.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001419">wt_module#x_IntLatRad_xyz</a>
</p>


        </div>
      </div>


      <div id="method-M000123" class="method-detail">
        <a name="M000123"></a>

        <div class="method-heading">




          <span class="method-name">x_IntLat_xv</span><span class="method-args">( xv_data ) result(x_IntLat_xv)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000123">x_IntLat_xv</a>(0:im-1)  </tt></b>  <tt> </tt> :</td><td><tt>real(8)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 積分された 1 次元経度(X)格子点データ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xv_data(0:im-1,<a href="wt_mpi_module.html#M000053">jc</a>)  </tt></b>  <tt> </tt> :</td><td><tt>real(8), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 2 次元経度緯度格子点データ(0:im-1,<a
href="wt_mpi_module.html#M000053">jc</a>)

</td></tr>
</table>
</td></tr>
</table>
<p>
2 次元緯度経度格子点データの緯度(Y)方向積分(1 層用).
</p>
<p>
実際には格子点データ各点毎に v_Y_Weight をかけた総和を計算している.
</p>
<p>
Original external subprogram is <a
href="w_integral_mpi_module.html#M000854">w_integral_mpi_module#x_IntLat_xv</a>
</p>


        </div>
      </div>


      <div id="method-M000111" class="method-detail">
        <a name="M000111"></a>

        <div class="method-heading">




          <span class="method-name">x_IntLat_xy</span><span class="method-args">( xy_data ) result(x_IntLat_xy)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000111">x_IntLat_xy</a>(0:im-1)  </tt></b>  <tt> </tt> :</td><td><tt>real(8)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 積分された 1 次元経度(X)格子点データ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xy_data(0:im-1,1:jm)  </tt></b>  <tt> </tt> :</td><td><tt>real(8), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 2 次元経度緯度格子点データ(0:im-1,1:jm)

</td></tr>
</table>
</td></tr>
</table>
<p>
2 次元緯度経度格子点データの緯度(Y)方向積分(1 層用).
</p>
<p>
実際には格子点データ各点毎に y_Y_Weight をかけた総和を計算している.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001493">wt_module#x_IntLat_xy</a>
</p>


        </div>
      </div>


      <div id="method-M000118" class="method-detail">
        <a name="M000118"></a>

        <div class="method-heading">




          <span class="method-name">x_IntRad_xz</span><span class="method-args">( xz ) result(x_IntRad_xz)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000118">x_IntRad_xz</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 動径積分された 1 次元経度格子点データ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xz  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 2 次元緯度動径格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
2 次元(XZ)格子点データの動径方向域積分.
</p>
<p>
2 次元データ f(λ,r) に対して ∫f(λ,r) r^2dr を計算する.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001427">wt_module#x_IntRad_xz</a>
</p>


        </div>
      </div>


      <div id="method-M000054" class="method-detail">
        <a name="M000054"></a>

        <div class="method-heading">




          <span class="method-name">x_Lon</span><span class="method-args"></span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em>Variable</em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000054">x_Lon</a>(:)  </tt></b>  <tt> </tt> :</td><td><tt>real(8), allocatable</tt>

<table>
<tr><td valign="top"> :</td><td> 緯度経度

</td></tr>
</table>
</td></tr>
</table>
<p>
Original external subprogram is <a
href="wt_module.html#M001473">wt_module#x_Lon</a>
</p>


        </div>
      </div>


      <div id="method-M000055" class="method-detail">
        <a name="M000055"></a>

        <div class="method-heading">




          <span class="method-name">x_Lon_Weight</span><span class="method-args"></span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em>Variable</em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000055">x_Lon_Weight</a>(:)  </tt></b>  <tt> </tt> :</td><td><tt>real(8), allocatable</tt>

<table>
<tr><td valign="top"> :</td><td> 座標重み

</td></tr>
</table>
</td></tr>
</table>
<p>
Original external subprogram is <a
href="wt_module.html#M001474">wt_module#x_Lon_Weight</a>
</p>


        </div>
      </div>


      <div id="method-M000045" class="method-detail">
        <a name="M000045"></a>

        <div class="method-heading">


          <a href="#M000045" class="method-signature">



          <span class="method-name">xv_AvrRad_xvz</span><span class="method-args">( xvz ) result(xv_AvrRad_xvz)</span>



          </a>

        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000045">xv_AvrRad_xvz</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,<a
href="wt_mpi_module.html#M000053">jc</a>)</tt>

<table>
<tr><td valign="top"> :</td><td> 水平格子点データ (out) 動径平均された 2 次元経度緯度(水平,
球面)格子点データ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xvz  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,<a
href="wt_mpi_module.html#M000053">jc</a>,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 3 次元経度緯度動径格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
3 次元格子点データの動径方向域平均.
</p>
<p>
3 次元データ f(λ,φ,r) に対して
</p>
<pre>
   ∫f(λ,φ,r) r^2dr/((r[o]^3-r[i]^3)/3)
</pre>
<p>
を計算する.
</p>


          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000045-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000045-source">
<pre>
    function xv_AvrRad_xvz(xvz)
      !
      ! 3 次元格子点データの動径方向域平均.
      !
      ! 3 次元データ f(λ,φ,r) に対して 
      !
      !    ∫f(λ,φ,r) r^2dr/((r[o]^3-r[i]^3)/3) 
      !
      ! を計算する.
      !
      real(8), dimension(0:im-1,jc,0:km), intent(in) :: xvz
      !(in) 3 次元経度緯度動径格子点データ

      real(8), dimension(0:im-1,jc)  :: xv_AvrRad_xvz          ! 水平格子点データ
      !(out) 動径平均された 2 次元経度緯度(水平, 球面)格子点データ

      xv_AvrRad_xvz = xv_IntRad_xvz(xvz)/sum(z_Rad_Weight)

    end function xv_AvrRad_xvz
</pre>
          </div>

        </div>
      </div>


      <div id="method-M000035" class="method-detail">
        <a name="M000035"></a>

        <div class="method-heading">


          <a href="#M000035" class="method-signature">



          <span class="method-name">xv_IntRad_xvz</span><span class="method-args">( xvz ) result(xv_IntRad_xvz)</span>



          </a>

        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000035">xv_IntRad_xvz</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,<a
href="wt_mpi_module.html#M000053">jc</a>)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 動径積分された 2 次元経度緯度(水平, 球面)格子点データ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xvz  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,<a
href="wt_mpi_module.html#M000053">jc</a>,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 3 次元経度緯度動径格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
動径積分
</p>
<p>
3 次元格子点データの動径方向域積分.
</p>
<p>
3 次元データ f(λ,φ,r) に対して∫f(λ,φ,r) r^2dr を計算する.
</p>


          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000035-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000035-source">
<pre>
    function xv_IntRad_xvz(xvz)  ! 動径積分
      !
      ! 3 次元格子点データの動径方向域積分.
      !
      ! 3 次元データ f(λ,φ,r) に対して∫f(λ,φ,r) r^2dr を計算する.
      !
      real(8), dimension(0:im-1,jc,0:km), intent(in) :: xvz
      !(in) 3 次元経度緯度動径格子点データ

      real(8), dimension(0:im-1,jc)  :: xv_IntRad_xvz
      !(out) 動径積分された 2 次元経度緯度(水平, 球面)格子点データ

      integer :: k

      xv_IntRad_xvz = 0.0d0
      do k=0,km
         xv_IntRad_xvz(:,:) = xv_IntRad_xvz(:,:) + xvz(:,:,k) * z_Rad_Weight(k) 
      enddo
    end function xv_IntRad_xvz
</pre>
          </div>

        </div>
      </div>


      <div id="method-M000071" class="method-detail">
        <a name="M000071"></a>

        <div class="method-heading">




          <span class="method-name">xv_Lat</span><span class="method-args"></span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em>Variable</em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000071">xv_Lat</a>(:,:)  </tt></b>  <tt> </tt> :</td><td><tt>real(8), allocatable</tt>

</td></tr>
</table>
<p>
Original external subprogram is <a
href="w_base_mpi_module.html#M000190">w_base_mpi_module#xv_Lat</a>
</p>


        </div>
      </div>


      <div id="method-M000070" class="method-detail">
        <a name="M000070"></a>

        <div class="method-heading">




          <span class="method-name">xv_Lon</span><span class="method-args"></span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em>Variable</em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000070">xv_Lon</a>(:,:)  </tt></b>  <tt> </tt> :</td><td><tt>real(8), allocatable</tt>

</td></tr>
</table>
<p>
Original external subprogram is <a
href="w_base_mpi_module.html#M000189">w_base_mpi_module#xv_Lon</a>
</p>


        </div>
      </div>


      <div id="method-M000080" class="method-detail">
        <a name="M000080"></a>

        <div class="method-heading">




          <span class="method-name">xv_w</span><span class="method-args">( w_data, [ipow], [iflag] ) result(xv_w)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000080">xv_w</a>(0:im-1,<a href="wt_mpi_module.html#M000053">jc</a>)  </tt></b>  <tt> </tt> :</td><td><tt>real(8)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 格子点データ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>w_data((nm+1)*(nm+1))  </tt></b>  <tt> </tt> :</td><td><tt>real(8), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) スペクトルデータ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>ipow  </tt></b>  <tt> </tt> :</td><td><tt>integer, intent(in), optional</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 作用させる 1/cosφ の次数. 省略時は 0.

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>iflag  </tt></b>  <tt> </tt> :</td><td><tt>integer, intent(in), optional</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 変換の種類

<pre>
    0 : 通常の正変換
    1 : 経度微分を作用させた正変換
   -1 : 緯度微分を作用させた正変換
    2 : sinφを作用させた正変換
    省略時は 0.
</pre>
</td></tr>
</table>
</td></tr>
</table>
<p>
スペクトルデータから分散格子データへ変換する(1 層用).
</p>
<p>
Original external subprogram is <a
href="w_base_mpi_module.html#M000194">w_base_mpi_module#xv_w</a>
</p>


        </div>
      </div>


      <div id="method-M000023" class="method-detail">
        <a name="M000023"></a>

        <div class="method-heading">


          <a href="#M000023" class="method-signature">



          <span class="method-name">xvz_Div_xvz_xvz_xvz</span><span class="method-args">( xvz_Vlon, xvz_Vlat, xvz_Vrad ) result(xvz_Div_xvz_xvz_xvz)</span>



          </a>

        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000023">xvz_Div_xvz_xvz_xvz</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,<a
href="wt_mpi_module.html#M000053">jc</a>,0:km)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) ベクトル場の発散

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xvz_Vlon  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,<a
href="wt_mpi_module.html#M000053">jc</a>,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) ベクトル場の経度成分

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xvz_Vlat  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,<a
href="wt_mpi_module.html#M000053">jc</a>,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) ベクトル場の緯度成分

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xvz_Vrad  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,<a
href="wt_mpi_module.html#M000053">jc</a>,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) ベクトル場の動径成分

</td></tr>
</table>
</td></tr>
</table>
<p>
ベクトル成分である 3 つの格子データに発散を作用させる.
</p>
<p>
第 1, 2 ,3 引数(u,v,w)がそれぞれベクトルの経度成分, 緯度成分,
動径成分を表す.
</p>
<p>
極の特異性を回避するためにベクトル場に cosφ/r の重みをかけて 計算している.
</p>
<pre>
     div V = (r/cosφ)・div (Vcosφ/r) + V_φtanφ/r + V_r/r
</pre>


          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000023-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000023-source">
<pre>
    function xvz_Div_xvz_xvz_xvz(xvz_Vlon,xvz_Vlat,xvz_Vrad)
      !
      ! ベクトル成分である 3 つの格子データに発散を作用させる.
      !
      ! 第 1, 2 ,3 引数(u,v,w)がそれぞれベクトルの経度成分, 緯度成分, 
      ! 動径成分を表す.
      !
      ! 極の特異性を回避するためにベクトル場に cosφ/r の重みをかけて
      ! 計算している. 
      !
      !      div V = (r/cosφ)・div (Vcosφ/r) + V_φtanφ/r + V_r/r
      ! 
      real(8), dimension(0:im-1,jc,0:km), intent(in) :: xvz_Vlon
      !(in) ベクトル場の経度成分

      real(8), dimension(0:im-1,jc,0:km), intent(in) :: xvz_Vlat
      !(in) ベクトル場の緯度成分

      real(8), dimension(0:im-1,jc,0:km), intent(in) :: xvz_Vrad
      !(in) ベクトル場の動径成分

      real(8), dimension(0:im-1,jc,0:km)             :: xvz_Div_xvz_xvz_xvz
      !(out) ベクトル場の発散

      xvz_Div_xvz_xvz_xvz = xvz_Rad/cos(xvz_Lat) * xvz_wt(wt_Div_xvz_xvz_xvz(xvz_VLon*cos(xvz_Lat)/xvz_Rad, xvz_VLat*cos(xvz_Lat)/xvz_Rad, xvz_VRad*cos(xvz_Lat)/xvz_Rad )) + xvz_VLat*tan(xvz_Lat)/xvz_Rad + xvz_VRad/xvz_Rad

    end function xvz_Div_xvz_xvz_xvz
</pre>
          </div>

        </div>
      </div>


      <div id="method-M000019" class="method-detail">
        <a name="M000019"></a>

        <div class="method-heading">


          <a href="#M000019" class="method-signature">



          <span class="method-name">xvz_GradLat_wt</span><span class="method-args">( wt ) result(xvz_GradLat_wt)</span>



          </a>

        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000019">xvz_GradLat_wt</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,<a
href="wt_mpi_module.html#M000053">jc</a>,0:km)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 勾配型緯度微分を作用された 2 次元スペクトルデータ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>wt  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 2 次元球面調和函数チェビシェフスペクトルデータ

</td></tr>
</table>
</td></tr>
</table>
<p>
スペクトルデータに勾配型経度微分 1/r ∂/∂φ を作用させる.
</p>


          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000019-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000019-source">
<pre>
    function xvz_GradLat_wt(wt) 
      !
      ! スペクトルデータに勾配型経度微分 1/r ∂/∂φ を作用させる.
      !
      real(8), dimension((nm+1)*(nm+1),0:lm), intent(in) :: wt
      !(in) 2 次元球面調和函数チェビシェフスペクトルデータ

      real(8), dimension(0:im-1,jc,0:km)                     :: xvz_GradLat_wt
      !(out) 勾配型緯度微分を作用された 2 次元スペクトルデータ

      xvz_GradLat_wt = xva_GradLat_wa(wz_wt(wt))/xvz_Rad
    end function xvz_GradLat_wt
</pre>
          </div>

        </div>
      </div>


      <div id="method-M000018" class="method-detail">
        <a name="M000018"></a>

        <div class="method-heading">


          <a href="#M000018" class="method-signature">



          <span class="method-name">xvz_GradLon_wt</span><span class="method-args">( wt ) result(xvz_GradLon_wt)</span>



          </a>

        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000018">xvz_GradLon_wt</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,<a
href="wt_mpi_module.html#M000053">jc</a>,0:km)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 勾配型経度微分を作用された 2 次元スペクトルデータ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>wt  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 2 次元球面調和函数チェビシェフスペクトルデータ

</td></tr>
</table>
</td></tr>
</table>
<p>
スペクトルデータに勾配型経度微分 1/rcosφ・∂/∂λ を作用させる.
</p>


          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000018-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000018-source">
<pre>
    function xvz_GradLon_wt(wt)
      !
      ! スペクトルデータに勾配型経度微分 1/rcosφ・∂/∂λ
      ! を作用させる.
      !
      real(8), dimension((nm+1)*(nm+1),0:lm), intent(in) :: wt
      !(in) 2 次元球面調和函数チェビシェフスペクトルデータ

      real(8), dimension(0:im-1,jc,0:km)                     :: xvz_GradLon_wt
      !(out) 勾配型経度微分を作用された 2 次元スペクトルデータ

      xvz_GradLon_wt = xva_GradLon_wa(wz_wt(wt))/xvz_Rad

    end function xvz_GradLon_wt
</pre>
          </div>

        </div>
      </div>


      <div id="method-M000027" class="method-detail">
        <a name="M000027"></a>

        <div class="method-heading">


          <a href="#M000027" class="method-signature">



          <span class="method-name">xvz_KGrad_wt</span><span class="method-args">( wt ) result(xvz_KGrad_wt)</span>



          </a>

        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000027">xvz_KGrad_wt</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,<a
href="wt_mpi_module.html#M000053">jc</a>,0:km)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 軸方向微分を作用された 2 次元スペクトルデータ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>wt  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 2 次元球面調和函数チェビシェフスペクトルデータ

</td></tr>
</table>
</td></tr>
</table>
<p>
k・▽ = cosφ/r ∂/∂φ + sinφ∂/∂r
</p>
<p>
入力スペクトルデータに対応する格子データに軸方向微分
</p>
<pre>
   k・▽ = cosφ/r ∂/∂φ + sinφ∂/∂r
</pre>
<p>
を作用させた格子データが返される. ここでベクトル k
は球の中心から北極向きの単位ベクトルである.
</p>


          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000027-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000027-source">
<pre>
    function xvz_KGrad_wt(wt)    ! k・▽ = cosφ/r ∂/∂φ + sinφ∂/∂r
      !
      ! 入力スペクトルデータに対応する格子データに軸方向微分 
      !
      !    k・▽ = cosφ/r ∂/∂φ + sinφ∂/∂r 
      !
      ! を作用させた格子データが返される. 
      ! ここでベクトル k は球の中心から北極向きの単位ベクトルである.
      !
      real(8), dimension((nm+1)*(nm+1),0:lm), intent(in) :: wt
      !(in) 2 次元球面調和函数チェビシェフスペクトルデータ

      real(8), dimension(0:im-1,jc,0:km)                     :: xvz_KGrad_wt
      !(out) 軸方向微分を作用された 2 次元スペクトルデータ

      xvz_KGrad_wt =  cos(xvz_Lat)*xvz_GradLat_wt(wt) + sin(xvz_Lat)*xvz_wt(wt_Drad_wt(wt))
    end function xvz_KGrad_wt
</pre>
          </div>

        </div>
      </div>


      <div id="method-M000011" class="method-detail">
        <a name="M000011"></a>

        <div class="method-heading">




          <span class="method-name">xvz_LAT</span><span class="method-args"></span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em>Variable</em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000011">xvz_LAT</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(:,:,:), allocatable</tt>

<table>
<tr><td valign="top"> :</td><td> 座標

</td></tr>
</table>
</td></tr>
</table>


        </div>
      </div>


      <div id="method-M000010" class="method-detail">
        <a name="M000010"></a>

        <div class="method-heading">




          <span class="method-name">xvz_LON</span><span class="method-args"></span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em>Variable</em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000010">xvz_LON</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(:,:,:), allocatable</tt>

<table>
<tr><td valign="top"> :</td><td> 座標

</td></tr>
</table>
</td></tr>
</table>


        </div>
      </div>


      <div id="method-M000012" class="method-detail">
        <a name="M000012"></a>

        <div class="method-heading">




          <span class="method-name">xvz_RAD</span><span class="method-args"></span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em>Variable</em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000012">xvz_RAD</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(:,:,:), allocatable</tt>

<table>
<tr><td valign="top"> :</td><td> 座標

</td></tr>
</table>
</td></tr>
</table>


        </div>
      </div>


      <div id="method-M000025" class="method-detail">
        <a name="M000025"></a>

        <div class="method-heading">


          <a href="#M000025" class="method-signature">



          <span class="method-name">xvz_RotLat_wt_wt</span><span class="method-args">( wt_Vlon, wt_Vrad ) result(xvz_RotLat_wt_wt)</span>



          </a>

        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000025">xvz_RotLat_wt_wt</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,<a
href="wt_mpi_module.html#M000053">jc</a>,0:km)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) ベクトル場の回転の緯度成分

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>wt_Vlon  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) ベクトル場の経度成分

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>wt_Vrad  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) ベクトル場の動径成分

</td></tr>
</table>
</td></tr>
</table>
<p>
ベクトル場の経度成分, 動径成分である第 1, 2 引数 Vlon, Vrad から
回転の緯度成分
</p>
<pre>
   1/r ∂(r Vlon)/∂r - 1/rcosφ・∂Vrad/∂λ
</pre>
<p>
を計算する.
</p>


          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000025-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000025-source">
<pre>
    function xvz_RotLat_wt_wt(wt_Vlon,wt_Vrad) 
      !
      ! ベクトル場の経度成分, 動径成分である第 1, 2 引数 Vlon, Vrad から
      ! 回転の緯度成分 
      !
      !    1/r ∂(r Vlon)/∂r - 1/rcosφ・∂Vrad/∂λ
      !
      ! を計算する.
      !
      real(8), dimension((nm+1)*(nm+1),0:lm), intent(in) :: wt_Vlon
      !(in) ベクトル場の経度成分

      real(8), dimension((nm+1)*(nm+1),0:lm), intent(in) :: wt_Vrad
      !(in) ベクトル場の動径成分

      real(8), dimension(0:im-1,jc,0:km)                     :: xvz_RotLat_wt_wt
      !(out) ベクトル場の回転の緯度成分

        xvz_RotLat_wt_wt =   xvz_wt(wt_RotRad_wt(wt_Vlon)) - xvz_GradLon_wt(wt_Vrad) 

    end function xvz_RotLat_wt_wt
</pre>
          </div>

        </div>
      </div>


      <div id="method-M000024" class="method-detail">
        <a name="M000024"></a>

        <div class="method-heading">


          <a href="#M000024" class="method-signature">



          <span class="method-name">xvz_RotLon_wt_wt</span><span class="method-args">( wt_Vrad, wt_Vlat ) result(xvz_RotLon_wt_wt)</span>



          </a>

        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000024">xvz_RotLon_wt_wt</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,<a
href="wt_mpi_module.html#M000053">jc</a>,0:km)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) ベクトル場の回転の経度成分

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>wt_Vrad  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) ベクトル場の動径成分

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>wt_Vlat  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) ベクトル場の緯度成分

</td></tr>
</table>
</td></tr>
</table>
<p>
ベクトル場の動径成分, 緯度成分である第 1, 2 引数 Vrad, Vlat から
回転の経度成分
</p>
<pre>
   1/r ∂Vrad/∂φ-1/r ∂(r Vlat)/∂r を計算する.
</pre>
<p>
を計算する
</p>


          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000024-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000024-source">
<pre>
    function xvz_RotLon_wt_wt(wt_Vrad,wt_Vlat) 
      !
      ! ベクトル場の動径成分, 緯度成分である第 1, 2 引数 Vrad, Vlat から
      ! 回転の経度成分 
      !
      !    1/r ∂Vrad/∂φ-1/r ∂(r Vlat)/∂r を計算する.
      !
      ! を計算する
      !
      real(8), dimension((nm+1)*(nm+1),0:lm), intent(in) :: wt_Vrad
      !(in) ベクトル場の動径成分

      real(8), dimension((nm+1)*(nm+1),0:lm), intent(in) :: wt_Vlat
      !(in) ベクトル場の緯度成分

      real(8), dimension(0:im-1,jc,0:km)                     :: xvz_RotLon_wt_wt
      !(out) ベクトル場の回転の経度成分

        xvz_RotLon_wt_wt =   xvz_GradLat_wt(wt_Vrad) - xvz_wt(wt_RotRad_wt(wt_Vlat))

    end function xvz_RotLon_wt_wt
</pre>
          </div>

        </div>
      </div>


      <div id="method-M000014" class="method-detail">
        <a name="M000014"></a>

        <div class="method-heading">


          <a href="#M000014" class="method-signature">



          <span class="method-name">xvz_wt</span><span class="method-args">( wt ) result(xvz_wt)</span>



          </a>

        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000014">xvz_wt</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,<a
href="wt_mpi_module.html#M000053">jc</a>,0:km)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 3 次元経度緯度動径格子点データ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>wt  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 2 次元球面調和函数チェビシェフスペクトルデータ

</td></tr>
</table>
</td></tr>
</table>
<p>
スペクトルデータから 3 次元格子点データへ(逆)変換する.
</p>


          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000014-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000014-source">
<pre>
    function xvz_wt(wt)
      !
      ! スペクトルデータから 3 次元格子点データへ(逆)変換する.
      !
      real(8), dimension(0:im-1,jc,0:km)                     :: xvz_wt
      !(out) 3 次元経度緯度動径格子点データ

      real(8), dimension((nm+1)*(nm+1),0:lm), intent(in) :: wt
      !(in) 2 次元球面調和函数チェビシェフスペクトルデータ

      xvz_wt = xva_wa(az_at(wt))

    end function xvz_wt
</pre>
          </div>

        </div>
      </div>


      <div id="method-M000016" class="method-detail">
        <a name="M000016"></a>

        <div class="method-heading">


          <a href="#M000016" class="method-signature">



          <span class="method-name">xvz_wz</span><span class="method-args">( wz ) result(xvz_wz)</span>



          </a>

        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000016">xvz_wz</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,<a
href="wt_mpi_module.html#M000053">jc</a>,0:km)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 3 次元経度緯度動径格子点データ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>wz  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 2 次元球面調和函数スペクトル・動径格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
水平スペクトル・動径格子点データから 3 次元格子点データへ(逆)変換する.
</p>


          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000016-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000016-source">
<pre>
    function xvz_wz(wz)
      !
      ! 水平スペクトル・動径格子点データから 3 次元格子点データへ(逆)変換する.
      !
      real(8), dimension(0:im-1,jc,0:km)                     :: xvz_wz
      !(out) 3 次元経度緯度動径格子点データ

      real(8), dimension((nm+1)*(nm+1),0:km), intent(in) :: wz
      !(in) 2 次元球面調和函数スペクトル・動径格子点データ

      xvz_wz = xva_wa(wz)

    end function xvz_wz
</pre>
          </div>

        </div>
      </div>


      <div id="method-M000129" class="method-detail">
        <a name="M000129"></a>

        <div class="method-heading">




          <span class="method-name">xy_AvrRad_xyz</span><span class="method-args">( xyz ) result(xy_AvrRad_xyz)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000129">xy_AvrRad_xyz</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 動径平均された 2 次元経度緯度(水平, 球面)格子点データ
水平格子点データ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xyz  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 3 次元経度緯度動径格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
3 次元格子点データの動径方向域平均.
</p>
<p>
3 次元データ f(λ,φ,r) に対して
</p>
<pre>
   ∫f(λ,φ,r) r^2dr/((r[o]^3-r[i]^3)/3)
</pre>
<p>
を計算する.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001432">wt_module#xy_AvrRad_xyz</a>
</p>


        </div>
      </div>


      <div id="method-M000106" class="method-detail">
        <a name="M000106"></a>

        <div class="method-heading">




          <span class="method-name">xy_IntRad_xyz</span><span class="method-args">( xyz ) result(xy_IntRad_xyz)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000106">xy_IntRad_xyz</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 動径積分された 2 次元経度緯度(水平, 球面)格子点データ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xyz  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 3 次元経度緯度動径格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
動径積分
</p>
<p>
3 次元格子点データの動径方向域積分.
</p>
<p>
3 次元データ f(λ,φ,r) に対して∫f(λ,φ,r) r^2dr を計算する.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001418">wt_module#xy_IntRad_xyz</a>
</p>


        </div>
      </div>


      <div id="method-M000069" class="method-detail">
        <a name="M000069"></a>

        <div class="method-heading">




          <span class="method-name">xy_Lat</span><span class="method-args"></span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em>Variable</em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000069">xy_Lat</a>(:,:)  </tt></b>  <tt> </tt> :</td><td><tt>real(8), allocatable</tt>

</td></tr>
</table>
<p>
Original external subprogram is <a
href="wt_module.html#M001486">wt_module#xy_Lat</a>
</p>


        </div>
      </div>


      <div id="method-M000068" class="method-detail">
        <a name="M000068"></a>

        <div class="method-heading">




          <span class="method-name">xy_Lon</span><span class="method-args"></span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em>Variable</em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000068">xy_Lon</a>(:,:)  </tt></b>  <tt> </tt> :</td><td><tt>real(8), allocatable</tt>

</td></tr>
</table>
<p>
Original external subprogram is <a
href="wt_module.html#M001485">wt_module#xy_Lon</a>
</p>


        </div>
      </div>


      <div id="method-M000078" class="method-detail">
        <a name="M000078"></a>

        <div class="method-heading">




          <span class="method-name">xy_w</span><span class="method-args">( w_data, [ipow], [iflag] ) result(xy_w)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000078">xy_w</a>(0:im-1,1:jm)  </tt></b>  <tt> </tt> :</td><td><tt>real(8)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 格子点データ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>w_data((nm+1)*(nm+1))  </tt></b>  <tt> </tt> :</td><td><tt>real(8), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) スペクトルデータ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>ipow  </tt></b>  <tt> </tt> :</td><td><tt>integer, intent(in), optional</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 作用させる 1/cosφ の次数. 省略時は 0.

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>iflag  </tt></b>  <tt> </tt> :</td><td><tt>integer, intent(in), optional</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 変換の種類

<pre>
   0 : 通常の正変換
  -1 : 経度微分を作用させた逆変換
   1 : 緯度微分 cosφ・∂/∂φ を作用させた逆変換
   2 : sinφを作用させた逆変換
   省略時は 0.
</pre>
</td></tr>
</table>
</td></tr>
</table>
<p>
スペクトルデータから格子データへ変換する(1 層用).
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001488">wt_module#xy_w</a>
</p>


        </div>
      </div>


      <div id="method-M000100" class="method-detail">
        <a name="M000100"></a>

        <div class="method-heading">




          <span class="method-name">xyz_Div_xyz_xyz_xyz</span><span class="method-args">( xyz_Vlon, xyz_Vlat, xyz_Vrad ) result(xyz_Div_xyz_xyz_xyz)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000100">xyz_Div_xyz_xyz_xyz</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) ベクトル場の発散

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xyz_Vlon  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) ベクトル場の経度成分

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xyz_Vlat  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) ベクトル場の緯度成分

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xyz_Vrad  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) ベクトル場の動径成分

</td></tr>
</table>
</td></tr>
</table>
<p>
ベクトル成分である 3 つの格子データに発散を作用させる.
</p>
<p>
第 1, 2 ,3 引数(u,v,w)がそれぞれベクトルの経度成分, 緯度成分,
動径成分を表す.
</p>
<p>
極の特異性を回避するためにベクトル場に cosφ/r の重みをかけて 計算している.
</p>
<pre>
     div V = (r/cosφ)・div (Vcosφ/r) + V_φtanφ/r + V_r/r
</pre>
<p>
Original external subprogram is <a
href="wt_module.html#M001412">wt_module#xyz_Div_xyz_xyz_xyz</a>
</p>


        </div>
      </div>


      <div id="method-M000096" class="method-detail">
        <a name="M000096"></a>

        <div class="method-heading">




          <span class="method-name">xyz_GradLat_wt</span><span class="method-args">( wt ) result(xyz_GradLat_wt)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000096">xyz_GradLat_wt</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 勾配型緯度微分を作用された 2 次元スペクトルデータ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>wt  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 2 次元球面調和函数チェビシェフスペクトルデータ

</td></tr>
</table>
</td></tr>
</table>
<p>
スペクトルデータに勾配型経度微分 1/r ∂/∂φ を作用させる.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001408">wt_module#xyz_GradLat_wt</a>
</p>


        </div>
      </div>


      <div id="method-M000095" class="method-detail">
        <a name="M000095"></a>

        <div class="method-heading">




          <span class="method-name">xyz_GradLon_wt</span><span class="method-args">( wt ) result(xyz_GradLon_wt)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000095">xyz_GradLon_wt</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 勾配型経度微分を作用された 2 次元スペクトルデータ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>wt  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 2 次元球面調和函数チェビシェフスペクトルデータ

</td></tr>
</table>
</td></tr>
</table>
<p>
スペクトルデータに勾配型経度微分 1/rcosφ・∂/∂λ を作用させる.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001407">wt_module#xyz_GradLon_wt</a>
</p>


        </div>
      </div>


      <div id="method-M000073" class="method-detail">
        <a name="M000073"></a>

        <div class="method-heading">




          <span class="method-name">xyz_LAT</span><span class="method-args"></span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em>Variable</em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000073">xyz_LAT</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(:,:,:), allocatable</tt>

<table>
<tr><td valign="top"> :</td><td> 座標

</td></tr>
</table>
</td></tr>
</table>
<p>
Original external subprogram is <a
href="wt_module.html#M001392">wt_module#xyz_LAT</a>
</p>


        </div>
      </div>


      <div id="method-M000072" class="method-detail">
        <a name="M000072"></a>

        <div class="method-heading">




          <span class="method-name">xyz_LON</span><span class="method-args"></span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em>Variable</em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000072">xyz_LON</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(:,:,:), allocatable</tt>

<table>
<tr><td valign="top"> :</td><td> 座標

</td></tr>
</table>
</td></tr>
</table>
<p>
Original external subprogram is <a
href="wt_module.html#M001391">wt_module#xyz_LON</a>
</p>


        </div>
      </div>


      <div id="method-M000074" class="method-detail">
        <a name="M000074"></a>

        <div class="method-heading">




          <span class="method-name">xyz_RAD</span><span class="method-args"></span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em>Variable</em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000074">xyz_RAD</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(:,:,:), allocatable</tt>

<table>
<tr><td valign="top"> :</td><td> 座標

</td></tr>
</table>
</td></tr>
</table>
<p>
Original external subprogram is <a
href="wt_module.html#M001393">wt_module#xyz_RAD</a>
</p>


        </div>
      </div>


      <div id="method-M000102" class="method-detail">
        <a name="M000102"></a>

        <div class="method-heading">




          <span class="method-name">xyz_RotLat_wt_wt</span><span class="method-args">( wt_Vlon, wt_Vrad ) result(xyz_RotLat_wt_wt)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000102">xyz_RotLat_wt_wt</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) ベクトル場の回転の緯度成分

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>wt_Vlon  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) ベクトル場の経度成分

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>wt_Vrad  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) ベクトル場の動径成分

</td></tr>
</table>
</td></tr>
</table>
<p>
ベクトル場の経度成分, 動径成分である第 1, 2 引数 Vlon, Vrad から
回転の緯度成分
</p>
<pre>
   1/r ∂(r Vlon)/∂r - 1/rcosφ・∂Vrad/∂λ
</pre>
<p>
を計算する.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001414">wt_module#xyz_RotLat_wt_wt</a>
</p>


        </div>
      </div>


      <div id="method-M000101" class="method-detail">
        <a name="M000101"></a>

        <div class="method-heading">




          <span class="method-name">xyz_RotLon_wt_wt</span><span class="method-args">( wt_Vrad, wt_Vlat ) result(xyz_RotLon_wt_wt)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000101">xyz_RotLon_wt_wt</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) ベクトル場の回転の経度成分

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>wt_Vrad  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) ベクトル場の動径成分

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>wt_Vlat  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) ベクトル場の緯度成分

</td></tr>
</table>
</td></tr>
</table>
<p>
ベクトル場の動径成分, 緯度成分である第 1, 2 引数 Vrad, Vlat から
回転の経度成分
</p>
<pre>
   1/r ∂Vrad/∂φ-1/r ∂(r Vlat)/∂r を計算する.
</pre>
<p>
を計算する
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001413">wt_module#xyz_RotLon_wt_wt</a>
</p>


        </div>
      </div>


      <div id="method-M000085" class="method-detail">
        <a name="M000085"></a>

        <div class="method-heading">




          <span class="method-name">xyz_wt</span><span class="method-args">( wt ) result(xyz_wt)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000085">xyz_wt</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 3 次元経度緯度動径格子点データ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>wt  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:lm), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 2 次元球面調和函数チェビシェフスペクトルデータ

</td></tr>
</table>
</td></tr>
</table>
<p>
スペクトルデータから 3 次元格子点データへ(逆)変換する.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001397">wt_module#xyz_wt</a>
</p>


        </div>
      </div>


      <div id="method-M000087" class="method-detail">
        <a name="M000087"></a>

        <div class="method-heading">




          <span class="method-name">xyz_wz</span><span class="method-args">( wz ) result(xyz_wz)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000087">xyz_wz</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 3 次元経度緯度動径格子点データ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>wz  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension((nm+1)*(nm+1),0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 2 次元球面調和函数スペクトル・動径格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
水平スペクトル・動径格子点データから 3 次元格子点データへ(逆)変換する.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001399">wt_module#xyz_wz</a>
</p>


        </div>
      </div>


      <div id="method-M000044" class="method-detail">
        <a name="M000044"></a>

        <div class="method-heading">


          <a href="#M000044" class="method-signature">



          <span class="method-name">xz_AvrLat_xvz</span><span class="method-args">( xvz ) result(xz_AvrLat_xvz)</span>



          </a>

        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000044">xz_AvrLat_xvz</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(im,0:km)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 緯度平均された 2 次元緯度動径格子点データ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xvz  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,<a
href="wt_mpi_module.html#M000053">jc</a>,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 3 次元経度緯度動径格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
緯度積分
</p>
<p>
3 次元格子点データの緯度方向域平均.
</p>
<p>
3 次元データ f(λ,φ,r) に対して ∫f(λ,φ,r)cosφ dφ/2 を計算する.
</p>


          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000044-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000044-source">
<pre>
    function xz_AvrLat_xvz(xvz)  ! 緯度積分
      !
      ! 3 次元格子点データの緯度方向域平均.
      !
      ! 3 次元データ f(λ,φ,r) に対して ∫f(λ,φ,r)cosφ dφ/2 を計算する.
      !
      real(8), dimension(0:im-1,jc,0:km), intent(in) :: xvz
      !(in) 3 次元経度緯度動径格子点データ

      real(8), dimension(im,0:km)  :: xz_AvrLat_xvz
      !(out) 緯度平均された 2 次元緯度動径格子点データ

      xz_AvrLat_xvz = xz_IntLat_xvz(xvz)/sum(y_Lat_Weight)

    end function xz_AvrLat_xvz
</pre>
          </div>

        </div>
      </div>


      <div id="method-M000128" class="method-detail">
        <a name="M000128"></a>

        <div class="method-heading">




          <span class="method-name">xz_AvrLat_xyz</span><span class="method-args">( xyz ) result(xz_AvrLat_xyz)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000128">xz_AvrLat_xyz</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,0:km)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 緯度平均された 2 次元緯度動径格子点データ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xyz  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 3 次元経度緯度動径格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
緯度積分
</p>
<p>
3 次元格子点データの緯度方向域平均.
</p>
<p>
3 次元データ f(λ,φ,r) に対して ∫f(λ,φ,r)cosφ dφ/2 を計算する.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001431">wt_module#xz_AvrLat_xyz</a>
</p>


        </div>
      </div>


      <div id="method-M000034" class="method-detail">
        <a name="M000034"></a>

        <div class="method-heading">


          <a href="#M000034" class="method-signature">



          <span class="method-name">xz_IntLat_xvz</span><span class="method-args">( xvz ) result(xz_IntLat_xvz)</span>



          </a>

        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000034">xz_IntLat_xvz</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,0:km)</tt>

<table>
<tr><td valign="top"> :</td><td> 緯度円格子点データ (out) 緯度積分された 2 次元緯度動径格子点データ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xvz  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,<a
href="wt_mpi_module.html#M000053">jc</a>,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 3 次元経度緯度動径格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
3 次元格子点データの緯度方向域積分.
</p>
<p>
3 次元データ f(λ,φ,r) に対して∫f(λ,φ,r) cosφ dφ を計算する.
</p>


          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000034-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000034-source">
<pre>
    function xz_IntLat_xvz(xvz)
      !
      ! 3 次元格子点データの緯度方向域積分.
      !
      ! 3 次元データ f(λ,φ,r) に対して∫f(λ,φ,r) cosφ dφ を計算する.
      !
      real(8), dimension(0:im-1,jc,0:km), intent(in) :: xvz
      !(in) 3 次元経度緯度動径格子点データ

      real(8), dimension(0:im-1,0:km)  :: xz_IntLat_xvz        ! 緯度円格子点データ
      !(out) 緯度積分された 2 次元緯度動径格子点データ

      real(8), dimension(0:im-1,0:km)  :: xz_IntLatTMP
      integer :: j

      xz_IntLat_xvz = 0.0d0
      do j=1,jc
         xz_IntLat_xvz(:,:) = xz_IntLat_xvz(:,:) + xvz(:,j,:) * v_Lat_Weight(j)
      enddo
      xz_IntLatTmp=xz_IntLat_xvz
      CALL MPI_ALLREDUCE(xz_IntLatTMP,xz_IntLat_xvz,im*(km+1),MPI_REAL8, MPI_SUM,MPI_COMM_WORLD,IERR)

    end function xz_IntLat_xvz
</pre>
          </div>

        </div>
      </div>


      <div id="method-M000105" class="method-detail">
        <a name="M000105"></a>

        <div class="method-heading">




          <span class="method-name">xz_IntLat_xyz</span><span class="method-args">( xyz ) result(xz_IntLat_xyz)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000105">xz_IntLat_xyz</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,0:km)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 緯度積分された 2 次元緯度動径格子点データ. 緯度円格子点データ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xyz  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 3 次元経度緯度動径格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
3 次元格子点データの緯度方向域積分.
</p>
<p>
3 次元データ f(λ,φ,r) に対して∫f(λ,φ,r) cosφ dφ を計算する.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001417">wt_module#xz_IntLat_xyz</a>
</p>


        </div>
      </div>


      <div id="method-M000131" class="method-detail">
        <a name="M000131"></a>

        <div class="method-heading">




          <span class="method-name">y_AvrLonRad_xyz</span><span class="method-args">( xyz ) result(y_AvrLonRad_xyz)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000131">y_AvrLonRad_xyz</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(1:jm)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 経度動径(緯度円)平均された 1 次元緯度格子点データ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xyz  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 3 次元経度緯度動径格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
経度動径(緯度円)積分
</p>
<p>
3 次元格子点データの経度動径(緯度円)平均.
</p>
<p>
3 次元データ f(λ,φ,r) に対して
</p>
<pre>
    ∫f(λ,φ,r) r^2dλdr /(2π(r[o]^3-r[i]^3)/3)
</pre>
<p>
を計算する.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001434">wt_module#y_AvrLonRad_xyz</a>
</p>


        </div>
      </div>


      <div id="method-M000135" class="method-detail">
        <a name="M000135"></a>

        <div class="method-heading">




          <span class="method-name">y_AvrLon_xy</span><span class="method-args">( xy_data ) result(y_AvrLon_xy)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000135">y_AvrLon_xy</a>(1:jm)  </tt></b>  <tt> </tt> :</td><td><tt>real(8)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 平均された 1 次元緯度(Y)格子点

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xy_data(0:im-1,1:jm)  </tt></b>  <tt> </tt> :</td><td><tt>real(8), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 2 次元経度緯度格子点データ(0:im-1,1:jm)

</td></tr>
</table>
</td></tr>
</table>
<p>
2 次元緯度経度格子点データの経度(X)方向平均(1 層用).
</p>
<p>
実際には格子点データ各点毎に x_X_Weight をかけた総和を計算し, x_X_Weight
の総和で割ることで平均している.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001499">wt_module#y_AvrLon_xy</a>
</p>


        </div>
      </div>


      <div id="method-M000138" class="method-detail">
        <a name="M000138"></a>

        <div class="method-heading">




          <span class="method-name">y_AvrRad_yz</span><span class="method-args">( yz ) result(y_AvrRad_yz)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000138">y_AvrRad_yz</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(1:jm)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 動径平均された 1 次元緯度格子点データ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>yz  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(1:jm,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 2 次元緯度動径(子午面)格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
2 次元(YZ)格子点データの動径方向域平均.
</p>
<p>
2 次元データ f(φ,r) に対して ∫f(φ,r) r^2dr /((r[o]^3-r[i]^3)/3)
を計算する.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001438">wt_module#y_AvrRad_yz</a>
</p>


        </div>
      </div>


      <div id="method-M000108" class="method-detail">
        <a name="M000108"></a>

        <div class="method-heading">




          <span class="method-name">y_IntLonRad_xyz</span><span class="method-args">( xyz ) result(y_IntLonRad_xyz)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000108">y_IntLonRad_xyz</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(1:jm)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 経度動径(緯度円)積分された 1 次元緯度格子点データ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xyz  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 3 次元経度緯度動径格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
3 次元格子点データの経度動径(緯度円)積分.
</p>
<p>
3 次元データ f(λ,φ,r) に対して∫f(λ,φ,r) r^2dλdr を計算する.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001420">wt_module#y_IntLonRad_xyz</a>
</p>


        </div>
      </div>


      <div id="method-M000112" class="method-detail">
        <a name="M000112"></a>

        <div class="method-heading">




          <span class="method-name">y_IntLon_xy</span><span class="method-args">( xy_data ) result(y_IntLon_xy)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000112">y_IntLon_xy</a>(1:jm)  </tt></b>  <tt> </tt> :</td><td><tt>real(8)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 積分された 1 次元緯度(Y)格子点データ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xy_data(0:im-1,1:jm)  </tt></b>  <tt> </tt> :</td><td><tt>real(8), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 2 次元経度緯度格子点データ(0:im-1,1:jm)

</td></tr>
</table>
</td></tr>
</table>
<p>
2 次元緯度経度格子点データの経度(X)方向積分(1 層用).
</p>
<p>
実際には格子点データ各点毎に x_X_Weight をかけた総和を計算している.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001494">wt_module#y_IntLon_xy</a>
</p>


        </div>
      </div>


      <div id="method-M000115" class="method-detail">
        <a name="M000115"></a>

        <div class="method-heading">




          <span class="method-name">y_IntRad_yz</span><span class="method-args">( yz ) result(y_IntRad_yz)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000115">y_IntRad_yz</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(1:jm)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 動径積分された 1 次元緯度格子点データ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>yz  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(1:jm,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 2 次元緯度動径(子午面)格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
動径積分
</p>
<p>
2 次元(YZ)格子点データの動径方向域積分.
</p>
<p>
2 次元データ f(φ,r) に対して∫f(φ,r) r^2dr を計算する.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001424">wt_module#y_IntRad_yz</a>
</p>


        </div>
      </div>


      <div id="method-M000056" class="method-detail">
        <a name="M000056"></a>

        <div class="method-heading">




          <span class="method-name">y_Lat</span><span class="method-args"></span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em>Variable</em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000056">y_Lat</a>(:)  </tt></b>  <tt> </tt> :</td><td><tt>real(8), allocatable</tt>

<table>
<tr><td valign="top"> :</td><td> 緯度経度

</td></tr>
</table>
</td></tr>
</table>
<p>
Original external subprogram is <a
href="wt_module.html#M001475">wt_module#y_Lat</a>
</p>


        </div>
      </div>


      <div id="method-M000057" class="method-detail">
        <a name="M000057"></a>

        <div class="method-heading">




          <span class="method-name">y_Lat_Weight</span><span class="method-args"></span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em>Variable</em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000057">y_Lat_Weight</a>(:)  </tt></b>  <tt> </tt> :</td><td><tt>real(8), allocatable</tt>

<table>
<tr><td valign="top"> :</td><td> 座標重み

</td></tr>
</table>
</td></tr>
</table>
<p>
Original external subprogram is <a
href="wt_module.html#M001476">wt_module#y_Lat_Weight</a>
</p>


        </div>
      </div>


      <div id="method-M000127" class="method-detail">
        <a name="M000127"></a>

        <div class="method-heading">




          <span class="method-name">yz_AvrLon_xyz</span><span class="method-args">( xyz ) result(yz_AvrLon_xyz)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000127">yz_AvrLon_xyz</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(1:jm,0:km)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 経度方向(帯状)平均された 2 次元子午面格子点データ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xyz  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 3 次元経度緯度動径格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
経度(帯状)積分
</p>
<p>
3 次元格子点データの経度方向(帯状)平均.
</p>
<p>
3 次元データ f(λ,φ,r) に対して ∫f(λ,φ,r)dλ/2π を計算する.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001430">wt_module#yz_AvrLon_xyz</a>
</p>


        </div>
      </div>


      <div id="method-M000104" class="method-detail">
        <a name="M000104"></a>

        <div class="method-heading">




          <span class="method-name">yz_IntLon_xyz</span><span class="method-args">( xyz ) result(yz_IntLon_xyz)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000104">yz_IntLon_xyz</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(1:jm,0:km)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 経度方向(帯状)積分された 2 次元子午面格子点データ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xyz  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 3 次元経度緯度動径格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
経度(帯状)積分
</p>
<p>
3 次元格子点データの経度方向(帯状)積分.
</p>
<p>
3 次元データ f(λ,φ,r) に対して ∫f(λ,φ,r)dλ を計算する.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001416">wt_module#yz_IntLon_xyz</a>
</p>


        </div>
      </div>


      <div id="method-M000050" class="method-detail">
        <a name="M000050"></a>

        <div class="method-heading">


          <a href="#M000050" class="method-signature">



          <span class="method-name">z_AvrLat_vz</span><span class="method-args">( vz ) result(z_AvrLat_vz)</span>



          </a>

        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000050">z_AvrLat_vz</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:km)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 緯度平均された 1 次元動径格子点データ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>vz  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(<a href="wt_mpi_module.html#M000053">jc</a>,0:km),
intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 2 次元緯度動径(子午面)格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
2 次元(VZ)格子点データの緯度方向域平均.
</p>
<p>
2 次元データ f(φ,r) に対して ∫f(φ,r) cosφ dφ/2 を計算する.
</p>


          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000050-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000050-source">
<pre>
    function z_AvrLat_vz(vz)
      !
      ! 2 次元(VZ)格子点データの緯度方向域平均.
      !
      ! 2 次元データ f(φ,r) に対して ∫f(φ,r) cosφ dφ/2 を計算する.
      !
      real(8), dimension(jc,0:km), intent(in) :: vz
      !(in) 2 次元緯度動径(子午面)格子点データ

      real(8), dimension(0:km)  :: z_AvrLat_vz
      !(out) 緯度平均された 1 次元動径格子点データ

      z_AvrLat_vz = z_IntLat_vz(vz)/sum(y_Lat_Weight)
    end function z_AvrLat_vz
</pre>
          </div>

        </div>
      </div>


      <div id="method-M000137" class="method-detail">
        <a name="M000137"></a>

        <div class="method-heading">




          <span class="method-name">z_AvrLat_yz</span><span class="method-args">( yz ) result(z_AvrLat_yz)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000137">z_AvrLat_yz</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:km)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 緯度平均された 1 次元動径格子点データ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>yz  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(1:jm,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 2 次元緯度動径(子午面)格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
2 次元(YZ)格子点データの緯度方向域平均.
</p>
<p>
2 次元データ f(φ,r) に対して ∫f(φ,r) cosφ dφ/2 を計算する.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001437">wt_module#z_AvrLat_yz</a>
</p>


        </div>
      </div>


      <div id="method-M000048" class="method-detail">
        <a name="M000048"></a>

        <div class="method-heading">


          <a href="#M000048" class="method-signature">



          <span class="method-name">z_AvrLonLat_xvz</span><span class="method-args">( xvz ) result(z_AvrLonLat_xvz)</span>



          </a>

        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000048">z_AvrLonLat_xvz</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:km)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 緯度経度(水平, 球面)平均された 1 次元動径格子点データ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xvz  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,<a
href="wt_mpi_module.html#M000053">jc</a>,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 3 次元経度緯度動径格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
緯度経度(水平)積分
</p>
<p>
3 次元格子点データの緯度経度(水平, 球面)積分
</p>
<p>
3 次元データ f(λ,φ,r) に対して
</p>
<pre>
   ∫f(λ,φ,r) cosφ dλdφ /4π
</pre>
<p>
を計算する.
</p>


          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000048-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000048-source">
<pre>
    function z_AvrLonLat_xvz(xvz)  ! 緯度経度(水平)積分
      !
      ! 3 次元格子点データの緯度経度(水平, 球面)積分
      ! 
      ! 3 次元データ f(λ,φ,r) に対して
      !
      !    ∫f(λ,φ,r) cosφ dλdφ /4π 
      !
      ! を計算する.
      !
      real(8), dimension(0:im-1,jc,0:km), intent(in) :: xvz
      !(in) 3 次元経度緯度動径格子点データ

      real(8), dimension(0:km)     :: z_AvrLonLat_xvz
      !(out) 緯度経度(水平, 球面)平均された 1 次元動径格子点データ

      z_AvrLonLat_xvz = z_IntLonLat_xvz(xvz) /(sum(x_Lon_Weight)*sum(y_Lat_Weight))

    end function z_AvrLonLat_xvz
</pre>
          </div>

        </div>
      </div>


      <div id="method-M000132" class="method-detail">
        <a name="M000132"></a>

        <div class="method-heading">




          <span class="method-name">z_AvrLonLat_xyz</span><span class="method-args">( xyz ) result(z_AvrLonLat_xyz)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000132">z_AvrLonLat_xyz</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:km)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 緯度経度(水平, 球面)平均された 1 次元動径格子点データ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xyz  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 3 次元経度緯度動径格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
緯度経度(水平)積分
</p>
<p>
3 次元格子点データの緯度経度(水平, 球面)積分
</p>
<p>
3 次元データ f(λ,φ,r) に対して
</p>
<pre>
   ∫f(λ,φ,r) cosφ dλdφ /4π
</pre>
<p>
を計算する.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001435">wt_module#z_AvrLonLat_xyz</a>
</p>


        </div>
      </div>


      <div id="method-M000140" class="method-detail">
        <a name="M000140"></a>

        <div class="method-heading">




          <span class="method-name">z_AvrLon_xz</span><span class="method-args">( xz ) result(z_AvrLon_xz)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000140">z_AvrLon_xz</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:km)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 経度平均された 1 次元動径格子点データ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xz  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 2 次元緯度動径格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
経度(帯状)積分
</p>
<p>
2 次元(XZ)格子点データの経度方向平均.
</p>
<p>
2 次元データ f(λ,r) に対して ∫f(λ,r)dλ/2π を計算する.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001440">wt_module#z_AvrLon_xz</a>
</p>


        </div>
      </div>


      <div id="method-M000040" class="method-detail">
        <a name="M000040"></a>

        <div class="method-heading">


          <a href="#M000040" class="method-signature">



          <span class="method-name">z_IntLat_vz</span><span class="method-args">( vz ) result(z_IntLat_vz)</span>



          </a>

        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000040">z_IntLat_vz</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:km)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 緯度積分された 1 次元動径格子点データ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>vz  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(<a href="wt_mpi_module.html#M000053">jc</a>,0:km),
intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 2 次元緯度動径(子午面)格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
緯度積分
</p>
<p>
2 次元(VZ)格子点データの緯度方向域積分.
</p>
<p>
2 次元データ f(φ,r) に対して∫f(φ,r) cosφ dφ を計算する.
</p>


          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000040-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000040-source">
<pre>
    function z_IntLat_vz(vz)  ! 緯度積分
      !
      ! 2 次元(VZ)格子点データの緯度方向域積分.
      !
      ! 2 次元データ f(φ,r) に対して∫f(φ,r) cosφ dφ を計算する.
      !
      real(8), dimension(jc,0:km), intent(in) :: vz
      !(in) 2 次元緯度動径(子午面)格子点データ

      real(8), dimension(0:km)  :: z_IntLat_vz
      !(out) 緯度積分された 1 次元動径格子点データ

      real(8), dimension(0:km)  :: z_IntLatTMP
      integer :: j

      z_IntLat_vz = 0.0d0
      do j=1,jc
         z_IntLat_vz(:) = z_IntLat_vz(:) + vz(j,:) * v_Lat_Weight(j)
      enddo
      z_IntLatTmp=z_IntLat_vz
      CALL MPI_ALLREDUCE(z_IntLatTMP,z_IntLat_vz,km+1,MPI_REAL8, MPI_SUM,MPI_COMM_WORLD,IERR)

    end function z_IntLat_vz
</pre>
          </div>

        </div>
      </div>


      <div id="method-M000114" class="method-detail">
        <a name="M000114"></a>

        <div class="method-heading">




          <span class="method-name">z_IntLat_yz</span><span class="method-args">( yz ) result(z_IntLat_yz)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000114">z_IntLat_yz</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:km)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 緯度積分された 1 次元動径格子点データ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>yz  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(jm,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 2 次元緯度動径(子午面)格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
緯度積分
</p>
<p>
2 次元(YZ)格子点データの緯度方向域積分.
</p>
<p>
2 次元データ f(φ,r) に対して∫f(φ,r) cosφ dφ を計算する.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001423">wt_module#z_IntLat_yz</a>
</p>


        </div>
      </div>


      <div id="method-M000038" class="method-detail">
        <a name="M000038"></a>

        <div class="method-heading">


          <a href="#M000038" class="method-signature">



          <span class="method-name">z_IntLonLat_xvz</span><span class="method-args">( xvz ) result(z_IntLonLat_xvz)</span>



          </a>

        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000038">z_IntLonLat_xvz</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:km)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 緯度経度(水平, 球面)積分された 1 次元動径格子点データ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xvz  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,<a
href="wt_mpi_module.html#M000053">jc</a>,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 3 次元経度緯度動径格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
緯度経度(水平)積分
</p>
<p>
3 次元格子点データの緯度経度(水平, 球面)積分
</p>
<p>
3 次元データ f(λ,φ,r) に対して
</p>
<pre>
   ∫f(λ,φ,r) cosφ dλdφ
</pre>
<p>
を計算する.
</p>


          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000038-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000038-source">
<pre>
    function z_IntLonLat_xvz(xvz)  ! 緯度経度(水平)積分
      !
      ! 3 次元格子点データの緯度経度(水平, 球面)積分
      ! 
      ! 3 次元データ f(λ,φ,r) に対して
      !
      !    ∫f(λ,φ,r) cosφ dλdφ 
      !
      ! を計算する.
      !
      real(8), dimension(0:im-1,jc,0:km), intent(in) :: xvz
      !(in) 3 次元経度緯度動径格子点データ

      real(8), dimension(0:km)     :: z_IntLonLat_xvz
      !(out) 緯度経度(水平, 球面)積分された 1 次元動径格子点データ

      real(8), dimension(0:km)     :: z_IntLonLatTMP
      integer :: i, j

      z_IntLonLat_xvz = 0
      do j=1,jc
         do i=0,im-1
            z_IntLonLat_xvz = z_IntLonLat_xvz + xvz(i,j,:) * x_Lon_Weight(i) * v_Lat_Weight(j)
         enddo
      enddo

      z_IntLonLatTmp=z_IntLonLat_xvz
      CALL MPI_ALLREDUCE(z_IntLonLatTMP,z_IntLonLat_xvz,km+1,MPI_REAL8, MPI_SUM,MPI_COMM_WORLD,IERR)

    end function z_IntLonLat_xvz
</pre>
          </div>

        </div>
      </div>


      <div id="method-M000109" class="method-detail">
        <a name="M000109"></a>

        <div class="method-heading">




          <span class="method-name">z_IntLonLat_xyz</span><span class="method-args">( xyz ) result(z_IntLonLat_xyz)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000109">z_IntLonLat_xyz</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:km)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 緯度経度(水平, 球面)積分された 1 次元動径格子点データ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xyz  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,1:jm,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 3 次元経度緯度動径格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
緯度経度(水平)積分
</p>
<p>
3 次元格子点データの緯度経度(水平, 球面)積分
</p>
<p>
3 次元データ f(λ,φ,r) に対して
</p>
<pre>
   ∫f(λ,φ,r) cosφ dλdφ
</pre>
<p>
を計算する.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001421">wt_module#z_IntLonLat_xyz</a>
</p>


        </div>
      </div>


      <div id="method-M000117" class="method-detail">
        <a name="M000117"></a>

        <div class="method-heading">




          <span class="method-name">z_IntLon_xz</span><span class="method-args">( xz ) result(z_IntLon_xz)</span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="wt_mpi_module.html#M000117">z_IntLon_xz</a>  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:km)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 経度積分された 1 次元動径格子点データ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xz  </tt></b>  <tt> </tt> :</td><td><tt>real(8), dimension(0:im-1,0:km), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 2 次元緯度動径格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
2 次元(XZ)格子点データの経度方向積分.
</p>
<p>
2 次元データ f(λ,r) に対して ∫f(λ,r)dλ を計算する.
</p>
<p>
Original external subprogram is <a
href="wt_module.html#M001426">wt_module#z_IntLon_xz</a>
</p>


        </div>
      </div>


      <div id="method-M000060" class="method-detail">
        <a name="M000060"></a>

        <div class="method-heading">




          <span class="method-name">z_RAD</span><span class="method-args"></span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em>Variable</em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt>g_X(:)  </tt></b>  <tt> </tt> :</td><td><tt>real(8), allocatable</tt>

<table>
<tr><td valign="top"> :</td><td> 格子点座標 km 次のチェビシェフ多項式の零点から定まる格子点

</td></tr>
</table>
</td></tr>
</table>
<p>
Original external subprogram is <a
href="wt_module.html#M001477">wt_module#z_RAD</a>
</p>


        </div>
      </div>


      <div id="method-M000061" class="method-detail">
        <a name="M000061"></a>

        <div class="method-heading">




          <span class="method-name">z_RAD_WEIGHT</span><span class="method-args"></span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em>Variable</em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt>g_X_Weight(:)  </tt></b>  <tt> </tt> :</td><td><tt>real(8), allocatable</tt>

<table>
<tr><td valign="top"> :</td><td> 格子点重み座標 各格子点における積分のための重みが格納してある

</td></tr>
</table>
</td></tr>
</table>
<p>
Original external subprogram is <a
href="wt_module.html#M001478">wt_module#z_RAD_WEIGHT</a>
</p>


        </div>
      </div>



    </div>



  </div>

<div id="validator-badges">
  <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
</div>

</body>
</html>
