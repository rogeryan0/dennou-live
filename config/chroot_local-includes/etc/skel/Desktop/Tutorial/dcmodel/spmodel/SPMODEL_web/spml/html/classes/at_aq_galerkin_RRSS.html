<?xml version="1.0" encoding="euc-jp"?>
<!DOCTYPE html
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>Class: at_aq_galerkin_RRSS</title>
  <meta http-equiv="Content-Type" content="text/html; charset=euc-jp" />
  <meta http-equiv="Content-Script-Type" content="text/javascript" />
  <link rel="stylesheet" href=".././rdoc-style.css" type="text/css" media="screen" />
  <script type="text/javascript">
  // <![CDATA[

  function popupCode( url ) {
    window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
  }

  function toggleCode( id ) {
    if ( document.getElementById )
      elem = document.getElementById( id );
    else if ( document.all )
      elem = eval( "document.all." + id );
    else
      return false;

    elemStyle = elem.style;

    if ( elemStyle.display != "block" ) {
      elemStyle.display = "block"
    } else {
      elemStyle.display = "none"
    }

    return true;
  }

  // Make codeblocks hidden by default
  document.writeln( "<style type=\"text/css\">div.method-source-code { display: none }</style>" )

  // ]]>
  </script>

</head>
<body>


    <div id="classHeader">
        <table class="header-table">
        <tr class="top-aligned-row">
          <td><strong>Class</strong></td>
          <td class="class-name-in-header">at_aq_galerkin_RRSS</td>
        </tr>
        <tr class="top-aligned-row">
            <td><strong>In:</strong></td>
            <td>


                <a href="../files/src/at_aq_galerkin_RRSS_f90.html">

                src/at_aq_galerkin_RRSS.f90

                </a>


        <br />
            </td>
        </tr>


        </table>
    </div>
  <!-- banner header -->

  <div id="bodyContent">


  <div id="contextContent">



    <div id="description">
      <h1><a href="at_aq_galerkin_RRSS.html">at_aq_galerkin_RRSS</a></h1>
<table>
<tr><td valign="top">Authors:</td><td>Shin-ichi Takehiro, Youhei SASAKI

</td></tr>
<tr><td valign="top">Version:</td><td>$Id: <a
href="../files/src/at_aq_galerkin_RRSS_f90.html">at_aq_galerkin_RRSS.f90</a>,v
1.3 2009-02-28 21:33:46 uwabami Exp $

</td></tr>
<tr><td valign="top">Copyright&amp;License:</td><td>See <a href="../../COPYRIGHT">COPYRIGHT</a>

</td></tr>
</table>
<h2>概要</h2>
<p>
spml/at_aq_galerkin_RRSS はチェビシェフ−ガラーキン法,
非圧縮流体の流線関数・流れポテンシャルに対して,
</p>
<ul>
<li>case RR: 両端粘着条件(両端で値と 1 階微分が 0)

<pre>
         f(:,i=0)=f(:,i=im)=f'(:,i=0)=f'(:,i=im)=0
         [ f(:,x=xmax)=f(:,x=xmin)=f'(:,x=xmax)=0=f'(:,x=xmin)=0 ]
</pre>
</li>
<li>case SS: 両端自由すべり条件(両端で値と 2 階微分が 0)

<pre>
         f(:,i=0)=f(:,i=im)=f''(:,i=0)=f''(:,i=im)=0
         [ f(:,x=xmax)=f(:,x=xmin)=f''(:,x=xmax)=0=f''(:,x=xmin)=0 ]
</pre>
</li>
<li>case RS: 片端粘着条件, 片端自由すべり条件

<pre>
         (両端で値が 0, 片側で 1 階微分, もう一方で 2 階微分が 0)
         f(:,i=0)=f(:,i=im)=f'(:,i=0)=f''(:,i=im)=0
         [ f(:,x=xmax)=f(:,x=xmin)=f''(:,x=xmax)=0=f'(:,x=xmin)=0 ]
</pre>
</li>
<li>case SR: 片端自由すべり条件, 片端粘着条件

<pre>
         (両端で値が 0, 片側で 2 階微分, もう一方で 1 階微分が 0)
         f(:,i=0)=f(:,i=im)=f''(:,i=0)=f'(:,i=im)=0
         [ f(:,x=xmax)=f(:,x=xmin)=f'(:,x=xmax)=0=f''(:,x=xmin)=0 ]
</pre>
</li>
</ul>
<p>
を k 次のガラーキン基底が
</p>
<pre>
    \phi_k(x)=T_k(x) + C_{k-1}T_{k-1}(x) + C_{k-2}T_{k-2}(x)
                     + C_{k-3}T_{k-3}(x) + C_{k-4}T_{k-4}(x)
</pre>
<p>
の型式(Type1)を用いて計算するためのモジュールである.
</p>
<p>
定式化については解説文書「チェビシェフ関数展開を利用したガラーキン法」 (<a
href=".././link:cheb_gal.pdf">cheb_gal.pdf</a>)を参照のこと.
</p>

    </div>





   </div>


    <div id="method-list">
      <h3 class="section-bar">Methods</h3>

      <div class="name-list">

        <a href="#M000811">QT</a>&nbsp;&nbsp;

        <a href="#M000810">TQ</a>&nbsp;&nbsp;

        <a href="#M000821">ag_aq</a>&nbsp;&nbsp;

        <a href="#M000812">alpha</a>&nbsp;&nbsp;

        <a href="#M000823">aq_Dx_aq</a>&nbsp;&nbsp;

        <a href="#M000819">aq_ag</a>&nbsp;&nbsp;

        <a href="#M000815">aq_at</a>&nbsp;&nbsp;

        <a href="#M000817">at_aq</a>&nbsp;&nbsp;

        <a href="#M000814">at_aq_galerkin_RRSS_Initial</a>&nbsp;&nbsp;

        <a href="#M000813">beta</a>&nbsp;&nbsp;

        <a href="#M000822">g_q</a>&nbsp;&nbsp;

        <a href="#M000824">q_Dx_q</a>&nbsp;&nbsp;

        <a href="#M000820">q_g</a>&nbsp;&nbsp;

        <a href="#M000816">q_t</a>&nbsp;&nbsp;

        <a href="#M000818">t_q</a>&nbsp;&nbsp;
      </div>
    </div>


  </div>


    <!-- if includes -->

    <div id="includes">
      <h3 class="section-bar">Included Modules</h3>

      <div id="includes-list">

        <span class="include-name"><a href="lumatrix.html">lumatrix</a></span>

        <span class="include-name"><a href="at_module.html">at_module</a></span>

        <span class="include-name">dc_message</span>
      </div>
    </div>



    <div id="section">










      


    <!-- if method_list -->

    <div id="methods">


      <h3 class="section-bar">Public Instance methods</h3>


      <div id="method-M000811" class="method-detail">
        <a name="M000811"></a>

        <div class="method-heading">




          <span class="method-name">QT</span><span class="method-args"></span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em>Variable</em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="at_aq_galerkin_RRSS.html#M000811">QT</a>(:,:)  </tt></b>  <tt> </tt> :</td><td><tt>real(8), allocatable</tt>

<table>
<tr><td valign="top"> :</td><td> チェビシェフ-&gt;ガラーキン変換行列

</td></tr>
</table>
</td></tr>
</table>


        </div>
      </div>


      <div id="method-M000810" class="method-detail">
        <a name="M000810"></a>

        <div class="method-heading">




          <span class="method-name">TQ</span><span class="method-args"></span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em>Variable</em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="at_aq_galerkin_RRSS.html#M000810">TQ</a>(:,:)  </tt></b>  <tt> </tt> :</td><td><tt>real(8), allocatable</tt>

<table>
<tr><td valign="top"> :</td><td> ガラーキン-&gt;チェビシェフ変換行列

</td></tr>
</table>
</td></tr>
</table>


        </div>
      </div>


      <div id="method-M000821" class="method-detail">
        <a name="M000821"></a>

        <div class="method-heading">


          <a href="#M000821" class="method-signature">



          <span class="method-name">ag_aq</span><span class="method-args">( aq_data ) result(ag_aq)</span>



          </a>

        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="at_aq_galerkin_RRSS.html#M000821">ag_aq</a>(size(aq_data,1),0:im)  </tt></b>  <tt> </tt> :</td><td><tt>real(8)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 格子点データ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>aq_data(:,ks:)  </tt></b>  <tt> </tt> :</td><td><tt>real(8), intent(IN)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) ガラーキン係数

</td></tr>
</table>
</td></tr>
</table>
<p>
チェビシェフ−ガラーキン法 非圧縮流体の流線関数・流れポテンシャル用
</p>
<p>
ガラーキン係数 -&gt; 格子点データ変換(2次元データ)
</p>


          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000821-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000821-source">
<pre>
  function ag_aq(aq_data)
    !
    ! チェビシェフ−ガラーキン法
    ! 非圧縮流体の流線関数・流れポテンシャル用
    !
    ! ガラーキン係数 -&gt; 格子点データ変換(2次元データ)
    !
    real(8), intent(IN) :: aq_data(:,ks:)              !(in)  ガラーキン係数  
    real(8)             :: ag_aq(size(aq_data,1),0:im) !(out) 格子点データ  
    
    ag_aq = ag_at(at_aq(aq_data))
  end function ag_aq
</pre>
          </div>

        </div>
      </div>


      <div id="method-M000812" class="method-detail">
        <a name="M000812"></a>

        <div class="method-heading">




          <span class="method-name">alpha</span><span class="method-args"></span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em>Variable</em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="at_aq_galerkin_RRSS.html#M000812">alpha</a>(:)  </tt></b>  <tt> </tt> :</td><td><tt>real(8), allocatable</tt>

<table>
<tr><td valign="top"> :</td><td> チェビシェフ&lt;-&gt;ガラーキン行列積係数

</td></tr>
</table>
</td></tr>
</table>


        </div>
      </div>


      <div id="method-M000823" class="method-detail">
        <a name="M000823"></a>

        <div class="method-heading">


          <a href="#M000823" class="method-signature">



          <span class="method-name">aq_Dx_aq</span><span class="method-args">( aq_data ) result(aq_Dx_aq)</span>



          </a>

        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="at_aq_galerkin_RRSS.html#M000823">aq_Dx_aq</a>(size(aq_data,1),ks:km)  </tt></b>  <tt> </tt> :</td><td><tt>real(8)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 微分ガラーキン

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>aq_data(:,ks:)  </tt></b>  <tt> </tt> :</td><td><tt>real(8), intent(IN)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) ガラーキン係数

</td></tr>
</table>
</td></tr>
</table>
<p>
チェビシェフ−ガラーキン法 非圧縮流体の流線関数・流れポテンシャル用
</p>
<p>
X 微分計算(2 次元)
</p>


          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000823-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000823-source">
<pre>
  function aq_Dx_aq(aq_data)
    !
    ! チェビシェフ−ガラーキン法
    ! 非圧縮流体の流線関数・流れポテンシャル用
    !
    ! X 微分計算(2 次元)
    !
    real(8), intent(IN) :: aq_data(:,ks:)                  !(in) ガラーキン係数
    real(8)             :: aq_Dx_aq(size(aq_data,1),ks:km) !(out) 微分ガラーキン
    aq_Dx_aq = aq_at(at_Dx_at(at_aq(aq_data)))
  end function aq_Dx_aq
</pre>
          </div>

        </div>
      </div>


      <div id="method-M000819" class="method-detail">
        <a name="M000819"></a>

        <div class="method-heading">


          <a href="#M000819" class="method-signature">



          <span class="method-name">aq_ag</span><span class="method-args">( ag_data ) result(aq_ag)</span>



          </a>

        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="at_aq_galerkin_RRSS.html#M000819">aq_ag</a>(size(ag_data,1),ks:km)  </tt></b>  <tt> </tt> :</td><td><tt>real(8)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) ガラーキン係数

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>ag_data(:,0:)  </tt></b>  <tt> </tt> :</td><td><tt>real(8), intent(IN)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
チェビシェフ−ガラーキン法 非圧縮流体の流線関数・流れポテンシャル用
</p>
<p>
格子点データ -&gt; ガラーキン係数変換(2次元データ)
</p>


          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000819-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000819-source">
<pre>
  function aq_ag(ag_data)
    !
    ! チェビシェフ−ガラーキン法
    ! 非圧縮流体の流線関数・流れポテンシャル用
    !
    ! 格子点データ -&gt; ガラーキン係数変換(2次元データ)
    !
    real(8), intent(IN)  :: ag_data(:,0:)                !(in)  格子点データ
    real(8)              :: aq_ag(size(ag_data,1),ks:km) !(out) ガラーキン係数

    aq_ag = aq_at(at_ag(ag_data))
  end function aq_ag
</pre>
          </div>

        </div>
      </div>


      <div id="method-M000815" class="method-detail">
        <a name="M000815"></a>

        <div class="method-heading">


          <a href="#M000815" class="method-signature">



          <span class="method-name">aq_at</span><span class="method-args">( at_data ) result(aq_at)</span>



          </a>

        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="at_aq_galerkin_RRSS.html#M000815">aq_at</a>(size(at_data,1),ks:km)  </tt></b>  <tt> </tt> :</td><td><tt>real(8)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) ガラーキン係数

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>at_data(:,0:)  </tt></b>  <tt> </tt> :</td><td><tt>real(8), intent(IN)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) チェビシェフ係数

</td></tr>
</table>
</td></tr>
</table>
<p>
チェビシェフ−ガラーキン法 非圧縮流体の流線関数・流れポテンシャル用
</p>
<p>
チェビシェフ係数 -&gt; ガラーキン係数変換(2次元データ)
</p>


          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000815-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000815-source">
<pre>
  function aq_at(at_data)
    !
    ! チェビシェフ−ガラーキン法
    ! 非圧縮流体の流線関数・流れポテンシャル用
    !
    ! チェビシェフ係数 -&gt; ガラーキン係数変換(2次元データ)
    !
    real(8), intent(IN) :: at_data(:,0:)                !(in)  チェビシェフ係数
    real(8)             :: aq_at(size(at_data,1),ks:km) !(out) ガラーキン係数  

    real(8)             :: aq_work(size(at_data,1),ks:km)  ! 作業用配列
    
    integer :: k,m

    if ( .not. RRSS_Initialized ) call MessageNotify('E','aq_at', 'at_aq_galerkin_RRSS_module not initialized')

    aq_work =0.0
    do m=ks,km
       do k=0,km
          aq_work(:,m) = aq_work(:,m) + alpha(k) * beta(k) * at_data(:,k) * TQ(k,m)
       enddo
    enddo

    aq_at = LUSolve(QT,kp,aq_work)
  end function aq_at
</pre>
          </div>

        </div>
      </div>


      <div id="method-M000817" class="method-detail">
        <a name="M000817"></a>

        <div class="method-heading">


          <a href="#M000817" class="method-signature">



          <span class="method-name">at_aq</span><span class="method-args">( aq_data ) result(at_aq)</span>



          </a>

        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="at_aq_galerkin_RRSS.html#M000817">at_aq</a>(size(aq_data,1),0:km)  </tt></b>  <tt> </tt> :</td><td><tt>real(8)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) チェビシェフ係数

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>aq_data(:,ks:)  </tt></b>  <tt> </tt> :</td><td><tt>real(8), intent(IN)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) ガラーキン係数

</td></tr>
</table>
</td></tr>
</table>
<p>
チェビシェフ−ガラーキン法 非圧縮流体の流線関数・流れポテンシャル用
</p>
<p>
ガラーキン係数 -&gt; チェビシェフ係数変換(2次元データ)
</p>


          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000817-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000817-source">
<pre>
  function at_aq(aq_data)
    !
    ! チェビシェフ−ガラーキン法
    ! 非圧縮流体の流線関数・流れポテンシャル用
    !
    ! ガラーキン係数 -&gt; チェビシェフ係数変換(2次元データ)
    !
    real(8), intent(IN)  :: aq_data(:,ks:)              !(in)  ガラーキン係数
    real(8)              :: at_aq(size(aq_data,1),0:km) !(out) チェビシェフ係数

    integer :: m, n

    if ( .not. RRSS_Initialized ) call MessageNotify('E','at_aq', 'at_aq_galerkin_RRSS_module not initialized')

    at_aq = 0.0D0
    do m=0,km
       do n=ks,km
          at_aq(:,m) = at_aq(:,m) + TQ(m,n)*aq_data(:,n)/beta(m)
       enddo
    enddo
  end function at_aq
</pre>
          </div>

        </div>
      </div>


      <div id="method-M000814" class="method-detail">
        <a name="M000814"></a>

        <div class="method-heading">


          <a href="#M000814" class="method-signature">



          <span class="method-name">at_aq_galerkin_RRSS_Initial</span><span class="method-args">( i_in, k_in, bc_in ) </span>



          </a>

        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Subroutine </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt>i_in  </tt></b>  <tt> </tt> :</td><td><tt>integer, intent(IN)</tt>

<table>
<tr><td valign="top"> :</td><td> (in)格子点数

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>k_in  </tt></b>  <tt> </tt> :</td><td><tt>integer, intent(IN)</tt>

<table>
<tr><td valign="top"> :</td><td> (in)チェビシェフ切断波数

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>bc_in  </tt></b>  <tt> </tt> :</td><td><tt>character(LEN=2), intent(IN)</tt>

<table>
<tr><td valign="top"> :</td><td> (in)境界条件(RR/SS/RS/SR)

</td></tr>
</table>
</td></tr>
</table>
<p>
チェビシェフ−ガラーキン法 非圧縮流体の流線関数・流れポテンシャル用
</p>
<p>
初期化サブルーチン
</p>


          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000814-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000814-source">
<pre>
  subroutine at_aq_galerkin_RRSS_Initial(i_in,k_in,bc_in)
    !
    ! チェビシェフ−ガラーキン法
    ! 非圧縮流体の流線関数・流れポテンシャル用
    !
    ! 初期化サブルーチン
    !
    integer, intent(IN)          :: i_in     ! (in)格子点数
    integer, intent(IN)          :: k_in     ! (in)チェビシェフ切断波数  
    character(LEN=2), intent(IN) :: bc_in    ! (in)境界条件(RR/SS/RS/SR)

    integer :: k, l, m, n
    real(8) :: delta

    im=i_in 
     km=k_in 
     bc=bc_in

    allocate(TQ(0:km,ks:km),QT(ks:km,ks:km),kp(ks:km))
    allocate(alpha(0:km),beta(0:km))


    select case (bc)

    !---- 両端粘着条件用変換行列設定
    case ('RR','rr')
       TQ = 0.0D0
       do k=ks,km
          TQ(k,k)   = 1.0
          TQ(k-2,k) = -2.0*(K-2.0D0)/(K-3.0D0)
          TQ(k-4,k) = (K-1.0D0)/(K-3.0D0)
       enddo
       call MessageNotify('M','at_aq_galerkin_RRSS_Initial', 'Conversion matrices for RR-B.C. initialized.')

    !---- 両端自由すべり条件用変換行列設定
    case ('SS','ss')
       TQ = 0.0D0
       do k=ks,km
          TQ(k,k)   = 1.0
          TQ(k-2,k) = -(T2(k)-T2(k-4))/(T2(k-2)-T2(k-4))
          TQ(k-4,k) = (T2(k)-T2(k-2))/(T2(k-2)-T2(k-4))
       enddo
       call MessageNotify('M','at_aq_galerkin_RRSS_Initial', 'Conversion matrices for SS-B.C. initialized.')


    !---- 片端粘着条件, 片端自由すべり条件変換行列設定
    case ('RS','rs')
       TQ = 0.0D0
       do k=ks,km
          delta = (T1(k-1)-T1(k-3))*(T2(k-2)-T2(k-4)) + (T2(k-1)-T2(k-3))*(T1(k-2)-T1(k-4))
          TQ(k,k)   = 1.0
          TQ(k-3,k) = ( (T2(k-2)-T2(k-4))*(T1(k)-T1(k-2)) - (T1(k-2)-T1(k-4))*(T2(k)-T2(k-2)) )/delta
          TQ(k-4,k) = ( (T2(k-1)-T2(k-3))*(T1(k)-T1(k-2)) + (T1(k-1)-T1(k-3))*(T2(k)-T2(k-2)) )/delta
          TQ(k-1,k) = -TQ(k-3,k)
          TQ(k-2,k) = -TQ(k-4,k) - 1.0D0
       enddo
       call MessageNotify('M','at_aq_galerkin_RRSS_Initial', 'Conversion matrices for RS-B.C. initialized.')

    !---- 片端自由すべり条件, 片端粘着条件変換行列設定
    case ('SR','sr')
       TQ = 0.0D0
       do k=ks,km
          delta = (T2(k-1)-T2(k-3))*(T1(k-2)-T1(k-4)) + (T1(k-1)-T1(k-3))*(T2(k-2)-T2(k-4))
          TQ(k,k)   = 1.0
          TQ(k-3,k) = ( (T1(k-2)-T1(k-4))*(T2(k)-T2(k-2)) - (T2(k-2)-T2(k-4))*(T1(k)-T1(k-2)) )/delta
          TQ(k-4,k) = ( (T1(k-1)-T1(k-3))*(T2(k)-T2(k-2)) + (T2(k-1)-T2(k-3))*(T1(k)-T1(k-2)) )/delta
          TQ(k-1,k) = -TQ(k-3,k)
          TQ(k-2,k) = -TQ(k-4,k) - 1.0D0
       enddo
       call MessageNotify('M','at_aq_galerkin_RRSS_Initial', 'Conversion matrices for SR-B.C. initialized.')

    case default
       call MessageNotify('E','at_aq_galerkin_RRSS_Initial', 'Argument for B.C. not valid. Should be RR/SS/RS/SR.')

    end select

    beta=1.0 
     beta(0)=0.5D0
    if (im .eq. km ) beta(km)=0.5D0

    ! 両端粘着条件用変換逆行列
    alpha=1.0 
     alpha(0)=2.0D0

    QT = 0.0D0
    do m=ks,km
       do n=ks,km
          do l=0,km
             QT(m,n) = QT(m,n) + alpha(l)*TQ(l,m)*TQ(l,n)
          enddo
       enddo
    enddo

    call LUDecomp(QT,kp)

    RRSS_Initialized=.true.

    contains
      !
      ! k 次チェビシェフ多項式 2 階微分の x=1 での値
      !
      function T2(k)            
        integer, intent(IN) :: k
        real(8)             :: T2

        T2 = k**2 * (k**2 -1) / 3.0D0
      end function T2
      !
      ! k 次チェビシェフ多項式 1 階微分の x=1 での値
      !
      function T1(k)            
        integer, intent(IN) :: k
        real(8)             :: T1

        T1 = k**2
      end function T1

  end subroutine at_aq_galerkin_RRSS_Initial
</pre>
          </div>

        </div>
      </div>


      <div id="method-M000813" class="method-detail">
        <a name="M000813"></a>

        <div class="method-heading">




          <span class="method-name">beta</span><span class="method-args"></span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em>Variable</em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="at_aq_galerkin_RRSS.html#M000813">beta</a>(:)  </tt></b>  <tt> </tt> :</td><td><tt>real(8), allocatable</tt>

<table>
<tr><td valign="top"> :</td><td> チェビシェフ&lt;-&gt;ガラーキン行列和係数

</td></tr>
</table>
</td></tr>
</table>


        </div>
      </div>


      <div id="method-M000822" class="method-detail">
        <a name="M000822"></a>

        <div class="method-heading">


          <a href="#M000822" class="method-signature">



          <span class="method-name">g_q</span><span class="method-args">( q_data ) result(g_q)</span>



          </a>

        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="at_aq_galerkin_RRSS.html#M000822">g_q</a>(0:im)  </tt></b>  <tt> </tt> :</td><td><tt>real(8)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 格子点データ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>q_data(ks:km)  </tt></b>  <tt> </tt> :</td><td><tt>real(8), intent(IN)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) ガラーキン係数

</td></tr>
</table>
</td></tr>
</table>
<p>
チェビシェフ−ガラーキン法 非圧縮流体の流線関数・流れポテンシャル用
</p>
<p>
ガラーキン係数 -&gt; 格子点データ変換(1次元データ)
</p>


          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000822-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000822-source">
<pre>
  function g_q(q_data)
    !
    ! チェビシェフ−ガラーキン法
    ! 非圧縮流体の流線関数・流れポテンシャル用
    !
    ! ガラーキン係数 -&gt; 格子点データ変換(1次元データ)
    !
    real(8), intent(IN) :: q_data(ks:km)        !(in)  ガラーキン係数  
    real(8)             :: g_q(0:im)            !(out) 格子点データ  
    
    g_q = g_t(t_q(q_data))
  end function g_q
</pre>
          </div>

        </div>
      </div>


      <div id="method-M000824" class="method-detail">
        <a name="M000824"></a>

        <div class="method-heading">


          <a href="#M000824" class="method-signature">



          <span class="method-name">q_Dx_q</span><span class="method-args">( q_data ) result(q_Dx_q)</span>



          </a>

        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="at_aq_galerkin_RRSS.html#M000824">q_Dx_q</a>(ks:km)  </tt></b>  <tt> </tt> :</td><td><tt>real(8)</tt>

</td></tr>
<tr><td valign="top"><b><tt>q_data(ks:km)  </tt></b>  <tt> </tt> :</td><td><tt>real(8), intent(IN)</tt>

</td></tr>
</table>
<p>
チェビシェフ−ガラーキン法 非圧縮流体の流線関数・流れポテンシャル用
</p>
<p>
X 微分計算(1 次元)
</p>


          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000824-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000824-source">
<pre>
  function q_Dx_q(q_data)
    !
    ! チェビシェフ−ガラーキン法
    ! 非圧縮流体の流線関数・流れポテンシャル用
    !
    ! X 微分計算(1 次元)
    !
    real(8), intent(IN) :: q_data(ks:km)
    real(8)             :: q_Dx_q(ks:km)

    q_Dx_q = q_t(t_Dx_t(t_q(q_data)))

  end function q_Dx_q
</pre>
          </div>

        </div>
      </div>


      <div id="method-M000820" class="method-detail">
        <a name="M000820"></a>

        <div class="method-heading">


          <a href="#M000820" class="method-signature">



          <span class="method-name">q_g</span><span class="method-args">( g_data ) result(q_g)</span>



          </a>

        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="at_aq_galerkin_RRSS.html#M000820">q_g</a>(ks:km)  </tt></b>  <tt> </tt> :</td><td><tt>real(8)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) ガラーキン係数

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>g_data(0:im)  </tt></b>  <tt> </tt> :</td><td><tt>real(8), intent(IN)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
チェビシェフ−ガラーキン法 非圧縮流体の流線関数・流れポテンシャル用
</p>
<p>
格子点データ -&gt; ガラーキン係数変換(1次元データ)
</p>


          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000820-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000820-source">
<pre>
  function q_g(g_data)
    !
    ! チェビシェフ−ガラーキン法
    ! 非圧縮流体の流線関数・流れポテンシャル用
    !
    ! 格子点データ -&gt; ガラーキン係数変換(1次元データ)
    !
    real(8), intent(IN)  :: g_data(0:im)        !(in)  格子点データ
    real(8)              :: q_g(ks:km)          !(out) ガラーキン係数

    q_g = q_t(t_g(g_data))
  end function q_g
</pre>
          </div>

        </div>
      </div>


      <div id="method-M000816" class="method-detail">
        <a name="M000816"></a>

        <div class="method-heading">


          <a href="#M000816" class="method-signature">



          <span class="method-name">q_t</span><span class="method-args">( t_data ) result(q_t)</span>



          </a>

        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="at_aq_galerkin_RRSS.html#M000816">q_t</a>(ks:km)  </tt></b>  <tt> </tt> :</td><td><tt>real(8)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) ガラーキン係数

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>t_data(0:km)  </tt></b>  <tt> </tt> :</td><td><tt>real(8), intent(IN)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) チェビシェフ係数

</td></tr>
</table>
</td></tr>
</table>
<p>
チェビシェフ−ガラーキン法 非圧縮流体の流線関数・流れポテンシャル用
</p>
<p>
チェビシェフ係数 -&gt; ガラーキン係数変換(1次元データ)
</p>


          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000816-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000816-source">
<pre>
  function q_t(t_data)
    !
    ! チェビシェフ−ガラーキン法
    ! 非圧縮流体の流線関数・流れポテンシャル用
    !
    ! チェビシェフ係数 -&gt; ガラーキン係数変換(1次元データ)
    !
    real(8), intent(IN) :: t_data(0:km)        !(in)  チェビシェフ係数
    real(8)             :: q_t(ks:km)          !(out) ガラーキン係数  

    real(8)             :: q_work(ks:km)       ! 作業用配列

    integer :: k,m

    if ( .not. RRSS_Initialized ) call MessageNotify('E','q_t', 'at_aq_galerkin_RRSS_module not initialized')

    q_work =0.0
    do m=ks,km
       do k=0,km
          q_work(m) = q_work(m) + alpha(k) * beta(k) * t_data(k) * TQ(k,m)
       enddo
    enddo

    q_t = LUSolve(QT,kp,q_work)
  end function q_t
</pre>
          </div>

        </div>
      </div>


      <div id="method-M000818" class="method-detail">
        <a name="M000818"></a>

        <div class="method-heading">


          <a href="#M000818" class="method-signature">



          <span class="method-name">t_q</span><span class="method-args">( q_data ) result(t_q)</span>



          </a>

        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="at_aq_galerkin_RRSS.html#M000818">t_q</a>(0:km)  </tt></b>  <tt> </tt> :</td><td><tt>real(8)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) チェビシェフ係数

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>q_data(ks:km)  </tt></b>  <tt> </tt> :</td><td><tt>real(8), intent(IN)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) ガラーキン係数

</td></tr>
</table>
</td></tr>
</table>
<p>
チェビシェフ−ガラーキン法 非圧縮流体の流線関数・流れポテンシャル用
</p>
<p>
ガラーキン係数 -&gt; チェビシェフ係数変換(1次元データ)
</p>


          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000818-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000818-source">
<pre>
  function t_q(q_data)
    !
    ! チェビシェフ−ガラーキン法
    ! 非圧縮流体の流線関数・流れポテンシャル用
    !
    ! ガラーキン係数 -&gt; チェビシェフ係数変換(1次元データ)
    !
    real(8), intent(IN)  :: q_data(ks:km)       !(in)  ガラーキン係数  
    real(8)              :: t_q(0:km)           !(out) チェビシェフ係数

    integer :: m, n

    if ( .not. RRSS_Initialized ) call MessageNotify('E','t_q', 'at_aq_galerkin_RRSS_module not initialized')

    t_q = 0.0D0
    do m=0,km
       do n=ks,km
          t_q(m) = t_q(m) + TQ(m,n)*q_data(n)/beta(m)
       enddo
    enddo
  end function t_q
</pre>
          </div>

        </div>
      </div>



    </div>



  </div>

<div id="validator-badges">
  <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
</div>

</body>
</html>
