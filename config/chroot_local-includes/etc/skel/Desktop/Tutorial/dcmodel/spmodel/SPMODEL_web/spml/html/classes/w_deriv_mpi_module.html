<?xml version="1.0" encoding="euc-jp"?>
<!DOCTYPE html
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>Class: w_deriv_mpi_module</title>
  <meta http-equiv="Content-Type" content="text/html; charset=euc-jp" />
  <meta http-equiv="Content-Script-Type" content="text/javascript" />
  <link rel="stylesheet" href=".././rdoc-style.css" type="text/css" media="screen" />
  <script type="text/javascript">
  // <![CDATA[

  function popupCode( url ) {
    window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
  }

  function toggleCode( id ) {
    if ( document.getElementById )
      elem = document.getElementById( id );
    else if ( document.all )
      elem = eval( "document.all." + id );
    else
      return false;

    elemStyle = elem.style;

    if ( elemStyle.display != "block" ) {
      elemStyle.display = "block"
    } else {
      elemStyle.display = "none"
    }

    return true;
  }

  // Make codeblocks hidden by default
  document.writeln( "<style type=\"text/css\">div.method-source-code { display: none }</style>" )

  // ]]>
  </script>

</head>
<body>


    <div id="classHeader">
        <table class="header-table">
        <tr class="top-aligned-row">
          <td><strong>Class</strong></td>
          <td class="class-name-in-header">w_deriv_mpi_module</td>
        </tr>
        <tr class="top-aligned-row">
            <td><strong>In:</strong></td>
            <td>


                <a href="../files/src-mpi/w_deriv_mpi_module_f90.html">

                src-mpi/w_deriv_mpi_module.f90

                </a>


        <br />
            </td>
        </tr>


        </table>
    </div>
  <!-- banner header -->

  <div id="bodyContent">


  <div id="contextContent">



    <div id="description">
      <p>
<a href="w_deriv_mpi_module.html">w_deriv_mpi_module</a>
</p>
<pre>
 spml/w_deriv_module モジュールは球面上での 2 次元流体運動を
 球面調和函数を用いたスペクトル法と MPI によって数値計算するための
 モジュール w_mpi_module の下部モジュールであり, スペクトル法の
 微分計算のための Fortran90 関数を提供する.

 内部で ISPACK の SPPACK と SNPACK の Fortran77 サブルーチンを呼んでいる.
 スペクトルデータおよび格子点データの格納方法や変換の詳しい計算法に
 ついては ISPACK/SNPACK,SPPACK のマニュアルを参照されたい.
</pre>

    </div>





   </div>


    <div id="method-list">
      <h3 class="section-bar">Methods</h3>

      <div class="name-list">

        <a href="#M001386">im</a>&nbsp;&nbsp;

        <a href="#M001385">im</a>&nbsp;&nbsp;

        <a href="#M001388">jm</a>&nbsp;&nbsp;

        <a href="#M001387">jm</a>&nbsp;&nbsp;

        <a href="#M001390">nm</a>&nbsp;&nbsp;

        <a href="#M001389">nm</a>&nbsp;&nbsp;

        <a href="#M001383">w_DivLambda_xv</a>&nbsp;&nbsp;

        <a href="#M001378">w_DivLat_xv</a>&nbsp;&nbsp;

        <a href="#M001377">w_DivLon_xv</a>&nbsp;&nbsp;

        <a href="#M001384">w_DivMu_xv</a>&nbsp;&nbsp;

        <a href="#M001379">w_Div_xv_xv</a>&nbsp;&nbsp;

        <a href="#M001380">w_JacobianMPI_w_w</a>&nbsp;&nbsp;

        <a href="#M001374">w_deriv_mpi_initial</a>&nbsp;&nbsp;

        <a href="#M001381">xv_GradLambda_w</a>&nbsp;&nbsp;

        <a href="#M001376">xv_GradLat_w</a>&nbsp;&nbsp;

        <a href="#M001375">xv_GradLon_w</a>&nbsp;&nbsp;

        <a href="#M001382">xv_GradMu_w</a>&nbsp;&nbsp;
      </div>
    </div>


  </div>


    <!-- if includes -->

    <div id="includes">
      <h3 class="section-bar">Included Modules</h3>

      <div id="includes-list">

        <span class="include-name">dc_message</span>

        <span class="include-name"><a href="w_base_module.html">w_base_module</a></span>

        <span class="include-name"><a href="w_base_mpi_module.html">w_base_mpi_module</a></span>
      </div>
    </div>



    <div id="section">










      


    <!-- if method_list -->

    <div id="methods">


      <h3 class="section-bar">Public Instance methods</h3>


      <div id="method-M001386" class="method-detail">
        <a name="M001386"></a>

        <div class="method-heading">




          <span class="method-name">im</span><span class="method-args"></span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em>Variable</em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="w_deriv_mpi_module.html#M001385">im</a>  </tt></b>  <tt> =64            </tt> :</td><td><tt>integer</tt>

<table>
<tr><td valign="top"> :</td><td> 格子点の設定(東西)

</td></tr>
</table>
</td></tr>
</table>
<p>
Original external subprogram is <a
href="w_base_mpi_module.html#M000196">w_base_mpi_module#im</a>
</p>


        </div>
      </div>


      <div id="method-M001385" class="method-detail">
        <a name="M001385"></a>

        <div class="method-heading">




          <span class="method-name">im</span><span class="method-args"></span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em>Variable</em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="w_deriv_mpi_module.html#M001385">im</a>  </tt></b>  <tt> =64            </tt> :</td><td><tt>integer</tt>

<table>
<tr><td valign="top"> :</td><td> 格子点の設定(東西)

</td></tr>
</table>
</td></tr>
</table>
<p>
Original external subprogram is <a
href="w_base_module.html#M001503">w_base_module#im</a>
</p>


        </div>
      </div>


      <div id="method-M001388" class="method-detail">
        <a name="M001388"></a>

        <div class="method-heading">




          <span class="method-name">jm</span><span class="method-args"></span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em>Variable</em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="w_deriv_mpi_module.html#M001387">jm</a>  </tt></b>  <tt> =32            </tt> :</td><td><tt>integer</tt>

<table>
<tr><td valign="top"> :</td><td> 格子点の設定(南北)

</td></tr>
</table>
</td></tr>
</table>
<p>
Original external subprogram is <a
href="w_base_mpi_module.html#M000197">w_base_mpi_module#jm</a>
</p>


        </div>
      </div>


      <div id="method-M001387" class="method-detail">
        <a name="M001387"></a>

        <div class="method-heading">




          <span class="method-name">jm</span><span class="method-args"></span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em>Variable</em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="w_deriv_mpi_module.html#M001387">jm</a>  </tt></b>  <tt> =32            </tt> :</td><td><tt>integer</tt>

<table>
<tr><td valign="top"> :</td><td> 格子点の設定(南北)

</td></tr>
</table>
</td></tr>
</table>
<p>
Original external subprogram is <a
href="w_base_module.html#M001504">w_base_module#jm</a>
</p>


        </div>
      </div>


      <div id="method-M001390" class="method-detail">
        <a name="M001390"></a>

        <div class="method-heading">




          <span class="method-name">nm</span><span class="method-args"></span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em>Variable</em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="w_deriv_mpi_module.html#M001389">nm</a>  </tt></b>  <tt> =21            </tt> :</td><td><tt>integer</tt>

<table>
<tr><td valign="top"> :</td><td> 切断波数の設定

</td></tr>
</table>
</td></tr>
</table>
<p>
Original external subprogram is <a
href="w_base_mpi_module.html#M000198">w_base_mpi_module#nm</a>
</p>


        </div>
      </div>


      <div id="method-M001389" class="method-detail">
        <a name="M001389"></a>

        <div class="method-heading">




          <span class="method-name">nm</span><span class="method-args"></span>



        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em>Variable</em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="w_deriv_mpi_module.html#M001389">nm</a>  </tt></b>  <tt> =21            </tt> :</td><td><tt>integer</tt>

<table>
<tr><td valign="top"> :</td><td> 切断波数の設定

</td></tr>
</table>
</td></tr>
</table>
<p>
Original external subprogram is <a
href="w_base_module.html#M001505">w_base_module#nm</a>
</p>


        </div>
      </div>


      <div id="method-M001383" class="method-detail">
        <a name="M001383"></a>

        <div class="method-heading">


          <a href="#M001383" class="method-signature">



          <span class="method-name">w_DivLambda_xv</span><span class="method-args">( xv_data ) result(w_DivLambda_xv)</span>



          </a>

        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="w_deriv_mpi_module.html#M001383">w_DivLambda_xv</a>((<a href="w_deriv_mpi_module.html#M001389">nm</a>+1)*(<a href="w_deriv_mpi_module.html#M001389">nm</a>+1))  </tt></b>  <tt> </tt> :</td><td><tt>real(8)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 格子点データを発散型経度微分したスペクトルデータ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xv_data(0:im-1,jc)  </tt></b>  <tt> </tt> :</td><td><tt>real(8), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 入力格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
格子点データに発散型経度微分 1/(1-μ^2)・∂/∂λ (μ=sinφ)
を作用させてスペクトルデータに変換して返す(1 層用).
</p>


          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M001383-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M001383-source">
<pre>
    function w_DivLambda_xv(xv_data)
      !
      ! 格子点データに発散型経度微分 1/(1-μ^2)・∂/∂λ (μ=sinφ) 
      ! を作用させてスペクトルデータに変換して返す(1 層用).
      !
      real(8)              :: w_DivLambda_xv((nm+1)*(nm+1))
      !(out) 格子点データを発散型経度微分したスペクトルデータ

      real(8), intent(in)  :: xv_data(0:im-1,jc)
      !(in) 入力格子点データ

      w_DivLambda_xv = w_xv(xv_data,ipow=2,iflag=-1)
    end function w_DivLambda_xv
</pre>
          </div>

        </div>
      </div>


      <div id="method-M001378" class="method-detail">
        <a name="M001378"></a>

        <div class="method-heading">


          <a href="#M001378" class="method-signature">



          <span class="method-name">w_DivLat_xv</span><span class="method-args">( xv_data ) result(w_DivLat_xv)</span>



          </a>

        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="w_deriv_mpi_module.html#M001378">w_DivLat_xv</a>((<a href="w_deriv_mpi_module.html#M001389">nm</a>+1)*(<a href="w_deriv_mpi_module.html#M001389">nm</a>+1))  </tt></b>  <tt> </tt> :</td><td><tt>real(8)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 格子点データを発散型緯度微分したスペクトルデータ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xv_data(0:im-1,jc)  </tt></b>  <tt> </tt> :</td><td><tt>real(8), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 入力格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
格子点データに発散型緯度微分 1/cosφ・∂(f cosφ)/∂φ を作用させて
スペクトルデータに変換して返す(1 層用).
</p>


          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M001378-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M001378-source">
<pre>
    function w_DivLat_xv(xv_data)
      !
      ! 格子点データに発散型緯度微分 1/cosφ・∂(f cosφ)/∂φ を作用させて
      ! スペクトルデータに変換して返す(1 層用).
      !
      real(8)              :: w_DivLat_xv((nm+1)*(nm+1))
      !(out) 格子点データを発散型緯度微分したスペクトルデータ

      real(8), intent(in)  :: xv_data(0:im-1,jc)
      !(in) 入力格子点データ

      w_DivLat_xv = w_xv(xv_data,ipow=1,iflag=1)
    end function w_DivLat_xv
</pre>
          </div>

        </div>
      </div>


      <div id="method-M001377" class="method-detail">
        <a name="M001377"></a>

        <div class="method-heading">


          <a href="#M001377" class="method-signature">



          <span class="method-name">w_DivLon_xv</span><span class="method-args">( xv_data ) result(w_DivLon_xv)</span>



          </a>

        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="w_deriv_mpi_module.html#M001377">w_DivLon_xv</a>((<a href="w_deriv_mpi_module.html#M001389">nm</a>+1)*(<a href="w_deriv_mpi_module.html#M001389">nm</a>+1))  </tt></b>  <tt> </tt> :</td><td><tt>real(8)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 格子点データを発散型経度微分したスペクトルデータ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xv_data(0:im-1,jc)  </tt></b>  <tt> </tt> :</td><td><tt>real(8), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 入力格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
格子点データに発散型経度微分 1/cosφ・∂/∂λ を作用させて
スペクトルデータに変換して返す(1 層用).
</p>


          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M001377-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M001377-source">
<pre>
    function w_DivLon_xv(xv_data)
      !
      ! 格子点データに発散型経度微分 1/cosφ・∂/∂λ を作用させて
      ! スペクトルデータに変換して返す(1 層用).
      !
      real(8)              :: w_DivLon_xv((nm+1)*(nm+1))
      !(out) 格子点データを発散型経度微分したスペクトルデータ
      
      real(8), intent(in)  :: xv_data(0:im-1,jc)
      !(in) 入力格子点データ

      w_DivLon_xv = w_xv(xv_data,ipow=1,iflag=-1)
    end function w_DivLon_xv
</pre>
          </div>

        </div>
      </div>


      <div id="method-M001384" class="method-detail">
        <a name="M001384"></a>

        <div class="method-heading">


          <a href="#M001384" class="method-signature">



          <span class="method-name">w_DivMu_xv</span><span class="method-args">( xv_data ) result(w_DivMu_xv)</span>



          </a>

        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="w_deriv_mpi_module.html#M001384">w_DivMu_xv</a>((<a href="w_deriv_mpi_module.html#M001389">nm</a>+1)*(<a href="w_deriv_mpi_module.html#M001389">nm</a>+1))  </tt></b>  <tt> </tt> :</td><td><tt>real(8)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 格子点データを発散型緯度微分したスペクトルデータ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xv_data(0:im-1,jc)  </tt></b>  <tt> </tt> :</td><td><tt>real(8), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 入力格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
格子点データに発散型緯度微分 ∂/∂μ (μ=sinφ)を作用させて
スペクトルデータに変換して返す(1 層用).
</p>


          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M001384-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M001384-source">
<pre>
    function w_DivMu_xv(xv_data)
      !
      ! 格子点データに発散型緯度微分 ∂/∂μ (μ=sinφ)を作用させて
      ! スペクトルデータに変換して返す(1 層用).
      !
      real(8)              :: w_DivMu_xv((nm+1)*(nm+1))
      !(out) 格子点データを発散型緯度微分したスペクトルデータ

      real(8), intent(in)  :: xv_data(0:im-1,jc)
      !(in) 入力格子点データ

      w_DivMu_xv = w_xv(xv_data,ipow=2,iflag=1)
    end function w_DivMu_xv
</pre>
          </div>

        </div>
      </div>


      <div id="method-M001379" class="method-detail">
        <a name="M001379"></a>

        <div class="method-heading">


          <a href="#M001379" class="method-signature">



          <span class="method-name">w_Div_xv_xv</span><span class="method-args">( xv_u, xv_v ) result(w_Div_xv_xv)</span>



          </a>

        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="w_deriv_mpi_module.html#M001379">w_Div_xv_xv</a>((<a href="w_deriv_mpi_module.html#M001389">nm</a>+1)*(<a href="w_deriv_mpi_module.html#M001389">nm</a>+1))  </tt></b>  <tt> </tt> :</td><td><tt>real(8)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 2 つの入力格子点データをベクトル成分とする発散のスペクトルデータ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xv_u(0:im-1,jc)  </tt></b>  <tt> </tt> :</td><td><tt>real(8), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) ベクトル経度成分の格子点データ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>xv_v(0:im-1,jc)  </tt></b>  <tt> </tt> :</td><td><tt>real(8), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) ベクトル緯度成分の格子点データ

</td></tr>
</table>
</td></tr>
</table>
<p>
2 つの入力格子点データをベクトル成分とする発散を計算し,
スペクトルデータとして返す(1 層用).
</p>


          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M001379-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M001379-source">
<pre>
    function w_Div_xv_xv(xv_u,xv_v)
      !
      ! 2 つの入力格子点データをベクトル成分とする発散を計算し, 
      ! スペクトルデータとして返す(1 層用).
      !
      real(8)              :: w_Div_xv_xv((nm+1)*(nm+1))
      !(out) 2 つの入力格子点データをベクトル成分とする発散のスペクトルデータ

      real(8), intent(in)  :: xv_u(0:im-1,jc)
      !(in) ベクトル経度成分の格子点データ

      real(8), intent(in)  :: xv_v(0:im-1,jc)
      !(in) ベクトル緯度成分の格子点データ

      w_Div_xv_xv = w_Divlon_xv(xv_u) + w_Divlat_xv(xv_v)
    end function w_Div_xv_xv
</pre>
          </div>

        </div>
      </div>


      <div id="method-M001380" class="method-detail">
        <a name="M001380"></a>

        <div class="method-heading">


          <a href="#M001380" class="method-signature">



          <span class="method-name">w_JacobianMPI_w_w</span><span class="method-args">( w_a, w_b ) result(w_JacobianMPI_w_w)</span>



          </a>

        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="w_deriv_mpi_module.html#M001380">w_JacobianMPI_w_w</a>((<a href="w_deriv_mpi_module.html#M001389">nm</a>+1)*(<a href="w_deriv_mpi_module.html#M001389">nm</a>+1))  </tt></b>  <tt> </tt> :</td><td><tt>real(8)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) 2 つのスペクトルデータのヤコビアン

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>w_a((<a href="w_deriv_mpi_module.html#M001389">nm</a>+1)*(<a href="w_deriv_mpi_module.html#M001389">nm</a>+1))  </tt></b>  <tt> </tt> :</td><td><tt>real(8), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 1つ目の入力スペクトルデータ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>w_b((<a href="w_deriv_mpi_module.html#M001389">nm</a>+1)*(<a href="w_deriv_mpi_module.html#M001389">nm</a>+1))  </tt></b>  <tt> </tt> :</td><td><tt>real(8), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 2つ目の入力スペクトルデータ

</td></tr>
</table>
</td></tr>
</table>
<p>
2 つのスペクトルデータにヤコビアン
</p>
<pre>
  J(f,g) = ∂f/∂λ・∂g/∂μ - ∂g/∂λ・∂f/∂μ
         = ∂f/∂λ・1/cosφ・∂g/∂φ
            - ∂g/∂λ・1/cosφ・∂f/∂φ
</pre>
<p>
を作用させる(1 層用).
</p>


          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M001380-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M001380-source">
<pre>
    function w_JacobianMPI_w_w(w_a,w_b)
      ! 2 つのスペクトルデータにヤコビアン
      !
      !   J(f,g) = ∂f/∂λ・∂g/∂μ - ∂g/∂λ・∂f/∂μ
      !          = ∂f/∂λ・1/cosφ・∂g/∂φ
      !             - ∂g/∂λ・1/cosφ・∂f/∂φ
      !
      ! を作用させる(1 層用).

      real(8)             :: w_JacobianMPI_w_w((nm+1)*(nm+1))
      !(out) 2 つのスペクトルデータのヤコビアン

      real(8), intent(in) :: w_a((nm+1)*(nm+1))
      !(in) 1つ目の入力スペクトルデータ
      
      real(8), intent(in) :: w_b((nm+1)*(nm+1))
      !(in) 2つ目の入力スペクトルデータ

      call spmjcb(nm,im,id,jc,jd,w_a,w_b,w_JacobianMPI_w_w, it,t,y,ip2,p2,r2,ip3,p3,r3,ia,a,q,ws,ww,w)
    end function w_JacobianMPI_w_w
</pre>
          </div>

        </div>
      </div>


      <div id="method-M001374" class="method-detail">
        <a name="M001374"></a>

        <div class="method-heading">


          <a href="#M001374" class="method-signature">



          <span class="method-name">w_deriv_mpi_initial</span><span class="method-args">( ) </span>



          </a>

        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Subroutine </em></b> :</td><td>
</td></tr>
</table>
<p>
スペクトル変換の格子点数, 波数を設定する.
</p>
<p>
他の関数を呼ぶ前に, 最初にこのサブルーチンを呼んで初期設定を
しなければならない.
</p>


          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M001374-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M001374-source">
<pre>
    subroutine w_deriv_mpi_initial
      !
      ! スペクトル変換の格子点数, 波数を設定する.
      !
      ! 他の関数を呼ぶ前に, 最初にこのサブルーチンを呼んで初期設定を
      ! しなければならない. 
      !
      integer iw

      allocate(ip2(2*((nm+1)/2+nm+1)*2))      ! ヤコビアン計算用配列
      allocate(p2(2*((nm+1)/2+nm+1)*jm))      ! ヤコビアン計算用配列
      allocate(r2(2*((nm+1)/2*2+3)*(nm/2+1))) ! ヤコビアン計算用配列
      allocate(ip3(3*((nm+1)/2+nm+1)*2))      ! ヤコビアン計算用配列
      allocate(p3(3*((nm+1)/2+nm+1)*jm))      ! ヤコビアン計算用配列
      allocate(r3(3*((nm+1)/2*2+3)*(nm/2+1))) ! ヤコビアン計算用配列
      call snkini(nm,jc,2,ip,p,r,ip2,p2,r2)
      call snkini(nm,jc,3,ip,p,r,ip3,p3,r3)

      allocate(q(3*((nm+1)/2+nm+1)*jm))       ! 作業用配列
      iw=3*max( ((nm+1)/2*2+3)*(nm/2+2)*2, jm*((nm+1)/2+nm+1)*2, jm*jm )
      allocate(ws(iw),ww(iw),w((nm+1)*(nm+1)))   ! 作業用配列

      call MessageNotify('M','w_deriv_mpi_initial', 'w_deriv_mpi_module is initialized')

    end subroutine w_deriv_mpi_initial
</pre>
          </div>

        </div>
      </div>


      <div id="method-M001381" class="method-detail">
        <a name="M001381"></a>

        <div class="method-heading">


          <a href="#M001381" class="method-signature">



          <span class="method-name">xv_GradLambda_w</span><span class="method-args">( w_data ) result(xv_GradLambda_w)</span>



          </a>

        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="w_deriv_mpi_module.html#M001381">xv_GradLambda_w</a>(0:im-1,jc)  </tt></b>  <tt> </tt> :</td><td><tt>real(8)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) スペクトルデータを勾配型経度微分した格子点データ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>w_data((<a href="w_deriv_mpi_module.html#M001389">nm</a>+1)*(<a href="w_deriv_mpi_module.html#M001389">nm</a>+1))  </tt></b>  <tt> </tt> :</td><td><tt>real(8), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 入力スペクトルデータ

</td></tr>
</table>
</td></tr>
</table>
<p>
スペクトルデータに勾配型経度微分 ∂/∂λ を作用する(1 層用).
</p>


          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M001381-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M001381-source">
<pre>
    function xv_GradLambda_w(w_data)
      !
      ! スペクトルデータに勾配型経度微分 ∂/∂λ を作用する(1 層用).
      !
      real(8)              :: xv_GradLambda_w(0:im-1,jc)
      !(out) スペクトルデータを勾配型経度微分した格子点データ

      real(8), intent(in)  :: w_data((nm+1)*(nm+1))
      !(in) 入力スペクトルデータ
      
      xv_GradLambda_w = xv_w(w_data,ipow=0,iflag=-1)
    end function xv_GradLambda_w
</pre>
          </div>

        </div>
      </div>


      <div id="method-M001376" class="method-detail">
        <a name="M001376"></a>

        <div class="method-heading">


          <a href="#M001376" class="method-signature">



          <span class="method-name">xv_GradLat_w</span><span class="method-args">( w_data ) result(xv_GradLat_w)</span>



          </a>

        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="w_deriv_mpi_module.html#M001376">xv_GradLat_w</a>(0:im-1,jc)  </tt></b>  <tt> </tt> :</td><td><tt>real(8)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) スペクトルデータを勾配型緯度微分した格子点データ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>w_data((<a href="w_deriv_mpi_module.html#M001389">nm</a>+1)*(<a href="w_deriv_mpi_module.html#M001389">nm</a>+1))  </tt></b>  <tt> </tt> :</td><td><tt>real(8), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 入力スペクトルデータ

</td></tr>
</table>
</td></tr>
</table>
<p>
スペクトルデータに勾配型緯度微分 ∂/∂φ を作用させて
格子点データに変換して返す(1 層用).
</p>


          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M001376-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M001376-source">
<pre>
    function xv_GradLat_w(w_data)
      !
      ! スペクトルデータに勾配型緯度微分 ∂/∂φ を作用させて
      ! 格子点データに変換して返す(1 層用).
      !
      real(8)              :: xv_GradLat_w(0:im-1,jc)
      !(out) スペクトルデータを勾配型緯度微分した格子点データ

      real(8), intent(in)  :: w_data((nm+1)*(nm+1))
      !(in) 入力スペクトルデータ

      xv_GradLat_w = xv_w(w_data,ipow=1,iflag=1)
    end function xv_GradLat_w
</pre>
          </div>

        </div>
      </div>


      <div id="method-M001375" class="method-detail">
        <a name="M001375"></a>

        <div class="method-heading">


          <a href="#M001375" class="method-signature">



          <span class="method-name">xv_GradLon_w</span><span class="method-args">( w_data ) result(xv_GradLon_w)</span>



          </a>

        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="w_deriv_mpi_module.html#M001375">xv_GradLon_w</a>(0:im-1,jc)  </tt></b>  <tt> </tt> :</td><td><tt>real(8)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) スペクトルデータを勾配型経度微分した格子点データ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>w_data((<a href="w_deriv_mpi_module.html#M001389">nm</a>+1)*(<a href="w_deriv_mpi_module.html#M001389">nm</a>+1))  </tt></b>  <tt> </tt> :</td><td><tt>real(8), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 入力スペクトルデータ

</td></tr>
</table>
</td></tr>
</table>
<p>
スペクトルデータに勾配型経度微分 1/cosφ・∂/∂λ を
作用させた格子点データを返す(1 層用).
</p>


          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M001375-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M001375-source">
<pre>
    function xv_GradLon_w(w_data)
      !
      ! スペクトルデータに勾配型経度微分 1/cosφ・∂/∂λ を
      ! 作用させた格子点データを返す(1 層用).
      !
      real(8)              :: xv_GradLon_w(0:im-1,jc)
      !(out) スペクトルデータを勾配型経度微分した格子点データ

      real(8), intent(in)  :: w_data((nm+1)*(nm+1))
      !(in) 入力スペクトルデータ

      xv_GradLon_w = xv_w(w_data,ipow=1,iflag=-1)
    end function xv_GradLon_w
</pre>
          </div>

        </div>
      </div>


      <div id="method-M001382" class="method-detail">
        <a name="M001382"></a>

        <div class="method-heading">


          <a href="#M001382" class="method-signature">



          <span class="method-name">xv_GradMu_w</span><span class="method-args">( w_data ) result(xv_GradMu_w)</span>



          </a>

        </div>

        <div class="method-description">

          <table>
<tr><td valign="top"><b><em> Function </em></b> :</td><td>
</td></tr>
<tr><td valign="top"><b><tt><a href="w_deriv_mpi_module.html#M001382">xv_GradMu_w</a>(0:im-1,jc)  </tt></b>  <tt> </tt> :</td><td><tt>real(8)</tt>

<table>
<tr><td valign="top"> :</td><td> (out) スペクトルデータを勾配型緯度微分した格子点データ

</td></tr>
</table>
</td></tr>
<tr><td valign="top"><b><tt>w_data((<a href="w_deriv_mpi_module.html#M001389">nm</a>+1)*(<a href="w_deriv_mpi_module.html#M001389">nm</a>+1))  </tt></b>  <tt> </tt> :</td><td><tt>real(8), intent(in)</tt>

<table>
<tr><td valign="top"> :</td><td> (in) 入力スペクトルデータ

</td></tr>
</table>
</td></tr>
</table>
<p>
スペクトルデータに勾配型緯度微分 (1-μ^2)∂/∂μ (μ=sinφ)
を作用させて格子点データに変換して返す(1 層用).
</p>


          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M001382-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M001382-source">
<pre>
    function xv_GradMu_w(w_data)
      !
      ! スペクトルデータに勾配型緯度微分 (1-μ^2)∂/∂μ  (μ=sinφ)
      ! を作用させて格子点データに変換して返す(1 層用).
      !
      real(8)              :: xv_GradMu_w(0:im-1,jc)
      !(out) スペクトルデータを勾配型緯度微分した格子点データ

      real(8), intent(in)  :: w_data((nm+1)*(nm+1))
      !(in) 入力スペクトルデータ

      xv_GradMu_w = xv_w(w_data,ipow=0,iflag=1)
    end function xv_GradMu_w
</pre>
          </div>

        </div>
      </div>



    </div>



  </div>

<div id="validator-badges">
  <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
</div>

</body>
</html>
