%表題  SPMODEL レファレンスマニュアル
%      2 重フーリエ変換
%
%履歴  2007/11/09 竹広真一 新規作成
%
\documentclass[a4j,12pt]{jarticle}
\usepackage{Dennou6}

\Dtitle{2 重フーリエ変換}
\Dauthor{竹広真一}
\Ddate{平成 19 年 11 月 9 日}

\Dparskip

\begin{document}

\maketitle

この文書は, 2 重フーリエ変換の基本的な定式化を行う. 

\section{2 重フーリエ変換}

$x$ 方向に $[x_{min},x_{max}]$, $y$ 方向に $[y_{min},y_{max}]$ の領域での
周期関数 $g(x,y)$ のフーリエ変換は
%
\begin{equation}
  s_{k,l} = \frac{D_x}{D_y}\int_{x_{min}}^{x_{max}}\int_{y_{min}}^{y_{max}}
               g(x,y)\exp\left(-i\frac{2\pi}{D_x}kx-i\frac{2\pi}{D_y}ly\right)
               dx dy
\end{equation}
%
ただし $D_x=x_{max}-x_{min}$, $D_y=y_{max}-y_{min}$ である. 
切断波数 $K,L$ とする逆変換は
%
\begin{equation}
  g(x,y) = \sum_{k=-K}^{K}\sum_{l=-L}^{L}
               s_{k,l}\exp\left(i\frac{2\pi}{D_x}kx+i\frac{2\pi}{D_y}ly\right)
\end{equation}

$x,y$ それぞれ $[0,2\pi]$ の範囲に変換する. すなわち
$x=x_{min} + D_x/(2\pi)\tilde{x}, y=y_{min} + D_y/(2\pi)\tilde{y}$
と変換すると正変換, 逆変換はそれぞれ
%
\begin{eqnarray}
  s_{k,l} &=& \frac{1}{(2\pi)^2}\int_0^{2\pi}\int_0^{2\pi}
               g(x,y)\exp(-ikx-ily) dx dy, \\
  g(x,y) &=& \sum_{k=-K}^{K}\sum_{l=-L}^{L}
               s_{k,l}\exp\left(ikx+ily\right).
\end{eqnarray}
%
となる. ただし簡単のため $\tilde{x}$ を $x$,$\tilde{y}$ を $y$ に置き換えた.

$g(x,y)$ が実数であることから $s_{k,l}$ に制約が加わる. 
逆変換の式で波数 $(k,l), (-k,-l) $ 成分を書き出すと
%
\begin{eqnarray*}
  & & s_{k,l}e^{ikx+ily} + s_{-k,-l}e^{-ikx-ily}              \\
  &=&    Re[s_{k,l}]\cos(kx+ly)-Im[s_{k,l}]\sin(kx+ly)        \\
  & &+i\{Im[s_{k,l}]\cos(kx+ly)+Re[s_{k,l}]\sin(kx+ly)\}      \\
  & &   +Re[s_{-k,-l}]\cos(-kx-ly)-Im[s_{-k,-l}]\sin(-kx-ly)  \\
  & &+i\{Im[s_{-k,-l}]\cos(-kx-ly)+Re[s_{-k,-l}]\sin(-kx-ly)\}\\
  &=&    Re[s_{k,l}]\cos(kx+ly)-Im[s_{k,l}]\sin(kx+ly)        \\
  & &+i\{Im[s_{k,l}]\cos(kx+ly)+Re[s_{k,l}]\sin(kx+ly)\}      \\
  & &   +Re[s_{-k,-l}]\cos(kxly)+Im[s_{-k,-l}]\sin(kx+ly)     \\
  & &+i\{Im[s_{-k,-l}]\cos(kx+ly)-Re[s_{-k,-l}]\sin(kx+ly)\}  \\
  &=&  \{ Re[s_{k,l}] + Re[s_{-k,-l}] \}\cos(kx+ly)
      +\{-Im[s_{k,l}] + Im[s_{-k,-l}] \}\sin(kx+ly)              \\
  & &+i\{ Im[s_{k,l}] + Im[s_{-k,-l}] \}\cos(kx+ly)
     +i\{ Re[s_{k,l}] - Re[s_{-k,-l}] \}\sin(kx+ly)\}
\end{eqnarray*}
%
この虚数部が 0 とならねばならない. したがって
\begin{equation}
  Re[s_{k,l}] = Re[s_{-k,-l}], Im[s_{k,l}] =- Im[s_{-k,-l}], \quad
  i.e. \quad
  s_{k,l} = s_{-k,-l}^*
\end{equation}
%
である. 

\section{スペクトル計算}

流線関数 $\psi(x,y)$ で表される場の全運動エネルギー
ならびにエンストロフィーを計算し, 
スペクトル成分で書き表す. 全運動エネルギーは
%
\begin{equation}
  E = \frac{1}{2}\int_{x_{min}}^{x_{max}}\int_{y_{min}}^{y_{max}}
               \left[\DP[][]{\psi}{x}^2 + \DP[][]{\psi}{y}^2 \right]dx dy
\end{equation}
%
部分積分すると
%
\begin{eqnarray*}
  E &=& \int_{y_{min}}^{y_{max}}
          \left[\psi\DP{\psi}{x}\right]_{x_{min}}^{x_{max}}dy
       +\int_{x_{min}}^{x_{max}}
          \left[\psi\DP{\psi}{y}\right]_{y_{min}}^{y_{max}}dx
       -\frac{1}{2}\int_{x_{min}}^{x_{max}}\int_{y_{min}}^{y_{max}}
               \psi\left[\DP[2]{\psi}{x} + \DP[2]{\psi}{y}\right] dx dy\\
    &=& -\frac{1}{2}\int_{x_{min}}^{x_{max}}\int_{y_{min}}^{y_{max}}
               \psi\left[\DP[2]{\psi}{x} + \DP[2]{\psi}{y}\right] dx dy
\end{eqnarray*}
%
ここで周期境界条件を用いている. 
$x,y$ それぞれ $[0,2\pi]$ の範囲に変換すべく
$x=x_{min} + D_x/(2\pi)x^*, y=y_{min} + D_y/(2\pi)y^*$
とすると, 
%
\begin{eqnarray*}
  E &=& -\frac{1}{2}\int_0^{2\pi}\int_0^{2\pi}
        \psi\left[\left(\frac{2\pi}{D_x}\right)^2\DP[2]{\psi}{x^*} 
                 +\left(\frac{2\pi}{D_y}\right)^2\DP[2]{\psi}{y^*}\right]
        \frac{D_x}{2\pi}\frac{D_y}{2\pi}dx^* dy^* \\
    &=&-\frac{D_xD_y}{(2\pi)^2}\frac{1}{2}\int_0^{2\pi}\int_0^{2\pi}
        \psi\left[\left(\frac{2\pi}{D_x}\right)^2\DP[2]{\psi}{x^*} 
                 +\left(\frac{2\pi}{D_y}\right)^2\DP[2]{\psi}{y^*}\right]
         dx^* dy^*
\end{eqnarray*}
%
ここで流線関数のスペクトル
%
\begin{equation}
  \psi(x,y) = \sum_{k=-K}^{K}\sum_{l=-L}^{L}
           \tilde{\psi}\exp\left(i\frac{2\pi}{D_x}kx+i\frac{2\pi}{D_y}ly\right)
      = \sum_{k=-K}^{K}\sum_{l=-L}^{L}
               \tilde{\psi}_{kl}\exp\left(ikx^*+ily^*\right)
\end{equation}
%
を代入すると, 
\begin{eqnarray*}
  E &=& \frac{D_xD_y}{(2\pi)^2}\frac{1}{2}\int_0^{2\pi}\int_0^{2\pi}
       \sum_{k=-K}^{K}\sum_{l=-L}^{L}
           \tilde{\psi}_{k,l}e^{ikx^*+ily^*} \\
    & &\cdot\sum_{k'=-K}^{K}\sum_{l'=-L}^{L}
       \left[\left(\frac{2\pi k'}{D_x}\right)^2
                   +\left(\frac{2\pi l'}{D_y}\right)^2 
       \right]\tilde{\psi}_{k'l'}e^{ik'x^*+il'y^*}
       dx^* dy^* \\
    &=& \frac{D_xD_y}{(2\pi)^2}\frac{1}{2}
       \sum_{k=-K}^{K}\sum_{l=-L}^{L}\sum_{k'=-K}^{K}\sum_{l'=-L}^{L}
       \left[\left(\frac{2\pi k'}{D_x}\right)^2
                   +\left(\frac{2\pi l'}{D_y}\right)^2 
       \right]\tilde{\psi}_{k,l}\tilde{\psi}_{k'l'}\\
    & & \cdot\int_0^{2\pi}e^{i(k+k')x^*}dx^*\int_0^{2\pi}e^{i(l+l')y^*}dy^* \\
    &=& \frac{D_xD_y}{(2\pi)^2}\frac{1}{2}
       \sum_{k=-K}^{K}\sum_{l=-L}^{L}\sum_{k'=-K}^{K}\sum_{l'=-L}^{L}
       \left[\left(\frac{2\pi k'}{D_x}\right)^2
                   +\left(\frac{2\pi l'}{D_y}\right)^2 
       \right]\tilde{\psi}_{k,l}\tilde{\psi}_{k'l'}(2\pi)^2
       \delta_{k,-k'}\delta_{l,-l'} \\
    &=& D_xD_y\frac{1}{2}
       \sum_{k=-K}^{K}\sum_{l=-L}^{L}
       \left[\left(\frac{2\pi k}{D_x}\right)^2
                   +\left(\frac{2\pi l}{D_y}\right)^2 
       \right]\tilde{\psi}_{k,l}\tilde{\psi}_{-k,-l}.
\end{eqnarray*}
%
最後に $\tilde{\psi}_{-k,-l}=\tilde{\psi}_{k,l}^*$ の関係を用いて
%
\begin{equation}
  E = D_xD_y\frac{1}{2}
       \sum_{k=-K}^{K}\sum_{l=-L}^{L}
       \left[\left(\frac{2\pi k}{D_x}\right)^2
                   +\left(\frac{2\pi l}{D_y}\right)^2 
       \right]|\tilde{\psi}_{k,l}|^2,
\end{equation}
%
となる. そこで
%
\begin{equation}
\frac{1}{2}\left[\left(\frac{2\pi k}{D_x}\right)^2
                   +\left(\frac{2\pi l}{D_y}\right)^2 
       \right]|\tilde{\psi}_{k,l}|^2
\end{equation}
%
をエネルギースペクトルの波数 $k,l$ 成分と呼ぶことができる. 

同様にエンストロフィーは
\begin{eqnarray*}
  Q  &=& \frac{1}{2}\int_{x_{min}}^{x_{max}}\int_{y_{min}}^{y_{max}}
               \left[\DP[2]{\psi}{x} + \DP[2]{\psi}{y}\right]^2 dx dy \\
    &=& \frac{1}{2}\int_0^{2\pi}\int_0^{2\pi}
            \left[\left(\frac{2\pi}{D_x}\right)^2\DP[2]{\psi}{x^*} 
                 +\left(\frac{2\pi}{D_y}\right)^2\DP[2]{\psi}{y^*}\right]^2
        \frac{D_x}{2\pi}\frac{D_y}{2\pi}dx^* dy^* \\
    &=& \frac{D_xD_y}{(2\pi)^2}\frac{1}{2}\int_0^{2\pi}\int_0^{2\pi}
            \left[\left(\frac{2\pi}{D_x}\right)^2\DP[2]{\psi}{x^*} 
                 +\left(\frac{2\pi}{D_y}\right)^2\DP[2]{\psi}{y^*}\right]^2
         dx^* dy^* \\
   &=& \frac{D_xD_y}{(2\pi)^2}\frac{1}{2}\int_0^{2\pi}\int_0^{2\pi}
       \sum_{k=-K}^{K}\sum_{l=-L}^{L}
       \left[\left(\frac{2\pi k}{D_x}\right)^2
                   +\left(\frac{2\pi l}{D_y}\right)^2 
       \right]\tilde{\psi}_{k,l}e^{ikx^*+ily^*} \\
    & &\cdot\sum_{k'=-K}^{K}\sum_{l'=-L}^{L}
       \left[\left(\frac{2\pi k'}{D_x}\right)^2
                   +\left(\frac{2\pi l'}{D_y}\right)^2 
       \right]\tilde{\psi}_{k'l'}e^{ik'x^*+il'y^*}
       dx^* dy^* \\
   &=& \frac{D_xD_y}{(2\pi)^2}\frac{1}{2}
       \sum_{k=-K}^{K}\sum_{l=-L}^{L}
       \sum_{k'=-K}^{K}\sum_{l'=-L}^{L}
       \left[\left(\frac{2\pi k}{D_x}\right)^2
                   +\left(\frac{2\pi l}{D_y}\right)^2 
       \right]
       \left[\left(\frac{2\pi k'}{D_x}\right)^2
                   +\left(\frac{2\pi l'}{D_y}\right)^2 
       \right]\tilde{\psi}_{k,l}\tilde{\psi}_{k'l'}\\
    & &\cdot \int_0^{2\pi}\int_0^{2\pi}
         e^{ikx^*+ily^*}e^{ik'x^*+il'y^*}dx^* dy^* \\
   &=& \frac{D_xD_y}{(2\pi)^2}\frac{1}{2}
       \sum_{k=-K}^{K}\sum_{l=-L}^{L}
       \sum_{k'=-K}^{K}\sum_{l'=-L}^{L}
       \left[\left(\frac{2\pi k}{D_x}\right)^2
                   +\left(\frac{2\pi l}{D_y}\right)^2 
       \right]
       \left[\left(\frac{2\pi k'}{D_x}\right)^2
                   +\left(\frac{2\pi l'}{D_y}\right)^2 
       \right]\tilde{\psi}_{k,l}\tilde{\psi}_{k'l'}\\
   & & \cdot (2\pi)^2 \delta_{k,-k'} \delta_{l,-l'}\\
   &=& D_xD_y\frac{1}{2}
       \sum_{k=-K}^{K}\sum_{l=-L}^{L}
       \left[\left(\frac{2\pi k}{D_x}\right)^2
                   +\left(\frac{2\pi l}{D_y}\right)^2 
       \right]^2
       \tilde{\psi}_{k,l}\tilde{\psi}_{-k'-l}\\
\end{eqnarray*}
%
したがって, 
%
\begin{equation}
   Q = D_xD_y\frac{1}{2}
       \sum_{k=-K}^{K}\sum_{l=-L}^{L}
       \left[\left(\frac{2\pi k}{D_x}\right)^2
                   +\left(\frac{2\pi l}{D_y}\right)^2 
       \right]^2
       |\tilde{\psi}_{k,l}|^2,
\end{equation}
%
となる. そこで
%
\begin{equation}
   Q = \frac{1}{2}
       \left[\left(\frac{2\pi k}{D_x}\right)^2
                   +\left(\frac{2\pi l}{D_y}\right)^2 
       \right]^2
       |\tilde{\psi}_{k,l}|^2,
\end{equation}
%
をエンストロフィースペクトルの波数 $k,l$ 成分と呼ぶことができる. 

\end{document}

%%% Local Variables: 
%%% mode: latex
%%% TeX-master: t
%%% End: 
